<html xmlns="http://www.w3.org/1999/xhtml"><head><link href="/Agile/includes/grid/agile.css?_tgc=18920638" rel="Stylesheet" title="GridStyle">
<title> Agile Product Lifecycle Management - Welcome&nbsp;, Longsida, Wisit (wlongsid)</title>


<meta http-equiv="expires" content="Mon, 26 Jul 1997 05:00:00 GMT">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Cache-Control" content="no-store">
<meta http-equiv="Cache-Control" content="max-age=0">
<meta http-equiv="Cache-Control" content="must-revalidate">
<meta http-equiv="Cache-Control" content="post-check=0, pre-check=0">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="X-UA-Compatible" content="IE=11">

<meta name="upk-namespace" content="agile;9.3.1;en-US">
<script src="/Agile/static/d8306f084b3bc8f9981cc0c706d0109den_US/default/includes/ScriptMessages.jsp"></script>



<script>



var intStartDayOffset = 0; 






//Cancelled Warning option code
var WARN_CANCELLED = 1060;
var strAM = "AM";  // set JavaScript global vars for use in calendarControl
var strPM = "PM";
var FULL_MONTH_NAMES = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

var MONTH_NAMES = new Array("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec");

// Array of months for Month dropdown
var msNames = ["Jan", "Feb", "Mar", "Apr", "May",  "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];

// Array of days of the week for display on calander header row
/*var msDOW = ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"];*/

var msDOW = [];
var fsDOW = [];

msDOW[0] = "Sun"
fsDOW[0] = "Sunday"
msDOW[1] = "Mon"
fsDOW[1] = "Monday"
msDOW[2] = "Tue"
fsDOW[2] = "Tuesday"
msDOW[3] = "Wed"
fsDOW[3] = "Wednesday"
msDOW[4] = "Thu"
fsDOW[4] = "Thursday"
msDOW[5] = "Fri"
fsDOW[5] = "Friday"
msDOW[6] = "Sat"
fsDOW[6] = "Saturday"


//Calendar tooltip
var strCalToolTip = "Launch Calendar (Ctrl+L)";
//Month/Year anchor tooltips
var strNextMonth = "Next Month";
var strNextYear = "Next Year";
var strPrevMonth = "Previous Month";
var strPrevYear = "Previous Year";


//934 REQ00061
var RICHTEXT_INLINE_URL = '/Agile/static/f8e8450effabb50b33f95e97a7bcd151/default/InlineRichText.jsp?t=c4334c5893df17507395405876b4c765';

var agile_jsdebug_enabled = false;

</script>



<link href="/Agile/static/5333049fb7ea3586124f0ed33c53f90b/release/agile.css" rel="stylesheet" type="text/css" media="screen">



<script>
var AgilePopupLoadingImg = 'http\x3A\x2F\x2Fwwwix\x2Dpqmprd.cisco.com\x3A7009\x2FAgile\x2Fstatic\x2F71d359b0fa6667457cda0d22ddf29475\x2Fimages\x2Fpage_loader.gif';
var THEMED_CONTROL_HILITE_COLOR = "";
</script>






<script> var SearchFormName = 'MainForm'; </script>


		<script type="text/javascript" src="/Agile/static/2ba6049f6cef4481e3162aa31b1a0e75/release/core-ext-min.js"></script>
<script type="text/javascript" src="/Agile/static/da08311b66a662581c1d8f7deedf1f95/release/core-agile-min.js"></script>
<script type="text/javascript" src="/Agile/static/6c9cb3a7d44b9829842589d27122c710/release/agile-keylistener-min.js"></script>
<script type="text/javascript" src="/Agile/static/ba246746be0a3ff291ced47eb810d43e/release/agile-framework-min.js"></script>
<script type="text/javascript" src="/Agile/static/69f412a57fee7895bcad6f6aa50d6d01/release/agile-controls-min.js"></script>
<script type="text/javascript" src="/Agile/static/159a31d6619b8533da82c3a4177782fc/release/misc-min.js"></script>
<script type="text/javascript" src="/Agile/static/37531dd773e8aaabe990f9cbdd06847d/release/agile-table-min.js"></script><script>//<![CDATA[
var MS=new Object(),ME=new Object(),MX=new Object(),A=1,B=0; var _7A="<table cellspacing='0' cellpadding='0' "; var _7B="><tbody>",_7C="</tbody></table>"; var _7D="&#160;",_7E="='1'"; var _7F=navigator.appName.search("Opera")>=0; var _7G=_7F?0:navigator.userAgent.search("Opera")>=0; var _7H=parseFloat(navigator.appVersion); var _7I=navigator.userAgent.search("Safari")>=0; var _7J=_7I&&navigator.userAgent.search("Windows")>=0; var _7K=navigator.userAgent.search("KHTML")>=0; var _7L=_7K?parseFloat(navigator.userAgent.slice(navigator.userAgent.search("KHTML")+6)):0; var _7M=_7K&&!_7I&&!_7J; var D=_7K&&navigator.userAgent.search("Chrome")>=0; var _7N=navigator.appName.search("Netscape")>=0&&!_7G&&!_7K; var _7O=document.compatMode=="CSS1Compat"; var _7P=!_7G&&(navigator.appName.search("Microsoft")>=0|| navigator.userAgent.search(/MSIE|Trident.*; rv:[0-9.]+/)>=0); var _7Q=_7P&&!_7O; var _7R=_7P&&!_7Q; var _7S=_7Q&&navigator.appVersion.search("MSIE 5")>=0; var _7T=_7P&&navigator.appVersion.search("MSIE 6")>=0||_7S; var _7U=_7P&&(document.documentMode>=8||navigator.userAgent.search(/MSIE\s*(8|9|10)|Trident.*; rv:[0-9.]+/)>=0); var F=_7U&&_7R; if(_7T)try{document.execCommand("BackgroundImageCache",false,true);}catch(H){}; var _7V=navigator.userAgent.search("Netscape")>=0; var _7W=_7N&&navigator.userAgent.search("Firefox/1.")>=0; var _7X=_7N&&navigator.userAgent.search("Firefox/1.5")>=0; var _7Y=_7N&&navigator.userAgent.search("Firefox/3.")>=0; if(_7S)undefined=null; if(_7K){_7B=">";_7C="</table>";} var _7Z=0,_7a=0; var _7b=_7S?"cursor:hand;":"cursor:pointer;"; try{if(_7T)document.execCommand("BackgroundImageCache",false,true);}catch(H){}; var _7c=60024; var _7d=60024; var MS=new Object(),ME=new Object(),MX=new Object(); function _7e(){ this.Visible=true;}; function _7f(){}; function _7g(){ this.I=0;this.J=0; this.Tag=null; this.Move=3;}; function TDataIO(){this.Data={Param:{}};this.Layout={Param:{}};this.Base={Param:{}};this.Defaults={Param:{}};this.Text={Param:{}};this.Upload={Param:{}};this.Export={Param:{}};this.Page={Param:{}};this.Check={Param:{}};}; function _7h(){ this.Index=-1; this.K=""; this.id=""; this.Tag=""; this.L=[null,null,null]; this.N=[null,null,null]; this.O=[null,null,null]; this.P=1; this.Q=1; this.Paging=0; this.PageLength=20; this.ChildPaging=0; this.U=1; this.V=0; this.RowCount=0; this.SortCols=[]; this.SortTypes=[]; this.W=0; this.GroupCols=[]; this.GroupTypes=[]; this.Z=0; this.b=0; this.MaxHeight=0; this.c=0; this.d=0; this.XB=_7i.createElement("U"); this.XH=_7i.createElement("U"); this.XF=_7i.createElement("U"); this.XS=_7i.createElement("U"); this.Body=this.XB;this.Head=this.XH;this.Foot=this.XF;this.Solid=this.XS; this.Root=_7i.createElement("U"); this.Header=_7i.createElement("U"); this.Toolbar=_7i.createElement("U"); this.Filter=null; this.Cols={}; this.ColNames=[[],[],[]]; this.Def={}; this.e=null; this.MenuCfg={}; this.MenuColumns={}; this.Pager={}; this.Img={}; this.f={}; this.g={}; this.Actions={}; this.Mouse={}; this.Lang={Format:new h()}; this.Par={}; this.l={}; for(var i=65;i<91;i++)this.l[i]=String.fromCharCode(i); for(var i=48;i<58;i++)this.l[i]="D"+String.fromCharCode(i); this.m={}; this.ActionFormulas={}; this.n={}; this.o={}; this.p={}; this.Flags={}; this.q={}; this.r={}; this.s={}; this.t={}; this.u={}; this.v=[]; this.w=0;this.z=0;this.AA=0;this.AB=0; this.AC=[]; this.AD=[]; this.Event={}; this.AE={}; this.AF=1;}; if(!window.Grids||!Grids.OnDemand)var Grids=new Array(); Grids.Keys=new Array(); Grids.AG=[0,2,5,10,30,60,120,300,600]; Grids.CacheVersion=Math.floor(Math.random()*1e8); Grids.AH=new Object(); var AI=document.createElement("I"); for(var i in AI)Grids.AH[i]=true; var AJ=new Object(); AJ[95]=1; for(var i=65;i<91;i++){AJ[i]=1;AJ[i+32]=1;} for(var i=48;i<58;i++)AJ[i]=1; Grids.AK=AJ; function GetGrids(){ var AJ=[]; for(var i=0;i<Grids.length;i++){ var G=Grids[i]; if(G&&Grids[G.id]==G)AJ[AJ.length]=G;} return AJ;}; function _7j(){ this.childNodes={length:0};}; _7j.prototype.removeChild=function(AL){ if(!AL)return null; var AM=AL.parentNode; if(!AM)return null; if(AL==AM.firstChild)AM.firstChild=AL.nextSibling; else AL.previousSibling.nextSibling=AL.nextSibling; if(AL==AM.lastChild)AM.lastChild=AL.previousSibling; else AL.nextSibling.previousSibling=AL.previousSibling; AL.parentNode=null; AL.previousSibling=null; AL.nextSibling=null; this.childNodes.length--; return AL;}; _7j.prototype.appendChild=function(AL){ if(!AL)return null; if(AL.parentNode)AL.parentNode.removeChild(AL); if(this.lastChild){ this.lastChild.nextSibling=AL; AL.previousSibling=this.lastChild;} else{ this.firstChild=AL; AL.previousSibling=null;}; this.lastChild=AL; AL.nextSibling=null; AL.parentNode=this; this.childNodes.length++; return AL;}; _7j.prototype.insertBefore=function(AL,AN){ if(!AL)return null; if(!AN)return this.appendChild(AL); if(AN.parentNode!=this)return null; if(AL.parentNode)AL.parentNode.removeChild(AL); if(AN.previousSibling)AN.previousSibling.nextSibling=AL; else this.firstChild=AL; AL.previousSibling=AN.previousSibling; AL.nextSibling=AN; AN.previousSibling=AL; AL.parentNode=this; this.childNodes.length++; return AL;}; _7j.prototype._7k=function(AO){ for(var AP=this.firstChild;AP&&AO;AP=AP.nextSibling)AO--; return AP;}; _7j.prototype._7l=function(){ this.firstChild=null; this.lastChild=null; this.childNodes.length=0;}; function _7k(row,AO){ return row._7k?row._7k(AO):row.childNodes[AO];}; function _7l(row){ if(row._7l)row._7l(); else row.innerHTML="";}; function _7m(){}; _7m.prototype=new _7j(); _7m.prototype.createElement=function(name){ var E=new _7j(); E.tagName=name; E.nodeName=name; return E;}; var _7i=_7P?document:new _7m(); var Requests=[]; var AQ={ Url:null, Method:null, Sync:0, ReturnXml:0, Xml:0, Param:{}, Params:"", Timeout:60, Repeat:0, RepeatText:"", Envelope:"", Namespace:"", Function:"", AR:0}; function AjaxCall(AS,Data,AT){ if(!AS)return; if(typeof(AS)=="string")AS={Url:AS}; else if(!AS.Url)return; if(AS.Sync==null)AS.Sync=AT?0:1; for(AS.id=0;Requests[AS.id];AS.id++); Requests[AS.id]=AS; AS.K="Requests["+AS.id+"]"; for(var i in AQ)if(AS[i]==null)AS[i]=AQ[i]; if(!Requests.Interval)Requests.Interval=setInterval(Requests.Timeout,500); AS.AU=Data; if(AS.Debug&&AS.Debug["out"]){ if(!Data)AS.Grid.Debug(3,"AJAX for ",AS.Name+"_Url='"+AS.Url+"'",": No request XML to send"); else AS.Grid.AV(AS,Data,"a request XML to send to server:");} var content="",AW=""; var name=AS.Data;if(!name)name="Data"; var AX=AS.Method?(AS.Method+"").toLowerCase():null;if(!AX)AX=Data?"form":"get";if(AX=="post")AX="form"; if(Data&&!AS.Xml)Data=(Data+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"); if(AX=="soap"){ var AY="soap"; AW='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">'; if(AS.Envelope){ AW=AS.Envelope; var M=AW.match(/^\<(\w*)\:/); if(M&&M[1])AY=M[1];} AW+="<"+AY+":Body><"+AS.Function+(AS.Namespace?" xmlns='"+AS.Namespace+"'>":""); if(name)AW+="<"+name+">"+Data+"</"+name+">"; if(AS.Param)for(var i in AS.Param)AW+="<"+i+">"+AS.Param[i]+"</"+i+">"; if(AS.Params)AW+=AS.Params; AW+="</"+AS.Function+"></"+AY+":Body></"+AY+":Envelope>"; content="text/xml";} else{ if(AS.Param)for(var i in AS.Param)AW+=(AW?"&":"")+encodeURIComponent(i)+"="+encodeURIComponent(AS.Param[i]); if(AS.Params)AW+=(AW?"&":"")+encodeURI(AS.Params); if(AX=="form"){ if(name)AW+=(AW?"&":"")+encodeURIComponent(name)+"="+encodeURIComponent(Data); content="application/x-www-form-urlencoded";}}; if(AS.Debug&&AS.Debug["raw"]&&Data){ if(!AW)AS.Grid.Debug(3,"AJAX for ",AS.Name+"_Url='"+AS.Url+"'",": No request was finally sent because of setting Method=","Get"); else AS.Grid.AV(AS,AW,"a request sent to server:");} var AZ; if(!AT&&AS.Sync){ AT=function(code,data){AZ=code<0?code:data;}} var Aa=Requests.Ab(); AS.Aa=Aa; AS.Ac=(new Date()).getTime()+(AS.Timeout>=0?AS.Timeout*1000:60000); AS.AT=AT; try{ Aa.onreadystatechange=new Function(AS.K+".Finish();"); var Ad=AS.Url; if(AX=="get"){ if(AW){Ad=Ad+((Ad+"").indexOf('?')>=0?"&":"?")+AW;AW="";} if(AS.Grid)Ad=AS.Grid.Ae(Ad,AS.Cache);} if(_7Y&&!content&&AX=="get"&&location.protocol=="file:"&&AS.Url.indexOf("p://")<0){ if(document.cookie.search(/TGFF3SA\s?\=\s?1/)<0){ alert("In Firefox 3 is disabled reading local files from different directories.\nTreeGrid requires access to its data source XML files.\nYou need to permit the access in the next dialog.\nOr you can run the page from your localhost server."); var exp=new Date();exp.setDate(exp.getDate()+1); document.cookie="TGFF3SA=1; expires="+exp.toUTCString();} netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");} try{Aa.open(content?"POST":"GET",Ad,AS.Sync?false:true);} catch(H){ if(_7P&&window.XMLHttpRequest){ AS.Aa=Requests.Ab(1); if(AS.Aa)AS.Aa.onreadystatechange=Aa.onreadystatechange; Aa=AS.Aa; try{Aa.open(content?"POST":"GET",Ad,AS.Sync?false:true);} catch(H){ if(_7P&&!content&&AX=="get"&&location.protocol=="file:"&&AS.Url.indexOf("p://")<0){ AS.Aa=new ActiveXObject("Microsoft.XMLDOM"); if(AS.Aa){ AS.Aa.async="false"; AS.Aa.onreadystatechange=new Function(AS.K+".Finish();"); AS.Aa.load(Ad); return;} else throw(H);}}} else throw(H);}; if(content)Aa.setRequestHeader("Content-Type",content+"; charset=UTF-8"); if(AX=="soap")Aa.setRequestHeader("SOAPAction",(AS.Namespace?AS.Namespace+"/":"")+AS.Function);} catch(H){ if(AS.Grid)AS.Grid.Debug(1,"Cannot access the ",AS.Name+"_Url='"+AS.Url+"'",", exception raised: ",H.message?H.message:H); if(AT)AT(-2,H.message?H.message:H); return;}; try{Aa.send(AW);} catch(H){ if(AS.Grid)AS.Grid.Debug(1,"Cannot access the ",AS.Name+"_Url='"+AS.Url+"'",", exception raised: ",H.message?H.message:H); if(AT)AT(-3,H.message?H.message:H);}; if(AS.Sync&&Requests[AS.id])AS.Finish(); return AZ;}; AQ.Finish=function(){ var Aa=this.Aa; if(!Aa||Aa.readyState!=4)return; var AS=this,AT=this.AT,Af=0; try{Af=Aa.status;}catch(H){}; this.Aa=null; if(Af==0){ if(this.Ac<0){ if(this.Grid)this.Grid.Debug(2,"Timeout ("+(AS.Timeout>=0?AS.Timeout:60)+" sec) expired when accessing the ",AS.Name+"_Url='"+AS.Url+"'"); this.Delete(); var Ag=0; if(this.Repeat==3)Ag=1; else if(IO.Repeat==2){if(confirm(this.RepeatText))Ag=1;} if(Ag){ Ah(this,this.AU,AT); return;} if(this.Grid)this.Grid.Debug(1,"Timeout ("+(AS.Timeout>=0?AS.Timeout:60)+" sec) expired when accessing the ",AS.Name+"_Url='"+AS.Url+"'",", communication failed"); if(AT)AT(-6); return;}} else if(Af<100||Af>=400){ var Ai=Aa.statusText,Aj=Aa.responseText; if(_7P&&Af<100&&Aj=="")return; if(this.Grid&&Grids.OnDataErrorDebug)Grids.OnDataErrorDebug(this.Grid,Af,Ai,Aj); if(this.Grid){ this.Grid.Debug(1,"Error in communication with server from ",AS.Name+"_Url='"+AS.Url+"'"," ! Server response: ","["+Af+"] "+Ai); if((this.Grid.DebugFlags["ioerror"]||AS.Debug&&AS.Debug["in"])&&Aj)this.Grid.AV(AS,Aj,"a response XML got from server:");} this.Delete(); if(AT){ AT(-3,"["+Af+"] "+Ai);} return;} var Ai=Aa.responseText; if(!Ai&&_7P&&Af==null)Ai=Aa.xml; if(!Ai){ if(this.Grid)this.Grid.Debug(1,"Empty xml received from server from ",AS.Name+"_Url='"+AS.Url+"'"); if(AT)AT(-4); return;} if(this.Grid&&AS.Debug&&AS.Debug["in"])this.Grid.AV(AS,Ai,"a response XML got from server:"); this.Delete(); if(AT)AT(0,Ai,this.ReturnXml?Aa.responseXML:null);}; AQ.Delete=function(){ this.Aa=null; delete Requests[this.id]; this.id=null;}; Requests.Timeout=function(){ var Ak=(new Date()).getTime(); for(var i=0;i<Requests.length;i++){ if(Requests[i])if(Requests[i].Ac>0&&Requests[i].Ac<Ak){Requests[i].Ac=-1;if(Requests[i].Aa)Requests[i].Aa.abort();}}}; Requests.Ab=function(Al){ if(window.XMLHttpRequest&&!Al)return new XMLHttpRequest(); if(window.ActiveXObject){ if(Requests._7n)return new ActiveXObject(Requests._7n); var Am,An=["Msxml3.XMLHTTP","Msxml2.XMLHTTP","Microsoft.XMLHTTP"]; for(var i=0;i<An.length;i++){ try{ var Aa=new ActiveXObject(An[i]); Requests._7n=An[i]; return Aa;} catch(H){Am=H.message;}} return Am;} return null;}; var Ao={ Class:"GMPick", Popup:1, CanFocus:1, RowsPrev:0, RowsNext:0, MinHeight:0, NoScroll:1, Text:{Ap:"Today",Clear:"Clear",Aq:"OK"}, AR:0}; function Ar(M,AM){ if(!M)M={}; else M=As(M); for(var i in Ao)if(M[i]==null)M[i]=Ao[i]; Dialogs.Add(M); var At=M.Date; if(M.Range){ M.Multi=[],Au=0; if(!At)At=new Date(); else{ if(typeof(At)=="object"){ if(s.GMT-0)At.setUTCHours(0,0,0,0); else At.setHours(0,0,0,0); At=At.getTime();} var AJ=(At+"").split(s.ValueSeparator);At=null; for(var i=0;i<AJ.length;i++){ var AN=AJ[i].split(s.RangeSeparator); if(!At)At=new Date(AN[0]-0); M.Multi[Au++]=AN[0]-0; M.Multi[Au++]=AN[AN[1]?1:0]-0;}}} else if(!At)At=new Date(); else if(typeof(At)!="object")At=new Date(At-0+""==At?At-0:s._7o(At)); if(s.GMT-0){M.Year=At.getUTCFullYear();M.Month=At.getUTCMonth();M.Av=At.getUTCDate();} else{M.Year=At.getFullYear();M.Month=At.getMonth();M.Av=At.getDate();}; M.Aw=M.Year;M.Ax=M.Month;M.Ay=M.Av; if(M.Az)M.Az=M._7p(M.Az); M.A0=s.DateToString(At,M.Az); At=new Date(); if(s.GMT-0){M.A1=At.getFullYear();M.A2=At.getMonth();M.A3=At.getDate();} else{M.A1=At.getFullYear();M.A2=At.getMonth();M.A3=At.getDate();}; M.A4(); M.OnWidth=function(T,A5){M.A6();}; ShowDialog(M,AM); M.A7(); M.A8(); return M;}; Ao.A6=function(){ var AS=this.A9().firstChild.firstChild.firstChild; AS.style.display="block"; AS.nextSibling.style.display="block";}; Ao._7p=function(BA){ var Ak=BA,BB="",BC=' :hHmstz'; if(Ak.length==1)Ak=_7q[Ak]; for(var i=0;i<Ak.length;i++){ var BD=Ak.charAt(i); if(BC.indexOf(BD)>=0)BB+=BD; else if(BD=='\\')i++; else if(BD=='"'||BD=="'")while(i<Ak.length&&i.charAt(i)!=BD)i++;} BB=BB.replace(/(^\s*)|(\s*$)/g,""); return BB;}; Ao.A4=function(){ var BE=s.GMT-0; var BF=s.FirstWeekDay-0; var BG=new Date(this.Year,this.Month,0);BG=s.GMT-0?BG.getUTCDate():BG.getDate(); var BH=new Date(this.Year,this.Month+1,0);BH=s.GMT-0?BH.getUTCDate():BH.getDate(); var BI=new Date(this.Year,this.Month,1);BI=s.GMT-0?BI.getUTCDay():BI.getDay();BI-=BF;if(BI<0)BI+=7; var AJ=new Array(),Au=0,BJ=" class='"+this.Class; AJ[Au++]="<div onmouseup='"+this.K+".PickDrag(4);'>"; AJ[Au++]="<div"+BJ+"BL' onclick='"+this.K+".MYChg(-1);'>"+_7D+"</div>"; AJ[Au++]="<div"+BJ+"BR' onclick='"+this.K+".MYChg(1);'>"+_7D+"</div>"; var BK=s.LongMonthNames[this.Month]+_7D+this.Year+_7D; AJ[Au++]="<div"+BJ+"MY' dir='ltr'><span"+BJ+"MYDown' onclick='"+this.K+".Render(1)'>"+BK+"</span></div>"; AJ[Au++]=_7A+BJ+"Table'"+_7B; var x=BF,BL="<td"+BJ+"Cell'><div"; AJ[Au++]="<tr"+BJ+"RowW'>"; for(var i=0;i<7;i++){ AJ[Au++]=BL+BJ+"WDN'>"+s.Day2CharNames[x+i>=7?x+i-7:x+i]+"</div></td>";} AJ[Au++]="</tr>"; var BM=1-BI-(7*this.RowsPrev),BN=!this.ReadOnly; var BO=-BF;if(BO<0)BO+=7; var BP=6-BF;if(BP<0)BP+=7; for(var AP=0;AP<this.RowsPrev+this.RowsNext+6;AP++){ AJ[Au++]="<tr"+BJ+"Row'>"; for(var BD=0;BD<7;BD++){ var BQ=BJ+"WD";if(BD==BO)BQ=BJ+"Su";else if(BD==BP)BQ=BJ+"Sa"; var AS=BE?new Date(Date.UTC(this.Year,this.Month,BM)):new Date(this.Year,this.Month,BM); var BR=AS.getDate(); if(BM<=0||BM>BH)BQ=BJ+"OM"; if(this.Year==this.A1&&this.Month==this.A2&&BM==this.A3)BQ=BJ+"Now"; if(!this.Multi&&this.Year==this.Aw&&this.Month==this.Ax&&BM==this.Ay)BQ=BJ+"Sel"; var BS=this.OnCanEditDate?this.OnCanEditDate(AS):BN; if(BS){ var BT=AS.getTime(); if(this.Multi)AJ[Au++]=BL+(this.IsSel(BT)?BJ+"Sel":BQ)+"'"+" onmouseover='this.className="+this.K+".IsSel("+BT+")?\""+BJ.slice(8)+"SelHover\":\""+BJ.slice(8)+"Hover\";"+this.K+".PickDrag(1,"+BT+");'"+" onmouseout='this.className="+this.K+".IsSel("+BT+")?\""+BJ.slice(8)+"Sel\":\""+BQ.slice(8)+"\";"+this.K+".PickDrag(2,"+BT+");'"+" onmousedown='"+this.K+".PickDrag(3,"+BT+");CancelEvent(event);'"+" id='GPick_"+BT+"_"+BQ.slice(8)+"'"+">"+BR+"</div></td>"; else AJ[Au++]=BL+BQ+"'"+" onmouseover='this.className=\""+this.Class+"Hover\";'"+" onmouseout='this.className=\""+BQ.slice(8)+"\";'"+" onclick='"+this.K+".DayClick("+BM+");'>"+BR+"</div></td>";} else AJ[Au++]=BL+BQ+"NE'>"+BR+"</div></td>"; BM++;} AJ[Au++]="</tr>";} AJ[Au++]=_7C; if(this.Az&&!this.Multi){ this.BU="G"+this.id+"Time"; var BB=this.Az.indexOf('t')>=0&&this.Az.indexOf('h')>=0; AJ[Au++]="<div"+BJ+"TimeCell'><input"+BJ+"Time' id='"+this.BU+"' type='text'"; AJ[Au++]=" value='"+this.A0+"'"; AJ[Au++]=" onkeydown='var k=event.keyCode;if(!k)k=event.charCode;if(k==13)"+this.K+".DayClick(); if(k==27)"+this.K+".Close(); CancelEvent(event,1)'"; AJ[Au++]=" onkeypress='if(window.KeyDate) KeyDate(event,this,"+(BB?1:0)+")'"; AJ[Au++]="/></div>";} var BV=this.Buttons;if(BV==null)BV=this.Multi?7:0; if(BV){ var BW=" style='visibility:hidden;'"; AJ[Au++]="<div"+BJ+"Footer'>"; AJ[Au++]="<button"+BJ+"Button'"+(BV&1?"":BW)+" onclick='"+this.K+".BClick(0);'>"+this.Text.Ap+"</button>"; AJ[Au++]="<button"+BJ+"Button'"+(BV&2?"":BW)+" onclick='"+this.K+".BClick(1);'>"+this.Text.Clear+"</button>"; AJ[Au++]="<button"+BJ+"Button'"+(BV&4?"":BW)+" onclick='"+this.K+".BClick(2);'>"+this.Text.Aq+"</button>"; AJ[Au++]="</div>";} AJ[Au++]="</div>"; this.Body=AJ.join("");}; Ao.BX=function(BY){ var AJ=new Array(),Au=0,BJ=" class='"+this.Class; AJ[Au++]="<div onmouseup='"+this.K+".PickDrag(4);'>"; AJ[Au++]="<div"+BJ+"BL' onclick='"+this.K+".MYChg(-1);'>"+_7D+"</div>"; AJ[Au++]="<div"+BJ+"BR' onclick='"+this.K+".MYChg(1);'>"+_7D+"</div>"; var BK=s.LongMonthNames[this.Month]+_7D+this.Year+_7D; AJ[Au++]="<div"+BJ+"MY' dir='ltr'><span"+BJ+"MYUp' onclick='"+this.K+".Render()'>"+BK+"</span></div>"; AJ[Au++]="<div"+BJ+"2SepH'>"+_7D+"</div>"; AJ[Au++]=_7A+BJ+"2Table'"+_7B; if(!BY)this["FY"]=Math.floor(this.Year/5)*5;if(this.Year-BZ<2)BZ-=5; var BZ=this["FY"]; for(var i=0;i<6;i++){ AJ[Au++]="<tr"+BJ+"2Row'>"; for(var j=0;j<=6;j+=6){ AJ[Au++]="<td"+BJ+"2Cell'><div"+BJ+"2M"+(i+j==this.Month?"Sel":"")+"'"+" onmouseover='this.className=\""+this.Class+"2M"+((i+j==this.Month?"Sel":""))+"Hover\";'"+" onmouseout='this.className=\""+this.Class+"2M"+((i+j==this.Month?"Sel":""))+"\";'"+" onclick='"+this.K+".Month="+(i+j)+";"+this.K+".Render(2);'"+">"+s.ShortMonthNames[i+j]+"</div></td>";} AJ[Au++]="<td><div"+BJ+"2Sep'>"+_7D+"</div></td>"; if(!i){ AJ[Au++]="<td"+BJ+"2Cell'><div"+BJ+"2BL' onclick='"+this.K+".FY-=5;"+this.K+".Render(2);'>"+_7D+"</div></td>"; AJ[Au++]="<td"+BJ+"2Cell'><div"+BJ+"2BR' onclick='"+this.K+".FY+=5;"+this.K+".Render(2);'>"+_7D+"</div></td>";} else{ for(var j=-1;j<=4;j+=5){ AJ[Au++]="<td"+BJ+"2Cell'><div"+BJ+"2Y"+(BZ+i+j==this.Year?"Sel":"")+"'"+" onmouseover='this.className=\""+this.Class+"2Y"+((BZ+i+j==this.Year?"Sel":""))+"Hover\";'"+" onmouseout='this.className=\""+this.Class+"2Y"+((BZ+i+j==this.Year?"Sel":""))+"\";'"+" onclick='"+this.K+".Year="+(BZ+i+j)+";"+this.K+".Render(2);'"+">"+(BZ+i+j)+"</div></td>";}}; AJ[Au++]="</tr>";} AJ[Au++]=_7C; AJ[Au++]="<div"+BJ+"2Footer'>"; AJ[Au++]="<button"+BJ+"Button' style='visibility:hidden;'>"+this.Text.Ap+"</button>"; AJ[Au++]="<button"+BJ+"Button' style='visibility:hidden;'>"+this.Text.Clear+"</button>"; AJ[Au++]="<button"+BJ+"Button' onclick='"+this.K+".Render();'>"+this.Text.Aq+"</button>"; AJ[Au++]="</div>"; AJ[Au++]="</div>"; this.Body=AJ.join("");}; Ao.Render=function(type){ if(type)this.BX(type-1); else this.A4(); this.A9().firstChild.innerHTML=this.Body; this.A6(); this.A7(); this.A8(); this.Ba(); if(_7r!=1)this.Tag.innerHTML=this.Tag.innerHTML;}; Ao.A8=function(){ if(!this.Az)return; var AI=GetElem(this.BU); if(!AI)return; try{ AI.focus(); if(AI.select)AI.select();} catch(H){}}; Ao.MYChg=function(dir){ this.Month+=dir; while(this.Month<0){this.Year--;this.Month+=12;} while(this.Month>11){this.Year++;this.Month-=12;} this.Render();}; Ao.DayClick=function(BM){ var BE=s.GMT-0; var Bb=BE?new Date(Date.UTC(this.Year,this.Month,BM==null?this.Av:BM)):new Date(this.Year,this.Month,BM==null?this.Av:BM); if(this.Az){ var AI=GetElem(this.BU); if(AI){ var Ak=s.StringToDate(AI.value,this.Az); if(Ak){ Ak=new Date(Ak); if(BE)Bb.setUTCHours(Ak.getUTCHours(),Ak.getUTCMinutes(),Ak.getSeconds()); else Bb.setHours(Ak.getHours(),Ak.getMinutes(),Ak.getSeconds());}}} Bb=Bb.getTime(); this.Save(Bb);}; Ao.Close=function(){ this.Delete();}; Ao.Save=function(Bb){ if(this.OnSave)this.OnSave(Bb); this.Close();}; Ao.IsSel=function(BM){ if(this.Bc&&(BM>=this.Bd&&BM<=this.Be||BM>=this.Be&&BM<=this.Bd))return this.Bf; for(var i=0;i<this.Multi.length;i+=2){ if(BM>=this.Multi[i]&&BM<=this.Multi[i+1])return true;} return false;}; Ao.PickDrag=function(Bg,Bh,Bi){ if(!this.Bc&&Bg!=3)return; switch(Bg){ case 1: this.Be=Bh; this.Update(); Bj(); break; case 2: break; case 3: this.Bc=1; this.Bd=Bh; this.Be=Bh; this.Bf=1; this.Update(); break; case 4: this.Bc=0; if(this.Bd==this.Be){ this.DaySelect(this.Bd); this.Update();} else{ var M=this.Multi; M[M.length]=this.Bd<this.Be?this.Bd:this.Be; M[M.length]=this.Bd<this.Be?this.Be:this.Bd; this.Update();}; if(this.OnChange)this.OnChange(s.Bk(this.Multi)); break;}; return false;}; Ao.Update=function(){ var Bi=this.Tag.getElementsByTagName("table")[0].getElementsByTagName("div"); for(var i=0;i<Bi.length;i++){ var id=Bi[i].id; if(!id)continue; id=id.split('_'); var BQ=Bi[i].className,Bl=BQ.toLowerCase().indexOf("hover")>=0; var Bm=this.IsSel(id[1])?this.Class+"Sel"+(Bl?"Hover":""):(Bl?this.Class+"Hover":id[2]); if(BQ!=Bm)Bi[i].className=Bm;} this.A7();}; Ao.DaySelect=function(Bh,Bi){ var M=this.Multi; var BI=new Date(Bh),Bn=new Date(Bh); BI.setDate(BI.getDate()+1);BI=BI.getTime(); Bn.setDate(Bn.getDate()-1);Bn=Bn.getTime(); for(var i=0;i<M.length;i+=2){ if(Bh>=M[i]&&Bh<=M[i+1]){ if(Bh==M[i]){ if(Bh==M[i+1]){M[i]=null;M[i+1]=null;} else M[i]=BI;} else if(Bh==M[i+1])M[i+1]=Bn; else{ M[M.length]=BI; M[M.length]=M[i+1]; M[i+1]=Bn;}; if(Bi)Bi.className=this.Class+"Hover"; return;}} if(Bi)Bi.className=this.Class+"SelHover"; for(var i=0;i<M.length;i+=2){ if(BI==M[i]){M[i]=Bh;return;} if(Bn==M[i+1]){M[i+1]=Bh;return;}} M[M.length]=Bh; M[M.length]=Bh;}; Ao.A7=function(){}; Ao.BClick=function(Bo){ if(Bo==0){ var BE=s.GMT-0; var Bb=new Date();if(BE)Bb.setUTCHours(0,0,0,0);else Bb.setHours(0,0,0,0); this.Save(Bb.getTime());} if(Bo==1){ if(this.Multi){ this.Multi=[]; this.A7(); this.Render(); if(this.OnChange)this.OnChange("");} else{ this.Save("");}} if(Bo==2){ if(this.Multi)this.Save(s.Bk(this.Multi)); else this.DayClick();}}; Ao.Bp=function(Bq,Br){ var M=this; if(Bq==27){if(M.Popup)M.Close(1);}}; Dialogs=[]; Dialogs.X=0;Dialogs.Y=0; var Bs={ Base:"GMMenu", CloseTimeout:300, HeadDrag:1, HeadClose:1, Shift:-1, Shadow:1, ShadowHeader:1, ShadowWidth:7, AppendHeader:1, MinEdge:3, ResizeUpdate:1, ScrollUpdate:1, AR:0}; function ShowDialog(M,AM){ if(!M)return; M=As(M); if(typeof(M)=="string")M={Body:M}; if(!AM)AM=M.Pos; AM=Bs.Bt(AM); if(M.id!=null&&M.Tag&&M.Close)M.Close(); Dialogs.Add(M); for(var i in Bs)if(M[i]==null)M[i]=Bs[i]; M.Tag=null;M.Bu=null;M.Bv=null;M.Bw=null; var align=Bx(AM.Align),By=Bx(AM.AlignHeader); var x=0,y=0,width=0,height=0; if(AM.Tag){ if(typeof(AM.Tag)!="object")AM.Tag=GetElem(AM.Tag); var AJ=_7s(AM.Tag),AN=_7t(); x=AJ[0]-AN[0];y=AJ[1]-AN[1];width=AM.Tag.offsetWidth;height=AM.Tag.offsetHeight; M.BaseTag=AM.Tag;} if(AM.X)x+=AM.X;if(AM.Y)y+=AM.Y;if(AM.Width)width+=AM.Width;if(AM.Height)height+=AM.Height; if(AM.Left)x+=AM.Left;if(AM.Top)y+=AM.Top; if(M.ClosePos)M.Cell=[x,y,width,height]; if(M.CloseMove)M.Bz=[Dialogs.X,Dialogs.Y]; if(AM.Mouse){ var C=_7u({clientX:Dialogs.X,clientY:Dialogs.Y,type:1}); if(C[0])x+=C[0];if(C[1])y+=C[1]; if(AM.Tag){ x-=AJ[0]-AN[0];y-=AJ[1]-AN[1]; if(M.Cell){if(AM.X)M.Cell[0]-=AM.X;if(AM.Y)M.Cell[1]-=AM.Y;}} else if(M.Cell)M.Cell=[x,y,width,height];} if(M.Area&&typeof(M.Area)=="string")M.Area=GetElem(M.Area); if(M.Header){ var AS=document.createElement("div"); AS.className=M.B0("Header")+" "+M.B0("Header"+(align.prev?"Left":align.next?"Right":align.above?"Top":"Bottom")); AS.style.left=x+"px"; AS.style.top=y+"px"; if(!By.left&&!By.right&&width)AS.style.width=width+"px"; if(!By.top&&!By.bottom&&height)AS.style.height=height+"px"; AS.innerHTML="<div>"+M.Header+"</div>"; AS.style.visibility="hidden"; if(M.CloseClick)M.B1(AS); else if(M.CloseClickHeader)AS.onclick=new Function(M.K+".Close()"); else if(M.CloseClickOut)AS.onclick=CancelEvent; B2(AS); M.Bw=AS; if(!_7Q){ if(!By.left&&!By.right&&width)AS.style.width=(width-AS.offsetWidth+AS.clientWidth)+"px"; if(!By.top&&!By.bottom&&height)AS.style.height=(height-AS.offsetHeight+AS.clientHeight)+"px";} if(By.right&&width)AS.style.left=(x+width-AS.offsetWidth)+"px"; if(By.bottom&&height)AS.style.top=(y+height-AS.offsetHeight)+"px"; if(M.AppendHeader&1)height=AS.offsetHeight; if(M.AppendHeader&2)width=AS.offsetWidth;} var B3="",B4=" onclick='CancelEvent(event)'";if(M.CloseClick)B4=""; if(M.Head){ B3+="<div"+M.B5("Head")+(M.HeadDrag&&window.B6?" onmousedown='"+M.K+".StartDrag();CancelEvent(event);'":"")+B4+">"+"<div"+M.B5("Close")+" onclick='"+M.K+".Close()'>"+_7D+"</div>"+M.Head+"</div>";} B3+="<div"+M.B5("Body")+" style='"+(M.Wrap==null?"":"white-space:"+(M.Wrap?"normal":"nowrap")+";")+(_7Q||_7T?"width:0px;overflow-x:visible;":"")+"height:50px;'"+B4+">"+(M.InDiv?M.Body:"<div>"+M.Body+"</div>")+"</div>"; if(M.Foot)B3+="<div"+M.B5("Foot")+B4+">"+M.Foot+"</div>"; if(M.Modal)B7(); var AS=document.createElement("div"); M.Tag=AS; AS.className=M.B0("Main"); AS.style.visibility="hidden"; if(M.Bw)document.body.insertBefore(AS,M.Bw); else B2(AS); AS.innerHTML="<div"+M.B5("Outer")+">"+B3+"</div>"; if(M.CloseClick)M.B1(AS); if(M.OnShow)M.OnShow(M.Tag); M.SetWidth(M.Tag,width); if(_7Q||_7T||_7F)M.A9().style.overflowY="hidden"; M.B8=AS.offsetHeight-50; if(_7Q||_7T||_7F)M.A9().style.overflowY=""; M.Align=align;M.Width=width;M.Height=height;M.X=x;M.Y=y;M.Pos=AM; M.UpdatePos(); if(M.HeadClose&&M.Head)AS.firstChild.firstChild.firstChild.style.display="block"; AS.style.visibility=""; if(M.Bw){ M.Bw.style.visibility="";} if(M.Shadow){ var AS=document.createElement("div"); AS.className=M.B0("Shadow"); AS.innerHTML=_7D; document.body.insertBefore(AS,M.Tag); M.Bu=AS; M.B9(AS,M.Tag);} if(M.ShadowHeader&&M.Bw){ var AS=document.createElement("div"),CA=M.Bw; AS.className=M.B0("Shadow"); AS.innerHTML=_7D; AS.style.left=CA.style.left; AS.style.top=CA.style.top; AS.style.height=CA.offsetHeight+"px"; AS.style.width=CA.offsetWidth+"px"; if(M.Shift&&(align.below||align.above)){ AS.style.height=(CA.offsetHeight+M.Shift)+"px"; if(align.above)AS.style.top=(parseInt(CA.style.top)-M.Shift)+"px";} document.body.insertBefore(AS,M.Tag); M.Bv=AS;} if(_7r!=1)M.Tag.innerHTML=M.Tag.innerHTML; M.CB=(new Date).getTime()+100; if(M.CloseAfter)setTimeout(function(){if(M.Tag)M.Close();},M.CloseAfter); return M;}; function CC(M){ if(!M)return; if(typeof(M)=="string")M={Body:M}; M.CD=1; Dialogs.Add(M); for(var i in Bs)if(M[i]==null)M[i]=Bs[i]; M.Tag=null;M.Bu=null;M.Bv=null;M.Bw=null; var B3=""; if(M.Head)B3+="<div"+M.B5("Head")+">"+M.Head+"</div>"; B3+="<div"+M.B5("Body")+" style='"+(M.Wrap==null?"":"white-space:"+(M.Wrap?"normal":"nowrap")+";")+(_7Q||_7T?"width:0px;overflow-x:visible;":"")+"height:50px;'"+"><div>"+M.Body+"</div></div>"; if(M.Foot)B3+="<div"+M.B5("Foot")+">"+M.Foot+"</div>"; document.write("<div id='STDLG"+M.id+"'"+M.B5("Static")+" style='xvisibility:hidden;'><div style='width:0px;'"+M.B5("Outer")+">"+B3+"</div></div>"); var AS=GetElem("STDLG"+M.id);M.Tag=AS; M.SetWidth(M.Tag.firstChild); M.B8=AS.offsetHeight-50; AS.style.visibility=""; if(_7r!=1)M.Tag.innerHTML=M.Tag.innerHTML; return M;}; Bs.B0=function(BQ){ return this.Base+BQ+(this.Class?" "+this.Class+BQ:"");}; Bs.B5=function(BQ){ return " class='"+this.Base+BQ+(this.Class?" "+this.Class+BQ:"")+"'";}; Bs.SetWidth=function(CA,width){ var CE=this.Tag.firstChild; var CF,A5=CE.scrollWidth>CE.offsetWidth?CE.scrollWidth+CE.offsetWidth-CE.clientWidth:CE.offsetWidth; if(this.OnWidth){CF=this.OnWidth(this.Tag,A5);if(CF)A5=CF;} CF=this.MaxWidth==0?width:this.MaxWidth; if(CF&&A5>CF)A5=CF; CF=this.MinWidth==0?width:this.MinWidth; if(CF&&A5<CF)A5=CF; CE.style.width=A5+"px"; if(CA.offsetWidth>A5){ CF=A5*2-CA.offsetWidth; if(CF>A5/2)A5=CF; CE.style.width=A5+"px";} this.CG=A5; var AN=this.A9(); if(_7P)AN.style.overflowX="hidden"; if(_7Q||_7T)AN.style.width="";}; Bs.Bt=function(AM){ if(!AM)AM={}; else AM=As(AM); if(typeof(AM)=="string")AM={Tag:GetElem(AM)}; else if(AM.length)AM={X:AM[0],Y:AM[1],Width:AM[2],Height:AM[3]}; else if(AM.offsetLeft!=null)AM={Tag:AM}; if(!AM.Align)AM.Align="left below"; return AM;}; Bs.B1=function(T){ if(!this.BaseTag)T.onclick=new Function(this.K+".Close();"); else{ T.onclick=new Function("ev","var D="+this.K+".BaseTag;"+this.K+".Close();FireMouseEvent(D,ev?ev:event);"); T.onmousedown=new Function("ev","FireMouseEvent("+this.K+".BaseTag,ev?ev:event);"); T.oncontextmenu=new Function("ev","FireMouseEvent("+this.K+".BaseTag,ev?ev:event);");}}; Bs.A9=function(){ var CE=this.Tag.firstChild.firstChild; if(this.Head)CE=CE.nextSibling; return CE;}; Bs.B9=function(AS,CA){ if(!AS||!CA)return; AS.style.left=CA.style.left; AS.style.top=CA.style.top; AS.style.height=CA.offsetHeight+"px"; AS.style.width=CA.firstChild.offsetWidth+"px";}; Bs.CH=function(){ if(this.Area){ if(this.Area.offsetLeft!=null){ var AN=_7v(this.Area); return[AN[0],AN[1],this.Area.clientWidth?this.Area.clientWidth:this.Area.offsetWidth,this.Area.clientHeight?this.Area.clientHeight:this.Area.offsetHeight];} if(!this.Area.length)return[this.Area.X,this.Area.Y,this.Area.Width,this.Area.Height]; return this.Area;} if(!_7r||_7r==1)return CI(); var AJ=CI(); return[AJ[0]/_7r,AJ[1]/_7r,AJ[2]/_7r,AJ[3]/_7r];}; Bs.UpdatePos=function(){ var AS=this.Tag,M=this,AM=this.Pos,CE=AS.firstChild,AJ=this.CH(); var x=this.X,y=this.Y,width=this.Width,height=this.Height,align=this.Align,CJ=M.Shadow?M.ShadowWidth:0; if(y<AJ[1])y=AJ[1]; else if(y>AJ[1]+AJ[3])y=AJ[1]+AJ[3]; if(height>AJ[3])height=AJ[3]; var CK=(AM.Move?AJ[0]:y)-this.B8+(align.top||align.bottom?height:0)-M.MinEdge-AJ[1],CL=AJ[3]+AJ[1]-(AM.Move?0:y)-(align.top||align.bottom?0:height)-this.B8-M.MinEdge-CJ; var max=align.bottom||align.above?CK:CL; if(max<0)max=0; M.CM=M.MinHeight==0?M.A9().firstChild.offsetHeight:M.MinHeight; if(max<M.CM&&AM.Realign!=0){ if(align.bottom||align.above){ if(CL>=M.CM){ max=CL; if(align.bottom){delete align.bottom;align.top=1;} else{delete align.above;align.below=1;}}} else{ if(CK>=M.CM){ max=CK; if(align.top){delete align.top;align.bottom=1;} else{delete align.below;align.above=1;}}}} M.CN=(!M.MaxHeight||M.MaxHeight>max)&&!align.middle?max:M.MaxHeight; if(x<AJ[0])x=AJ[0]; else if(x>AJ[0]+AJ[2])x=AJ[0]+AJ[2]; if(width>AJ[2])width=AJ[2]; var CO=x+(align.prev||align.next?0:width)-M.MinEdge-AJ[0],CP=AJ[2]+AJ[0]-x-(align.prev||align.next?width:0)-M.MinEdge-CJ; var max=align.right||align.prev?CO:CP; if(max<CE.offsetWidth&&AM.Realign!=0){ if(align.right||align.prev){ if(CP>=CE.offsetWidth){ if(align.right){delete align.right;align.left=1;} else{delete align.prev;align.next=1;}}} else{ if(CO>=CE.offsetWidth){ if(align.next){delete align.next;align.prev=1;} else{delete align.left;align.right=1;}}}} M.CQ=y; M.Ba(); var left,top; if(align.middle)top=y+Math.floor((height-AS.clientHeight)/2)+M.Shift; else if(align.above)top=y-AS.clientHeight-M.Shift; else if(align.top)top=y; else if(align.bottom)top=y+height-AS.clientHeight; else top=y+height+M.Shift; if(AM.Move||AM.Move==null&&align.middle){ if(top<M.MinEdge)top=M.MinEdge; if(top+AS.offsetHeight+CJ>AJ[1]+AJ[3]){ if(AM.CR)top-=AS.offsetHeight+(AM.Y?AM.Y:0)+AM.CR; else top=AJ[3]+AJ[1]-AS.offsetHeight-CJ;}} if(AM.Resize||AM.Resize==null&&align.middle){ if(top<M.MinEdge){ top=M.MinEdge; M.CQ=top; M.CN=AJ[3]+AJ[1]-M.MinEdge-CJ-AS.offsetHeight+M.A9().offsetHeight; M.Ba();}} AS.style.top=top+"px"; M.CQ=top; if(align.center)left=x+Math.floor((width-CE.offsetWidth)/2); else if(align.prev)left=x-CE.offsetWidth-M.Shift; else if(align.next)left=x+width+M.Shift; else if(align.right)left=x+width-CE.offsetWidth; else left=x; if(AM.Move||AM.Move==null&&align.center){ if(left<M.MinEdge)left=M.MinEdge; if(left+CE.offsetWidth+CJ>AJ[0]+AJ[2])left=AJ[2]+AJ[0]-CE.offsetWidth-CJ;} if(AM.Resize||AM.Resize==null&&align.center){ if(left<M.MinEdge){ left=M.MinEdge; CE.style.width=(AJ[0]+AJ[2]-CJ-M.MinEdge*2-5)+"px";} else if(left+CE.offsetWidth+CJ>AJ[0]+AJ[2])CE.style.width=(AJ[0]+AJ[2]-CJ-M.MinEdge*2-left)+"px";} AS.style.left=left+"px";}; Bs.Ba=function(){ var CE=this.A9(),A5; var CS=(CE.scrollHeight>CE.clientHeight?CE.scrollHeight:CE.firstChild.offsetHeight); if(CE.firstChild.offsetHeight>this.CN){ CE.firstChild.style.overflow="hidden"; CE.style.overflow=this.NoScroll?"hidden":"auto"; CE.style.height=this.CN+"px"; if(_7Q)CE.offsetHeight; CE.firstChild.style.width=(_7Q?CE.parentNode.offsetWidth-(this.NoScroll?0:_7Z+2):CE.offsetWidth-(this.NoScroll?0:_7Z))+"px";} else{ CE.style.overflow=""; if(_7T)CE.style.height=CE.scrollHeight; else CE.style.height=""; CE.firstChild.style.width=""; CE.firstChild.style.overflow="";}; if(this.Align.bottom||this.Align.above)this.Tag.style.top=(this.Y+(this.Align.bottom?this.Height:-this.Shift)-this.Tag.clientHeight)+"px"; if(this.Bu)this.B9(this.Bu,this.Tag); if(this.CT)this.CT(); if(_7P)CE.className=CE.className;}; Bs.Close=function(){this.Delete();}; Bs.Delete=function(){ if(this.OnClose)this.OnClose(); if(this.Tag){this.Tag.parentNode.removeChild(this.Tag);this.Tag=null;} if(this.Bw){this.Bw.parentNode.removeChild(this.Bw);this.Bw=null;} if(this.Bu){this.Bu.parentNode.removeChild(this.Bu);this.Bu=null;} if(this.Bv){this.Bv.parentNode.removeChild(this.Bv);this.Bv=null;} if(this.CU){clearTimeout(this.CU);this.CU=null;} Dialogs.Delete(this); if(this.Modal)CV();}; Bs.CW=function(CX){ var AJ=CY({clientX:Dialogs.X,clientY:Dialogs.Y}),x=AJ[0],y=AJ[1]; var T=this.Tag,S=this.Bu,CZ=this.Bw,R=this.Cell,E=this.CH(); if(this.CloseOut&&(x<T.offsetLeft*_7r||x>T.offsetLeft*_7r+T.offsetWidth||y<T.offsetTop*_7r||y>T.offsetTop*_7r+T.offsetHeight)&&(!CZ||x<CZ.offsetLeft*_7r||x>CZ.offsetLeft*_7r+CZ.offsetWidth||y<CZ.offsetTop*_7r||y>CZ.offsetTop*_7r+CZ.offsetHeight)||this.ClosePos&&R&&(x<R[0]||x>R[0]+R[2]||y<R[1]||y>R[1]+R[3])||this.CloseArea&&E&&(x<E[0]||x>E[0]+E[2]||y<E[1]||y>E[1]+E[3])||this.CloseIn&&(x>=T.offsetLeft*_7r&&x<=T.offsetLeft*_7r+T.offsetWidth&&y>=T.offsetTop*_7r&&y<=T.offsetTop*_7r+T.offsetHeight)||S&&this.CloseIn&&(x>=S.offsetLeft*_7r&&x<=S.offsetLeft*_7r+S.offsetWidth&&y>=S.offsetTop*_7r&&y<=S.offsetTop*_7r+S.offsetHeight)){ if(CX||!this.CloseTimeout)this.Close(); else{ if(!this.CU)this.CU=setTimeout(new Function("if("+this.K+")"+this.K+".ToClose(1);"),this.CloseTimeout);}} else this.CU=null;}; Bs.StartDrag=function(){ var M=this; B6({ Tag:this.Tag, Area:this.Area, OnMove:function(Ca,Cb){ var Cc=M.Bu; if(Cc){ if(Ca)Cc.style.left=(parseInt(Cc.style.left)+Ca)+"px"; if(Cb)Cc.style.top=(parseInt(Cc.style.top)+Cb)+"px";}}, OnCancel:function(){M.B9(M.Bu,M.Tag);M.Cd=(new Date()).getTime()+100;}, OnDrop:function(){M.Ba();M.Cd=(new Date()).getTime()+100;}, Copy:0});}; Dialogs.Click=function(Br){ if(!Br)Br=window.event; var Ak=(new Date()).getTime(); for(var i=0;i<Dialogs.length;i++){ var M=Dialogs[i]; if(M&&M.Close&&M.CloseClickOut&&M.Cd<Ak)M.Close();}}; Dialogs.Add=function(M){ if(M.id!=null)return; for(M.id=0;Dialogs[M.id];M.id++); Dialogs[M.id]=M; M.K="Dialogs["+M.id+"]"; if(M.CanFocus)Dialogs.Focused=M; M.Cd=(new Date()).getTime()+300;}; Dialogs.Delete=function(M){ if(Dialogs.Focused==M)Dialogs.Focused=null; delete Dialogs[M.id]; M.id=null; while(Dialogs.length&&!Dialogs[Dialogs.length-1])Dialogs.length--;}; Dialogs.Bp=function(Br){ if(!Br)Br=window.event; var Bq=Br.keyCode;if(!Bq)Bq=Br.charCode; var M=Dialogs.Focused; if(M&&M.Bp&&M.CB<(new Date).getTime())M.Bp(Bq,Br); else if(window.Ce)Ce.Bp(Br);}; Dialogs.Cf=function(Br){ if(!Br)Br=window.event;if(Br.clientY!=null){Dialogs.X=Br.clientX;Dialogs.Y=Br.clientY;} var AJ=CY(Br),x=AJ[0],y=AJ[1]; for(var i=0;i<Dialogs.length;i++){ var M=Dialogs[i];if(!M)continue; if(M.CW)M.CW();}}; Dialogs.Cg=function(Br){ if(!Br)Br=window.event;if(Br.clientY!=null){Dialogs.X=Br.clientX;Dialogs.Y=Br.clientY;} for(var i=0;i<Dialogs.length;i++){ var M=Dialogs[i];if(!M)continue; if(M.CloseMove&&M.Bz){ if(M.Bz[0]==null)M.Bz=[Dialogs.X,Dialogs.Y]; var Ca=M.Bz[0]-Dialogs.X,Cb=M.Bz[1]-Dialogs.Y; if(Math.abs(Ca)>=M.CloseMove||Math.abs(Cb)>=M.CloseMove)M.Close();} if(M.ClosePos||M.CloseArea)M.CW();}}; Dialogs.Resize=function(Br,scroll){ if(!Br)Br=window.event;if(Br.clientY!=null){Dialogs.X=Br.clientX;Dialogs.Y=Br.clientY;} for(var i=0;i<Dialogs.length;i++){ var M=Dialogs[i];if(!M||!M.Tag||M.X==null||!scroll&&!M.ResizeUpdate||scroll&&!M.ScrollUpdate)continue; M.UpdatePos(); M.B9(M.Bu,M.Tag);}}; Dialogs.Ch=function(Br){Dialogs.Resize(Br,1);}; function ShowHint(M,AM,Ci,Bb){ AM=Bs.Bt(AM); var CA=AM.Tag;if(!CA)return; var Cj=AM.Ck;if(!Cj)Cj=CA; var Cl=AM.Cm;if(!Cl)Cl=CA; if(Ci&2)HideHint(CA); else for(var i=0;i<Dialogs.length;i++)if(Dialogs[i]&&Dialogs[i].HintTag==CA)return; var Cn=Cl.scrollWidth,CZ=Cj.scrollHeight; if((_7N||_7F||_7G)&&Cn==Cl.offsetWidth&&Cl.tagName.toLowerCase()=="td"){ var AS=ShowHint.Co; if(!AS){ var AS=document.createElement("div"),B3=AS.style; B3.position="absolute";B3.left="0px";B3.top="0px";B3.visibility="hidden"; document.body.appendChild(AS); ShowHint.Co=AS;} AS.className=Cl.className; AS.innerHTML=Cl.innerHTML; Cn=AS.scrollWidth;} if(!(Ci&1)&&(!M||!M.Body)&&(_7N||_7F||_7G||!Cl.clientWidth?Cl.offsetWidth>=Cn:Cl.clientWidth>=Cn)&&((_7N||_7F||_7G||!Cj.clientHeight?Cj.offsetHeight>=CZ:Cj.clientHeight>=CZ)||!CZ))return; var name=CA.tagName.toLowerCase(); if(Bb==null)Bb=name=="input"?CA.value:CA.innerHTML; if(name=="textarea")Bb=Bb.replace(/\n/g,"<br>"); if(!M)M={Body:Bb}; else if(typeof(M)=="string"){M={Body:M.replace('%d',Bb)};Cn=null;} else if(!M.Body)M.Body=Bb; else M.Body=M.Body.replace('%d',Bb); var B3=GetStyle(CA); if(M.Wrap==null){ if(name=="textarea")M.Wrap=1; else if(B3.whiteSpace&&B3.whiteSpace!="normal")M.Wrap=0; else if(CA.style.whiteSpace&&CA.style.whiteSpace!="normal")M.Wrap=0; else if(CZ<30)M.Wrap=0; else M.Wrap=1;} if(!M.Class)M.Class="GMHint"; if(M.MaxWidth==null&&M.Wrap)M.MaxWidth=0; if(M.MinWidth==null&&M.Wrap)M.MinWidth=0; if(!M.Wrap&&Cn)M.MaxWidth=Cn; if(M.ClosePos==null)M.ClosePos=1; if(M.CloseClick==null)M.CloseClick=1; if(M.CloseTimeout==null)M.CloseTimeout=0; if(M.NoScroll==null)M.NoScroll=1; AM.Align="left top"; AM.Resize=1; var AJ=["fontSize","fontStyle","fontFamily","fontVariant","fontWeight","letterSpacing","textAlign","verticalAlign","textIndent","wordSpacing"]; var AN=["font-size","font-style","font-family","font-variant","font-weight","letter-spacing","text-align","vertical-align","text-indent","word-spacing"]; var Cp=""; for(var i=0;i<AJ.length;i++)if(B3[AJ[i]])Cp+=AN[i]+":"+(B3[AJ[i]]+"").replace(/\'/g,'"')+";"; M.Body="<div style='"+Cp+"'>"+M.Body+"</div>"; M.InDiv=1; ShowDialog(M,AM); var CE=M.Tag.firstChild,Au=GetStyle(CE); var AJ=["Left","Right","Top","Bottom"]; for(var i=0;i<AJ.length;i++){ var A5=0,a; a=parseInt(Au["border"+AJ[i]+"Width"]);if(a)A5-=a; a=parseInt(Au["padding"+AJ[i]]);if(a)A5-=a; a=parseInt(B3["border"+AJ[i]+"Width"]);if(a)A5+=a; a=parseInt(B3["padding"+AJ[i]]);if(a)A5+=a; if(A5>0){ CE.style["padding"+AJ[i]]=A5+"px"; if(_7Q&&i<=1)CE.style.width=parseInt(CE.style.width)+A5+"px";} else if(A5<0)M.Tag.style["margin"+AJ[i]]=A5+"px";} if(!_7Q&&M.Wrap){ A5=parseInt(CE.style.width)-parseInt(CE.style.paddingLeft)-parseInt(CE.style.paddingRight); if(A5)CE.style.width=A5+"px";} var AJ=["backgroundImage","backgroundRepeat","backgroundPosition","backgroundPositionX","backgroundPositionY","cursor","color"]; for(var i=0;i<AJ.length;i++)if(B3[AJ[i]])M.Tag.style[AJ[i]]=B3[AJ[i]]; if(M.Bu)M.B9(M.Bu,M.Tag); M.HintTag=CA; var Cq=new Function("ev","if("+M.K+")FireMouseEvent("+M.K+".HintTag,ev?ev:event);"); M.Tag.onmousemove=Cq; M.Tag.onmouseover=Cq; M.Tag.onmouseout=Cq; if(M.Bu){ M.Bu.onmousemove=Cq; M.Bu.onmouseover=Cq; M.Bu.onmouseout=Cq;} if(_7N){ M.Tag.addEventListener('DOMMouseScroll',Cq,false); if(M.Bu)M.Bu.addEventListener('DOMMouseScroll',Cq,false);} return M;}; function HideHint(AM){ AM=Bs.Bt(AM); var CA=AM.Tag; for(var i=0;i<Dialogs.length;i++)if(Dialogs[i]&&(CA&&Dialogs[i].HintTag==CA||!CA&&Dialogs[i].HintTag))Dialogs[i].Close();}; function ShowTip(M,AM,Cr,Cs){ AM=Bs.Bt(AM); var CA=AM.Tag;if(!CA)return; for(var i=0;i<Dialogs.length;i++)if(Dialogs[i]&&Dialogs[i].Ct==CA)return; var Bb=CA.value?CA.value:CA.innerHTML; if(!M)M={Body:Bb}; else if(typeof(M)=="string")M={Body:M.replace('%d',Bb)}; else if(!M.Body)M.Body=Bb; else M.Body=M.Body.replace('%d',Bb); if(!M.Class)M.Class="GMTip"; if(M.ClosePos==null)M.ClosePos=1; if(M.CloseIn==null)M.CloseIn=1; if(M.CloseTimeout==null)M.CloseTimeout=0; if(M.NoScroll==null)M.NoScroll=1; if(AM.X==null)AM.X=-10; if(AM.Y==null){ AM.Y=16; for(var i=0,Ak=CA;i<10;i++,Ak=Ak.parentNode){ var Cu=GetStyle(Ak).cursor; if(Cu){ if(Cu=="pointer"||Cu=="hand")AM.Y=20; else if(Cu=="text")AM.Y=8; break;}}} AM.Align="top left"; if(AM.Mouse==null)AM.Mouse=1; if(AM.Move==null){AM.Move=1;AM.CR=10;} if(AM.Resize==null)AM.Resize=1; ShowDialog(M,AM); M.Ct=CA; if(Cr==null)Cr=500; var x=Dialogs.X,y=Dialogs.Y; setTimeout(function(){ if(!M.Tag)return; var left=parseInt(M.Tag.style.left),top=parseInt(M.Tag.style.top); if(left>M.MinEdge)M.Tag.style.left=(left+Dialogs.X-x)+"px"; if(top>M.MinEdge)M.Tag.style.top=(top+Dialogs.Y-y)+"px"; if(Cs){ var Cv=Cs(M.Tag); if(!Cv){M.Close();return;} else if(Cv!=Bb){M.Body=Cv;M=ShowDialog(M,AM);}} M.Tag.style.visibility="visible"; if(M.Bu){M.B9(M.Bu,M.Tag);M.Bu.style.visibility="visible";}},Cr); return M;}; function HideTip(AM){ AM=Bs.Bt(AM); var CA=AM.Tag; for(var i=0;i<Dialogs.length;i++)if(Dialogs[i]&&(CA&&Dialogs[i].Ct==CA||!CA&&Dialogs[i].Ct))Dialogs[i].Close();}; function B7(){ if(Bs.Cw){Bs.Cw++;return;} var AS=document.createElement("div"); AS.style.left="0px"; AS.style.top="0px"; AS.style.width="100%"; AS.style.height="100%"; AS.className="GridDisabled"; AS.innerHTML=_7D; B2(AS); Bs.Cw=1; Bs.Cx=AS;}; function CV(Ci){ if(!Bs.Cw)return; Bs.Cw--; if(Bs.Cw){ if(!Ci)return; Bs.Cw=0;} var AS=Bs.Cx; AS.parentNode.removeChild(AS); Bs.Cx=null;}; AttachEvent(document,"keydown",Dialogs.Bp); AttachEvent(document,"click",Dialogs.Click); AttachEvent(document,"mouseover",Dialogs.Cf); AttachEvent(document,"mousemove",Dialogs.Cg); AttachEvent(window,"resize",Dialogs.Resize); AttachEvent(document.documentElement,"scroll",Dialogs.Ch); AttachEvent(window,"scroll",Dialogs.Ch); AttachEvent(window,"load",function(){ AttachEvent(document.body,"scroll",Dialogs.Ch); if(_7R)_7w(); _7x();}); var Cy={ Type:"Text", CloseClickOut:1, SaveMouse:1, SaveMove:1, Class:"GMEdit", MaskColor:"red", AutoSize:1, ParentAutoSize:0, AcceptEnters:1, ReadOnly:0, AR:0}; function Cz(M,AM){ if(!M)M={}; else M=As(M); if(!M)M={}; if(typeof(M)=="string"){alert("Incorrect setting for Edit: "+M);return null;} AM=Bs.Bt(AM); for(var i in Cy)if(M[i]==null)M[i]=Cy[i]; C0(M,AM); var Bb=""; if(M.Input)Bb=M.Input.value; else if(M.Value!=null)Bb=M.Value; else if(AM.Tag)Bb=AM.Tag.innerHTML; if(typeof(Bb)=="string"){ if(M.Multi)Bb=Bb.replace(/\%n/g,"\n"); Bb=s.StringToValue(Bb,M.Type,M.IOFormat,M.Range);} var CA=AM.Tag; if(!CA){ CA=document.createElement("div"); CA.className=M.Class+"Parent"; if(AM.X)CA.style.left=AM.X+"px"; if(AM.Y)CA.style.top=AM.Y+"px"; if(AM.Width)CA.style.width=AM.Width+"px"; if(AM.Height)CA.style.height=AM.Height+"px"; B2(CA); M.C1=CA;} M.C2=CA.innerHTML; if(M.Multi){ var AI=document.createElement("textarea"); AI.style.overflow="hidden"; if(_7F&&window._7y)DetachEvent(document,"mousewheel",_7y);} else{ var AI=document.createElement("input"); AI.type=M.Type=="Pass"?"password":"text"; if(M.Size)AI.maxLength=M.Size;}; if(!M.EditMask){ var C3=M.Range?s.ValueSeparator+s.RangeSeparator:""; if(M.Type=="Int")AI.onkeypress=function(Br){C4(Br?Br:event,this,C5,C3);}; else if(M.Type=="Float")AI.onkeypress=function(Br){C4(Br?Br:event,this,C5,C3);}; else if(M.Type=="Date"){ var BB=M.Format&&M.Format.indexOf('t')>=0&&M.Format.indexOf('h')>=0; if(BB)C3+=s.AMDesignator.toUpperCase()+s.PMDesignator.toUpperCase(); AI.onkeypress=function(Br){C4(Br?Br:event,this,C6,C3);}}} if(M.Type=="Date"&&M.Calendar&&window.Ar){ var C=M.Calendar; if(typeof(C)!="object"){C={};M.Calendar=C;} C.Date=Bb; C.Range=M.Range; C.Az=""; C.OnChange=function(Bb){ M.C7=M.C8(Bb); M.Tag.value=M.C7; AI.focus(); AI.select(); if(M.Multi){M.Resize();C.Height=AI.parentNode.offsetHeight;C.UpdatePos();C.B9(C.Bu,C.Tag);}}; C.OnSave=function(Bb){ M.C7=M.C8(Bb); M.Tag.value=M.C7; M.Save();}; C.OnClose=function(){ if(M.Tag){ M.Calendar=null; M.C9(); M.Calendar=C;}}; Ar(C,{Tag:CA,Align:M.CalendarAlign?M.CalendarAlign:"right below"});} AI.className=M.Class+(M.Multi?"Textarea ":"Input ")+M.Class+M.Type; if(M.Align!=null)AI.style.textAlign=M.Align; if(M.ReadOnly)AI.readOnly=true; AI.onclick=_7z; AI.onkeydown=function(Br){M.Bp(Br?Br:event);}; AI.onkeyup=function(Br){return M.DA();}; if(M.EditMask)_7AA(AI,M.EditMask,window.Grids?Grids.DB:null,M.MaskColor,M.MaskSound,M.MaskSoundLength); var B3=GetStyle(CA),DC; var A5=CA.clientWidth;if(!A5)A5=CA.offsetWidth; DC=parseInt(B3.paddingLeft);if(DC)A5-=DC; DC=parseInt(B3.paddingRight);if(DC)A5-=DC; if(!CA.clientWidth){ DC=parseInt(B3.borderLeftWidth);if(DC)A5-=DC; DC=parseInt(B3.borderRightWidth);if(DC)A5-=DC;} AI.style.width=A5+"px"; var CS=CA.clientHeight;if(!CS)CS=CA.offsetHeight; if(_7P&&!CA.clientWidth)CS-=2; DC=parseInt(B3.paddingTop);if(DC)CS-=DC; DC=parseInt(B3.paddingBottom);if(DC)CS-=DC; AI.style.height=CS+"px"; CA.innerHTML=""; AI.value=M.C8(Bb); CA.appendChild(AI); M.C7=Bb; M.Tag=AI; if(AI.offsetWidth>A5){A5=A5*2-AI.offsetWidth;AI.style.width=A5+"px";} if(AI.offsetHeight>CS)AI.style.height=(CS*2-AI.offsetHeight)+"px"; if(M.AutoSize)M.Resize(); AI.focus(); AI.select(); Dialogs.Add(M); M.DD=1; return M;}; function C0(M,AM){ if(M.Input&&typeof(M.Input)!="object"){ var DE=GetElem(M.Input); if(!DE){ DE=document.createElement("input"); DE.name=DF; DE.id=M.Input; DE.type="hidden"; if(document.forms.length==1)document.forms[0].appendChild(DE); else if(AM.Tag)AM.Tag.parentNode.insertBefore(DE,AM.Tag); else if(document.forms[0])document.forms[0].appendChild(DE); else B2(DE);} M.Input=DE;}}; Cy.Bp=function(Br){ var Bq=Br.keyCode;if(!Bq)Bq=Br.charCode; var DG=true; if(this.DH&&this.DH.Cursor&&(Bq==13)){ this.DH.Bp(Bq,Br); return;} if(this.DH&&!(this.DH.Cursor)&&(Bq==38||Bq==33)){CancelEvent(Br);return;} if(Bq==13){ if(!this.Multi||!this.AcceptEnters||Br.shiftKey||Br.altKey||Br.ctrlKey)DG=this.Save(); else CancelEvent(Br,1);} if(Bq==27)DG=this.C9(); if(Bq==9){ var save=this.OnTab?this.OnTab(Br.shiftKey?1:0,Br):this.SaveMove; if(save&&this.Tag&&this.Save()==false)DG=false;} if(Bq==38||Bq==40){ if(this.Multi)CancelEvent(Br,1); else if(!this.DH){ var save=this.OnArrow?this.OnArrow(Bq==38?0:1,Br):this.SaveMove; if(save&&this.Tag&&this.Save()==false)DG=false;}} if(!DG)CancelEvent(Br);}; Cy.Save=function(){ if(this.ReadOnly)return this.C9(); var AI=this.Tag,Bb=AI.value; var DI=this.ResultMask; try{ if(DI&&Bb.search(typeof(DI)=="object"?DI:new RegExp(DI,""))==-1){ if(this.OnResultMask)DG=this.OnResultMask(Bb); else DG=0; if(!DG){ if(this.ResultText){ var B3=_7AB(AI); alert(this.ResultText); setTimeout(function(){AI.focus();_7AC(AI,B3[0],B3[1]);},10);} return;} else if(DG==2)this.C9(); else if(DG==1)return;}} catch(H){alert("Wrong result mask "+this.ResultMask);}; var DJ=Bb; Bb=this.DK(Bb); var DL=s.ValueToString(Bb,this.Type,this.IOFormat,this.Range?1:0); var DM=s.ValueToString(Bb,this.Type,this.DisplayFormat,this.Range); if(this.Multi){ Bb=Bb.replace(/\r\n|\r/g,"\n"); DL=DL.replace(/\r\n|\n/g,"%n"); DM=DM.replace(/\r\n|\n/g,"<br/>");} var DG=this.OnSave?this.OnSave(Bb,DL,DM,DJ):null; if(DG==false)return; this.C2=DG==true?null:DM; if(this.Input&&DG!=true)this.Input.value=DL; return this.C9();}; Cy.DK=function(Bb){return s.StringToValue(Bb,this.Type,this.Format,this.Range?1:0);}; Cy.C8=function(Bb){return s.ValueToString(Bb,this.Type,this.Format,this.Range?1:0);}; Cy.Close=function(){ if(this.SaveMouse)this.Save(); else this.C9();}; Cy.C9=function(){ if(this.OnClose)this.OnClose(); var AI=this.Tag; if(AI){ try{ var B3=_7AB(AI); if(this.OnClose&&this.OnClose()==false){ setTimeout(function(){AI.focus();_7AC(AI,B3[0],B3[1]);},10); return false;} AI.onkeypress=null; AI.onkeydown=null; AI.onkeyup=null; AI.blur(); var AM=AI.parentNode; AM.removeChild(AI); if(this.C2!=null)AM.innerHTML=this.C2;} catch(H){}} if(this.C1){this.C1.parentNode.removeChild(this.C1);this.C1=null;} delete Dialogs[this.id]; this.id=null; if(this.Calendar&&this.Calendar.Close){this.Calendar.OnClose=null;this.Calendar.Close();} if(this.DH)this.DH.Close(); if(this.DN){this.DN.parentNode.removeChild(this.DN);this.DN=null;} if(_7F&&window._7y&&this.Multi)AttachEvent(document,"mousewheel",_7y); this.DD=0;}; function C4(Br,CA,Cs,data){ var DO=Br.keyCode;if(!DO||_7N)DO=Br.charCode;if(!DO)return; var DP=Cs(DO,CA.value,data),DQ=!!Br.preventDefault; if(typeof(DP)=="string")DP=DP.charCodeAt(0); if(DP&&DP!=DO){ if(!DQ)Br.keyCode=DP; else{ try{ var B3=CA.selectionStart,H=CA.selectionEnd;if(H==null)H=B3; CA.value=CA.value.slice(0,B3)+String.fromCharCode(DP)+CA.value.slice(H); CA.selectionStart=B3+1;CA.selectionEnd=B3+1;} catch(H){}; DP=0;}} if(!DP){ if(DQ)Br.preventDefault(); else Br.returnValue=false;} return DP;}; function DR(Bq,Bb,C3){ if(Bq>=97&&Bq<=122)Bq-=32; if(C3)for(var i=0;i<C3.length;i++)if(Bq==C3.charCodeAt(i))return Bq; if(Bq==88)return 120; if(Bq==45)return Bq; if(Bq>=65&&Bq<=70)return Bb.indexOf('x')>=0?Bq:0; if(Bq>=48&&Bq<=57||Bq==8||_7K&&(Bq==37||Bq==39))return Bq; return 0;}; function C5(Bq,Bb,C3){ if(Bq>=97&&Bq<=122)Bq-=32; if(C3)for(var i=0;i<C3.length;i++)if(Bq==C3.charCodeAt(i))return Bq; if(Bq==45)return Bq; for(var i=0;i<s.InputDecimalSeparators.length;i++)if(Bq==s.InputDecimalSeparators.charCodeAt(i)){ return s.DecimalSeparator.charCodeAt(0);} for(var i=0;i<s.InputGroupSeparators.length;i++)if(Bq==s.InputGroupSeparators.charCodeAt(i)){ return s.GroupSeparator.charCodeAt(0);} if(Bq==69)return Bb.indexOf('e')>=0?0:101; if(Bq>=48&&Bq<=57||Bq==8||Bq==37||Bq==39)return Bq; return 0;}; function C6(Bq,Bb,C3){ if(Bq>=97&&Bq<=122)Bq-=32; if(C3)for(var i=0;i<C3.length;i++)if(Bq==C3.charCodeAt(i))return Bq; for(var i=0;i<s.DS.length;i++)if(Bq==s.DS.charCodeAt(i))return s.DateSeparator.charCodeAt(0); for(var i=0;i<s.DT.length;i++)if(Bq==s.DT.charCodeAt(i))return s.TimeSeparator.charCodeAt(0); if(Bq==32||Bq==44)return 32; if(Bq>=48&&Bq<=57||Bq==8||Bq==37||Bq==39)return Bq; return 0;}; Cy.DA=function(){ if(this.AutoSize)this.Resize(); var AI=this.Tag,Bb=AI.value; if(Bb==this.C7)return; if(this.OnChange)this.OnChange(Bb,this.C7); this.C7=Bb; if(this.Type=="Date"&&this.Calendar&&window.Ar){ Bb=this.DK(Bb); if(!isNaN(Bb)){ var C=this.Calendar; C.Date=Bb; var DU=C.OnClose;C.OnClose=null; this.Calendar.Close(); C.OnClose=DU; Ar(C,{Tag:AI.parentNode,Align:this.CalendarAlign?this.CalendarAlign:"right below"});}} else if(this.Defaults||this.OnDefaults){ var AS=this.Defaults,Bb=this.DK(Bb); if(this.DH){this.DH.Close();this.DH=null;} AS=DV.DW(AS); if(AS){ var R=new RegExp("(^|\\W)"+DX(Bb)),DY=AS.Items; for(var i=0;i<DY.length;i++)DY[i].Hidden=(DY[i].Text!=null?DY[i].Text:DY[i].Name).search(R)<0;} if(this.OnDefaults){ var A3=this.OnDefaults(AS,Bb); if(A3==false)return; if(A3!=null)AS=A3; else if(Bb=="")return;} else if(Bb=="")return; this.DZ(AS);}}; Cy.DZ=function(AS){ if(!AS||!window.ShowMenu)return; AS=DV.DW(AS); if(!AS)return; var AI=this.Tag,M=this; AS.OnSave=function(Da){AI.value=Da.Value!=null?Da.Value:Da.Name;M.Save();}; AS.OnMoveOut=function(dir){return!dir;}; if(M.DefaultsReplace)AS.OnMove=function(Da){ AI.value=Da.Value!=null?Da.Value:Da.Name;AI.select(); if(M.OnChange)M.OnChange(AI.value,this.C7); M.C7=AI.value;}; AS.FocusTag=AI; this.DH=ShowMenu(AS,{Tag:AI.parentNode,Align:this.DefaultsAlign?this.DefaultsAlign:"left below"});}; Cy.Resize=function(){ if(!this.Multi)return; var X=this.DN,AI=this.Tag; if(!X){ X=document.createElement("textarea"); X.className=this.Class+"Textarea "+this.Class+this.Type; X.style.position="absolute"; X.style.left="0px"; X.style.top="0px"; X.style.height="10px"; X.style.visibility="hidden"; X.style.overflow=AI.style.overflow?AI.style.overflow:"hidden"; X.style.width=AI.style.width; B2(X); this.DN=X;} X.value=AI.value;X.scrollHeight; var CS=X.scrollHeight;if(_7Q)CS+=AI.offsetHeight-AI.clientHeight; if(CS<this.MinHeight)CS=this.MinHeight; if(_7P)CS--; if(AI.style.height==CS+"px")return; if(this.MaxHeight){ if(CS>this.MaxHeight){ if(AI.style.overflow=="hidden"){AI.style.overflow="auto";X.style.overflow="auto";} CS=this.MaxHeight;} else if(AI.style.overflow=="auto"){AI.style.overflow="hidden";X.style.overflow="hidden";}} if(this.OnResize)this.OnResize(CS); AI.style.height=CS+"px"; if(this.C1||this.ParentAutoSize){ var T=AI.parentNode,CS=AI.offsetHeight; if(_7Q)CS+=T.offsetHeight-T.clientHeight; T.style.height=CS+"px"; if(_7Q&&T.scrollHeight>T.offsetHeight){CS+=T.scrollHeight-T.offsetHeight;T.style.height=CS+"px";}}}; function _7AD(src,Db){ var AN=_7AD.Dc,Dd=_7AD.De; function Df(){ if(Dd){ clearTimeout(Dd); _7AD.De=null; Dd=null;} if(_7N){ try{document.documentElement.removeChild(AN);} catch(H){}; AN=null;} else AN.src="";}; if(Dd)Df(); if(!src)return; if(!AN){ if(_7N){ AN=document.createElement("div"); AN.innerHTML='<embed src="'+src+'" autostart=true hidden width=0 height=0 enablejavascript="true">'; AN=AN.firstChild;} else{ AN=document.createElement("bgsound"); AN.src=src;}; document.documentElement.appendChild(AN); _7AD.Dc=AN;} else AN.src=src; if(Db)_7AD.De=setTimeout(function(){Df();},Db);}; function _7AB(T){ var B3,H; try{ if(T.selectionStart!=null){ B3=T.selectionStart,H=T.selectionEnd;} else{ function Dg(Dh){return Dh.replace(/\r\n/g,"\n").length;}; var S=document.selection.createRange(),Di=T.createTextRange(); Di.moveToBookmark(S.getBookmark()); var Dh=T.value,Db=Dg(Dh),Dj=Dg(Di.text); B3=-Di.moveStart('character',-Db); if(B3<Dg(Di.text)-Dj)B3=Db; H=B3+Dj;}} catch(Br){}; return[B3,H];}; function _7AC(T,B3,H){ if(T.selectionStart!=null){ T.selectionStart=B3; T.selectionEnd=H;} else{ var S=T.createTextRange(); S.move('character',B3); S.moveEnd('character',H-B3); S.select();}}; function _7AA(T,Mask,Dk,color,Dl,Dm){ var Dn,Do,Dp=typeof(Mask)=="object"?Mask:new RegExp(Mask,""),Dq=null,C9=0,Dr=T.style.backgroundColor,Ds=null; var Dt=T.onkeypress,Du=T.onkeydown,Dv=T.onkeyup; T.onkeypress=Dw; T.onkeydown=Bp; T.onkeyup=DA; function Dx(Dh){ if(Dh.search(Dp)==-1){ if(color){ T.style.backgroundColor=color; if(Dq)clearTimeout(Dq); Dq=setTimeout(function(){T.style.backgroundColor=Dr;},200);} if(Dl)_7AD(Dl,Dm); if(Ds!=null){T.selectionEnd=Ds;Ds=null;} return 1;} return 0;}; function Dw(Br){ if(!Br)Br=window.event; if(T.readOnly)return true; if(C9){CancelEvent(Br);return false;} if(Br&&!_7G&&!_7F&&_7K&&(!_7P||Dk!=null)){ var BD=_7P?Br.keyCode:Br.charCode; if(BD!=0){ if(BD==13)BD=10; var Dh=T.value.replace(/\r\n/g,"\n"); Dh=Dh.slice(0,Do[0])+String.fromCharCode(BD)+Dh.slice(Do[1]+(_7P&&Dk?1:0)); if(Dx(Dh)){CancelEvent(Br);return false;}}} if(Dt)Dt(Br); return true;}; function Bp(Br){ if(T.readOnly)return true; function Dy(){if(Du)Du(Br);return true;}; if(!Br)Br=window.event; if(T.value.search(Dp)==-1&&Do){ T.value=Dn; _7AC(T,Do[0],Do[1]);} Dn=T.value; Ds=null; if(Dk&&_7N){ var BD=Br.keyCode; if(BD!=37&&BD!=38&&BD!=40&&BD!=8&&BD!=45){ Ds=T.selectionEnd; T.selectionEnd+=1;}} Do=_7AB(T); C9=0; if(Br){ if(Br.shiftKey||Br.altKey||Br.Dz)return Dy(); var BD=Br.keyCode,B3=Do[0],H=Do[1],Dh=_7G||_7F?T.value:T.value.replace(/\r\n/g,"\n"); if(BD==0)BD=Br.charCode; if(BD==45){ if(Dk!=null)Dk=!Dk; return Dy();} else if(BD==8){ if(B3&&B3==H)B3--;} else if(BD==46&&H<Dh.length-1&&B3==H)H++; else return Dy(); Dh=Dh.slice(0,B3)+Dh.slice(H); if(Dx(Dh)){CancelEvent(Br);C9=1;return false;}} return Dy();}; function DA(Br){ if(T.readOnly||!Do)return true; if(!Br)Br=window.event; if(Dx(T.value)){ T.value=Dn; _7AC(T,Do[0],Do[1]);} if(C9){ C9=0;CancelEvent(Br);return false;} if(Dv)Dv(Br); return true;};}; var D0={ EmptyNumber:null, EmptyDate:null, ValueSeparator:";", RangeSeparator:"~", ValueSeparatorHtml:" <b style='color:red;'>;</b> ", RangeSeparatorHtml:" <b style='color:red;'>~</b> ", LongDayNames:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","), ShortDayNames:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","), Day2CharNames:"Su,Mo,Tu,We,Th,Fr,Sa".split(","), Day1CharNames:"S,M,T,W,T,F,S".split(","), LongMonthNames:"January,February,March,April,May,June,July,August,September,October,November,December".split(","), LongMonthNames2:"January,February,March,April,May,June,July,August,September,October,November,December".split(","), ShortMonthNames:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","), DayNumbers:"1st,2nd,3rd,4th,5th,6th,7th,8th,9th,10th,11th,12th,13th,14th,15th,16th,17th,18th,19th,20th,21st,22nd,23rd,24th,25th,26th,27th,28th,29th,30th,31st".split(","), Quarters:"I,II,III,IV".split(","), Halves:"I,II".split(","), DateSeparator:"/", DS:"/.-", TimeSeparator:":", DT:":", AMDesignator:"AM", PMDesignator:"PM", FirstWeekDay:0, NaD:"NaN", GMT:0, Hirji:0, DecimalSeparator:".", InputDecimalSeparators:".,", GroupSeparator:",", InputGroupSeparators:"", D1:"%", NaN:"NaN", BM:"M/d/yyyy", AS:"d. MMMM yyyy", Ak:"H:mm", T:"H:mm:ss", Cq:"d. MMMM yyyy H:mm", CE:"d. MMMM yyyy H:mm:ss", D2:"M/d/yyyy H:mm", G:"M/d/yyyy H:mm:ss", D3:"d. MMMM", M:"d. MMMM", B3:"yyyy-MM-ddTHH:mm:ss", D4:"yyyy-MM-dd HH:mm:ssZ", D5:"d. MMMM yyyy HH:mm:ss", AP:"ddd MMM d HH:mm:ss UTCzzzzz yyyy", R:"ddd MMM d HH:mm:ss UTCzzzzz yyyy", y:"MMMMMMM yyyy", Y:"MMMMMMM yyyy", D6:"0.######", D7:"0.###### E+00", D8:"0.00", D9:"$###########0.00", EA:"0.00%", EB:"0.0000", EC:"0.0000 E+00", ED:"0.000000 E+000", EE:["",/0$/,/0{1,2}$/,/0{1,3}$/,/0{1,4}$/,/0{1,5}$/,/0{1,6}$/,/0{1,7}$/,/0{1,8}$/,/0{1,9}$/,/0{1,10}$/,/0{1,11}$/,/0{1,12}$/,/0{1,13}$/,/0{1,14}$/,/0{1,15}$/,/0{1,16}$/,/0{1,17}$/,/0{1,18}$/,/0{1,19}$/,/0{1,20}$/], EF:["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000"], EG:["",/.{1,1}$/,/.{2,2}$/,/.{3,3}$/,/.{4,4}$/,/.{5,5}$/,/.{6,6}$/,/.{7,7}$/,/.{8,8}$/,/.{9,9}$/,/.{10,10}$/,/.{11,11}$/,/.{12,12}$/,/.{13,13}$/,/.{14,14}$/,/.{15,15}$/,/.{16,16}$/,/.{17,17}$/,/.{18,18}$/,/.{19,19}$/,/.{20,20}$/], _7AE:/\D*(\d{1,4})?\s*([\-\/\.])?\s*(\d{1,2})?\s*([\-\/\.])?\s*(\d{1,4})?[^\d\:\.]*(\d{1,2})?\s*[\:\.]?\s*(\d{1,2})?\s*[\:\.]?\s*(\d{1,2})?\s*([apAP]\.?[Mm]?\.?)?\D*/, EH:(new Date()).getUTCFullYear(), EI:(new Date()).getUTCMonth(), EJ:(new Date()).getUTCDate(), EK:/\W*(\d{1,4})?([a-zA-Z]+)?\s*([\-\/\.\,])?\s*(\d{1,4})?([a-zA-Z]+)?\s*([\-\/\.\,])?\s*(\d{1,4})?([a-zA-Z]+)?[^\d\:\.\a\A\p\P]*(\d{1,2})?\s*([\:\.])?\s*(\d{1,2})?\s*([\:\.])?\s*(\d{1,2})?\s*([apAP]\.?[Mm]?\.?)?\W*/, EL:/[\&\<]/,EM:/[\&\<\n]/,EN:/[\&\<\"\']/, EO:new RegExp(_7S?"^ | $|  ":"^ | $| (?= )","g"),EP:/\n/g, EQ:/\&/g,ER:/\</g,ES:/\'/g,ET:/\"/g, EU:{}}; var h=function(){}; h.prototype=D0; s=new h(); D0.NumberToString=function(EV,EW,EX){ if(EX&&EV&&typeof(EV)=="string"){ var AJ=EV.split(this.ValueSeparator); for(var i=0;i<AJ.length;i++){ var AN=AJ[i].split(this.RangeSeparator); for(var j=0;j<AN.length;j++)AN[j]=this.NumberToString(AN[j]-0,EW); AJ[i]=AN.join(EX==2?this.RangeSeparatorHtml:this.RangeSeparator);} return AJ.join(EX==2?this.ValueSeparatorHtml:this.ValueSeparator);} if(!EW)return EV+""; var Cq=this.EU[EW]; if(!Cq){Cq=this.EY(EW);if(!Cq)return "Bad format";} if(EV=="0")return Cq.EZ; if(!isFinite(EV))return Cq.NaN; if(!EV)return Cq.Ea; var Eb=0,exp=""; if(EV<0){ EV=-EV; Eb=1;} if(Cq.Ec){ var H=Cq.Ec; if(EV<=H.Ed||EV>=H.Ee){ exp=Math.floor(Math.log(EV)*Math.LOG10E); if(H.Ef)exp-=H.Ef; EV/=Math.pow(10,exp); var Eg=0; if(exp<0){Eg=1;exp=-exp;} exp+=""; if(H.Eh){ var Db=H.Eh-exp.length; if(Db==1)exp="0"+exp; else if(Db==2)exp="00"+exp;} if(Eg)exp=H.Ei+exp+H.Ej; else exp=H.Prefix+exp+H.Ek;}} EV=Math.round(EV*Cq.El); if(EV<1e21)EV+=""; else{ var B3=""; while(EV>=1e21){B3+="000";EV/=1000;} EV+=B3;}; if(Cq.Eh){ var Db=Cq.Ee+Cq.Eh-EV.length; if(Db>0)EV=(Db==1?"0":this.EF[Db])+EV;} if(Cq.Group){ var Db=EV.length-Cq.Ee; if(Db>3){ if(Db<7)EV=EV.slice(0,Db-3)+Cq.Group+EV.slice(Db-3); else if(Db<10)EV=EV.slice(0,Db-6)+Cq.Group+EV.slice(Db-6,Db-3)+Cq.Group+EV.slice(Db-3); else{ var B3=EV.slice(Db-3,Db+Cq.Ee);Db-=3; while(Db>3){B3=EV.slice(Db-3,Db)+Cq.Group+B3;Db-=3;} EV=(Db?EV.slice(0,Db)+Cq.Group:"")+B3;}}} if(Cq.Ee){ if(_7S){ var Em=EV.length-Cq.Ee,BM=EV.slice(Em); if(Cq.Ee!=Cq.Ed)BM=BM.replace(this.EE[Cq.Ee-Cq.Ed],""); if(BM)EV=EV.slice(0,Em)+Cq.En+BM; else EV=EV.slice(0,Em);} else{ EV=EV.replace(this.EG[Cq.Ee],Cq.En+"$&"); if(Cq.Ee!=Cq.Ed)EV=EV.replace(this.EE[Cq.Ee-Cq.Ed],"");}} if(Eb)return Cq.Ei+EV+exp+Cq.Ej; return Cq.Prefix+EV+exp+Cq.Ek;}; D0.EY=function(Cq,Eb){ if(!Cq)return null; if(Cq.length==1){ switch(Cq){ case 'g':Cq=this.D6;break; case 'f':Cq=this.D8;break; case 'c':Cq=this.D9;break; case 'p':Cq=this.EA;break; case 'r':Cq=this.EB;break; case 'e':Cq=this.ED;break;}} var CE={Eh:0,Ed:0,Ee:0,El:1,En:"",Group:"",Prefix:"",Ek:""}; var D2=0,DC="",Ak=0; for(var i=0;i<Cq.length;i++){ var BD=Cq.charAt(i); if(BD=='0'||BD=='#'){ if(D2){CE.Group=this.GroupSeparator;D2=0;} if(Ak==0){Ak=1;CE.Prefix=DC;DC="";} if(Ak==2){Ak=3;CE.En=DC;DC="";}} if(BD=='"'||BD=="'"){ for(i++;i<Cq.length&&Cq.charAt(i)!=BD;i++)DC+=Cq.charAt(i);} else if(BD=='\\'){ i++; DC+=Cq.charAt(i);} else if(BD=='0'){ if(Ak==1)CE.Eh++; if(Ak==3){CE.Ed++;CE.Ee++;} if(Ak==5)CE.Ec.Eh++;} else if(BD=='#'){ if(Ak==3){CE.Ee++;} if(Ak==5)CE.Ec.Eh++;} else if(BD=='.'){ if(Ak==0){Ak=1;CE.Prefix=DC;DC="";} if(Ak<2)Ak=2; DC+=this.DecimalSeparator; if(D2){CE.El/=Math.pow(1000,D2);D2=0;}} else if(BD==','){ if(Ak<2)D2++;} else if(BD=='%'){ DC+=this.D1; CE.El*=100;} else if(BD==';'){ var EW=Cq.slice(i+1); if(!EW)CE.EZ=""; else{ var AL=this.EY(EW,1); if(AL){ if(Eb){ CE.EZ=AL.Prefix+this.EF[AL.Eh]+AL.En+this.EF[AL.Ed]+AL.Ek;} else{ CE.Ei=AL.Prefix;CE.Ej=AL.Ek;CE.EZ=AL.EZ;}}}; break;} else if(BD=='e'||BD=='E'){ var H=new Object(); CE.Ec=H; H.Eh=0; H.Ed=1;H.Ee=1; H.Ef=CE.Eh-1;if(H.Ef<0)H.Ef=0; BD=DC+BD;DC=""; H.Prefix=BD;H.Ei=BD+"-"; H.Ek="";H.Ej=""; var Eo=Cq.charAt(i+1); if(Eo=='-')i++; else if(Eo=='+'){H.Prefix+='+';i++;} Ak=5;} else DC+=BD;} CE.Ek=DC; CE.El*=Math.pow(10,CE.Ee); if(CE.Ei==null)CE.Ei=CE.Prefix+"-"; if(CE.Ej==null)CE.Ej=CE.Ek; if(CE.EZ==null){ if(CE.Ec)CE.EZ=CE.Prefix+this.EF[CE.Eh]+CE.En+this.EF[CE.Ed]+CE.Ec.Prefix+this.EF[CE.Ec.Eh]+CE.Ec.Ek+CE.Ek; else CE.EZ=CE.Prefix+this.EF[CE.Eh]+CE.En+this.EF[CE.Ed]+CE.Ek;} CE.NaN=this.NaN; this.EU[Cq]=CE; CE.Ea=this.EmptyNumber==null?this.NumberToString(0,Cq):this.EmptyNumber; return CE;}; D0.StringToNumber=function(Ep,Cq,EX){ if(!Ep)return this.EmptyNumber!=null?"":0; if(Ep==this.EmptyNumber)return ""; if(Ep-0+""==Ep)return Ep-0; if(EX){ var AJ=Ep.split(this.ValueSeparator); for(var i=0;i<AJ.length;i++){ var AN=AJ[i].split(this.RangeSeparator); for(var j=0;j<AN.length;j++)AN[j]=StringToNumber(AN[j],Cq); AJ[i]=AN.join(this.RangeSeparator);} return AJ.join(this.ValueSeparator);} if(!Ep.replace)return parseFloat(Ep); var Eq=this.InputGroupSeparators;if(Eq)Eq="\\"+Eq.split('').join('\\'); Ep=Ep.replace(new RegExp("[\\s"+Eq+"]","g"),"").replace(new RegExp("[\\"+this.InputDecimalSeparators.split('').join('\\')+"]","g"),"."); if(Ep.search(/[xe]/i)>=0){ if(Ep.charAt(0).toLowerCase()=="x")Ep="0"+Ep; try{return eval(Ep);} catch(H){return 0;}} return parseFloat(Ep);}; D0._7AF=function(EV){ if(!EV)return ""; if(typeof(EV)!="object")EV=new Date(EV-0+""==EV?EV-0:EV); if(!isFinite(EV))return this.NaD; if(this.GMT-0){ var BM=EV.getUTCDate(),M=EV.getUTCMonth()+1,y=EV.getUTCFullYear(); var CS=EV.getUTCHours(),D3=EV.getUTCMinutes(),B3=EV.getUTCSeconds();} else{ var BM=EV.getDate(),M=EV.getMonth()+1,y=EV.getFullYear(); var CS=EV.getHours(),D3=EV.getMinutes(),B3=EV.getSeconds();}; var S=""; if(BM!=1||M!=1||y!=1970)S=(M<10?"0":"")+M+"/"+(BM<10?"0":"")+BM+"/"+y; if(CS||D3||B3)S+=(S?" ":"")+(CS<10?"0":"")+CS+":"+(D3<10?"0":"")+D3+(B3?":"+(B3<10?"0":"")+B3:""); return S;}; D0.DateToString=function(EV,EW,EX){ if(EX&&EV&&typeof(EV)=="string"){ var AJ=EV.split(this.ValueSeparator); for(var i=0;i<AJ.length;i++){ var AN=AJ[i].split(this.RangeSeparator); for(var j=0;j<AN.length;j++)AN[j]=this.DateToString(AN[j]-0,EW); AJ[i]=AN.join(EX==2?this.RangeSeparatorHtml:this.RangeSeparator);} return AJ.join(EX==2?this.ValueSeparatorHtml:this.ValueSeparator);} if(!EW)return this._7AF(EV); var Cq=this.EU[EW]; if(!Cq){ Cq=this.Er(EW); if(!Cq)return "Bad format"; this.EU[EW]=Cq;} if(!EV&&EV!==0)return Cq[3]; if(typeof(EV)!="object")EV=new Date(EV-0+""==EV?EV-0:EV); if(!isFinite(EV))return Cq[4]; var Db=Cq.length,B3=Cq[10],Es; if(Cq[2]=="0")for(var i=11;i<Db;i+=2){ switch(Cq[i]){ case 1:B3+=EV.getUTCDate();break; case 2:Es=EV.getUTCDate();B3+=Es<10?"0"+Es:Es;break; case 3:B3+=Cq[6][EV.getUTCDay()];break; case 6:B3+=Cq[7][EV.getUTCDate()-1];break; case 7: var Et=new Date(EV.getUTCFullYear(),0,1); B3+=Math.ceil((((EV-Et)/86400000)+Et.getUTCDay())/7); break; case 11:B3+=EV.getUTCMonth()+1;break; case 12:Es=EV.getUTCMonth()+1;B3+=Es<10?"0"+Es:Es;break; case 13:B3+=Cq[5][EV.getUTCMonth()];break; case 15:B3+=Cq[5][Math.floor(EV.getUTCMonth()/3)];break; case 16:B3+=Cq[5][Math.floor(EV.getUTCMonth()/6)];break; case 21:B3+=EV.getUTCFullYear()%100;break; case 22:Es=EV.getUTCFullYear()%100;B3+=Es<10?"0"+Es:Es;break; case 24:B3+=EV.getUTCFullYear();break; case 41:B3+=EV.getUTCHours()%12;break; case 42:Es=EV.getUTCHours()%12;B3+=Es<10?"0"+Es:Es;break; case 51:B3+=EV.getUTCHours();break; case 52:Es=EV.getUTCHours();B3+=Es<10?"0"+Es:Es;break; case 61:B3+=EV.getUTCMinutes();break; case 62:Es=EV.getUTCMinutes();B3+=Es<10?"0"+Es:Es;break; case 71:B3+=EV.getUTCSeconds();break; case 72:Es=EV.getUTCSeconds();B3+=Es<10?"0"+Es:Es;break; case 81:B3+=EV.getUTCHours()<12?Cq[8]:Cq[9];break; default: Es=-EV.getTimezoneOffset(); if(Es<0){B3+="-";Es=-Es;}else B3+="+"; B3+=(Es<600&&Cq[i]==92||Cq[i]==94||Cq[i]==95?"0":"")+Math.round(Es/60); if(Cq[i]>=93){Es=Es%60;B3+=(Cq[i]==95?"":":")+(Es<10?"0":"")+Es;} break;}; B3+=Cq[i+1];} else if(!Cq[2])for(var i=11;i<Db;i+=2){ switch(Cq[i]){ case 1:B3+=EV.getDate();break; case 2:Es=EV.getDate();B3+=Es<10?"0"+Es:Es;break; case 3:B3+=Cq[6][EV.getDay()];break; case 6:B3+=Cq[7][EV.getDate()-1];break; case 7: var Et=new Date(EV.getFullYear(),0,1); B3+=Math.ceil((((EV-Et)/86400000)+Et.getDay())/7); break; case 11:B3+=EV.getMonth()+1;break; case 12:Es=EV.getMonth()+1;B3+=Es<10?"0"+Es:Es;break; case 13:B3+=Cq[5][EV.getMonth()];break; case 15:B3+=Cq[5][Math.floor(EV.getMonth()/3)];break; case 16:B3+=Cq[5][Math.floor(EV.getMonth()/6)];break; case 21:B3+=EV.getFullYear()%100;break; case 22:Es=EV.getFullYear()%100;B3+=Es<10?"0"+Es:Es;break; case 24:B3+=EV.getFullYear();break; case 41:B3+=EV.getHours()%12;break; case 42:Es=EV.getHours()%12;B3+=Es<10?"0"+Es:Es;break; case 51:B3+=EV.getHours();break; case 52:Es=EV.getHours();B3+=Es<10?"0"+Es:Es;break; case 61:B3+=EV.getMinutes();break; case 62:Es=EV.getMinutes();B3+=Es<10?"0"+Es:Es;break; case 71:B3+=EV.getSeconds();break; case 72:Es=EV.getSeconds();B3+=Es<10?"0"+Es:Es;break; case 81:B3+=EV.getHours()<12?Cq[8]:Cq[9];break; default: Es=-EV.getTimezoneOffset(); if(Es<0){B3+="-";Es=-Es;}else B3+="+"; B3+=(Es<600&&Cq[i]==92||Cq[i]==94||Cq[i]==95?"0":"")+Math.round(Es/60); if(Cq[i]>=93){Es=Es%60;B3+=(Cq[i]==95?"":":")+(Es<10?"0":"")+Es;} break;}; B3+=Cq[i+1];} return B3;}; D0.Er=function(Cq){ if(!Cq)return null; var CE=[null,null,this.GMT-0?0:null,this.EmptyDate?this.EmptyDate:"",this.NaD]; if(Cq.length==1){ if(Cq=='U')CE[2]=0; if(Cq=='R'||Cq=='r')CE[2]=null; if(this[Cq])Cq=this[Cq];} var Au=10,Eu=""; for(var i=0;i<Cq.length;i++){ switch(Cq.charAt(i)){ case '%':break; case '/':Eu+=this.DateSeparator;break; case ':':Eu+=this.TimeSeparator;break; case 'd': CE[Au++]=Eu;Eu=""; if(Cq.charAt(i+1)!='d'){CE[Au++]=1;break;} i++;if(Cq.charAt(i+1)!='d'){CE[Au++]=2;break;} i++;if(Cq.charAt(i+1)!='d'){CE[Au++]=3;CE[6]=this.ShortDayNames;break;} i++;if(Cq.charAt(i+1)!='d'){CE[Au++]=3;CE[6]=this.LongDayNames;break;} i++;if(Cq.charAt(i+1)!='d'){CE[Au++]=3;CE[6]=this.Day1CharNames;break;} i++;if(Cq.charAt(i+1)!='d'){CE[Au++]=6;CE[7]=this.DayNumbers;break;} i++;if(Cq.charAt(i+1)!='d'){CE[Au++]=7;break;} CE[Au++]="";break; case 'M': CE[Au++]=Eu;Eu=""; if(Cq.charAt(i+1)!='M'){CE[Au++]=11;break;} i++;if(Cq.charAt(i+1)!='M'){CE[Au++]=12;break;} i++;if(Cq.charAt(i+1)!='M'){CE[Au++]=13;CE[5]=this.ShortMonthNames;break;} i++;if(Cq.charAt(i+1)!='M'){CE[Au++]=13;CE[5]=this.LongMonthNames;break;} i++;if(Cq.charAt(i+1)!='M'){CE[Au++]=15;CE[5]=this.Quarters;break;} i++;if(Cq.charAt(i+1)!='M'){CE[Au++]=16;CE[5]=this.Halves;break;} i++;if(Cq.charAt(i+1)!='M'){CE[Au++]=13;CE[5]=this.LongMonthNames2;break;} CE[Au++]="";break; case 'y': CE[Au++]=Eu;Eu=""; if(Cq.charAt(i+1)!='y'){CE[Au++]=21;break;} i++;if(Cq.charAt(i+1)!='y'){CE[Au++]=22;break;} i++;if(Cq.charAt(i+1)!='y'){CE[Au++]="";break;} i++;if(Cq.charAt(i+1)!='y'){CE[Au++]=24;break;} CE[Au++]="";break; case 'h': CE[Au++]=Eu;Eu=""; if(Cq.charAt(i+1)!='h'){CE[Au++]=41;break;} i++;if(Cq.charAt(i+1)!='h'){CE[Au++]=42;break;} CE[Au++]="";break; case 'H': CE[Au++]=Eu;Eu=""; if(Cq.charAt(i+1)!='H'){CE[Au++]=51;break;} i++;if(Cq.charAt(i+1)!='H'){CE[Au++]=52;break;} CE[Au++]="";break; case 'm': CE[Au++]=Eu;Eu=""; if(Cq.charAt(i+1)!='m'){CE[Au++]=61;break;} i++;if(Cq.charAt(i+1)!='m'){CE[Au++]=62;break;} CE[Au++]="";break; case 's': CE[Au++]=Eu;Eu=""; if(Cq.charAt(i+1)!='s'){CE[Au++]=71;break;} i++;if(Cq.charAt(i+1)!='s'){CE[Au++]=72;break;} CE[Au++]="";break; case 't': CE[Au++]=Eu;Eu=""; if(Cq.charAt(i+1)!='t'){CE[Au++]=81;CE[8]=this.AMDesignator.charAt(0);CE[9]=this.PMDesignator.charAt(0);break;} i++;if(Cq.charAt(i+1)!='t'){CE[Au++]=81;CE[8]=this.AMDesignator;CE[9]=this.PMDesignator;break;} CE[Au++]="";break; case 'z': CE[Au++]=Eu;Eu=""; if(Cq.charAt(i+1)!='z'){CE[Au++]=91;break;} i++;if(Cq.charAt(i+1)!='z'){CE[Au++]=92;break;} i++;if(Cq.charAt(i+1)!='z'){CE[Au++]=93;break;} i++;if(Cq.charAt(i+1)!='z'){CE[Au++]=94;break;} i++;if(Cq.charAt(i+1)!='z'){CE[Au++]=95;break;} break; case '\\':i++;Eu+=Cq.charAt(i);break; case '"': case "'": var AO=Cq.indexOf(Cq.charAt(i),i+1); if(AO==-1)break; Eu+=Cq.substring(i+1,AO);i=AO; break; default:Eu+=Cq.charAt(i);}} CE[Au]=Eu; return CE;}; D0._7o=function(Ep){ if(!Ep)return this.EmptyDate!=null?"":0; if(Ep==this.EmptyDate)return ""; var M=(Ep+"").match(this._7AE); if(!M)return 0; var BD=M[2],BM,CS=M[6],D3=M[7],B3=M[8]; if(!CS)CS=0;if(!D3)D3=0;if(!B3)B3=0; if(M[9]){ var a=M[9].charAt(0); if(!BD)CS=M[1]; if(CS<12){if(a=='p'||a=='P')CS=CS-0+12;} else if(CS==12){if(a=='a'||a=='A')CS=0;} if(!BD)M[1]=CS;} if(this.GMT-0){ if(!BD){ if(M[7])return Date.UTC(1970,0,1,M[1],D3,B3); return Date.UTC(this.EH,this.EI,M[1]?M[1]:this.EJ);} if(M[4]){ if(BD=='/')return Date.UTC(M[5]<70?M[5]-0+2000:M[5],M[1]-1,M[3],CS,D3,B3); if(BD=='-')return Date.UTC(M[1]<70?M[5]-0+2000:M[1],M[3]-1,M[5],CS,D3,B3); if(BD=='.')return Date.UTC(M[5]<70?M[5]-0+2000:M[5],M[3]-1,M[1],CS,D3,B3); return 0;} if(BD=='/')return Date.UTC(this.EH,M[1]-1,M[3]?M[3]:1,CS,D3,B3); if(BD=='-')return Date.UTC(this.EH,M[1]-1,M[3]?M[3]:1,CS,D3,B3); if(BD=='.')return Date.UTC(this.EH,M[3]?M[3]-1:EI,M[1],CS,D3,B3); return 0;} if(!BD){ if(M[7])return(new Date(1970,0,1,M[1],D3,B3)).getTime(); return(new Date(this.EH,this.EI,M[1]?M[1]:this.EJ)).getTime();} if(M[4]){ if(BD=='/')return(new Date(M[5]<70?M[5]-0+2000:M[5],M[1]-1,M[3],CS,D3,B3)).getTime(); if(BD=='-')return(new Date(M[1]<70?M[5]-0+2000:M[1],M[3]-1,M[5],CS,D3,B3)).getTime(); if(BD=='.')return(new Date(M[5]<70?M[5]-0+2000:M[5],M[3]-1,M[1],CS,D3,B3)).getTime(); return 0;} if(BD=='/')return(new Date(this.EH,M[1]-1,M[3]?M[3]:1,CS,D3,B3)).getTime(); if(BD=='-')return(new Date(this.EH,M[1]-1,M[3]?M[3]:1,CS,D3,B3)).getTime(); if(BD=='.')return(new Date(this.EH,M[3]?M[3]-1:EI,M[1],CS,D3,B3)).getTime(); return 0;}; D0.StringToDate=function(Ep,Cq,EX){ if(!Ep)return this.EmptyDate!=null?"":0; if(Ep==this.EmptyDate)return ""; if(EX){ var AJ=Ep.split(this.ValueSeparator); for(var i=0;i<AJ.length;i++){ var AN=AJ[i].split(this.RangeSeparator); for(var j=0;j<AN.length;j++)AN[j]=this.StringToDate(AN[j],Cq); AJ[i]=AN.join(this.RangeSeparator);} return AJ.join(this.ValueSeparator);} if(!Cq)return this._7o(Ep); var BE=this.GMT-0; function Ev(Ep,AJ){ if(!AJ)return null; Ep=Ep.toLowerCase(); for(var i=0;i<AJ.length;i++)if(AJ[i].toLowerCase()==Ep)return i+1; return null;}; function Ew(Ep){ var D3=Ev(Ep,this.LongMonthNames);if(D3)return D3; D3=Ev(Ep,this.LongMonthNames2);if(D3)return D3; D3=Ev(Ep,this.ShortMonthNames);if(D3)return D3; return null;}; if(Cq.length==1){ Cq=this[Cq]; if(!Cq)this._7AF(Ep);} Cq=Cq.replace(/\'[^\']*\'|\"[^\"]*\"|\\\S/g,""); if(Ep-0&&Ep.length>=3){ var Ex=0,Db=Ep.length; var CS=0,Es=0,B3=0; if(Cq.indexOf('M')<0){ if(Db==6){CS=Ep.slice(0,2)-0;Es=Ep.slice(2,4)-0;B3=Ep.slice(4,6)-0;Ex=1;} else if(Db==5){CS=Ep.slice(0,1)-0;Es=Ep.slice(1,3)-0;B3=Ep.slice(3,5)-0;Ex=1;} else if(Db==4){ if(Cq.search(/h/)>=0){CS=Ep.slice(0,2)-0;Es=Ep.slice(2,4)-0;Ex=1;} else{Es=Ep.slice(0,2)-0;B3=Ep.slice(2,4)-0;Ex=1;}} else if(Db==3){ if(Cq.search(/h/)>=0){CS=Ep.slice(0,1)-0;Es=Ep.slice(1,3)-0;Ex=1;} else{Es=Ep.slice(0,1)-0;B3=Ep.slice(1,3)-0;Ex=1;}} if(Ex)return BE?Date.UTC(1970,0,1,CS,Es,B3):(new Date(1970,0,1,CS,Es,B3)).getTime();} else{ var At=new Date(); if(BE){var BM=At.getUTCDate(),D3=At.getUTCMonth(),y=At.getUTCFullYear();} else{var BM=At.getDate(),D3=At.getMonth()+1,y=At.getFullYear();}; if(Db==3){ if(Cq.search(/M.*d/)>=0){D3=Ep.slice(0,1)-0;BM=Ep.slice(1,3)-0;Ex=1;} else if(Cq.search(/d.*M/)>=0){BM=Ep.slice(0,1)-0;D3=Ep.slice(1,3)-0;Ex=1;}} else if(Db==4){ if(Cq.search(/M.*d/)>=0){D3=Ep.slice(0,2)-0;BM=Ep.slice(2,4)-0;Ex=1;} else if(Cq.search(/d.*M/)>=0){BM=Ep.slice(0,2)-0;D3=Ep.slice(2,4)-0;Ex=1;} else if(Cq.search(/y.*M/)>=0){y=Ep.slice(0,2)-0;D3=Ep.slice(2,4)-0;y+=y<70?2000:1900;Ex=1;} else if(Cq.search(/M.*y/)>=0){D3=Ep.slice(0,2)-0;y=Ep.slice(2,4)-0;y+=y<70?2000:1900;Ex=1;}} else if(Db==6){ if(Cq.search(/M.*d.*y/)>=0){D3=Ep.slice(0,2)-0;BM=Ep.slice(2,4)-0;y=Ep.slice(4,6)-0;y+=y<70?2000:1900;Ex=1;} else if(Cq.search(/d.*M.*y/)>=0){BM=Ep.slice(0,2)-0;D3=Ep.slice(2,4)-0;y=Ep.slice(4,6)-0;y+=y<70?2000:1900;Ex=1;} else if(Cq.search(/y.*M.*d/)>=0){y=Ep.slice(0,2)-0;D3=Ep.slice(2,4)-0;BM=Ep.slice(4,6)-0;y+=y<70?2000:1900;Ex=1;} else if(Cq.search(/y.*d.*M/)>=0){y=Ep.slice(0,2)-0;BM=Ep.slice(2,4)-0;D3=Ep.slice(4,6)-0;y+=y<70?2000:1900;Ex=1;} else if(Cq.search(/yyyy.*M/)>=0){y=Ep.slice(0,4)-0;D3=Ep.slice(4,6)-0;Ex=1;} else if(Cq.search(/M.*yyyy/)>=0){D3=Ep.slice(0,2)-0;y=Ep.slice(2,6)-0;Ex=1;}} else if(Db==8){ if(Cq.search(/M.*d.*y/)>=0){D3=Ep.slice(0,2)-0;BM=Ep.slice(2,4)-0;y=Ep.slice(4,8)-0;Ex=1;} else if(Cq.search(/d.*M.*y/)>=0){BM=Ep.slice(0,2)-0;D3=Ep.slice(2,4)-0;y=Ep.slice(4,8)-0;Ex=1;} else if(Cq.search(/y.*M.*d/)>=0){y=Ep.slice(0,4)-0;D3=Ep.slice(4,6)-0;BM=Ep.slice(6,8)-0;Ex=1;} else if(Cq.search(/y.*d.*M/)>=0){y=Ep.slice(0,4)-0;BM=Ep.slice(4,6)-0;D3=Ep.slice(6,8)-0;Ex=1;}} if(Ex)return BE?Date.UTC(y,D3-1,BM):(new Date(y,D3-1,BM)).getTime();}} var M=Ep.match(this.EK); if(!M)return 0; var BM,D3,y,CS=M[9],Es=M[11],B3=M[13],Ak=0; if(!M[3]&&!M[4]&&!M[5]&&M[10])Ak=Cq.search(/[dMy]/)<0?1:2; else if(M[3]=='.'&&!CS&&!Es){ if(Cq.search(/[dMy]/)<0)Ak=1; else if(this.TimeSeparator=='.')Ak=2; if(Ak){Es=M[4];B3=M[7];}} else if(M[1]&&!M[2]&&!CS&&Cq.search(/[dMy]/)<0)Ak=1; if(Ak)CS=M[1]; else if(!CS&&M[10]){ if(M[7]){CS=M[7];M[7]=null;}} if(!CS)CS=0;if(!Es)Es=0;if(!B3)B3=0; if(M[14]){ var a=M[14].charAt(0); if(CS<12){if(a=='p'||a=='P')CS=CS-0+12;} else if(CS==12){if(a=='a'||a=='A')CS=0;}} if(Ak==2){ var At=new Date(); if(BE)At.setUTCHours(CS,Es,B3,0); else At.setHours(CS,Es,B3,0); return At.getTime();} else if(Ak==1)return BE?Date.UTC(1970,0,1,CS,Es,B3):(new Date(1970,0,1,CS,Es,B3)).getTime(); if(!M[1]&&M[2]){ D3=Ew(M[2]);if(!D3)return 0; BM=M[4]; y=M[7];} else if(!M[4]&&M[5]){ D3=Ew(M[5]);if(!D3)return 0; BM=M[1]; y=M[7];} else if(!M[7]&&M[8]){ D3=Ew(M[8]);if(!D3)return 0; BM=M[4]; y=M[1];} else if(M[1]>31){ BM=M[7];D3=M[4]; if(Cq.search(/y{1,4}\W*d{1,2}/)>=0){BM=M[4];D3=M[7];} if(!BM)BM=1; if(!D3)D3=1; y=M[1];} else if(M[4]>31){ BM=M[7];if(!BM)BM=1; D3=M[1]; if(Cq.search(/d{1,2}\W*y{1,4}/)>=0){D3=BM;BM=M[1];} y=M[4];} else if(!M[1]){ BM=this.EJ;} else{ if(Cq.search(/d{1,2}\W*M{1,5}/)>=0){ if(Cq.search(/y{1,4}\W*d{1,2}/)>=0){ BM=M[4];if(!BM)BM=1; D3=M[7];if(!D3)D3=1; y=M[1]; if(D3>12&&y<=31){BM=M[1];D3=M[4];y=M[7];}} else{ BM=M[1];D3=M[4];y=M[7];}} else if(Cq.search(/y{1,4}\W*M{1,5}/)>=0){ if(Cq.search(/d{1,2}\W*y{1,4}/)>=0){ BM=M[1]; D3=M[7]; y=M[4];} else{ BM=M[7];if(!BM)BM=1; D3=M[4];if(!D3)D3=1; y=M[1]; if(BM>31&&y<=31){BM=M[1];D3=M[4];y=M[7];}}} else if(Cq.search(/M{1,5}\W*y{1,4}/)>=0){ BM=M[7];if(!BM)BM=1; D3=M[1]; y=M[4];} else{ BM=M[4];if(!BM)BM=1; D3=M[1]; y=M[7];}}; if(!y){y=D3||BM?this.EH:1970;} else if(y<100){if(y<70)y=y-0+2000;else y=y-0+1900;} if(!D3)D3=BM?this.EI+1:1; D3--; if(!BM)BM=1; return BE?Date.UTC(y,D3,BM,CS,Es,B3):(new Date(y,D3,BM,CS,Es,B3)).getTime();}; D0.Bk=function(Ep){ var M=Ep; if(typeof(M)=="string"){ M=new Array(),Au=0; Ep=Ep.split(this.ValueSeparator); for(var i=0;i<Ep.length;i++){ if(!Ep[i])continue; var Dh=Ep[i].split(this.RangeSeparator); M[Au++]=Dh[0]-0; M[Au++]=Dh[1]?Dh[1]-0:Dh[0]-0;}} for(var i=0;i<M.length;i+=2){ var a=M[i],Ey=M[i+1];if(a==null)continue; a=new Date(a);Ey=new Date(Ey); a.setDate(a.getDate()-1);a=a.getTime(); Ey.setDate(Ey.getDate()+1);Ey=Ey.getTime(); for(var j=0;j<M.length;j+=2){ if(i==j||M[j]==null)continue; if(M[j]>=a&&M[j]<=Ey){ if(M[j+1]>=Ey)M[i+1]=M[j+1]; if(M[j]==a)M[i]=a; M[j]=null;M[j+1]=null; i=-2;break;} else if(M[j+1]>=a&&M[j+1]<=Ey){ M[i]=M[j]; M[j]=null;M[j+1]=null; i=-2;break;}}} M.sort(); var B3=""; for(var i=0;i<M.length;i+=2){ if(M[i]==null)continue; if(B3)B3+=this.ValueSeparator; B3+=M[i]; if(M[i+1]!=M[i])B3+=this.RangeSeparator+M[i+1];} return B3;}; D0.Escape=function(Bb){ if(Bb==null)return ""; if(typeof(Bb)!="string")return Bb+""; if(Bb.search(this.EN)<0)return Bb; if(Bb.indexOf("&")>=0)Bb=Bb.replace(D0.EQ,"&amp;"); if(Bb.indexOf("<")>=0)Bb=Bb.replace(D0.ER,"&lt;"); if(Bb.indexOf('"')>=0)Bb=Bb.replace(D0.ET,"&quot;"); if(Bb.indexOf("'")>=0)Bb=Bb.replace(D0.ES,"&#x27;"); return Bb;}; D0.Ez=function(Value,BA,E0){ if(Value==null)Value=""; else Value+=""; if(!BA){ if(!E0)return Value; if(Value.search(this.EM)>=0){ if(Value.indexOf("&")>=0)Value=Value.replace(this.EQ,"&amp;"); if(Value.indexOf("<")>=0)Value=Value.replace(this.ER,"&lt;"); if(Value.indexOf("\n")>=0)Value=Value.replace(this.EP,"<br>");} if(Value.indexOf(" ")>=0)Value=Value.replace(this.EO,_7D); return Value;} BA+=""; var Cq=BA.split(BA.charAt(0)); if(Cq[4]){ try{Value=Value.replace(new RegExp(Cq[4],Cq[5]),Cq[6]);} catch(H){alert((H.message?H.message:H)+"\n\nin value: "+Value+"\nwith format: "+BA+"\nregex: /"+Cq[4]+"/"+Cq[5]+" => "+Cq[6]);}} switch(Cq[1]-0){ case 1:Value=Value.toLowerCase();break; case 2:Value=Value.toUpperCase();break; case 3:Value=Value.toLocaleLowerCase();break; case 4:Value=Value.toLocaleUpperCase();break;}; return(Cq[2]?(E0>1?this.Escape(Cq[2]):Cq[2]):"")+(E0?this.Escape(Value).replace(this.EO,_7D).replace(this.EP,"<br/>"):Value)+(Cq[3]?(E0>1?this.Escape(Cq[3]):Cq[3]):"");}; D0.StringToValue=function(Bb,type,BA,EX){ if(type=="Int"||type=="Float")Bb=this.StringToNumber(Bb,BA,EX); else if(type=="Date")Bb=this.StringToDate(Bb,BA,EX); return Bb;}; D0.ValueToString=function(Bb,type,BA,EX){ if(type=="Int"||type=="Float"){ if(Bb===""&&this.EmptyNumber)return ""; Bb=this.NumberToString(Bb,BA,EX);} else if(type=="Date"){ if(Bb===""&&this.EmptyDate)return ""; Bb=this.DateToString(Bb,BA,EX);} else if(Bb==null)Bb=""; else Bb+=""; return Bb;}; function GetElem(id){ if(document.getElementById)return document.getElementById(id); else return document.all[id];}; function _7AG(CA,name){ return CA?CA.getElementsByTagName(name):new Array();}; function B2(CA){ if(_7P&&!_7S){ if(!B2.Base){ var AS=document.createElement("div"); AS.style.display="none"; document.body.insertBefore(AS,document.body.firstChild); B2.Base=AS;} document.body.insertBefore(CA,B2.Base);} else document.body.appendChild(CA);}; function GetStyle(E1){ if(!E1)return null; if(window.getComputedStyle)return getComputedStyle(E1,null); var Dh=document.defaultView; if(Dh&&Dh.getComputedStyle)return Dh.getComputedStyle(E1,null); return E1.currentStyle;}; function _7AH(style,E2){ if(!style)return 0; var E3=parseInt(style.borderLeftWidth),E4=parseInt(style.borderRightWidth); var E5=parseInt(style.paddingLeft),E6=parseInt(style.paddingRight); return(E3?E3:0)+(E4?E4:0)+(!E2?(E5?E5:0)+(E6?E6:0):0);}; function _7AI(style,E2){ if(!style)return 0; var E7=parseInt(style.borderTopWidth),E8=parseInt(style.borderBottomWidth); var E9=parseInt(style.paddingTop),FA=parseInt(style.paddingBottom); return(E7?E7:0)+(E8?E8:0)+(!E2?(E9?E9:0)+(FA?FA:0):0);}; function CancelEvent(Br,type){ if(!Br)Br=window.event; if(!Br)return; if(!type)type=3; if(type&4){ try{Br.Handled=true;} catch(H){type|=1;}} if(type&1){ if(Br.FB)Br.FB(); else if(Br.stopPropagation)Br.stopPropagation(); else Br.cancelBubble=true;} if(type&2){ if(Br.preventDefault){ if(Br.cancelable)Br.preventDefault();} else Br.returnValue=false;}}; function _7z(Br){ CancelEvent(Br,1);}; function _7AJ(Br){ CancelEvent(Br,2);}; function AttachEvent(CA,name,Cs){ if(CA.addEventListener)CA.addEventListener(name,Cs,false); else if(CA.attachEvent)CA.attachEvent("on"+name,Cs); else CA["on"+name]=Cs;}; function DetachEvent(CA,name,Cs){ if(CA.removeEventListener)CA.removeEventListener(name,Cs,false); else if(CA.detachEvent)CA.detachEvent("on"+name,Cs); else CA["on"+name]=null;}; function FireMouseEvent(E1,Br){ if(document.createEvent){ var FC=document.createEvent('MouseEvents'); FC.initMouseEvent(Br["type"],true,Br["cancelable"],Br["view"],Br["detail"],Br["screenX"],Br["screenY"],Br["clientX"],Br["clientY"],Br["ctrlKey"],Br["altKey"],Br["shiftKey"],Br["metaKey"],Br["button"],Br["relatedTarget"]); E1.dispatchEvent(FC);} else if(document.createEventObject){ var FC=document.createEventObject(); var AM=["detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget"]; for(var i=0;i<AM.length;i++)FC[AM[i]]=Br[AM[i]]; E1.fireEvent("on"+Br["type"],FC);}}; function DX(B3){ if(B3==null)return ""; return(B3+"").replace(/[\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}\/]/g,"\\$&");}; function FD(Ep){ if(!Ep)return[]; Ep+=""; var BD=Ep.charCodeAt(0); if(BD==32||BD==36||BD==45||BD>=48&&BD<=57||BD>=65&&BD<=90||BD>=97&&BD<=122){ if(Ep.indexOf(','))return Ep.split(','); if(Ep.indexOf(';'))return Ep.split(';'); if(Ep.indexOf('|'))return Ep.split('|');} return Ep.slice(1).split(Ep.charAt(0));}; function Bx(Ep){ if(!Ep)return{}; Ep=(Ep+"").toLowerCase().split(/[\,\;\s\|]/); var Cc={}; for(var i=0;i<Ep.length;i++)Cc[Ep[i]]=1; return Cc;}; function Bj(Br){ try{ var Cc=GetWindowScroll(); if(window.getSelection)getSelection().removeAllRanges(); else if(document.selection&&document.selection.empty)document.selection.empty(); var FE=GetWindowScroll(); if(FE[0]!=Cc[0]||FE[1]!=Cc[1])_7AK(Cc[0],Cc[1]);} catch(H){}}; function As(B3){ if(typeof(B3)!="string")return B3; try{return(new Function("return ("+B3+");"))();} catch(H){return B3;}}; function FF(B3){ if(typeof(B3)!="string")return B3; return B3.replace(/[\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}\/]/g,"\\$&");}; var DV={ Popup:1, CloseClickOut:1, ShowCursor:1, ShowTree:1, CollapseOther:1, EnterSwitches:1, IgnoreSpace:0, Base:"GMMenu", Over:5, Shift:-1, SubmenuTime:200, ExpandTime:200, EnumTime:200, Indent:12, Texts:{Aq:"OK",Clear:"Clear",FG:"All on",C9:"Cancel"}, PageLength:8, ShowHint:1, MinHeight:0, CanFocus:1, NameSeparator:":", Separator:"|", SeparatorReplace:":", AR:0}; function ShowMenu(M,AM,Cs,FH){ M=DV.DW(M);if(!M)return; C0(M,AM); if(FH==null){ if(M.Input)FH=M.Input.value; else if(M.FI!=null)FH=M.FI; if(typeof(FH)=="string")FH=FH.split(M.Separator);} if(FH){ if(typeof(FH)!="object")FH=As(FH); if(FH){ M.FJ(M.Items,FH); if(M.AllValues==2)DV.FK(M); if(FH.length==1)M.Cursor=FH[0];}} Dialogs.Add(M); if(Cs)M.OnSave=Cs; if(!M.ShowCursor&&M.ShowTree){ M.FL=0; for(var i=0;i<M.Items.length;i++)if(M.Items[i].Level){M.FL=1;break;}} else M.FL=M.ShowCursor?1:0; M.FM=0;M.FN=0; M.Body=M.FO(M.Items,M.FL); if(M.Buttons){ var B3="",Bo="<button class='"+M.B0("Button")+"' onclick='"+M.K+".ButtonClick(\""; for(var i=0;i<M.Buttons.length;i++){ var Ey=M.Buttons[i]; if(Ey=="Cancel")B3+=Bo+"Cancel\")'>"+M.Texts.C9+"</button>"; else if(Ey=="Clear")B3+=Bo+"Clear\")'>"+(M.FM?M.Texts.Clear:M.Texts.FG)+"</button>"; else if(Ey=="Ok"||Ey=="OK")B3+=Bo+"Ok\")'>"+M.Texts.Aq+"</button>"; else B3+=Bo+Ey+"\")'>"+(M.Texts[Ey]?M.Texts[Ey]:Ey)+"</button>";} M.Foot=B3;} else M.Foot=""; M.OnWidth=function(T,A5){ if(_7P&&M.FP)T.firstChild.style.overflow=""; T=T.getElementsByTagName("table"); var FQ=0; for(var i=0;i<T.length;i++){ T[i].width="100%"; if(_7Q){ var Ca=ElemToParent(T[i],T[i].offsetParent)[0]*2; if(Ca<0)Ca=FQ; T[i].style.marginRight=-Ca+"px"; var AP=T[i].rows[0]; if(AP.cells.length<=1)AP.cells[0].style.paddingRight=Ca+"px"; else AP.insertCell(AP.cells.length).style.width=Ca+"px"; FQ=Ca;}}}; if(M.FP)M.OnShow=function(T){M.FR(M.Items);}; if(M.FN){ if(AM&&AM.FS)CC(M); else ShowDialog(M,AM);} else{Dialogs.Delete(M);M.Close=null;return null;}; M.Expanded=1; return M;}; DV.B0=function(BQ){ return this.Base+BQ+(this.Class?" "+this.Class+BQ:"");}; DV.B5=function(BQ){ return " class='"+this.Base+BQ+(this.Class?" "+this.Class+BQ:"")+"'";}; DV.FK=function(AM){ for(var i=0;i<AM.Items.length;i++){ var AI=AM.Items[i]; if(AI.Items)DV.FK(AI); AI.FT=AI.Value;}}; DV.FU=function(AM,_7AL){ if(!AM.Items)return; if(typeof(AM.Items)=="string")AM.Items=FD(AM.Items); for(var i=0;i<AM.Items.length;i++){ if(typeof(AM.Items[i])!="object")AM.Items[i]={Name:AM.Items[i]}; var AI=AM.Items[i]; if(AM.Item)for(var Dh in AM.Item)if(AI[Dh]==null)AI[Dh]=AM.Item[Dh]; AI.Parent=AM; if(AI.Items)DV.FU(AI,_7AL); AI.FT=AI.Value; var id=AI.Name;if(id==null||id==="")id="I"+i; id=(id+"").replace(/\W/g,"_"); if(_7AL[id]!=null){ var C3=1; while(_7AL[id+C3])C3++; id+=C3; _7AL[id]=AI;} else _7AL[id]=AI; AI.id=id;}}; DV.DW=function(M,FV){ if(!M)return; if(M.FW){ if(M.AllValues==2)DV.FK(M); return M;} M=As(M); if(typeof(M)=="string")M={Items:FD(M)}; if(M.length&&M[0]!=null)M={Items:M}; M._7AL=[]; DV.FU(M,M._7AL); if(!M.Items||!M.Items.length)return; for(var i in DV)if(M[i]==null)M[i]=DV[i]; if(typeof(M.Buttons)=="string")M.Buttons=FD(M.Buttons); if(M.Cursor!=null)M.Cursor=(M.Cursor+"").replace(/\W/g,"_"); if(M._7AL[M.Cursor]==null)M.Cursor=null; if(!FV)M.FW=1; return M;}; DV.FO=function(Items,FX,AJ){ var M=this,FY=this._7AL,DG=0; if(!AJ){AJ=[];DG=1;} for(var i=0;i<Items.length;i++){ var AI=Items[i],B3=""; if(AI.Hidden)continue; if(AI.Columns&&AI.Items){ if(AI.Columns==1){this.FO(AI.Items,FX,AJ);continue;} var AN=[]; this.FO(AI.Items,FX,AN); if(AI.Group)this.FP=1; var FZ=Math.ceil(AN.length/AI.Columns),Fa=Math.ceil(AN.length/FZ); B3+=_7A+_7B; for(var j=0;j<FZ;j++){ B3+="<tr>"; for(var k=0;k<Fa;k++){ var Dh=AN[k*FZ+j]; if(k&&Dh)B3+="<td"+this.B5("VSeparator")+">"+_7D+"</td>"; if(Dh)B3+="<td>"+Dh+"</td>";} B3+="</tr>"} B3+=_7C; AJ[AJ.length]=B3; continue;} var Ai=AI.Text;if(Ai==null)Ai=AI.Name; if(AI.Name=="-"||AI.Name=="*-"){B3+="<div"+this.B5("Separator")+">"+_7D+"</div>";AI.Caption=1;} else if(AI.Caption)B3+="<div class='"+this.B0("Caption")+" "+this.B0("ItemText")+"'>"+Ai+"</div>"; else{ B3+="<div"+this.B5(AI.id==M.Cursor?"Focus":"Item")+" id=\"GM"+M.id+"_"+AI.id.replace(/\"/g,"&quot;")+"\""; B3+=" onmouseover='"+M.K+".Hover(this);'"; B3+=" onmouseout='"+M.K+".HideHover(this);'"; B3+=" onclick='"+M.K+".Click(this);'"; B3+=">"+_7A+_7B+"<tr>"; if(FX){ var Fb=""; if(M.ShowTree&&AI.Level&&AI.Expanded==1)Fb=this.B0("ExpandedIcon")+" "; else if(M.ShowTree&&AI.Level&&AI.Expanded==0)Fb=this.B0("CollapsedIcon")+" "; else if(M.ShowCursor)Fb=this.B0("CursorIcon")+" "; var A5=" style='width:"+(FX*M.Indent)+"px;'"; B3+="<td"+A5+"><div class='"+Fb+this.B0("ItemText")+"'"+A5+">"+_7D+"</div></td>";} var BB=""; if(AI.Bool){ BB="<td"+this.B5("CheckedParent")+"><div class='"+this.B0((AI.Value?"Checked":"Unchecked")+(AI.Group?"Radio":"Icon"))+" "+this.B0("ItemText")+"'>"+_7D+"</div></td>"; if(AI.Value)M.FM++;} else if(AI.Enum&&AI.Items&&AI.Items.length){ var Bb=AI.Value,Fc=Bb,A5=AI.Width; for(var j=0;j<AI.Items.length;j++){ if(Bb==AI.Items[j].Name){ if(AI.Items[j].Text!=null)Fc=AI.Items[j].Text; break;}} if(Fc==null)Fc=_7D; A5=A5?" style='width:"+A5+"px'":""; var Fd="";if(M.ShowHint)Fd=" onmousemove='ShowHint({Base:"+(this.Base.charAt(0)=='G'?'"'+this.Base.slice(0,2)+"Hint\"":null)+",Wrap:0},this);'"; BB="<td"+A5+this.B5("EnumParent")+"><div"+A5+this.B5("Enum")+(M.EnumTime?" onmouseover='"+this.K+".HoverEnum(this);'":Fd)+">"+Fc+"</div></td>";} else if(AI.Edit){ var Bb=AI.Value; if(typeof(Bb)=="string")Bb=s.StringToValue(Bb,AI.Type,AI.IOFormat,AI.Range); BB=M.Fe(AI,Bb,1);} if(AI.Left&&BB)B3+=BB; var BJ=""; if(AI.Level)BJ="Level"; if(BJ)BJ=" "+this.B0(BJ); if(AI.Icon)B3+="<td style='width:"+(AI.IconWidth?AI.IconWidth:20)+"px;' class='"+this.B0("ItemIcon")+BJ+"'>"+AI.Icon+"</td>"; B3+="<td class='"+this.B0("ItemText")+BJ+"'>"+Ai+"</td>"; if(!AI.Left&&BB)B3+=BB; if(AI.Menu)B3+="<td"+this.B5("NextParent")+"><div"+this.B5("NextIcon")+">"+_7D+"</div></td>"; B3+="</tr>"+_7C; B3+="</div>"; M.FN++;}; if(AI.Level){ B3+="<div"+this.B5("Section")+(AI.Expanded==0?" style='display:none;'":"")+">"+this.FO(AI.Items,FX+1)+"</div>";} AJ[AJ.length]=B3;} if(DG)return AJ.join("");}; DV.Fe=function(AI,Bb,Bi){ var Fc=s.ValueToString(Bb,AI.Type,AI.DisplayFormat,AI.Range),A5=AI.Width,Ak=AI.Type; if(!Fc)Fc=_7D; if(AI.Multi)Fc=Fc.replace(/\r\n|\n|\%n/g,"<br/>"); A5=A5?" style='width:"+A5+"px'":""; Ak=Ak?" "+this.B0("Edit"+Ak):""; var Fd="";if(this.ShowHint)Fd=" onmousemove='ShowHint({Base:"+(this.Base.charAt(0)=='G'?'"'+this.Base.slice(0,2)+"Hint\"":null)+",Wrap:0},this);'"; return(Bi?"<td"+A5+this.B5("EditParent")+">":"")+"<div"+A5+" class='"+this.B0("Edit")+Ak+(AI.Multi?" "+this.B0("EditMulti"):"")+"'"+Fd+">"+Fc+"</div>"+(Bi?"</td>":"");}; DV.FR=function(Items){ var G=[],Ff=0; for(var i=0;i<Items.length;i++){ var AI=Items[i]; if(AI.Items&&(AI.Columns>1||AI.Level))this.FR(AI.Items); if(AI.Columns>1&&AI.Group&&AI.Items){ var Cc=this.Fg(AI.Items[0]); if(!Cc)continue; Cc=Cc.parentNode;Ff=1; for(var j=0;j<AI.Columns;j++){ var D2=G[AI.Group],A5=Cc.offsetWidth; if(!D2){D2=[];G[AI.Group]=D2;} Cc=Cc.nextSibling;if(!Cc&&j!=AI.Columns-1)break; if(!D2[j]||D2[j]<A5)D2[j]=A5; if(!Cc)break; Cc=Cc.nextSibling;}}} if(!Ff)return; for(var i=0;i<Items.length;i++){ var AI=Items[i]; if(AI.Columns>1&&AI.Group&&AI.Items){ var Cc=this.Fg(AI.Items[0]); if(!Cc)continue; Cc=Cc.parentNode; for(var j=0;j<AI.Columns;j++){ Cc.style.width=G[AI.Group][j]+"px"; Cc=Cc.nextSibling;if(!Cc)break; Cc=Cc.nextSibling;}}} if(_7P)this.Tag.firstChild.style.overflow="visible";}; DV.Fg=function(AI){ if(!AI||!AI.id)return null; return document.getElementById("GM"+this.id+"_"+AI.id);}; DV.Fh=function(Cc){ if(!Cc||!Cc.id)return null; var id=Cc.id.slice((this.id+"").length+3); return this._7AL[id];}; DV.Fi=function(AI,Fj){ AI.Value=Fj.Name; var Cc=this.Fg(AI);if(!Cc)return; var AM=Cc.firstChild.rows[0].cells[this.FL+(AI.Left?0:1)].firstChild.innerHTML=Fj.Text!=null?Fj.Text:Fj.Name;}; DV.Fk=function(AI,Em){ if(!AI.Items)return null; for(var i=0;i<AI.Items.length;i++)if(AI.Value==AI.Items[i].Name){ var Fj=AI.Items[i+Em]; if(Fj)this.Fi(AI,Fj); return;}}; DV.Fl=function(AI){ if(!AI.Items)return; var Cc=this.Fg(AI);if(!Cc)return; var AL={}; for(var i in AI)AL[i]=AI[i]; AL.id=null; var X=["Base","Class","IgnoreSpace","Over","Shift","Indent","PageLength"]; for(var i=0;i<X.length;i++)if(AL[X[i]]==null)AL[X[i]]=this[X[i]]; if(this.Next){ var Fm=this.Next.Fn; this.Next.Close(1); if(Fm==AI&&!(this.SubmenuTime>0))return;} if(this.ClassMenu!=null)AL.Class=this.ClassMenu; AL.Popup=1; if(this.OnSubmenu){ var Fo=this.OnSubmenu(AI,AL); if(Fo==false)return; if(Fo&&Fo.Items){ for(var i in AL)if(i.indexOf("On")==0&&!Fo[i])Fo[i]=AL[i]; AL=Fo;}} AL.Prev=this; AL.Fn=AI; this.Next=AL; ShowMenu(AL,{Tag:Cc,Align:"next top"}); AL.Fp(AL.Items[0]);}; DV.Fq=function(AI,exp){ var Cc=this.Fg(AI);if(!Cc)return; Cc.nextSibling.style.display=exp?"":"none"; AI.Expanded=exp; if(this.ShowTree)Cc.firstChild.rows[0].cells[0].firstChild.className=this.B0(exp?"ExpandedIcon":"CollapsedIcon"); var C=this._7AL[this.Cursor]; if(C){ var AM=this.Fg(C),Fr=AM; while(AM&&AM!=Cc.nextSibling)AM=AM.parentNode; if(AM){ C.Expanded=0; this.Cursor=AI.id; Cc.className=this.B0("Focus"+(Cc.className.indexOf("Hover")>=0?"Hover":"")); Fr.className=this.B0("Item");}}}; DV.Expand=function(AI,exp){ var Cc=this.Fg(AI);if(!Cc)return; if(exp==null)exp=!AI.Expanded; if(exp&&this.OnExpand&&this.OnExpand(AI)==false)return; this.Fq(AI,exp); if(this.CollapseOther&&exp){ for(var Fs=Cc.parentNode.firstChild;Fs;Fs=Fs.nextSibling){ if(Fs==Cc)continue; var Ft=this.Fh(Fs); if(Ft&&Ft.Expanded)this.Fq(Ft,0);}} this.Ba();}; DV.Check=function(AI,Fu){ var Cc=this.Fg(AI);if(!Cc)return; if(AI.Group){ if(AI.Value&&!AI.Uncheck&&!Fu)return; var Dh=AI.Value; if(!Fu){ this.CheckAll(this.Items,0,AI.Group); if(!Dh)AI.Value=1;} else AI.Value=!AI.Value;} else if(AI.CheckAll&&!Fu)this.CheckAll(this.Items,!AI.Value,AI.GroupAll,"GroupAll"); else{ AI.Value=!AI.Value; if(AI.Value){this.FM++;if(this.FM==1)this.Fv();} else{this.FM--;if(!this.FM)this.Fv();}}; Cc.firstChild.rows[0].cells[this.FL+(AI.Left?0:1)].firstChild.className=this.B0((AI.Value?"Checked":"Unchecked")+(AI.Group?"Radio":"Icon"));}; DV.CheckAll=function(Items,Fw,Fu,name){ if(!name)name="Group"; for(var i=0;i<Items.length;i++){ var AI=Items[i]; if(AI.Bool&&(AI.Value&&!Fw||!AI.Value&&Fw)&&(!Fu&&!AI[name]||AI[name]==Fu))this.Check(AI,Fu?Fu:-1); if(AI.Items&&(AI.Level||AI.Columns))this.CheckAll(AI.Items,Fw,Fu,name);}}; DV.Fx=function(AI){ var Cc=this.Fg(AI);if(!Cc)return; var AL={}; for(var i in AI)AL[i]=AI[i]; AL.id=null; var X=["Base","Class","IgnoreSpace","Over","Shift","Indent","PageLength"]; for(var i=0;i<X.length;i++)if(AL[X[i]]==null)AL[X[i]]=this[X[i]]; AL.Cursor=AI.Value; AL.Prev=this; if(this.Next){ var Fm=this.Next.Fn; this.Next.Close(1); if(Fm==AI)return;} if(this.ClassEnum!=null)AL.Class=this.ClassEnum; this.Next=AL; AL.Fn=AI; var Fc=null; for(var i=0;i<AI.Items.length;i++)if(AI.Value==AI.Items[i].Name){Fc=AI.Items[i].Text;break;} if(Fc==null)Fc=AI.Value; if(Fc==null)Fc=_7D; AL.Header="<div"+this.B5("EnumHeader")+">"+Fc+"</div>"; AL.Shift=this.Shift; AL.MinWidth=0; var AM=Cc.firstChild.rows[0].cells[this.FL+(AI.Left?0:1)].firstChild; AL.Popup=this.EnumTime?0:1; AL.CloseClickHeader=1; ShowMenu(AL,{Tag:AM,Align:"left below",AlignHeader:"top justify"}); if(this.EnumTime){ AL.Bw.onclick=new Function("ev","CancelEvent(ev?ev:event)"); AL.Popup=1; AL.CloseOut=1;AL.CloseTimeout=this.EnumTime;} var M=this; AL.OnClose=function(){M.Next=null;Dialogs.Focused=M;}; AL.OnSave=function(Fj){M.Fi(AI,Fj);}; AL.Prev=null;}; DV.StartEdit=function(AI){ var Cc=this.Fg(AI);if(!Cc)return; if(this.EditMode)return; var AL={},M=this; for(var i in AI)AL[i]=AI[i]; AL.id=null; var AM=Cc.firstChild.rows[0].cells[this.FL+(AI.Left?0:1)]; if(!AI.Width)AM.style.width=AM.offsetWidth+"px"; AL.OnSave=function(Bb,DL){ if(M.Input&&DL.indexOf(M.Separator)>=0){ DL=DL.replace(new RegExp(FF(M.Separator),"g"),M.SeparatorReplace);} AI.Value=DL; AM.innerHTML=M.Fe(AI,DL,0); AL.Tag=null;}; if(_7P)AL.OnArrow=function(dir){ var AM=dir?M.GetNext(AI):M.GetPrev(AI); if(AM)M.Fp(AM);}; AL.Class=this.B0("Edit"); AL.OnClose=function(){M.EditMode=0;Dialogs.Focused=M;}; this.EditMode=1; this.Fy=AL; AL.Value=AI.Value==null?"":AI.Value; Cz(AL,AM.firstChild);}; DV.Click=function(Cc,Fz){ var AI=this.Fh(Cc);if(!AI)return; this.Fp(AI); if(AI.Menu){ if(this.Next&&AI.Bool)this.Check(AI); else this.Fl(AI); return;} if(AI.Enum){if(!this.EnumTime)this.Fx(AI);return;} if(AI.Edit){this.StartEdit(AI);return;} if(this.Next)this.Next.Close(1); if(AI.Level&&AI.Expanded!=null&&!this.ExpandTime){ if(AI.Expanded==1&&AI.Bool)this.Check(AI); else this.Expand(AI);} else if(AI.Bool)this.Check(AI); else if(AI.CheckAll){this.CheckAll(this.Items,!AI.Value,AI.GroupAll,"GroupAll");this.Save();} else if(!AI.Caption&&!Fz&&!AI.Level)this.Save(AI);}; DV.Save=function(AI){ if(this.EditMode)this.Fy.Save(); var Fj=this.OnCSave||this.OnSave||this.Input?this.F0(this.Items):null; if(this.Input)this.Input.value=AI?(AI.Value!=null?AI.Value:AI.Name):Fj.join(this.Separator); if(this.OnCSave)this.OnCSave(AI,Fj); if(this.OnSave&&this.OnSave(AI,Fj)==false)return false; if(this.Popup)this.Close(); return true;}; DV.F1=function(Cc,Bl){ var AI=this.Fh(Cc);if(!AI)return; Cc.className=this.B0((this.Cursor==AI.id?"Focus":"Item")+(Bl?"Hover":"")); if(this.ShowCursor&&(!AI.Level||AI.Expanded==null)){ Cc.firstChild.rows[0].cells[0].firstChild.className=this.B0((Bl?"Hover":"Cursor")+"Icon");}}; DV.HideHover=function(Cc){ this.F2=Cc; var M=this; setTimeout(function(){if(M.F2==Cc){M.F1(Cc);M.F2=null;}},10);}; DV.Hover=function(Cc){ var AI=this.Fh(Cc),M=this; if(!AI)return; if(Cc==this.F2){this.F2=null;return;} if(this.F2)this.F1(this.F2,0); this.F1(Cc,1); if(this.ShowHint&&this.Tag.firstChild.offsetWidth<Cc.firstChild.offsetWidth){ ShowHint({Base:this.Base.charAt(0)=='G'?this.Base.slice(0,2)+"Hint":null,Wrap:0},Cc,1);} if(this.SubmenuTime>0){ var AL=M.Next; if(AL&&AL.Fn!=AI){ setTimeout(function(){ if(AL!=M.Next||Cc.className.indexOf("Hover")<0)return; if(M.Next)M.Next.Close(1);},M.SubmenuTime);} if(AI.Menu){ setTimeout(function(){ if(Cc.className.indexOf("Hover")<0)return; M.Fl(AI);},M.SubmenuTime);}} if(M.ExpandTime>0&&AI.Level&&AI.Expanded==0){ setTimeout(function(){ if(Cc.className.indexOf("Hover")<0)return; M.Expand(AI,1);},M.ExpandTime);}}; DV.F3=function(Cc){ while(Cc&&!Cc.id)Cc=Cc.parentNode; if(!Cc)return; var AI=this.Fh(Cc),M=this; if(!AI)return; setTimeout(function(){ if(Cc.className.indexOf("Hover")<0)return; M.Fx(AI); M.Cd=(new Date()).getTime()+100;},M.EnumTime);}; DV.Close=function(F4){ var M=this; if(this.EditMode){this.Fy.C9();this.EditMode=0;} if(!F4)while(M.Prev&&M.Prev.Popup)M=M.Prev; if(M.Next)M.Next.Close(1); if(M.Prev)M.Prev.Next=null; if(Dialogs.Focused==M)Dialogs.Focused=M.Prev; M.Prev=null; M.Expanded=0; M.Delete();}; DV.Fp=function(AI){ var C=this._7AL[this.Cursor]; if(C==AI)return; if(this.EditMode)this.Fy.Save(); if(C){ var Cc=this.Fg(C); if(Cc)Cc.className=this.B0("Item"+(Cc.className.indexOf("Hover")>=0?"Hover":""));} if(AI){ this.Cursor=AI.id; if(this.Cursor){ var Cc=this.Fg(AI); if(Cc)Cc.className=this.B0("Focus"+(Cc.className.indexOf("Hover")>=0?"Hover":"")); if(this.OnMove)this.OnMove(AI);}} else this.Cursor=null; this.CT();}; DV.CT=function(){ var CE=this.A9(); if(this.Cursor==null||CE.style.overflow!="auto")return; try{this.FocusTag?this.FocusTag.focus():this.Tag.focus();}catch(H){}; var Cc=this.Fg(this._7AL[this.Cursor]); if(Cc){ var top=Cc.offsetTop; if(Cc.parentNode.tagName.toLowerCase()=="td")top+=Cc.parentNode.parentNode.parentNode.parentNode.offsetTop; CE.scrollTop=top-CE.clientHeight/2+Cc.offsetHeight/2;}}; DV.ButtonClick=function(Bo){ if(this.OnButton&&F5(Bo)==false)return; if(Bo=="Ok")this.Save(); else if(Bo=="Clear"){ this.CheckAll(this.Items,this.FM?0:1);} else if(Bo=="Cancel"){ if(this.Popup)this.Close();} try{(this.FocusTag?this.FocusTag:this.Tag).focus();}catch(H){}}; DV.Fv=function(){ if(!this.Buttons)return; for(var i=0;i<this.Buttons.length;i++){ if(this.Buttons[i]=="Clear")this.Tag.firstChild.lastChild.childNodes[i].value=this.FM?this.Texts.Clear:this.Texts.FG;}}; DV.GetPrev=function(AI){ var Cc=this.Fg(AI); var AM=Cc?Cc.previousSibling:this.A9().firstChild.lastChild; if(!AM&&Cc)AM=Cc.parentNode.previousSibling; if(Cc&&Cc.parentNode.tagName.toLowerCase()=="td"){ AM=Cc.parentNode.parentNode.previousSibling; while(1){ if(!AM){AM=Cc.parentNode.parentNode.parentNode.parentNode.previousSibling;break;} var F6=Cc.parentNode.cellIndex,Fj=AM; AM=AM.cells[F6].firstChild; while(AM&&!AM.id)AM=AM.previousSibling; if(AM){this.F7=F6;break;} AM=Fj.previousSibling;}} while(AM&&!AM.id){ if(AM.tagName.toLowerCase()=="table"){ var F6=this.F7; AM=AM.rows[AM.rows.length-1]; if(!AM.cells[F6])F6=0; while(AM&&!AM.cells[F6].firstChild.id)AM=AM.previousSibling; if(AM)AM=AM.cells[F6].firstChild; else AM=Cc.previousSibling.previousSibling;} else if(AM.className.indexOf("Section")>=0){ if(AM.style.display!="none")AM=AM.lastChild; else AM=AM.previousSibling;} else AM=AM.previousSibling;} if(AM&&AM.id)return this.Fh(AM); return null;}; DV.GetNext=function(AI){ var Cc=this.Fg(AI); var AM=Cc?Cc.nextSibling:this.A9().firstChild.firstChild; if(!AM&&Cc)AM=Cc.parentNode.nextSibling; if(Cc&&Cc.parentNode.tagName.toLowerCase()=="td"){ AM=Cc.parentNode.parentNode.nextSibling; while(1){ if(!AM){AM=Cc.parentNode.parentNode.parentNode.parentNode.nextSibling;break;} var F6=Cc.parentNode.cellIndex,Fj=AM; AM=AM.cells[F6]; if(!AM&&F6){AM=Fj.cells[0];F6=0;} if(AM)AM=AM.firstChild; while(AM&&!AM.id)AM=AM.nextSibling; if(AM){this.F7=F6;break;} AM=Fj.nextSibling;}} while(AM&&!AM.id){ if(AM.tagName.toLowerCase()=="table"){ var F6=this.F7; if(!AM.rows[0].cells[F6])F6=0; AM=AM.rows[0]; while(AM&&!AM.cells[F6].firstChild.id)AM=AM.nextSibling; if(AM)AM=AM.cells[F6].firstChild; else AM=Cc.nextSibling.nextSibling;} else if(AM.className.indexOf("Section")>=0){ if(AM.style.display!="none")AM=AM.firstChild; else AM=AM.nextSibling;} else AM=AM.nextSibling;} if(AM&&AM.id)return this.Fh(AM); return null;}; DV.Bp=function(Bq,Br){ var M=this,AI=this._7AL[this.Cursor],Cc=this.Fg(AI); if(Bq==38||Bq==40){ var C=Bq==38?this.GetPrev(AI):this.GetNext(AI); if(C)this.Fp(C); else if(this.OnMoveOut&&this.OnMoveOut(Bq==38?0:1))this.Fp(null);} else if(Bq==33||Bq==34){ var Em=AI?this.PageLength:1; for(var i=0;i<Em;i++){ var C=Bq==33?this.GetPrev(AI):this.GetNext(AI); if(!C){ if(!i){AI=null;if(this.OnMoveOut&&this.OnMoveOut(Bq==33?0:1))this.Fp(null);} break;} AI=C;} if(AI)this.Fp(AI);} else if(Bq==27){if(M.Popup)M.Close(1);} else if(Bq==13&&M.Buttons&&M.Buttons.join(",").indexOf("Ok")>=0&&(Br.altKey||Br.ctrlKey||!M.EnterSwitches)){ if(M.Level||M.Menu||M.Caption)M.ButtonClick(1); else M.Save();} else if(Bq==9){if(M.OnTab)M.OnTab(Br.shiftKey?1:0);} else if(Cc){ if(Bq==32&&this.IgnoreSpace)return; else if((Bq==37||Bq==39)&&Cc.parentNode.tagName.toLowerCase()=="td"){ var AM=Cc.parentNode[Bq==37?"previousSibling":"nextSibling"]; if(AM){AM=AM[Bq==37?"previousSibling":"nextSibling"];if(AM)AM=AM.firstChild;} if(AM&&AM.id){ this.Fp(this.Fh(AM)); this.F7=AM.parentNode.cellIndex;}} else if(Bq==32&&AI.Bool)M.Check(AI); else if((Bq==32||Bq==113)&&AI.Enum)M.Fx(AI); else if((Bq==32||Bq==113)&&AI.Edit)M.StartEdit(AI); else if(Bq==37&&M.Prev)M.Close(1); else if(Bq==39&&AI.Menu){if(!M.Next||M.Next.Fn!=AI)M.Fl(AI);} else if(Bq==37&&AI.Level&&AI.Expanded!=null){if(AI.Expanded==1)M.Expand(AI,0);} else if(Bq==39&&AI.Level&&AI.Expanded!=null){if(AI.Expanded==0)M.Expand(AI,1);} else if((Bq==32||Bq==13)&&AI.Level&&AI.Expanded!=null)M.Expand(AI); else if((Bq==32||Bq==13)&&AI.Menu)M.Fl(AI); else if(Bq==13&&AI.Bool)M.Check(AI); else if(Bq==13&&AI.Enum)M.Fx(AI); else if(Bq==13&&AI.Edit)M.StartEdit(AI); else if(Bq==37&&AI.Bool&&AI.Value)M.Check(AI); else if(Bq==39&&AI.Bool&&!AI.Value)M.Check(AI); else if(Bq==37&&AI.Enum)M.Fk(AI,-1); else if(Bq==39&&AI.Enum)M.Fk(AI,1); else if((Bq==32||Bq==13)&&!M.Caption)M.Save(AI); else if(Bq==27){if(M.Popup)M.Close(1);} else return;} else return; CancelEvent(Br);}; DV.F0=function(Items){ var AJ=[]; for(var i=0;i<Items.length;i++){ var AI=Items[i]; if(AI.Bool){ if(this.AllValues){if(this.AllValues!=2||AI.Value&&!AI.FT||!AI.Value&&AI.FT)AJ[AJ.length]=AI.Name+this.NameSeparator+(AI.Value?1:0);} else if(AI.Value)AJ[AJ.length]=AI.Name;} else if(AI.Enum||AI.Edit){ if(this.AllValues==2&&AI.Value!=AI.FT||this.AllValues!=2&&(AI.Value||this.AllValues)){ var Dh=AI.Value; if(AI.Edit&&AI.IOFormat){ if(AI.Type=="Int"||AI.Type=="Float")Dh=s.NumberToString(Dh,AI.IOFormat,AI.Range); else if(AI.Type=="Date")Dh=s.DateToString(Dh,AI.IOFormat,AI.Range);} AJ[AJ.length]=AI.Name+this.NameSeparator+(Dh?Dh:"");}} else if(AI.Items)AJ=AJ.concat(this.F0(AI.Items));} return AJ;}; DV.FJ=function(Items,AJ){ for(var i=0;i<Items.length;i++){ var AI=Items[i]; if(AI.Bool&&!this.AllValues){AI.Value=0;for(var j=0;j<AJ.length;j++)if(AJ[j]==AI.Name){AI.Value=1;break;}} else if(AI.Enum||AI.Edit||AI.Bool){ if(this.AllValues!=2)AI.Value=null; var Es=AI.Name+this.NameSeparator,F8=Es.length; for(var j=0;j<AJ.length;j++){ if(AJ[j].indexOf(Es)==0){ var Dh=AJ[j].slice(F8); if(AI.Bool){ if(Dh-0)AI.Value=1; else if(!Dh||Dh==0)AI.Value=1; else continue;} else AI.Value=Dh; break;}}} else if(AI.Items)this.FJ(AI.Items,AJ);}}; function F9(M,AM,DF){ M=DV.DW(M);if(!M)return; AM=Bs.Bt(AM); if(DF)M.Input=DF; var GA=M.Input;if(!GA)GA=AM.Tag; for(var i=0;i<Dialogs.length;i++)if(Dialogs[i]&&Dialogs[i].GB==GA)return; M.GB=GA; if(!M.MinWidth)M.MinWidth=0; M.CloseClickHeader=1; var GC=AM.Tag?AM.Tag.innerHTML:"";if(!GC)GC=_7D; M.Header="<div class='"+GD.Class+"EnumHeader'>"+GC+"</div>"; M.OnCSave=function(AI,Fj){ var Dh=""; if(AI)Dh=AI.Value!=null?AI.Value:AI.Name; else Dh=Fj.join(M.Separator); if(M.Input)M.Input.value=Dh; if(AM.Tag)AM.Tag.innerHTML=Dh;}; return ShowMenu(M,AM);}; function GE(M,Cs,FH){ M=ShowMenu(M,{X:-10,Y:-10,Mouse:1},Cs,FH); if(M&&M.Tag&&!M.Head)M.Hover(M.Fg(M.Items[0]));}; function _7t(){ var GF=document.body,GG=document.documentElement; if(_7Q)return[GF.clientLeft,GF.clientTop]; if(_7N){ if(_7t.GH==null){ var B3=GetStyle(GG); if(!B3)return[-GG.offsetLeft,-GG.offsetTop]; var GI=parseInt(B3.marginLeft),GJ=parseInt(B3.marginTop); _7t.GH=GI?GI:0; _7t.GK=GJ?GJ:0;} return[-GG.offsetLeft+_7t.GH,-GG.offsetTop+_7t.GK];} if(D)return[GF.clientLeft,GF.clientTop]; if(_7J)return[GG.offsetLeft,GG.offsetTop]; if(_7K){ if(_7t.GL==null){ var B3=GetStyle(GG); if(!B3)return[GG.offsetLeft,GG.offsetTop]; var GM=parseInt(B3.borderLeftWidth),GN=parseInt(B3.borderTopWidth); _7t.GL=GM?GM:0; _7t.Dd=GN?GN:0;} return[GG.offsetLeft+_7t.GL,GG.offsetTop+_7t.Dd];} return[0,0];}; function _7u(Br){ var GF=document.body,GG=document.documentElement,x=Br.clientX,y=Br.clientY; if(_7F&&_7O||F||_7N&&_7O)return[x+GG.scrollLeft,y+GG.scrollTop]; if(_7R){ if(Br.type)return[(x+GG.scrollLeft-GG.clientLeft)/_7r,(y+GG.scrollTop-GG.clientTop)/_7r]; else return[x+(GG.scrollLeft-GG.clientLeft)/_7r,y+(GG.scrollTop-GG.clientTop)/_7r];} if(D)return[x+GF.clientLeft+GF.scrollLeft,y+GF.clientTop+GF.scrollTop]; return[x+GF.scrollLeft,y+GF.scrollTop];}; function CY(Br){var AJ=_7u(Br),AN=_7t();return[AJ[0]-AN[0],AJ[1]-AN[1]];}; function _7v(E1){var AJ=_7s(E1),AN=_7t();return[AJ[0]-AN[0],AJ[1]-AN[1]];}; function GO(Br,E1){var AJ=_7s(E1),AN=_7u(Br);return[AN[0]-AJ[0],AN[1]-AJ[1]];}; function ElemToParent(E1,GP){var AJ=_7s(GP),AN=_7s(E1);return[AN[0]-AJ[0],AN[1]-AJ[1]];}; EventXYToElement=GO; function _7s(E1){ if(!E1)return null; var GF=document.body,GG=document.documentElement; if(_7P&&E1.getBoundingClientRect){ var AJ=E1.getBoundingClientRect(); var x=AJ.left,y=AJ.top; if(_7R){ x+=GG.scrollLeft; y+=GG.scrollTop; if(!_7U){x-=GG.clientLeft;y-=GG.clientTop;}} else if(_7Q){ x+=GF.scrollLeft; y+=GF.scrollTop;} return[x/_7r,y/_7r];} var x=E1.offsetLeft,y=E1.offsetTop,Au,GQ=E1; try{Au=E1.offsetParent;}catch(H){return[x,y];}; if(!Au)return _7t(); if(_7P){ if(_7R&&_7r!=1&&GQ.style.position=="absolute"){ x+=Math.floor(GQ.offsetLeft/_7r-GQ.offsetLeft); y+=Math.floor(GQ.offsetTop/_7r-GQ.offsetTop);} while(Au&&Au!=GG){ if(Au==GF){ x+=Au.offsetLeft+Au.clientLeft; y+=Au.offsetTop+Au.clientTop; break;} if((!_7U||!_7O)&&Au.tagName.toLowerCase()=="table"){ x-=Au.clientLeft; y-=Au.clientTop;} x+=Au.offsetLeft+Au.clientLeft-Au.scrollLeft; y+=Au.offsetTop+Au.clientTop-Au.scrollTop; Au=Au.offsetParent;} if(_7U&&_7O){x-=GF.clientLeft;y-=GF.clientTop;} if(_7R&&_7r!=1){ x+=Math.floor(Au.offsetLeft/_7r-Au.offsetLeft); y+=Math.floor(Au.offsetTop/_7r-Au.offsetTop);}} else{ var GR=E1; while(1){ while(GR!=Au){ GR=GR.parentNode; if(!GR||GR==GF)break; if(_7N&&((!_7W||_7X)&&!_7Y&&!_7V&&(GR.scrollWidth!=GR.offsetWidth||GR.scrollHeight!=GR.offsetHeight)||GR==Au)||_7G&&GR==Au){ if(GR.clientWidth&&GR.clientHeight&&GR.offsetHeight&&GR!=document.body){ var Ca=GR.offsetWidth-GR.clientWidth,Cb=GR.offsetHeight-GR.clientHeight; if(_7W){ if(Ca>=30)Ca-=30; if(Cb>=24)Cb-=24;} else{ if(Ca>=16)Ca-=16; if(Cb>=16)Cb-=16;}; if(_7N&&(GR==Au&&(GR.scrollWidth!=GR.offsetWidth||GR.scrollHeight!=GR.offsetHeight))){ x+=Math.ceil(Ca/2)*2; y+=Math.ceil(Cb/2)*2;} else{ var CA=GR.tagName.toLowerCase(); if(CA!="table"&&(CA!="td"||_7G)){ x+=Math.ceil(Ca/2); y+=Math.ceil(Cb/2);}}}} if(GR!=GF){ x-=GR.scrollLeft; y-=GR.scrollTop;} if((_7G||_7F&&_7H<9.5)&&GR.tagName){ var CA=GR.tagName.toLowerCase(); if(CA=='tr'){y+=GR.offsetTop;x+=GR.scrollLeft;} else if(CA=='tbody')x+=GR.scrollLeft; else if(_7F&&CA=='table'&&GR.style.borderCollapse!='collapse')y+=Math.floor((GR.offsetHeight-GR.clientHeight)/2);} if(_7J&&GR.tagName){ var CA=GR.tagName.toLowerCase(); if(CA=='table'&&GR.style.borderCollapse!='collapse'){ x+=Math.floor((GR.offsetWidth-GR.clientWidth)/2); y+=Math.floor((GR.offsetHeight-GR.clientHeight)/2);}} if((_7Y||_7J)&&GR.tagName){ var CA=GR.tagName.toLowerCase(); if(CA=="td"){x+=GR.clientLeft;y+=GR.clientTop;}}} if(!Au||Au==GF)break; x+=Au.offsetLeft; y+=Au.offsetTop; GQ=Au; Au=Au.offsetParent;} if(_7G||_7N||_7J||_7I){ var abs=GQ.GS; if(abs==null){ var B3=GetStyle(GQ); abs=B3.position=="absolute"; GQ.GS=abs;} if(_7N||_7J&&!abs){ if(GG.marginLeft==null){ var B3=GetStyle(GG); var GI=parseInt(B3.marginLeft),GJ=parseInt(B3.marginTop); GG.marginLeft=GI?GI:0;GG.marginTop=GJ?GJ:0;} x+=GG.marginLeft;y+=GG.marginTop;} if(_7N&&abs){x-=GG.offsetLeft;y-=GG.offsetTop;} if(_7Y&&!abs&!_7O){x-=GF.offsetLeft;y-=GF.offsetTop;} if(_7I&&abs){x+=GG.offsetLeft;y+=GG.offsetTop;} if(_7I&&!abs){x+=GF.offsetLeft;y+=GF.offsetTop;} if((_7N||_7J)&&!abs){ if(GF.clientLeft==null){ var B3=GetStyle(GF); var GM=parseInt(B3.borderLeftWidth),GN=parseInt(B3.borderTopWidth); GF.clientLeft=GM?GM:0;GF.clientTop=GN?GN:0;} x+=GF.clientLeft;y+=GF.clientTop;} if(_7G&&!abs){ x+=GF.offsetLeft+GF.clientLeft; y+=GF.offsetTop+GF.clientTop;} if(_7J){ if(abs){ x+=GF.clientLeft; y+=GF.clientTop;}}} if(_7M){x+=GG.offsetLeft;y+=GG.offsetTop;}}; return[x,y];}; function GetWindowSize(GT){ var GG=document.documentElement,GF=document.body,A5,CS; if(_7O)CS=GG.clientHeight; else CS=GF.clientHeight; if(!_7P&&GT||_7N){ var GU=GetWindowSize.GV; if(GU==null){ var B3=GetStyle(GG); if(B3)GU=parseInt(B3.marginTop)+parseInt(B3.marginBottom); if(!GU)GU=0; if(B3)GetWindowSize.GV=GU;} CS-=GU; if(_7W&&!_7X||_7V||_7N&&!GT)CS+=GG.offsetTop*2;} if(_7Q)A5=GF.clientWidth; else A5=GG.clientWidth; if(_7N&&_7O||_7K&&!_7O){ var GW=GetWindowSize.GX; if(GW==null){ var B3=GetStyle(GG); if(B3)GW=parseInt(B3.marginLeft)+parseInt(B3.marginRight); if(!GW)GW=0; if(B3)GetWindowSize.GX=GW;} if(_7K)A5+=GW+GG.clientLeft*2; else A5-=GW; if(_7W&&!_7X||_7V||_7N&&!GT)A5+=GG.offsetLeft*2;} return[A5,CS];}; function GetWindowScroll(){ var GG=document.documentElement; if(!GG||!GG.clientWidth)return[document.body.scrollLeft,document.body.scrollTop]; var GF=document.body;if(!GF)return[0,0]; return[GG.scrollLeft?GG.scrollLeft:GF.scrollLeft,GG.scrollTop?GG.scrollTop:GF.scrollTop];}; function CI(){ var AJ=GetWindowSize(),AN=GetWindowScroll(); return[AN[0],AN[1],AJ[0],AJ[1]];}; function _7AK(x,y){ try{ var GG=document.documentElement; if(!GG||!GG.clientWidth||window.pageXOffset!=null&&document.compatMode!="CSS1Compat")GG=document.body; GG.scrollLeft=x;GG.scrollTop=y;} catch(H){}}; function _7AM(){ if(window.scrollMaxX!=null)return[window.scrollMaxX+window.innerWidth,window.scrollMaxY+window.innerHeight]; var GG=document.documentElement; if(!GG||!GG.clientWidth)GG=document.body; return[GG.scrollLeft,GG.scrollTop];}; function _7x(){ if(_7Z&&_7a)return; var AS=document.createElement("div"),B3=AS.style; B3.position="absolute";B3.left="0px";B3.top="0px";B3.width="100px";B3.height="100px";B3.overflow="scroll"; B3.innerHTML="<div style='width:200px;height:200px;overflow:hidden'>"+_7D+"</div>"; document.body.appendChild(AS); _7Z=AS.offsetWidth-AS.clientWidth; _7a=AS.offsetHeight-AS.clientHeight; if(_7P||_7K&&!_7I||_7G||_7F)_7Z++; if(_7K&&!_7I||_7G||_7F)_7a++; else if(_7I){_7a++;_7Z++;} if(!(_7Z>10))_7Z=22; if(!(_7a>10))_7a=22; document.body.removeChild(AS);}; var _7r=1; var _7AN; function _7w(){ if(!_7AN){ _7AN=document.createElement("div"); var B3=_7AN.style; B3.position="absolute"; B3.left="500px"; B3.top="0px"; B3.width="0px"; B3.height="0px"; B3.visibility="hidden"; document.body.insertBefore(_7AN,document.body.firstChild);} _7r=_7AN.offsetLeft/500; if(_7r>0.95&&_7r<1.05||!_7r)_7r=1; return _7r;}; function _7AO(CA){ var GY=true; for(var Au=CA.firstChild;Au;Au=Au.nextSibling){ if(Au.nodeType==1){_7AO(Au);GY=false;}} if(GY){try{CA.innerHTML=CA.innerHTML;}catch(H){}}}; var AreaObjects=[]; AreaObjects.PreciseBodyHeight=1; var OffsetParents=[]; var GZ={ AR:0}; function Ga(M,CA,height){ M=As(M); if(!M)return; if(M.offsetLeft!=null)M={Tag:M}; if(typeof(M.Tag)!="object")M.Tag=GetElem(M.Tag); if(CA)M.Tag=CA; if(!M.Tag)return; for(var i in GZ)if(M[i]==null)M[i]=GZ[i]; if(height)M.Height=height; M.Height=parseInt(M.Height); var AM=OffsetParents,S=AreaObjects;M.Gb=null; if(!M.Parent){ for(var Au=M.Tag.parentNode;Au&&Au.tagName.toLowerCase()!="body";Au=Au.parentNode){ var B3=GetStyle(Au);if(!B3)continue; if(B3.overflow!=""&&B3.overflow.toLowerCase()!="visible"&&parseInt(B3.height)||B3.display.toLowerCase()=='none'||B3.position.toLowerCase()=='absolute'){ M.Parent=Au; break;} if(B3.position.toLowerCase()=="absolute"){M.Parent=Au;M.Gb=1;break;}} if(!M.Parent)M.Parent=document.body; for(var j=0;j<AM.length;j++)if(AM[j]==M.Parent)break; if(j==AM.length)AM[AM.length]=M.Parent; if(!M.Gb){ var B3=GetStyle(M.Tag); if(B3&&B3.position.toLowerCase()=="absolute")M.Gb=2;}} if(M.Parent)M.Parent.Gc=null; M.Gd=M.Tag.offsetWidth; M.Ge=M.Tag.offsetHeight; M.Gf=M.Tag.style.width; var B3=GetStyle(M.Tag); M.Gg=_7AH(B3); M.Gh=_7AI(B3); for(var i=0;i<S.length;i++)if(S[i]&&S[i].Tag==M.Tag)return; for(M.id=0;S[M.id];M.id++); S[M.id]=M; M.K="AreaObjects["+M.id+"]"; if(S.Interval==null)S.Interval=setInterval(Gi,200);}; function Gj(CA){ var S=AreaObjects; for(var i=0;i<S.length;i++)if(S[i]&&S[i].Tag==CA)S[i]=null; for(var i=S.length-1;i>=0&&!S[i];i--)S.length--; if(S.length==0&&S.Interval){clearInterval(S.Interval);S.Interval=null;}}; function Gi(){ if(AreaObjects.Gk)return; AreaObjects.Gk=1; if(_7R)_7w(); var AM=OffsetParents,S=AreaObjects,GF=document.body; for(var j=0;j<AM.length;j++){ if(AM[j].offsetWidth==AM[j].Width)continue; AM[j].Width=AM[j].offsetWidth; for(var i=0;i<S.length;i++){ var G=S[i]; if(!G||G.Parent!=AM[i]||(!G.MinWidth&&!G.MaxWidth))continue; G.Tag.style.width=G.Gf; var A5=G.Tag.offsetWidth; if(!_7Q)A5-=G.Gg; if(A5<G.MinWidth||A5>G.MaxWidth){ A5=A5<G.MinWidth?G.MinWidth:G.MaxWidth; G.Gf=G.Tag.style.width; G.Tag.style.width=A5+"px";}}} for(var j=0;j<AM.length;j++){ var Cn,AS; if(AM[j]==GF){ var GG=document.documentElement; var Cn=GetWindowSize(1)[1]/_7r; if(_7Q||_7K&&!_7O){ if(!AreaObjects.PreciseBodyHeight||document.readyState!="complete")AS=GF.scrollHeight; else{ var Cq=AreaObjects.Gl,F8=AreaObjects.Gm; if(!Cq){ Cq=document.createElement("div"); var B3=Cq.style;B3.overflow="hidden";B3.height="0px";B3.width="0px";B3.styleFloat="left"; document.body.insertBefore(Cq,document.body.firstChild); AreaObjects.Gl=Cq; F8=document.createElement("div"); var B3=F8.style;B3.overflow="hidden";B3.height="0px";B3.width="0px";B3.styleFloat="left"; document.body.appendChild(F8); AreaObjects.Gm=F8;} if(Cq.previousSibling)document.body.insertBefore(Cq,document.body.firstChild); if(F8.nextSibling)document.body.appendChild(F8); Cq.style.display="";F8.style.display=""; AS=F8.offsetTop+Cq.offsetTop; Cq.style.display="none";F8.style.display="none";}} else if(_7R){ if(!AreaObjects.PreciseBodyHeight)AS=GG.scrollHeight; else{ var Gn=AreaObjects.Go; function Get(B3,Es,Gp){ if(!Gp)Gp=""; var CS=parseInt(B3[Es+"Top"+Gp])+parseInt(B3[Es+"Bottom"+Gp]); return CS?CS:0;}; if(Gn==null){ var Gq=GetStyle(GF),BR=GetStyle(GG); Gn=Get(Gq,"margin")+Get(Gq,"border","Width")+Get(BR,"border","Width")+Get(BR,"padding")+Get(BR,"margin"); AreaObjects.Go=Gn;} AS=GF.scrollHeight+Gn;}} else if(_7K)AS=GG.scrollHeight; else if(_7N){ var BI=GF.offsetHeight,Bn=GG.offsetHeight; AS=(_7W&&!_7X||_7V)&&Bn<=window.innerHeight?BI+_7a:Bn;} else AS=GG.offsetHeight+(_7G?_7a:0);} else{ Cn=AM[j].clientHeight;AS=AM[j].scrollHeight; if(Cn==AS&&!_7P){ for(var Au=AM[j].lastChild;Au;Au=Au.previousSibling){ if(Au.offsetHeight){ AS=Au.offsetTop+Au.offsetHeight-(Au.offsetParent!=AM[j]?AM[j].offsetTop:0); if(Cn<AS)AS=Cn; break;}}}}; AM[j].Gr=0; AM[j].Gs=0; AM[j].Gt=(Cn-AS)/_7r;} for(var i=0;i<S.length;i++){ if(!S[i]||!S[i].Parent)continue; S[i].Parent.Gr+=S[i].Tag.offsetHeight; S[i].Parent.Gs+=S[i].Height;} for(var i=0;i<S.length;i++){ var G=S[i];if(!G)continue; var CA=G.Tag,GP=G.Parent; if(!G.Height){ var CS=CA.offsetHeight; if(CS<G.MinHeight||CS>G.MaxHeight){ CS=CS<G.MinHeight?G.MinHeight:G.MaxHeight; if(CS<0)CS=0; CA.style.height=CS+"px";}} else if(G.Gb){ if(G.Gb==2){ var CS=Math.floor((GetWindowSize(0)[1]-CA.offsetTop)/(G.FixedPercent?100:G.Height)*G.Height-(_7Q?0:G.Gh)); if(G.ReservedHeight)CS-=G.ReservedHeight; if(CS<G.MinHeight||CS>G.MaxHeight){ CS=CS<G.MinHeight?G.MinHeight:G.MaxHeight;} if(CS<0)CS=0; CA.style.height=CS+"px";}} else if(GP.Gt!=GP.Gc&&(GP.Gt<0||GP.Gt>8)||GP.Gc==null){ G.Gu=0; var CS=Math.floor((GP.Gt+GP.Gr)/(G.FixedPercent?100:GP.Gs)*G.Height-(_7Q?0:G.Gh)); if(G.ReservedHeight)CS-=G.ReservedHeight; if(CS<G.MinHeight||CS>G.MaxHeight){ CS=CS<G.MinHeight?G.MinHeight:G.MaxHeight; if(!G.FixedPercent){ function Update(G,CS){ var CA=G.Tag,GP=G.Parent; CA.style.height=CS+"px";CA.offsetHeight; GP.Gt-=CA.offsetHeight; GP.Gs-=G.Height; G.Gu=1; for(var j=0;j<i;j++){ var T=S[j];if(!T||T.Parent!=GP||!T.Height||T.Gu)continue; var Ak=Math.floor((GP.Gt+GP.Gr)/(T.FixedPercent?100:GP.Gs)*T.Height-(_7Q?0:T.Gh)); if(T.ReservedHeight)Ak-=T.ReservedHeight; if(Ak<T.MinHeight||Ak>T.MaxHeight){ Ak=Ak<T.MinHeight?T.MinHeight:T.MaxHeight; if(!T.FixedPercent)Update(T,Ak);} else if(Ak<0)Ak=0; T.Tag.style.height=Ak+"px";}}; Update(G,CS);}} else{ if(CS<0)CS=0; CA.style.height=CS+"px";}}} for(var j=0;j<AM.length;j++)AM[j].Gc=AM[j].Gt; for(var i=0;i<S.length;i++){ var G=S[i],CA=G.Tag; if(G.Gd!=CA.offsetWidth||G.Ge!=CA.offsetHeight){ if(G.OnResize)G.OnResize(G.Gd,G.Ge); G.Gd=CA.offsetWidth; G.Ge=CA.offsetHeight;}} AreaObjects.Gk=0;}; var _7AP={"Text":1,"Int":1,"Float":1,"Date":1,"Bool":1,"Enum":1,"Radio":1,"Lines":1,"Pass":1}; function Get(row,Gv){ var Dh=row[Gv]; if(Dh!=null)return Dh; if(!row.Def)return null; return row.Def[Gv];}; function GetLower(row,Gv){ var Dh=row[Gv]; if(Dh==null&&row.Def)Dh=row.Def[Gv]; if(typeof(Dh)!="string")return Dh; return Dh.toLowerCase();}; function Is(row,Gv){ var Dh=row[Gv]; if(Dh!=null)return Dh-0; if(!row.Def)return null; return row.Def[Gv]-0;}; _7h.prototype.Gw=function(row,F6,Gx,Gy){ if(!row||!F6)return Gy; var a=row[F6+Gx];if(a!=null)return a; if(row.Def){a=row.Def[F6+Gx];if(a!=null)return a;} var C=this.Cols[F6]; if(C){a=C[Gx];return a==null?Gy:a;} return Gy;}; _7h.prototype.GetType=function(row,F6){ if(!row||!F6||row.Page)return ""; var Ak=row[F6+"Type"];if(Ak==null&&row.Def)Ak=row.Def[F6+"Type"]; if(Ak==null){ var BD=this.Cols[F6];if(BD)Ak=BD.Type; if(row.Kind=="Filter"&&!_7AP[Ak]&&Ak!="Panel"&&F6!="_ConstWidth")Ak="Text";} if(Grids.OnGetType)Ak=Grids.OnGetType(this,row,F6,Ak); return Ak;}; _7h.prototype.GetFormat=function(row,F6,Gz){ var H=Gz?"EditFormat":"Format"; var Cq=this.Gw(row,F6,H); if(Grids.OnGetFormat)Cq=Grids.OnGetFormat(this,row,F6,Cq,Gz); return Cq;}; _7h.prototype.GetCDef=function(row){ if(row.Page)return Get(this.Root,"CDef"); else return Get(row,"CDef");}; _7h.prototype.G0=function(row,F6,Gz){ var G1=Gz?"EditMask":"ResultMask"; var DI=Get(row,F6+G1);if(DI!=null)return DI; return this.Cols[F6][G1];}; _7h.prototype.G2=function(row,F6){ var AP=row[F6+"Range"];if(AP!=null)return AP-0; AP=row.Def[F6+"Range"];if(AP!=null)return AP-0; AP=this.Cols[F6]; return AP?AP["Range"]:0;}; _7h.prototype.CanFocus=function(row,F6,type){ if(row.Page){var BD=this.Cols[F6];return BD&&BD.CanFocus!=null?BD.CanFocus:1;} if(!F6){ var G3=row.CanFocus;if(G3!=null)return G3-0; G3=row.Def.CanFocus;return G3?1:0;} if(row.G4&&row[F6+"RowSpan"]==0)return 0; var G3=row[F6+"CanFocus"];if(G3!=null)return G3-0; G3=row.Def[F6+"CanFocus"];if(G3!=null)return G3-0; G3=row.CanFocus;if(G3==null)G3=row.Def.CanFocus;if(G3==0)return 0; var C=this.Cols[F6];if(!C)return 1; var G5=_7AQ[C.Sec]; if(row[G5]||row.Def[G5])return 0; if(C.CanFocus!=null)return C.CanFocus; if(!type)type=this.GetType(row,F6); if(type=="Panel"||type=="Button")return 0; return 1;}; _7h.prototype.CanEdit=function(row,F6,type,G6){ if(!F6||row.Page||!this.Editing&&(!row.Fixed||row.Kind!="Filter"&&row.Kind!="Group"&&row.Kind!="Search"))return 0; if(G6==null)G6=this.CanFocus(row,F6,type); if(!G6){ if(!type)type=this.GetType(row,F6); if(type!="Bool"&&type!="Radio"&&type!="Enum")return 0;} var BN=row[F6+"CanEdit"];if(BN==null)BN=row.Def[F6+"CanEdit"]; if(BN!=null)BN=BN-0; else{ var C=this.Cols[F6]; if(row.Kind=="Filter"){ if(!type)type=this.GetType(row,F6); BN=type!="Pass"&&C&&C.CanFilter>0;} else{ BN=row.CanEdit;if(BN==null)BN=row.Def.CanEdit; if(BN==0||BN==2)BN-=0; else{ if(!type)type=this.GetType(row,F6); if(row.Calculated){ BN=row[F6+"Formula"]; if(BN)BN=0; else if(row.Def[F6+"Formula"])BN=0; else if(C&&C.CanEdit!=null)BN=C.CanEdit; else BN=_7AP[type];} else if(C&&C.CanEdit!=null)BN=C.CanEdit; else BN=C&&C.Formula?0:_7AP[type];}}}; if(BN==1&&this.Editing==2&&(!row.Fixed||row.Kind!="Filter"&&row.Kind!="Group"&&row.Kind!="Search"))BN=2; if(Grids.OnCanEdit)return Grids.OnCanEdit(this,row,F6,BN); return BN;}; _7h.prototype.G7=function(row,F6){ var G8,AP=this.Gw(row,F6,"Related");if(!AP)return null; AP=AP.split(','); var Es=[]; for(var i=0;i<AP.length;i++){ var x=Get(row,AP[i]); if(!x&&x!==0)x=this.IndexEnum==1?0:"_"; if(this.Gw(row,AP[i],"Range")){ var a=(x+"").split(this.Lang.Format.ValueSeparator); if(a.length>1){ var Db=Es.length; if(!Db)for(var k=0;k<a.length;k++)Es[k]=a; else for(var k=0;k<a.length;k++)for(j=0;j<Db;j++)Es[k*Db+j]=Es[j]+"_"+a[k]; continue;}} if(!Es.length)Es[0]=x; else for(var j=0;j<Es.length;j++)Es[j]+="_"+x;} return Es;}; _7h.prototype.GetEnum=function(row,F6,name,G9,HA){ var G8=""; if(G9){ for(var i=0;i<G9.length;i++){ var Dh=this.Gw(row,F6,name+G9[i]); if(Dh)G8+=Dh;}} if(!G8)G8=this.Gw(row,F6,name); if(HA?Grids.OnGetEnumKeys:Grids.OnGetEnum){ G8=(HA?Grids.OnGetEnumKeys:Grids.OnGetEnum)(this,row,F6,G8); if(G8&&G8.join)G8="|"+G8.join("|");} return G8;}; _7h.prototype.HB=function(row,F6,Aj){ var G9=this.G7(row,F6); var G8=this.GetEnum(row,F6,"Enum",G9); if(!G8)return Aj?_7D:""; var HC=this.GetEnum(row,F6,"EnumKeys",G9,1); var E=this.n[G8+HC]; if(!E){ var HD=this.IndexEnum; E=G8.slice(1).split(G8.charAt(0)); var Fj=G8.slice(1).split(G8.charAt(0)); if(HC){ var HE=HC.slice(1).split(HC.charAt(0)); for(var i=0;i<HE.length;i++)E[HE[i]]=Fj[i];} for(var i=0;i<Fj.length;i++)if(!HD||E[Fj[i]]==null)E[Fj[i]]=Fj[i]; this.n[G8+HC]=E;} var Es=Get(row,F6),Bb; if(!Es&&Es!==0)Es=this.IndexEnum==1?0:""; if(Es&&Es.split&&this.Gw(row,F6,"Range")){ var HF=this.Lang.Format.ValueSeparator; var Dh=Es.split(HF); for(var i=0;i<Dh.length;i++)Dh[i]=E[Dh[i]]; Bb=Dh.join(HF);} else Bb=E[Es]; if(Bb==null){ if(Es-0+""==Es){ var Cq=this.Gw(row,F6,"IntFormat"); if(Cq){ Bb=this.Lang.Format.NumberToString(Es,Cq); if(!Bb||Bb==" ")return Aj?_7D:""; return!Aj||this.NoFormatEscape?Bb:D0.Escape(Bb);}} Bb=Es;} return Bb?Bb:Aj?_7D:"";}; _7h.prototype.HG=function(row,F6){ var Ak=this.GetType(row,F6); if(Ak=="Lines"||Ak=="Html"||Ak=="List")return 1; if(Ak=="Radio"){ var Cq=this.GetFormat(row,F6); return Cq&&((Cq.split(Cq.charAt(0))[1]-0)&3)>0;} if(Ak!="Img"&&Ak!="Link")return 0; var Cq=this.GetFormat(row,F6,1); return Cq&&Cq.charAt(1)!='0';}; _7h.prototype.HH=function(row,F6){ var HI=Get(row,F6+"AcceptEnters"); if(HI!=null)return HI; return this.AcceptEnters;}; _7h.prototype.HJ=function(row,F6){ var Bg=this.GetType(row,F6); if(Bg!="Img"&&Bg!="Link")return null; var Dh=this.GetValue(row,F6); if(!Dh)return null; Dh=Dh.split(Dh.charAt(0)); if(Bg=="Img"){Dh[1]=Dh[6];Dh[3]=Dh[7];} if(!Dh[1])return null; var Cq=this.GetFormat(row,F6); if(Cq){ Cq=Cq.split(Cq.charAt(0)); if(Bg=="Img"){Cq[1]=Cq[5];Cq[2]=Cq[6];} Dh[1]=(Cq[1]?Cq[1]:"")+Dh[1]+(Cq[2]?Cq[2]:"");} return[Dh[1],Dh[3]];}; _7h.prototype.HK=function(row){ if(row.Name)return row.Name; if(this.NameCol){ var Fa=(this.NameCol+"").split(","),B3="",C=this.Cols; for(var i=0;i<Fa.length;i++)B3+=(B3?", ":"")+this.GetString(row,Fa[i],1); return B3;} if(row.id)return row.id; if(this.MainCol)return this.GetString(row,this.MainCol,1); for(var F6 in C)if(C[F6].Type=="Text")return this.GetString(row,F6,1); return "???";}; _7h.prototype.GetText=function(HL){ var Ak=this.Lang["Text"]; return Ak?Ak[HL]:HL;}; _7h.prototype.GetAlert=function(HL){ var Ak=this.Lang["Alert"]; return Ak?Ak[HL]:HL;}; _7h.prototype.GetPos=function(row){ for(var AP=row.parentNode.firstChild,AO=0;AP&&AP!=row;AP=AP.nextSibling)if(AP.Visible)AO++; return AO;}; _7h.prototype.GetRowPage=function(row){ for(var Au=row;Au&&!Au.Page;Au=Au.parentNode); return Au;}; _7h.prototype.GetPagePos=function(row){ var Au=this.GetRowPage(row); for(var AP=this.GetFirstVisible(Au,1),AO=0;AP&&AP!=row;AP=this.GetNextVisible(AP,3),AO++); return AO;}; _7h.prototype.PagePosToRow=function(row,AO){ if(row.State<2)return null; if(!AO)AO=0; for(var AP=this.GetFirstVisible(row,1);AP&&AO;AP=this.GetNextVisible(AP,3),AO--); return AP?AP:this.GetLastVisible(row,1);}; _7h.prototype.HasChildren=function(row){ if(row.Count)return 1; var Es=row.firstChild; while(Es){ if(Es.Visible)return 1; Es=Es.nextSibling;} return 0;}; _7h.prototype.HM=function(row){ for(var Es=row.firstChild;Es&&Es.Deleted;Es=Es.nextSibling); return Es?1:0;}; _7h.prototype.HN=function(row){ if(this.ChildPaging<=1)return row.firstChild!=null; if(row.Count)return 1; return row.firstChild!=null;}; _7h.prototype.HO=function(row){ if(row.State<2)return row.Count; var Es=row.firstChild,FX=row.Level; if(!Es)return 0; var Em=Es.Visible?0:-1; do{Es=this.GetNextVisible(Es,1);Em++;}while(Es&&Es.Level>FX); return Em;}; _7h.prototype.HP=function(row,count){ if(row.State<2)return row.Count>=count; var Es=row.firstChild,FX=row.Level; if(!Es)return 0; if(Es.Visible)count--; do{ if(!(count--))return 1; Es=this.GetNextVisible(Es,1);}while(Es&&Es.Level>FX); return 0;}; _7h.prototype.GetRowById=function(id){ for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.id==id)return AP; var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++)if(CE[i].id==id)return CE[i]; for(var AP=this.GetFirst();AP;AP=this.GetNext(AP))if(AP.id==id)return AP; return null;}; _7h.prototype.ChangeDef=function(AP,AS,HQ){ if(typeof(AS)=="string")AS=this.Def[AS]; if(!AS)return false; AP.Def=AS; if(AS.Expanded!=null)AP.Expanded=AS.Expanded-0; if(AS.Kind!=null)AP.Kind=AS.Kind; if(AS.Visible!=null)AP.Visible=AS.Visible-0; if(AS.Calculated!=null)AP.Calculated=AS.Calculated-0; var HR=AP.Spanned; if(AS.Spanned!=null)AP.Spanned=AS.Spanned-0; if(HR||AP.Spanned)this.HS(AP); if(AP.Calculated){ if(!Get(AP,"CalcOrder")){ var HT=""; for(var i=0;i<Au;i++)if(Get(AP,HU[i]+"Formula"))HT+=(HT?",":"")+HU[i]; AP.CalcOrder=HT;} if(this.Calculating==null)this.Calculating=1;} this.Recalculate(AP); if(HQ!=0)this.RefreshRow(AP)}; _7h.prototype.HV=function(Br){ if(this.EditMode)return; Bj(Br); try{ if(!this.Dialog&&_7N&&this.HW&&this.HW.focus)this.HW.focus();} catch(H){}}; _7h.prototype.HX=function(AN){ AN.Level=-1; AN.LevelImg=1; AN.Page=1; AN.State=this.Paging>=2||!this.AllPages?2:4; if(this.Paging==1&&!this.AllPages&&this.V==this.XB.childNodes.length-2)AN.State=4;}; _7h.prototype.HY=function(HQ){ var AN=_7i.createElement("B"); this.XB.appendChild(AN); this.HX(AN); if(HQ){ var Au=AN.previousSibling,HZ=AN.State<4?this.Ha(AN,true):0,CS; for(var i=0;i<3;i++){ if(Au){CS=Au["r"+i];if(CS)CS=CS.parentNode;} else CS=this.A9(i); if(CS){ var BM=document.createElement("div"); CS.appendChild(BM); if(HZ)BM.style.height=HZ+"px"; BM.className=this.Img.Style+"Page";}}} return AN;}; _7h.prototype.Hb=function(AN){ if(this.AllPages)for(var i=0;i<3;i++){ var CS=AN["r"+i]; if(CS){ AN["r"+i]=null;CS.row=null; CS.parentNode.removeChild(CS);}} this.XB.removeChild(AN); AN.Removed=1; if(!this.AllPages){ while(this.V>=this.XB.childNodes.length)this.V--; if(this.Paging==3)this.UpdateBody();}}; _7h.prototype.Hc=function(Hd,FY,He){ if(!Hd)return{}; if(typeof(Hd)=="object")return Hd; var AJ=this.Flags[Hd];if(AJ)return AJ; AJ={}; var AL=(Hd+"").replace(/\s/g,""); if(!He)AL=AL.toLowerCase(); AL=AL.split(","); for(var i=0;i<AL.length;i++)AJ[AL[i]]=1; AJ.length=AL.length; this.Flags[Hd]=AJ; if(FY){ var X=this.Hc(FY); for(var i=0;i<AL.length;i++)if(!X[AL[i]])this.Debug(2,"Unknown flag ",AL[i]," in flags '"+Hd+"', possible flags are '"+FY+"'");} return AJ;}; _7h.prototype.Hf=function(Hg,FY){ if(!Hg)return{}; var AJ=this.Flags[Hg+FY];if(AJ)return AJ; AJ={}; var AL=this.p[FY];if(!AL){AL=(FY+"").toLowerCase().split(",");this.p[FY]=AL;} for(var i=0,k=1,Em=0;i<AL.length;i++,k<<=1)if(Hg&k){AJ[AL[i]]=1;Em++;} AJ.length=Em; this.Flags[Hg+FY]=AJ; return AJ;}; _7h.prototype.Hh=function(Hd,FY){ if(!Hd)return 0; var AJ=this.q[Hd+FY];if(AJ)return AJ; var CE=this.Hc(Hd); var AL=this.p[FY];if(!AL){AL=(FY+"").toLowerCase().split(",");this.p[FY]=AL;} var AJ=0; for(var i=0,k=1;i<AL.length;i++,k<<=1)if(AJ[AL[i]])AJ+=k; this.q[Hd+FY]=AJ; return AJ;}; _7h.prototype.Hi=function(X){ var Hj,AI=this.Img;X-=AI.Hk; if(X<this.Hl){Hj=0;X-=AI.Hm;} else{ X-=this.Hl; if(X<this.Hn){Hj=1;var Ho=this.GetScrollLeft();X-=AI.Hp-Ho;} else{ X-=this.Hn; if(X<this.Hq){Hj=2;X-=AI.Hr;} else return null}}; var S=this.ColNames[Hj],left=0; for(var i=0;i<S.length;i++){ var BD=this.Cols[S[i]]; if(BD.Visible){X-=BD.Width;left+=BD.Width;} if(X<0)return S[i];} return null}; _7h.prototype.Hs=function(row){ var CS=0; for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(!AP.Visible)continue; if(AP.firstChild&&AP.Expanded)CS+=this.Hs(AP); var Ht=AP.Height;if(!Ht){Ht=AP.Def.Height;if(!Ht)Ht=this.Hu;} CS+=Ht;} return CS;}; _7h.prototype.Ha=function(row,count){ if(row.Hv&&row.Height!=null)return row.Height; if(!count&&row.r1)return row.r1.offsetHeight; if(row.State<2)return row.Count*this.Hu; var Hw=row,Em=0; if(!row.firstChild)return 0; return this.Hs(row);}; _7h.prototype.GetRowHeight=function(row){ if(row.r1)return row.r1.offsetHeight; var CS=row.Height; if(CS!=null)return CS; if(row.Page)return this.Ha(row); CS=row.Def.Height; if(CS!=null)return CS; return this.Hu;}; _7h.prototype.Hx=function(row){ var AP=row.r1,C3=0; if(!AP){ if(row.Page)return 0; for(row=this.GetPrevVisible(row);row;row=this.GetPrevVisible(row)){ var Ht=row.Height;if(!Ht)Ht=row.Def.Height;if(!Ht)Ht=this.Hu; C3+=Ht; if(row.r1)break;} if(!row)return 0; AP=row.r1;} if(AP.getBoundingClientRect)return(AP.getBoundingClientRect().top-this.N[1].getBoundingClientRect().top)/_7r+this.GetScrollTop()+C3; var top=AP.offsetTop,AI=this.Img; top-=AI.Hy; if(_7N&&!_7Y)top-=AI.Hz-AI.H0; else if(_7P)top+=AI.H0; if(row.Page)top+=row.r1.offsetTop; else{ for(var Au=row.parentNode;Au&&!Au.Page;Au=Au.parentNode)top+=Au.r1.nextSibling.offsetTop; if(Au&&Au.Page){ top+=Au.r1.offsetTop; top+=Au.previousSibling?AI.H1:(Au.nextSibling?AI.H2:AI.H3);} if(this.ChildPages){ var H4=row; while(1){ var DC=H4.parentNode; if(!DC||DC.Page)break; top+=H4.r1.parentNode.parentNode.offsetTop; H4=DC;}}}; return top+C3;}; _7h.prototype.H5=function(row,F6){ var AI=this.Img; var H6=this.GetCell(row,F6); var left=0,top=0,width=H6.offsetWidth,height=H6.offsetHeight; var Ey,B3=GetStyle(H6); Ey=parseInt(B3.borderTopWidth);if(Ey)top+=Ey; Ey=parseInt(B3.borderBottomWidth);if(Ey)height-=Ey; Ey=parseInt(B3.borderLeftWidth);if(Ey)left+=Ey; Ey=parseInt(B3.borderRightWidth);if(Ey)width-=Ey; Ey=parseInt(B3.paddingTop);if(Ey)top+=Ey; Ey=parseInt(B3.paddingBottom);if(Ey)height-=Ey; Ey=parseInt(B3.paddingLeft);if(Ey)left+=Ey; Ey=parseInt(B3.paddingRight);if(Ey)width-=Ey; width-=left; height-=top; if(row.Spanned&&Get(row,F6+"Merge")){ var H7=(Get(row,F6+"Merge")+"").split(","); if(H7.length>1){ var H8=Get(row,F6+"MergeEdit"),H9=0; if(H8)for(H9=0;H9<H7.length&&H7[H9]!=H8;H9++); if(H9==H7.length)H9=0; var IA=H6.firstChild; var IB=H6.offsetLeft; IB+=IA.offsetLeft; if(IA.rows.length>1){ top=IA.offsetTop; IA=IA.rows[H9].cells[0]; if(IA){top+=IA.offsetTop;height=IA.offsetHeight;}} else{ left=IA.offsetLeft; IA=IA.rows[0].cells[H9]; if(IA){left+=IA.offsetLeft;width=IA.offsetWidth;}}}} if(F6==this.MainCol&&!row.Fixed){ var FX=row.Level;if(this.HideRootTree)FX--; if(FX>=0)left+=AI.Tree; if(FX>0)left+=FX*AI.Line;} return[left,top,width,height];}; _7h.prototype.IC=function(row,F6){ if(!row)return null; var ID=0; if(!F6){F6=this.GetFirstCol();ID=1;} var H6=this.GetCell(row,F6); var E={},AI=this.Img,C=this.Cols; E.X=this.IE-_7AR;E.Y=this.IF-_7AS; if(row.Space){ if(row.Tag){ var IG=_7s(row.r1); E.X-=this.IE-IG[0],E.Y-=this.IF-IG[1]; E.Y-=row.r1.firstChild.offsetTop; if(_7P)E.Y-=row.r1.clientTop;} else{ E.Y+=row.r1.parentNode.parentNode.offsetTop+row.r1.firstChild.offsetTop; if(_7P)E.Y+=row.r1.offsetTop+row.r1.clientTop;}; E.Height=row.r1.firstChild.offsetHeight; if(H6){ E.X+=H6.offsetLeft+AI.Hk+row.r1.firstChild.offsetLeft; if(_7P)E.X+=row.r1.offsetLeft+row.r1.clientLeft; E.Width=H6.offsetWidth;} else E.Width=0;} else{ if(!row.r1)E.Height=this.GetRowHeight(row); else E.Height=H6?H6.offsetHeight:row.r1.offsetHeight; if(!row.Fixed){ var Ho=this.GetScrollTop(); E.Y+=this.IH-Ho; var top=this.Hx(row); if(top<Ho)E.AA=Ho-top; if(top+E.Height>this.N[1].offsetHeight+Ho)E.AB=top+E.Height-this.N[1].offsetHeight-Ho; E.Y+=top+AI.Hy;} else{ if(row.Fixed=="Foot")E.Y+=this.II+AI.IJ+AI.IK; else E.Y+=this.IL+AI.IM+AI.IN; E.Y+=row.r1.offsetTop;}; if(H6){ E.X+=AI.Hk; E.Width=C[F6].Width; var Hj=C[F6].Sec,S=this.ColNames[Hj],left=0; for(var i=0;i<S.length&&S[i]!=F6;i++)if(C[S[i]].Visible)left+=C[S[i]].Width; if(row.Spanned){ var HR=row[F6+"Span"];if(HR==null)HR=row.Def[F6+"Span"]; if(HR>1){ E.Width=0; for(;i<S.length&&HR;i++,HR--)if(C[S[i]].Visible)E.Width+=C[S[i]].Width;}} E.X+=left; if(Hj==0)E.X+=AI.Hm; else if(Hj==1){ E.X+=this.Hl+AI.Hp; var Ho=this.GetScrollLeft(); if(left<Ho)E.w=Ho-left; if(left+E.Width>this.Hn-AI.IP+Ho)E.z=left+E.Width-this.Hn+AI.IP-Ho; E.X-=Ho;} else if(Hj==2)E.X+=this.Hl+this.Hn+AI.Hr;} else E.Width=0;}; E.IQ=E.X;E.X=0; E.IR=E.Y;E.Y=0; E.Row=row;E.Col=F6; if(ID){E.Col=null;E.Width=0;} return E;}; if(!window.TCalc||!TCalc.OnDemand)var TCalc=function(){}; var _7AT="EmptyValue,SortValue,SortDescValue,FilterValue,CopyValue,ExportValue,PageNameValue,Range,"+"CanEdit,CanFocus,CanSort,CanFilter,AcceptEnters,"+"Type,Format,EditFormat,ExportFormat,EditMask,MaskColor,ResultMask,ResultText,"+"Enum,EditEnum,EnumKeys,EnumType,IntFormat,Related,Refresh,"+"Button,ButtonText,Defaults,Menu,MenuIcons,MenuCaption,Class,ClassEdit,HtmlPrefix,HtmlPostfix,Color,NoColor,Visible,"+"ShowHint,Tip,TipClass,ToolTip,Error,CopyTo,"+"Width,Icon,IconChecked,Caption,ToolTipChecked,Height,ReloadData,Tab"; var _7AU=new RegExp("^(\\w+)("+_7AT.replace(/,/g,"|")+")$"); function _7AV(name){ var M=(name+"").match(_7AU); if(M)return M[1]; return null;}; _7h.prototype.IS=function(Cq,cells,IT){ var IU=Cq; if(typeof(Cq)=="number")Cq=Cq+""; if(typeof(Cq)!="string")return Cq; Cq=' '+Cq+' '; function Update(F6){ var R=new RegExp("^(\\\"([^\\\"]|\\\\\\\")*[^\\\\\\\"]\\\"|\\'([^\\']|\\\\\\')*[^\\\\\\']\\'|[^\\'\\\"]|(\\'\\')|(\\\"\\\"))*[^\\w\\d\\\"\\'\\$\\_\\.]"+F6+"[^\\w\\d\\\"\\'\\$\\_\\.]"); var M=Cq.match(R); while(M){ Cq=Cq.slice(0,M[0].length-1-F6.length)+"Get(Calc.Row,\""+F6+"\")"+Cq.slice(M[0].length-1); M=Cq.match(R);}}; if(cells)for(var i=0;i<cells.length;i++)Update(cells[i]); else for(var F6 in this.Cols)Update(F6); var EW=IU.replace(/\'/g,"\""); if(IT||Cq.search("return")>=0)Cq="with(Calc){"+Cq+"}"; else if(this.DebugFlags["problem"]){ Cq="with(Calc){ var _dbg="+Cq+";if(_dbg==null||typeof(_dbg)=='number'&&isNaN(_dbg))Calc.Grid.Debug(2,'Formula \"','"+EW+"','\" in cell [',Calc.Row.id,',',Calc.Col,'] returned ',(_dbg==null?'null':'NaN'));return _dbg;}";} else Cq="with(Calc) return "+Cq+";"; try{return new Function("Calc","try    {"+Cq+"}catch(e)      {"+(this.DebugFlags["problem"]?"Calc.Grid.Debug(1,'Formula \"','"+EW.replace(/[\r\n]/g," ")+"','\" in cell [',Calc.Row.id,',',Calc.Col,'] raised exception ',(e.message?e.message:e));":"")+"return NaN;}");} catch(H){ this.Debug(1,"Wrong syntax in formula '",IU,"', formula was converted to '",Cq,"', exception message: ",H.message?H.message:H); return new Function(IT?"":"return NaN;");}}; _7h.prototype.IV=function(IW,cells,IT){ var Cq=this.m[IW+(cells?1:0)]; if(Cq)return Cq; Cq=this.IS(IW,cells,IT); this.m[IW+(cells?1:0)]=Cq; return Cq;}; _7h.prototype.IX=function(){ var AJ=new TCalc,R=this.GetFixedRows(); for(var i=0;i<R.length;i++)if(R[i].id)AJ[R[i].id]=R[i]; AJ.Grid=this; return AJ;}; _7h.prototype.IY=function(row,IZ){ var Ia=row[IZ];if(Ia==null)Ia=row.Def[IZ]; var Ib=row.Calculated?1:0; if(!Ia){ if(!Ib){ row[IZ]="**"; var AJ=this.o["**0"]; if(AJ)return AJ; var AJ=[],AN=[],Au=0,Ey=0; for(var BD in this.Cols)if(this.Cols[BD].Formula)AJ[Au++]=BD; AJ.sort(); for(var i=0;i<Au;i++){AN[AN.length]=AJ[i];AN[AN.length]=AJ[i];} this.o["**0"]=AN; return AN;} var AJ=["*"],Au=1; for(var BD in this.Cols)if(Get(row,BD+"Formula"))AJ[Au++]=BD; AJ.sort(); Ia=AJ.join(","); row[IZ]=Ia;} var AJ=this.o[Ia+Ib]; if(AJ)return AJ; AJ=Ia; if(Ib&&!row.Fixed&&AJ.indexOf('*')<0)AJ="*,"+AJ; AJ=AJ.split(","); var AN=[],Au=0,Cols=row.Space?row.Ic:this.Cols; for(var i=0;i<AJ.length;i++){ var F6=AJ[i]; if(F6.charCodeAt(0)==42){AN[Au++]='*';AN[Au++]=F6.slice(1);} else if(Cols[F6]){AN[Au++]=F6;AN[Au++]=F6;} else{ AN[Au++]=F6; var F6=_7AV(AJ[i]); AN[Au++]=Cols[F6]?F6:null;}} this.o[Ia+Ib]=AN; return AN;}; _7h.prototype.Ie=function(row,BC){ if(row.State==0||row.State==1)BC[BC.length]=row; else for(var AP=row.firstChild;AP;AP=AP.nextSibling)if(!AP.Deleted&&!AP.Filtered){ if(Get(AP,"AggChildren"))this.Ie(AP,BC); else BC[BC.length]=AP;}}; _7h.prototype.If=function(row,AM,IZ,HQ,Ig,Ih,F6){ var Ib=row.Calculated; if(Ib){ if(this.ChildPaging==3&&!row.firstChild&&row.State==null&&row.Count)row.State=0;} else if(Ig)return; AM.Row=row; AM.Parent=row.parentNode; if(!row.Fixed)AM.Children=null; var Ia=F6?[F6,F6]:this.IY(row,IZ),AS=row.Def,C=this.Cols; var Ii=Grids.OnCalculateCell!=null,Ij=row.Kind&&row.Kind!="Data"; for(var j=0;j<Ia.length;j+=2){ var Es=Ia[j],BD=Ia[j+1],Cq=null; if(Es=="*"){ if(Ih)continue; var IZ="CalcOrder"+BD; var BC=AM.Children; for(var AP=row.firstChild;AP;AP=AP.nextSibling)this.If(AP,AM,IZ,HQ,Ig,0,F6); AM.Children=BC; AM.Row=row; AM.Parent=row.parentNode;} else{ AM.Col=Es; if(Ib){Cq=row[Es+"Formula"];if(Cq==null)Cq=AS[Es+"Formula"];} if(Cq==null&&C[BD]&&!Ij)Cq=C[BD].Formula; if(Cq){ Cq=this.IV(Cq,row.Cells); var Dh=Cq(AM); if(Ii){ var Ik=Grids.OnCalculateCell(this,row,Es,Dh,HQ); if(Ik!=null)Dh=Ik;} if(HQ){ if(Dh!=row[Es]){row[Es]=Dh;this.RefreshCell(row,BD);}} else row[Es]=Dh;}}} if(HQ&&row.RelWidth)this.Il(row);}; _7h.prototype.Im=function(HQ){ var AM=this.IX();AM.In=HQ; for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Calculated)this.If(AP,AM,"CalcOrder",HQ);}; _7h.prototype.Calculate=function(HQ,Ig,Io,Ip,Iq){ if(!this.Calculating||!this.Calculated||Ip){this.Im(HQ);return;} var AM=this.IX();AM.In=HQ; if(Grids.OnCalculate&&Grids.OnCalculate(this,HQ))return; var Ir=Ig; if(!Ig){ Ig=true; for(var BD in this.Cols)if(this.Cols[BD].Formula){Ig=false;break;}} var C=this.CalcOrder,CE=this.GetFixedRows(); if(!C){ for(var i=0;i<CE.length;i++)if(CE[i].CalcOrder){ if(C){C=null;break;} else C=CE[i].CalcOrder;}} if(C){ var R={}; for(var i=0;i<CE.It;i++)if(CE[i].id)R[CE[i].id]=CE[i]; for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Calculated&&AP.id)R[AP.id]=AP; if(typeof(C)=="string"){if(C.indexOf('*')<0)C="*,"+C;C=C.split(',');this.CalcOrder=C;} for(var j=0;j<C.length;j++){ var Es=C[j]; if(Es.charAt(0)=='*'){ if(Io)continue; var B3="CalcOrder"+Es.slice(1),BC=AM.Children; for(var AN=this.XB.firstChild;AN;AN=AN.nextSibling)for(var AP=AN.firstChild;AP;AP=AP.nextSibling)this.If(AP,AM,B3,HQ,Ig); AM.Children=BC;} else{ var Iu=Es.lastIndexOf('$'); if(Iu>=0){ var id=Es.slice(0,Iu),F6=Es.slice(Iu+1),AP=R[id]; if(AP)this.If(AP,AM,"CalcOrder",HQ,Ig,0,F6);} else{ for(var i=0;i<CE.length;i++)this.If(CE[i],AM,"CalcOrder",HQ,Ig,0,Es);}}}} else{ if(!Io)for(var AN=this.XB.firstChild;AN;AN=AN.nextSibling)for(var AP=AN.firstChild;AP;AP=AP.nextSibling)this.If(AP,AM,"CalcOrder",HQ,Ig); AM.Children=null; for(var i=0;i<CE.length;i++)this.If(CE[i],AM,"CalcOrder",HQ,Ig);}; this.Im(HQ); AM.Children=null; if(AM.Iv)this.Calculate(HQ,Ig,Io,Ip); else{ if(this.Gantt&&!Io&&!Ip&&!Iq)this.Iw(HQ,null,Ir);}}; _7h.prototype.Recalculate=function(row,F6,HQ){ if(!this.Calculating||!this.Calculated){this.Im(HQ);return;} if(Grids.OnCalculate&&Grids.OnCalculate(this,HQ,row,F6))return; var Calc=this.IX();Calc.In=HQ; if(row&&!row.Page){ var Ix=null; if(F6)Ix=Get(row,F6+"Recalc"); if(Ix==null)Ix=Get(row,"Recalc"); do{ if(Calc.Iv)Ix=Calc.Iv; Calc.Iv=0; if(Ix&256)this.Calculate(HQ); else{ if(Ix&16){this.If(row,Calc,"CalcOrder",HQ,0,1);if(this.Gantt)this.Iy(row,null,HQ);} else if(Ix&8)for(var AP=row.firstChild;AP;AP=AP.nextSibling){this.If(AP,Calc,"CalcOrder",HQ,0,1);if(this.Gantt)this.Iy(AP,null,HQ);} if(Ix&1&&!(Ix&16)){this.If(row,Calc,"CalcOrder",HQ,0,1);if(this.Gantt)this.Iy(row,null,HQ);} if(Ix&6&&!row.Fixed)for(var AP=row.parentNode;!AP.Page;AP=AP.parentNode)if(Ix&4||AP.Calculated){this.If(AP,Calc,"CalcOrder",HQ,0,1);if(this.Gantt)this.Iy(AP,null,HQ);} this.Calculate(HQ,0,1);}}while(Calc.Iv);}}; _7h.prototype.ActionCalcOff=function(){ if(!this.Calculating||!this.Calculated)return false; this.Calculated=false; this.SaveCfg(); this.Im(1); return true;}; _7h.prototype.ActionCalcOn=function(){ if(!this.Calculating||this.Calculated)return false; if(this.Paging==3&&!this.Iz())return false; this.ShowMessage(this.GetText("Calculate")); this.Calculated=true; var T=this; if(this.Paging==3){ setTimeout(function(){ T.I0=true; T.ReloadBody(function(){T.I0=false;},0,"ReCalc");},10);} else setTimeout(function(){T.Calculate(true);T.HideMessage();},10); this.SaveCfg(); this.Im(1); return true;}; _7h.prototype.DoAction=function(row,F6){ var I1=Get(row,F6+"Action"); if(!I1)return false; if(typeof(I1)!="function")I1=this.IV(I1,row.Cells,1); var AM=new TCalc();AM.Row=row;AM.Col=F6;AM.Grid=this; if(row)AM["Value"]=row[F6]; I1(AM); return true;}; TCalc.prototype.GetChildren=function(){ var AJ=this.Children; if(AJ)return AJ; AJ=new Array(); if(this.Row.Fixed){ for(var AN=this.Grid.XB.firstChild;AN;AN=AN.nextSibling)this.Grid.Ie(AN,AJ);} else this.Grid.Ie(this.Row,AJ); return AJ;}; TCalc.prototype.sum=function(F6){ if(!F6)F6=this.Col; var sum=0,AJ=this.GetChildren(),Db=AJ.length,i,BJ=F6+"sum"; if(this.Row.State<2)return this.Row[BJ]-0; if(this.Row.Fixed){ for(i=0;i<Db;i++){ if(AJ[i].Page)sum+=AJ[i][BJ]-0; else sum+=Get(AJ[i],F6)-0;}} else for(i=0;i<Db;i++)sum+=Get(AJ[i],F6)-0; return sum;}; TCalc.prototype.sumrange=function(F6){ if(!F6)F6=this.Col; var sum="",AJ=this.GetChildren(),Db=AJ.length,i,BJ=F6+"sum"; if(this.Row.State<2)return this.Row[BJ]-0; if(this.Row.Fixed){ for(i=0;i<Db;i++){ if(AJ[i].Page)sum+=AJ[i][BJ]+";"; else sum+=Get(AJ[i],F6)+";";}} else for(i=0;i<Db;i++)sum+=Get(AJ[i],F6)+";"; return this.Grid.I2(sum);}; TCalc.prototype.count=function(F6){ if(this.Row.Fixed&&this.Grid.Paging){ var Em=0,AJ=this.GetChildren(),Db=AJ.length; for(var i=0;i<Db;i++){ if(AJ[i].Page)Em+=AJ[i].Count; else Em++;} return Em;} if(this.Row.State<2)return this.Row.Count-0; return this.GetChildren().length;}; TCalc.prototype.sumsq=function(F6){ if(!F6)F6=this.Col; var sum=0,AJ=this.GetChildren(),Db=AJ.length,i,BJ=F6+"sumsq"; if(this.Row.State<2)return this.Row[BJ]-0; for(i=0;i<Db;i++){ if(this.Row.Fixed&&AJ[i].Page)sum+=AJ[i][BJ]-0; else{Bb=Get(AJ[i],F6)-0;sum+=Bb*Bb;}} return sum;}; TCalc.prototype.counta=function(F6){ if(!F6)F6=this.Col; var Em=0,AJ=this.GetChildren(),Db=AJ.length,i,BJ=F6+"counta"; if(this.Row.State<2)return this.Row[BJ]-0; for(i=0;i<Db;i++){ if(this.Row.Fixed&&AJ[i].Page)Em+=AJ[i][BJ]-0; else if(Get(AJ[i],F6)!=null)Em++;} return Em;}; TCalc.prototype.countblank=function(F6){ if(!F6)F6=this.Col; var Em=0,AJ=this.GetChildren(),Db=AJ.length,i,BJ=F6+"countblank"; if(this.Row.State<2)return this.Row[BJ]-0; for(i=0;i<Db;i++){ if(this.Row.Fixed&&AJ[i].Page)Em+=AJ[i][BJ]-0; else if(Get(AJ[i],F6)==null)Em++;} return Em;}; TCalc.prototype.I3=function(F6,I4,I5,Cs){ try{ if(!I4){ if(!F6)return null; I4=F6; F6=this.Col;} if(!I5)I5=F6; var I6=0,AJ=this.GetChildren(),Db=AJ.length,i,BJ=F6+"sumif"+I5,Fa=F6+"countif",row=this.Row; if(row.State<2){ if(Cs==1)return row[BJ]-0; else if(Cs==2)return row[Fa]-0;} var Cq=this.Grid.m[I4]; if(!Cq){ var BD=I4.charAt(0); Cq=this.Grid.IS((BD=='='||BD=='>'||BD=='<'||BD=='!')&&I4.indexOf("val")<0?"val"+I4:I4); this.Grid.m[I4]=Cq;} for(i=0;i<Db;i++){ if(row.Fixed&&AJ[i].Page){ if(Cs==1)I6+=AJ[i][BJ]-0; else if(Cs==2)I6+=AJ[i][Fa]-0;} else{ var Dh=Get(AJ[i],F6);this["val"]=(Dh-0)+""==Dh?Dh-0:Dh; this.Row=AJ[i]; if(Cq(this)){ if(Cs==1)I6+=Get(AJ[i],I5)-0; else if(Cs==2)I6++;}}} this.Row=row; return I6;} catch(H){return null;}}; TCalc.prototype.sumif=function(F6,I4,I5){ return this.I3(F6,I4,I5,1);}; TCalc.prototype.countif=function(F6,I4){ return this.I3(F6,I4,null,2);}; TCalc.prototype.product=function(F6){ if(!F6)F6=this.Col; var I7=1,i,BJ=F6+"product"; if(this.Row.State<2)return this.Row[BJ]-0; var AJ=this.GetChildren(),Db=AJ.length; if(!Db)return 0; for(i=0;i<Db;i++){ I7*=this.Row.Fixed&&AJ[i].Page?AJ[i][BJ]-0:Get(AJ[i],F6)-0;} return I7;}; TCalc.prototype.max=function(F6){ if(!F6)F6=this.Col; var max=-Infinity,Bb,i,BJ=F6+"max"; if(this.Row.State<2)return this.Row[BJ]-0; var AJ=this.GetChildren(),Db=AJ.length; if(!Db)return ""; for(i=0;i<Db;i++){ Bb=this.Row.Fixed&&AJ[i].Page?AJ[i][BJ]:Get(AJ[i],F6); if(Bb-0+""==Bb&&Bb>max)max=Bb;} return isFinite(max)?max:"";}; TCalc.prototype.min=function(F6){ if(!F6)F6=this.Col; var min=Infinity,Bb,i,BJ=F6+"min"; if(this.Row.State<2)return this.Row[BJ]-0; var AJ=this.GetChildren(),Db=AJ.length; if(!Db)return ""; for(i=0;i<Db;i++){ Bb=this.Row.Fixed&&AJ[i].Page?AJ[i][BJ]:Get(AJ[i],F6); if(Bb-0+""==Bb&&Bb<min)min=Bb;} return isFinite(min)?min:"";}; TCalc.prototype.maximum=function(){ for(var i=0,max=-Infinity;i<arguments.length;i++){ var Bb=arguments[i]; if(Bb-0+""==Bb&&Bb>max)max=Bb;} return isFinite(max)?max:"";}; TCalc.prototype.minimum=function(){ for(var i=0,min=Infinity;i<arguments.length;i++){ var Bb=arguments[i]; if(Bb-0+""==Bb&&Bb<min)min=Bb;} return isFinite(min)?min:"";}; TCalc.prototype.average=function(F6){ var Em=this.count(F6); return Em?this.sum(F6)/Em:0;}; TCalc.prototype.rank=function(F6,EV){ var AJ=this.GetChildren(); if(!F6)F6=this.Col; AJ.sort(function(a,Ey){return Get(a,F6)<Get(Ey,F6)?-1:1;}); for(var i=0;i<AJ.length;i++)if(Get(AJ[i],F6)>=EV)return i; return AJ.length;}; TCalc.prototype.median=function(F6){ var AJ=this.GetChildren(); if(!F6)F6=this.Col; AJ.sort(function(a,Ey){return Get(a,F6)<Get(Ey,F6)?-1:1;}); var I8=Math.floor(AJ.length/2); if(I8==AJ.length/2)return(Get(AJ[I8],F6)+Get(AJ[I8-1],F6))/2; else return Get(AJ[I8],F6);}; TCalc.prototype.mode=function(F6){ var AJ=this.GetChildren(),AN=new Object(),Bb,i; if(!F6)F6=this.Col; for(i in AJ){ Bb=Get(AJ[i],F6); if(!AN[Bb])AN[Bb]=1; else AN[Bb]++;} var max=0,Em=0; for(i in AN){ if(AN[i]>Em){max=i;Em=AN[i];}} return max;}; TCalc.prototype.avedev=function(F6){ var AJ=this.GetChildren(),I9=0,i; if(!F6)F6=this.Col; for(i in AJ)I9+=Get(AJ[i],F6); I9/=AJ.length; var sum=0; for(i in AJ)sum+=Math.abs(I9-Get(AJ[i],F6)); return sum/AJ.length;}; TCalc.prototype.JA=function(F6,Au){ var AJ=this.GetChildren(),B3=0,JB=0,i,Bb; if(!F6)F6=this.Col; for(i in AJ){Bb=Get(AJ[i],F6);B3+=Bb;JB+=Bb*Bb;} Bb=(AJ.length*JB-B3*B3)/AJ.length/(AJ.length-(Au==1||Au==3?1:0)); if(Au==0||Au==1)return Math.sqrt(Bb); else return Bb;}; TCalc.prototype.stdev=function(F6){return this.JA(F6,0);}; TCalc.prototype.stdevp=function(F6){return this.JA(F6,1);}; TCalc.prototype.vara=function(F6){return this.JA(F6,2);}; TCalc.prototype.varp=function(F6){return this.JA(F6,3);}; TCalc.prototype.countrows=function(type,Gy,row,BJ){ var Em=0; if(!row){ BJ="countrows"+type; row=this.Row; if(Gy){ BJ+=Gy; Gy=this.Grid.Def[Gy];}} if(row.Fixed){ for(var AM=this.Grid.XB.firstChild;AM;AM=AM.nextSibling){ if(AM.State==0||AM.State==1){var Dh=AM[BJ]-0;if(Dh)Em+=Dh;} else for(var AP=AM.firstChild;AP;AP=AP.nextSibling){ if(!AP.Deleted||type&2){ if((!AP.Filtered||type&1)&&(AP.Selected||!(type&8))&&(!Gy||AP.Def==Gy))Em++; if(type&4){ if(AP.firstChild)Em+=this.countrows(type,Gy,AP,BJ); else if(AP.Count){var Dh=AP[BJ]-0;if(Dh)Em+=Dh;}}}}}} else{ if(row.State<2){var Dh=row[BJ]-0;if(Dh)Em+=Dh;} else for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(!AP.Deleted||type&2){ if((!AP.Filtered||type&1)&&(AP.Selected||!(type&8))&&(!Gy||AP.Def==Gy))Em++; if(type&4){ if(AP.firstChild)Em+=this.countrows(type,Gy,AP,BJ); else if(AP.Count){var Dh=AP[BJ]-0;if(Dh)Em+=Dh;}}}}}; return Em;}; TCalc.prototype.choose=function(Bb,JC,JD,JE){ var C3=0,JF=0; if(!JD){ C3=1; JD=Get(this.Row,this.Col+"Defaults"); if(JD)JD=JD.split(JD.charAt(0));} else if(typeof(JD)=="string")JD=JD.split(','); if(!JC){ JF=1; JC=Get(this.Row,this.Col+"Defaults"); if(JC)JC=JC.split(JC.charAt(0));} else if(typeof(JC)=="string")JC=JC.split(','); if(Bb==null)Bb=Get(this.Row,this.Col); if(Bb==null)Bb=""; var Db=JC?JC.length:(JD?JD.length:0); for(var i=JF;i<Db;i++)if(JC?Bb==JC[i]:Bb==i)return JD?JD[i+C3-JF]:i; return JE==null?Get(this.Row,this.Col+"Custom"):JE;}; TCalc.prototype.split=function(Bb,HF){ if(Bb==null)Bb=Get(this.Row,this.Col); Bb+=""; if(HF)return Bb.split(HF); Bb=Bb.split(Bb.charAt(0)); Bb.shift(); return Bb;}; _7h.prototype.LoadCfg=function(JG){ if(Grids.OnLoadCfg&&Grids.OnLoadCfg(this))return; if(this.SuppressCfg&1){this.Debug(4,"Loading configuration is suppressed, default values from XML are used");return;} if(JG==null){ if(this.SuppressCfg&4){this.Debug(4,"No Cookie attribute set, default values from XML are used");return;} if(this.PersistentCfg){ var JG=LoadCache("TreeGrid"+this.id); if(JG==false&&this.PersistentCfg==1)JG=Grids.JH(this.id); this.Debug(4,"Loading configuration from persistent storage");} else{ var JG=Grids.JH(this.id); this.Debug(4,"Loading configuration from cookies");}} else{this.Debug(4,"Loading configuration from Cookie attribute");}; if(!JG){this.Debug(4,"No saved configuration is found, default values from XML are used");return;} JG+=""; if(JG.charAt(0)=='+'){ JG=JG.slice(1); this.JI(JG); var Cfg=Grids.JJ,E; Cfg.Data=JG; var JK=Cfg.JL(); if(this.Version&&JK!=parseInt(this.Version))return; var JM=Cfg.JN(),JO=Cfg.JN(),JP=Cfg.JN(),JQ=Cfg.JN(),JR=Cfg.JN(),JS=Cfg.JN(); if(!this["ShowDeletedLap"])this.ShowDeleted=JM&1?1:0; if(!this["SortedLap"])this.Sorted=JM&2?1:0; if(!this["AutoSortLap"])this.AutoSort=JM&4?1:0; if(!this["CalculatedLap"])this.Calculated=JM&8?1:0; if(!this["AutoUpdateLap"])this.AutoUpdate=JM&16?1:0; if(!this["HidePanelLap"]&&!this.Cols.Panel["VisibleLap"])this.Cols.Panel.Visible=JM&32?0:1; if(!this["ShowDragLap"])this.ShowDrag=JO&1?1:0; if(!this["ShowPagerLap"]&&!this.Pager["VisibleLap"])this.Pager.Visible=JO&2?1:0; if(!this["AllPagesLap"])this.AllPages=JO&4?1:0; if(!this["HoverLap"])this.Hover=(JO>>3)&3; if(JO&32){E=Cfg.JL();if(E<10)E=10;if(!this["PagerWidthLap"])this.Pager.Width=E;} if(!this["SortIconsLap"])this.SortIcons=JP&3; if(JP&4){E=Cfg.JL();if(!this["CheckIntervalLap"])this.Source.Check.Interval=E;} if(JP&8){ if(!this["ResizingMainLap"]&&this.MainTag){ var A5=Cfg.JL(),CS=Cfg.JL(); if(A5)this.MainTag.style.width=A5+"px"; if(CS)this.MainTag.style.height=CS+"px";} else{Cfg.JL();Cfg.JL();}} if(JS&8){ var B3=Cfg.GetString(); if(!this["StyleLap"])this.Img.Style=B3;} var Em=(JP>>4)&3; if(this["SortColsLap"]||this["SortLap"]){ for(var i=0;i<Em;i++)Cfg.GetString(Cfg.JL()&3);} else{ this.W=Em; this.SortCols=new Array(); this.SortTypes=new Array(); for(var i=0;i<this.W;i++){ var Bg=Cfg.JL(); this.SortTypes[i]=Bg>>2; this.SortCols[i]=Cfg.GetString(Bg&3);} this.JT();}; if(this["GroupColsLap"]||this["GroupLap"]){ if(JQ&1){ var Em=Cfg.JL(); for(var i=0;i<Em;i++)Cfg.GetString(Cfg.JL()&3);}} else{ this.GroupCols=new Array(); this.GroupTypes=new Array(); this.Z=0; if(!this["GroupedLap"])this.Grouped=JS&1?0:1; if(JQ&1){ this.Z=Cfg.JL(); for(var i=0;i<this.Z;i++){ var Bg=Cfg.JL(); this.GroupTypes[i]=Bg>>2; this.GroupCols[i]=Cfg.GetString(Bg&3);}}}; var CE=this["FilterLap"]?new Array():this.JU(); var Em=(JQ>>1)&3; for(var i=0;i<Em;i++){ if(CE[i])for(var F6 in this.Cols){CE[i][F6+"Filter"]=0;CE[i][F6]="";} while(Cfg.Data&&Cfg.Data.charAt(0)!='+'){ var JV=Cfg.JN(),F6=Cfg.GetString(JV&3),Bb=Cfg.GetString(); if(this.Cols[F6]&&CE[i]){ CE[i][F6+"Filter"]=JV>>2; CE[i][F6]=(Bb-0)+""==Bb?Bb-0:Bb;}} Cfg.Data=Cfg.Data.slice(1);} if(!this["FilteredLap"])this.Filtered=JS&2?0:1; if(JR&1){ var a=Cfg.JN(),AJ=["","Filter","Select","Mark","Find"]; this.SearchAction=AJ[a&7]; this.SearchMethod=a>>3;} if(JR&2)this.SearchExpression=Cfg.GetString(); if(JR&4)this.SearchType=Cfg.JL(); if(JR&8)this.SearchDefs=Cfg.GetString(); if(JR&16)this.SearchCols=Cfg.GetString(); if(!this["SearchedLap"])this.Searched=JS&4?0:1; if(JQ&8){ var A5=0,JW=0,JX=this["ColsLap"]; while(Cfg.Data&&Cfg.Data.charAt(0)!='+'){ var Bg=Cfg.JN(),F6=Cfg.GetString(Bg&3),AO=Cfg.JL(); var JY=Bg&12; var Cn=JY==4?-Cfg.JL():(JY==8?Cfg.JL():0); A5+=Cn; var BD=this.Cols[F6]; if(BD){ if(!BD["WidthLap"]&&!JX){ if(JY==12){ if(!BD.RelWidth)BD.JZ=1;} else{ if(BD.RelWidth){ BD.Ja=BD.RelWidth; BD.RelWidth=null;} BD.JZ=0; BD.Width=A5;}} if(!this["ColsPosLap"]&&!JX){ if(Bg&32){BD.Sec=1;BD.Pos=AO;} else{BD.Sec=AO&1?0:2;BD.Pos=AO>>1;}} if(!BD["VisibleLap"]&&!JX)BD.Visible=Bg&16?1:0;}} Cfg.Data=Cfg.Data.slice(1);} if(JQ&16){ var BM=Cfg.Data.indexOf("+"); if(this.SaveExpanded)this.Jb="&"+Cfg.Data.slice(0,BM)+"&"; Cfg.Data=Cfg.Data.slice(BM+1); var BM=Cfg.Data.indexOf("+"); if(this.SaveExpanded)this.Jc="&"+Cfg.Data.slice(0,BM)+"&"; Cfg.Data=Cfg.Data.slice(BM+1);} if(JQ&32){ var BM=Cfg.Data.indexOf("+"); if(this.SaveSelected)this.Jd="&"+Cfg.Data.slice(0,BM)+"&"; Cfg.Data=Cfg.Data.slice(BM+1);} if(JR&32){ var AJ=Cfg.GetString(); if(AJ){ AJ=AJ.split('@'); for(var i=0;i<AJ.length;i+=2){ var Bb=Cfg.GetString(); if((Bb-0)+""==Bb)Bb-=0; if(AJ[i]){ var AP=this.GetRowById(AJ[i]); if(AP)AP[AJ[i+1]]=Bb;} else this[AJ[i+1]]=Bb;}}} if(this.SaveValues&&Cfg.Data){ var AJ=Cfg.Data.split("+"); this.Je=new Object(); for(var BD in AJ){ if(AJ[BD]){ var x=AJ[BD].split("]"); this.Je[x[0]]=x[1];}}}} else{}; if(!this["ColsLap"]&&!this["ColsPosLap"]){ var C=this.Cols; for(var i=0;i<3;i++){ var Jf=new Array(); for(var BD in C)if(C[BD].Sec==i)Jf[Jf.length]=BD; this.ColNames[i]=Jf;} function Jg(a,Ey){return C[a].Pos<C[Ey].Pos?-1:C[a].Pos>C[Ey].Pos?1:0;}; for(var i=0;i<3;i++){ var Jf=this.ColNames[i]; Jf.sort(Jg); var AO=0; for(var j=0;j<Jf.length;j++)this.Cols[Jf[j]].Pos=AO++;}} if(Grids.OnCfgLoaded)Grids.OnCfgLoaded(this);}; _7h.prototype.SaveCfg=function(DG){ if(Grids.OnSaveCfg&&Grids.OnSaveCfg(this))return; if(this.SuppressCfg&2)return; if(!DG&&(this.SuppressCfg&4))return; var Cfg=Grids.JJ,C=this.Cols; Cfg.Data="+"; var CE=this["FilterLap"]?new Array():this.JU(); var A5=0,CS=0; if(this.ResizingMain&2){ var Jh=this.MainTag.style.width; A5=parseInt(Jh);if(A5+"px"!=Jh)A5=0;} if(this.ResizingMain&1){ var Ji=this.MainTag.style.height; CS=parseInt(Ji);if(CS+"px"!=Ji)CS=0;} Cfg.Jj(this.Version); Cfg.Jk((this.ShowDeleted?1:0)+(this.Sorted?2:0)+(this.AutoSort?4:0)+(this.Calculated?8:0)+(this.AutoUpdate?16:0)+(this.Cols.Panel&&this.Cols.Panel.Visible?0:32)); Cfg.Jk((this.ShowDrag?1:0)+(this.Pager.Visible?2:0)+(this.AllPages?4:0)+(this.Hover*8)+(this.Paging?32:0)); Cfg.Jk((this.SortIcons&3)+(this.Source.Check.Interval!=60?4:0)+(A5||CS?8:0)+((this.W<3?this.W:3)*16)); Cfg.Jk((this.Z?1:0)+((CE.length&3)*2)+(this["ColsLap"]?0:8)+(this.SaveExpanded?16:0)+(this.SaveSelected?32:0)); Cfg.Jk((this.SearchAction!=null||this.SearchMethod!=null?1:0)+(this.SearchExpression!=null?2:0)+(this.SearchType!=null?4:0)+(this.SearchDefs!=null?8:0)+(this.SearchCols!=null?16:0)+(this.SaveAttrs!=null?32:0)); Cfg.Jk((this.Grouped?0:1)+(this.Filtered?0:2)+(this.Searched?0:4)+(this["StyleLap"]?0:8)); if(this.Paging)Cfg.Jj(this.Pager.Width); if(this.Source.Check.Interval!=60)Cfg.Jj(this.Source.Check.Interval); if(A5||CS){ Cfg.Jj(A5); Cfg.Jj(CS);} if(!this["StyleLap"])Cfg.SetString(this.Img.Style); for(var i=0;i<this.W&&i<3;i++){ var Db=this.SortCols[i].length; if(Db>3)Db=0; Cfg.Jj(Db+(this.SortTypes[i]?this.SortTypes[i]*4:0)); Cfg.SetString(this.SortCols[i],Db);} if(this.Z){ Cfg.Jj(this.Z); for(var i=0;i<this.Z;i++){ var Db=this.GroupCols[i].length,Jl=this.GroupTypes[i]*4; if(Db>3)Db=0; Cfg.Jj(Db+(Jl?Jl:0)); Cfg.SetString(this.GroupCols[i],Db);}} for(var i=0;i<CE.length;i++){ for(var BD in this.Cols){ var Cq=CE[i][BD+"Filter"]; if(Cq||this["SaveAllFilterValues"]){ var Db=BD.length; if(Db>3)Db=0; Cfg.Jk(Db+Cq*4); Cfg.SetString(BD,Db); Cfg.SetString(CE[i][BD],null,this.SaveAttrsTrim);}} Cfg.Data+="+";} if(this.SearchAction!=null||this.SearchMethod!=null){ var AJ=["","Filter","Select","Mark","Find"]; for(var i=0;i<AJ.length;i++)if(this.SearchAction==AJ[i])break; if(i==AJ.length)i=0; var D3=this.SearchMethod; if(!D3)D3=0; Cfg.Jk(i+D3*8);} if(this.SearchExpression!=null)Cfg.SetString(this.SearchExpression,null,0); if(this.SearchType!=null)Cfg.Jj(this.SearchType); if(this.SearchDefs!=null)Cfg.SetString(this.SearchDefs,null,0); if(this.SearchCols!=null)Cfg.SetString(this.SearchCols,null,0); if(!this["ColsLap"]){ var A5=0; for(var F6 in this.Cols){ if(F6=="Panel")continue; var BD=C[F6],Jm=BD.Width-A5;if(!BD.JZ&&!BD.RelWidth)A5=BD.Width; var Db=F6.length; if(Db>3)Db=0; Cfg.Jk( Db+(BD.JZ||BD.RelWidth?12:(Jm<0?4:(Jm>0?8:0)))+(BD.Visible?16:0)+(BD.Sec==1?32:0)); Cfg.SetString(F6,Db); Cfg.Jj(BD.Sec==1?BD.Pos:BD.Pos*2+(BD.Sec==0?1:0)); if(Jm&&!BD.JZ&&!BD.RelWidth)Cfg.Jj(Jm>0?Jm:-Jm);} Cfg.Data+="+";} if(this.SaveExpanded){ var H="",BD=""; for(var AP=this.GetFirst();AP;AP=this.GetNext(AP)){ if(Is(AP,"CanExpand")&&AP.firstChild&&AP.State!=0&&(AP.Expanded!=AP.Def.Expanded||this.SaveExpanded==1)&&AP.id){ if(AP.Expanded)H+=(H?"&":"")+AP.id; else BD+=(BD?"&":"")+AP.id;}} Cfg.Data+=H+"+"; Cfg.Data+=BD+"+";} if(this.SaveSelected){ var B3=""; for(var AP=this.GetFirst();AP;AP=this.GetNext(AP)){ if(Is(AP,"CanSelect")&&AP.Selected&&AP.id)B3+=(B3?"&":"")+AP.id;} Cfg.Data+=B3+"+";} if(this.SaveAttrs){ Cfg.SetString(this.SaveAttrs.replace(/\,/g,'@'),null,0); var AJ=this.SaveAttrs.split(","); for(var i=0;i<AJ.length;i+=2){ var Bb=null; if(AJ[i]){ var AP=this.GetRowById(AJ[i]); if(AP)Bb=AP[AJ[i+1]];} else Bb=this[AJ[i+1]]; Cfg.SetString(Bb==null?"":(typeof(Bb)=="boolean"?Bb-0+"":Bb+""),null,this.SaveAttrsTrim);}} if(this.SaveValues){ var B3,CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++){ if(CE[i].id){ B3=this.Jn(CE[i]); if(B3)Cfg.Data+=CE[i].id+"]"+B3+"+";}} for(var AP=this.GetFirst();AP;AP=this.GetNext(AP)){ if(AP.id){ B3=this.Jn(AP); if(B3)Cfg.Data+=AP.id+"]"+B3+"+";}}} if(!window["DeLZ"])this.Enable=this.Disable; if(DG)return Cfg.Data; if(this.PersistentCfg){ if(SaveCache("TreeGrid"+this.id,Cfg.Data)||this.PersistentCfg==2)return;} Grids.Jo(this.id,Cfg.Data);}; _7h.prototype.Jp=function(row,Gx){ var AJ=this.Jq; if(!AJ){ var AN=this.SaveAttrs; if(!AN)return; AN=AN.split(","); AJ=new Object(); for(var i=0;i<AN.length;i+=2)AJ[AN[i]+"_"+AN[i+1]]=1; this.Jq=AJ;} if(AJ[row.id+"_"+Gx])this.SaveCfg();}; Grids.JH=function(id){ if(Grids.Cfg==null){ var BD=document.cookie; var D2=BD.search(/Grids\s?\=/); if(D2==-1)return ""; BD=BD.slice(D2); var B3=BD.search("="); if(B3==-1)return ""; var H=BD.search(";"); if(H<0)BD=BD.slice(B3+1); else BD=BD.slice(B3+1,H); Grids.Cfg=BD.split("|"); Grids.Jr=new Array(Grids.Cfg.length); for(var i=0;i<Grids.Cfg.length;i++){ var B3=Grids.Cfg[i]; var AO=B3.search("#");if(AO<0)continue; Grids.Cfg[i]=B3.slice(AO+1); Grids.Jr[i]=B3.slice(0,AO);}} for(var i=0;i<Grids.Jr.length;i++)if(id==Grids.Jr[i])return Grids.Cfg[i]; return "";}; Grids.Jo=function(id,JG){ if(Grids.Cfg==null){ Grids.Cfg=new Array(); Grids.Jr=new Array();} var Db=Grids.Jr.length; for(var i=0;i<Db;i++)if(id==Grids.Jr[i]){Grids.Cfg[i]=JG;break;} if(i==Grids.Jr.length){ Grids.Jr[i]=id; Grids.Cfg[i]=JG; Db++;} var AJ=new Array(Db),Au=0,exp=";"; for(var i=0;i<Db;i++){ AJ[Au++]=Grids.Jr[i]+"#"+Grids.Cfg[i];} if(Grids.CookieExpires){ if(Grids.CookieExpires>1)exp="; expires="+(new Date((new Date).getTime()+Grids.CookieExpires*1000)).toUTCString(); else if(Grids.CookieExpires.toUTCString)exp="; expires="+Grids.CookieExpires.toUTCString();} else{ exp=new Date(); exp.setFullYear(exp.getFullYear()+1); exp="; expires="+exp.toUTCString();}; document.cookie="Grids="+(AJ.join("|"))+exp+(Grids.CookieParam?Grids.CookieParam:"");}; function _7AW(){ this.Js="ABCDEFGHIJKLMNOPQRSTUVWXYZ01234("; this.Jt="abcdefghijklmnopqrstuvwxyz56789)"; this.Ju=new Object(); this.Jv=new Object(); for(var i=0;i<32;i++){ this.Ju[this.Js.charAt(i)]=i; this.Jv[this.Jt.charAt(i)]=i;} this.Data="";}; _7AW.prototype.Jk=function(EV){ if(EV>31)this.Data+=this.Jt.charAt(EV-32); else this.Data+=this.Js.charAt(EV);}; _7AW.prototype.JN=function(){ var Es=this.Data.charAt(0);this.Data=this.Data.slice(1); var x=this.Ju[Es]; return x==null?this.Jv[Es]+32:x;}; _7AW.prototype.Jj=function(EV){ if(EV<0){EV=-EV;this.Data+="-";} while(1){ var Es=EV&31; EV>>=5; if(!EV){ this.Data+=this.Jt.charAt(Es); return;} this.Data+=this.Js.charAt(Es);}}; _7AW.prototype.JL=function(){ var i=0,Es=this.Data.charAt(0),EV=0,Jw; if(Es=='['||Es==']')return this.GetString(); while(1){ Es=this.Data.charAt(i); var x=this.Ju[Es]; if(x==null){ x=this.Jv[Es]; if(x!=null){ EV+=x<<(i*5); this.Data=this.Data.slice(i+1); return Jw?-(EV>>5):EV;} if(Es=='-')Jw=true; else return null;} EV+=x<<(i*5); i++;}}; _7AW.prototype.SetString=function(Ep,Db,Jx){ if(Db){ this.Data+=escape(Ep);} else if(!Ep&&Ep!==0)this.Data+="]"; else{ if(Jx==null)Jx=50; if(Jx!=0&&Ep.length>Jx)Ep=Ep.slice(0,Jx); this.Data+=escape(Ep)+']';}}; _7AW.prototype.GetString=function(Db){ if(Db){ var Ep=unescape(this.Data.slice(0,Db)); this.Data=this.Data.slice(Db); return Ep;} var Es=this.Data.charAt(0); if(Es==']'){ this.Data=this.Data.slice(1); return "";} var i=this.Data.indexOf(']'); if(i<0)return null; var Ep=unescape(this.Data.slice(0,i)); this.Data=this.Data.slice(i+1); return Ep;}; Grids.JJ=new _7AW(); function _7AX(){ if(window._7AY)return _7AY; var C=document.createElement("cacher"); if(!C.addBehavior)return null; C.addBehavior("#default#userdata"); B2(C); _7AY=C; return C;}; function SaveCache(id,Bb){ if(window.globalStorage){ var F8=location.host;if(F8=="localhost")F8+=".localdomain"; try{globalStorage[F8][id]=Bb;return true;} catch(H){return false;}} var C=_7AX(); if(!C)return false; C.setAttribute("cache",Bb); C.save(id); return true;}; function LoadCache(id){ if(window.globalStorage){ var F8=location.host;if(F8=="localhost")F8+=".localdomain"; try{return globalStorage[F8][id];} catch(H){return false;}} var C=_7AX(); if(!C)return false; C.load(id); var DG=C.getAttribute("cache"); return DG;}; _7h.prototype.GetCfgRequest=function(BA,Jy){ var AJ=new Array(),Au=0,Jz=BA&&BA.toLowerCase()=="dtd"; AJ[Au++]="<Cfg"; if(this.Sorting&&this.Sorted){ var J0="",J1=""; for(var i=0;i<this.W;i++){ if(J0)J0+=","; J0+=this.SortCols[i]; if(J1)J1+=","; if(this.SortTypes[i]!=null)J1+=this.SortTypes[i];} if(J0)AJ[Au++]=" SortCols='"+J0+"'"; if(J1)AJ[Au++]=" SortTypes='"+J1+"'"; if(this.J2)AJ[Au++]=" ReSort='1'";} if(this.I0)AJ[Au++]=" ReCalc='1'"; var J0="",J1=""; if(this.Z&&this.Grouped&&this.Grouping){ AJ[Au++]=" GroupCols='"+this.GroupCols.join(",")+"'"; AJ[Au++]=" GroupTypes='"+this.GroupTypes.join(",")+"'";} if(this.SearchAction&&this.Searching&&this.Searched){ AJ[Au++]=" SearchAction='"+this.SearchAction+"'"; AJ[Au++]=" SearchExpression=\""+this.J3(this.SearchExpression)+"\""; AJ[Au++]=" SearchType='"+this.SearchType+"'"; AJ[Au++]=" SearchMethod='"+(this.SearchMethod==null?"":this.SearchMethod)+"'"; AJ[Au++]=" SearchDefs='"+(this.SearchDefs==null?"":this.SearchDefs)+"'"; AJ[Au++]=" SearchCols='"+(this.SearchCols==null?"":this.SearchCols)+"'";} AJ[Au++]=" TimeZone='"+(new Date()).getTimezoneOffset()+"'"; if(this.Focused!=null){ AJ[Au++]=" Focused='"+this.Focused+"'"; if(this.FocusedPos!=null)AJ[Au++]=" FocusedPos='"+this.FocusedPos+"'"; if(this.FocusedCol!=null)AJ[Au++]=" FocusedCol='"+this.FocusedCol+"'";} if(Jy)AJ[Au++]=Jy; AJ[Au++]="/>"; if(this.Filtering&&this.Filtered){ AJ[Au++]="<Filters>"; var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++){ var Cp,B3="",AP=CE[i]; if(AP.Kind!="Filter")continue; var Gy=AP.Def; if(typeof(AP.Def)=="string")AP.Def=this.Def[AP.Def]; if(!AP.Def)AP.Def=this.Def["Fixed"]; AJ[Au++]="<I"; if(CE[i].id)AJ[Au++]=" id='"+CE[i].id+"'"; if(Jz)AJ[Au++]=">"; for(var F6 in this.Cols){ var Ak=AP[F6+"Filter"]; if(Ak){ var Bb=AP[F6]; Bb=this.J4(AP,F6,Bb); if(Bb==null)Bb=""; Bb=this.J3(Bb); if(Jz)AJ[Au++]="<U N='"+F6+"' V=\""+Bb+"\" Filter='"+Ak+"'/>"; else AJ[Au++]=" "+F6+"=\""+Bb+"\" "+F6+"Filter='"+Ak+"'";}} AJ[Au++]=Jz?"</I>":"/>"; AP.Def=Gy;} AJ[Au++]="</Filters>";} return AJ.join("");}; _7h.prototype.Dispose=function(){ this.Clear(1); delete Grids[this.id]; Grids[this.Index]=null; if(Grids.Active==this)Grids.Active=null; if(Grids.Focused==this)Grids.Focused=null;}; function DisposeGrids(){ for(var i=0;i<Grids.length;i++){ var G=Grids[i]; if(G&&Grids[G.id]==G)G.Dispose();} Grids.length=0;}; _7h.prototype._7l=function(row,type){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(AP.r0)AP.r0.row=null; if(AP.r1){AP.r1.row=null;this.RowCount--;} if(AP.r2)AP.r2.row=null; AP.r0=null;AP.r1=null;AP.r2=null; if(type==1)AP.Def=null; if(AP.State>=3)AP.State=2; else if(AP.State==1)AP.State=0; if(AP.firstChild)this._7l(AP); AP._7AZ=0;}}; _7h.prototype.Clear=function(type){ this.AF++; if(type==null)type=1; if(this.XB)try{ this._7l(this.XB,type); if(type&3){ var CE=this.GetFixedRows();for(var i=0;i<CE.length;i++){ var AP=CE[i]; if(AP.r0)AP.r0.row=null; if(AP.r1)AP.r1.row=null; if(AP.r2)AP.r2.row=null; AP.r0=null;AP.r1=null;AP.r2=null; if(type==1){ AP.Def=null;AP.CalcOrder=null;}} for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){ if(AP.r1)AP.r1.row=null; AP.r1=null; if(type==1){ AP.Cells=null;AP.Def=null;AP.CalcOrder=null;}}}} catch(H){}; if(this.ARow&&(!this.ARow.Fixed||type&3))this.ARow=null; if(this.J5&&(!this.J5.Fixed||type&3))this.J5=null; if(type&4&&this.J6){ var AN=this.XB.firstChild; if(AN&&AN.MasterRow)this.J7(AN.MasterRow); AN.MasterRow=null;} if(type&1&&this.MainTag){ this.Loading=0; this.Rendering=0; this.MainTag.innerHTML="";} if(type&1){ try{ this.HideMessage(); var AM=[this.Message,this.J8,this.J9]; for(var i=0;i<AM.length;i++)if(AM[i])AM[i].parentNode.removeChild(AM[i]);}catch(H){}; try{this.HideTip();}catch(H){}; try{if(this.Dialog)this.Dialog.Close();}catch(H){}; try{this.HideHint();}catch(H){}; try{this.KA(this.KB);this.KA(this.KC);this.KA(this.KD);}catch(H){}; this.FRow=null; try{_7l(this.XB);}catch(H){}; try{_7l(this.XF);}catch(H){}; try{_7l(this.XH);}catch(H){}; try{_7l(this.XS);}catch(H){}; Gj(this.MainTag); this.KE=1;}}; var _7AQ=["LeftHtml","MidHtml","RightHtml"]; _7h.prototype.GetSections=function(){ var KF=1,KG=2,C=this.Cols; for(var i=0,S=this.ColNames[0];i<S.length;i++)if(C[S[i]].Visible||C[S[i]].Hidden){KF=0;break;} for(var i=0,S=this.ColNames[2];i<S.length;i++)if(C[S[i]].Visible||C[S[i]].Hidden){KG=3;break;} return[KF,KG];}; _7h.prototype.SetVPos=function(){ var Jf=this.ColNames,C=this.Cols,KH=this.MainCol; for(var i=0;i<Jf.length;i++){ var AL=Jf[i],KI=this.KJ; for(var BD=0;BD<AL.length;BD++){ var F6=AL[BD]; if(C[F6].Visible||C[F6].Hidden){ if(F6==KH)KI++; C[F6].KK=KI; KI++; if(C[F6].WidthPad)KI++;} else C[F6].KK=-1;}}}; _7h.prototype.GetNextCol=function(F6,row){ if(!F6)return null; if(row&&row.Space!=null){ for(var i=0;i<row.Cells.length;i++){ if(row.Cells[i]==F6)return row.Cells[i+1];}} var C=this.Cols;if(!C[F6])return null; var Hj=C[F6].Sec,S=this.ColNames,Au=C[F6].Pos+1; while(1){ while(S[Hj][Au]&&(!C[S[Hj][Au]].Visible&&(!row||!row.Spanned||!(Get(row,S[Hj][Au]+"Span")>1)||this.KL(row,S[Hj][Au])<=0)||row&&row.Spanned&&Get(row,S[Hj][Au]+"Span")==0))Au++; if(S[Hj][Au])return S[Hj][Au]; Hj++;Au=0; if(Hj>2)return null;}}; _7h.prototype.GetPrevCol=function(F6,row){ if(!F6)return null; if(row&&row.Space!=null){ for(var i=0;i<row.Cells.length;i++){ if(row.Cells[i]==F6)return i?row.Cells[i-1]:null;}} var C=this.Cols;if(!C[F6])return null; var Hj=C[F6].Sec,S=this.ColNames,Au=C[F6].Pos-1; while(1){ while(S[Hj][Au]&&(!C[S[Hj][Au]].Visible&&(!row||!row.Spanned||!(Get(row,S[Hj][Au]+"Span")>1)||this.KL(row,S[Hj][Au])<=0)||row&&row.Spanned&&Get(row,S[Hj][Au]+"Span")==0))Au--; if(S[Hj][Au])return S[Hj][Au]; Hj--; if(Hj<0)return null; Au=S[Hj].length-1;}}; _7h.prototype.GetLastCol=function(Hj,row){ if(row&&row.Space!=null)return row.Cells[row.Cells.length-1]; if(Hj==null){ for(var i=2;i>=0;i--){var F6=this.GetLastCol(i,row);if(F6)return F6;} return null;} var S=this.ColNames[Hj],Au=S.length-1,C=this.Cols; while(S[Au]&&(!C[S[Au]].Visible&&(!row||!row.Spanned||!(Get(row,S[Au]+"Span")>1)||this.KL(row,S[Au])<=0)||row&&row.Spanned&&Get(row,S[Au]+"Span")==0))Au--; return S[Au];}; _7h.prototype.GetFirstCol=function(Hj,row){ if(row&&row.Space!=null)return row.Cells[0]; if(Hj==null){ for(var i=0;i<3;i++){var F6=this.GetFirstCol(i);if(F6)return F6;} return null;} var S=this.ColNames[Hj],Au=0,C=this.Cols; while(S[Au]&&!C[S[Au]].Visible)Au++; return S[Au];}; _7h.prototype.GetCaption=function(F6){ return this.GetType(this.Header,F6)=="Html"?this.Header[F6]:this.Lang.Format.Escape(this.Header[F6]);}; _7h.prototype.GetVisibleCols=function(KM){ var AJ=new Array(),Au=0; for(var i=0;i<3;i++){ for(var j=0;j<this.ColNames[i].length;j++){ var F6=this.ColNames[i][j]; if(this.Cols[F6].Visible&&(!KM||this.Cols[F6].CanCopy))AJ[Au++]=F6;}} return AJ;}; _7h.prototype.KL=function(row,F6){ if(row.Space!=null)return row[F6+"Width"]; var C=this.Cols[F6]; if(!row.Spanned)return C.Width; var Span=Get(row,F6+"Span"); Span=Span==null?1:Span-0; if(Span==0)return 0; var Pos=C.Pos,KN=0; for(var i=0;i<Span;i++){ var BD=this.ColNames[C.Sec][Pos+i]; if(!BD)break; if(this.Cols[BD].Visible)KN+=this.Cols[BD].Width;} return KN;}; _7h.prototype.KO=function(row,F6){ if(!row.Spanned)return F6; var KP=Get(row,F6+"Span"); if(KP!=0)return F6; var C=this.Cols[F6],S=this.ColNames[C.Sec],Au=C.Pos-1; while(Au&&!Get(row,S[Au]+"Span"))Au--; if(Get(row,S[Au]+"Span")+this.Cols[S[Au]].Pos>C.Pos)F6=S[Au]; return F6;}; _7h.prototype.ShowCol=function(F6){ var C=this.Cols[F6]; if(!C||C.Visible)return; if(C.Hidden){ this.SetWidth(F6); if(F6=="Panel")for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)this.RefreshRow(AP); if(!this.FastMerge){this.KQ(F6);this.Update();} return;} if(!this.GetFirstCol(C.Sec)){ C.Visible=1; this.SetVPos(); this.Render(); return;} function KR(row,Bi){ if(KS)Bi=Bi.firstChild; while(Bi){ var KT=Bi.firstChild; if(KT&&KT.nodeType==1){ KT=KT.rows[0]; KT.insertCell(AO).style.height="0px"; if(KU)KT.insertCell(AO+1).style.height="0px"; if(KH)KT.insertCell(AO).style.height="0px";} Bi=Bi.nextSibling;} for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(!AP.r1)continue; var H6=null,KT=AP[KV],KW=AO,KP=0; if(AP[G5]!=null||AP.Def[G5]!=null){ KT.lastChild.colSpan+=1+KU+KH; H6=1;} else if(AP.Spanned&&Get(AP,F6+"Span")!=1){ H6=T.GetCell(AP,T.KO(AP,F6)); if(H6)H6.colSpan+=1+KU+KH;} else if(AP.G4){ if(AP[F6+"RowSpan"]==0)H6=1; else{ if(AP[F6+"RowSpan"])KP=AP[F6+"RowSpan"]; for(var i=0;i<KX.length;i++)if(AP[KX[i]+"RowSpan"]==0){ KW--;if(T.Cols[KX[i]].WidthPad)KW--;if(KX[i]==T.MainCol)KW--;}}} if(!H6){ var i=0,Au=0; while(Au<KW)Au+=KT.cells[i++].colSpan; var S=[];T.KY(AP,S,0,0,1,F6); var BD=KT.insertCell(i); BD.innerHTML=S[0]; BD.className=S[1]; BD.style.backgroundColor=S[2]; if(KP)BD.rowSpan=KP; if(S[3]){ BD=KT.insertCell(i+1); BD.innerHTML=_7D; BD.className=S[3]; BD.style.backgroundColor=S[2]; if(KP)BD.rowSpan=KP;} else if(KU)BD.colSpan=2; if(KH){ BD=KT.insertCell(i); BD.innerHTML=S[4]; BD.className=S[5]; BD.style.backgroundColor=S[2]; if(KP)BD.rowSpan=KP;}} if(KZ)Grids.OnRenderRow(T,row,F6); if(AP._7AZ){ var Bi=KT.nextSibling.cells[0]; Bi.colSpan+=1+KU+KH; if(AP._7AZ==4)KR(AP,Bi);}}}; C.Visible=1; this.SetVPos(); var Hj=C.Sec,G5=_7AQ[Hj],KV="r"+Hj,AO=C.KK,T=this,KU=C.WidthPad?1:0,KH=0; var KZ=Grids.OnRenderRow!=null,KS=this.ChildPages; var M=this.Cols[this.MainCol],Ka=M&&M.Sec==C.Sec&&M.KK>=0&&M.KK<=C.KK; if(this.G4)var KX=this.Kb(F6); KH=0;if(Ka)AO--; if(this.L[Hj])KR(this.XH,this.L[Hj]); if(this.O[Hj])KR(this.XF,this.O[Hj]); KH=F6==this.MainCol;if(Ka&&!KH)AO++; for(var row=this.XB.firstChild;row;row=row.nextSibling)if(row.r1&&row.State==4)KR(row,row[KV]); var A5=C.Width;C.Width=0;this.SetWidth(F6,A5); if(F6=="Panel")for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)this.RefreshRow(AP); if(!this.FastMerge){this.KQ(F6);this.Update();}}; _7h.prototype.HideCol=function(F6){ var C=this.Cols[F6]; if(!C||!C.Visible)return; if(this.FastColumns){ this.SetWidth(F6); if(F6=="Panel")for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)this.RefreshRow(AP); if(!this.FastMerge){this.KQ(F6);this.Update();} return;} C.Visible=0; if(!this.GetFirstCol(C.Sec)){ if(C.Sec==1){C.Visible=1;return;} this.SetVPos(); this.Render(); return;} C.Visible=1; var Hj=C.Sec,G5=_7AQ[Hj],KV="r"+Hj,AO=C.KK,T=this,KU=C.WidthPad?1:0,KH=0,KS=this.ChildPages; var M=this.Cols[this.MainCol],Ka=M&&M.Sec==C.Sec&&M.KK>=0&&M.KK<=C.KK; if(this.G4)var KX=this.Kb(F6); function KR(row,Bi){ if(KS)Bi=Bi.firstChild; while(Bi){ var KT=Bi.firstChild; if(KT&&KT.nodeType==1){ KT=KT.rows[0]; KT.deleteCell(AO); if(KU)KT.deleteCell(AO); if(KH)KT.deleteCell(AO-1);} Bi=Bi.nextSibling;} for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(!AP.r1)continue; var KT=AP[KV]; if(AP[G5]!=null||AP.Def[G5]!=null)KT.lastChild.colSpan-=1+KU+KH; else if(AP.Spanned&&Get(AP,F6+"Span")!=1)T.GetCell(AP,T.KO(AP,F6)).colSpan-=1+KU+KH; else if(AP.G4){ if(AP[F6+"RowSpan"]!=0){ var KW=AO; for(var i=0;i<KX.length;i++)if(AP[KX[i]+"RowSpan"]==0){ KW--;if(T.Cols[KX[i]].WidthPad)KW--;if(KX[i]==T.MainCol)KW--;} var i=0,Au=0; while(Au<KW)Au+=KT.cells[i++].colSpan; if(KU&&KT.cells[i].colSpan<=1)KT.deleteCell(i+1); KT.deleteCell(i); if(KH)KT.deleteCell(i-1);}} else{ var i=0,Au=0; while(Au<AO)Au+=KT.cells[i++].colSpan; if(KU&&KT.cells[i].colSpan<=1)KT.deleteCell(i+1); KT.deleteCell(i); if(KH)KT.deleteCell(i-1);}; if(AP._7AZ){ var Bi=KT.nextSibling.cells[0]; Bi.colSpan-=1+KU+KH; if(AP._7AZ==4)KR(AP,Bi);}}}; KH=0;if(Ka)AO--; if(this.L[Hj])KR(this.XH,this.L[Hj]); if(this.O[Hj])KR(this.XF,this.O[Hj]); KH=F6==this.MainCol;if(Ka)AO++; for(var row=this.XB.firstChild;row;row=row.nextSibling)if(row.r1&&row.State==4)KR(row,row[KV]); C.Visible=0;C.Hidden=0; this.SetVPos(); if(!this.FastMerge)this.KQ(F6); if(F6=="Panel")for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)this.RefreshRow(AP); this.Kc(); this.Update();}; _7h.prototype.KQ=function(F6){ var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++){ var AP=CE[i]; if(AP.r1&&AP.Spanned){ var Fa=this.KO(AP,F6); if(!(Get(AP,Fa+"MergeType")&2))this.RefreshCell(AP,Fa);}} for(var AP=this.GetFirst();AP;AP=this.GetNext(AP)){ if(AP.r1&&AP.Spanned){ var Fa=this.KO(AP,F6); if(Is(AP,Fa+"Merge")&&!(Get(AP,Fa+"MergeType")&2))this.RefreshCell(AP,Fa);}}}; _7h.prototype.ChangeColsVisibility=function(In,Kd,Ke,Kf){ var C=this.Cols,AJ=new Object(); if(Kd)for(var i=0;i<Kd.length;i++){ var BD=C[Kd[i]]; AJ[Kd[i]]=BD&&BD.Visible?-1:0;} if(In)for(var i=0;i<In.length;i++){ var BD=C[In[i]]; if(AJ[In[i]]!=null){ if(Ke)continue; else AJ[In[i]]=null;} AJ[In[i]]=BD&&!BD.Visible?1:0;} for(var i=0;i<3;i++){ var Jf=this.ColNames[i],Em=0,Ff=0; for(var j=0;j<Jf.length;j++){ var BD=Jf[j]; if(C[BD].Visible)Em++; if(AJ[BD])Ff+=AJ[BD];} if(Em==0&&Ff>0||Em>0&&Em+Ff==0){ for(var BD in AJ){ if(!BD||!AJ[BD])continue; C[BD].Visible=AJ[BD]==1;} this.SetVPos(); if(!this.Loading&&!this.Rendering&&!Kf)this.Render(); return true;}} if(!this.Loading&&!this.Rendering)this.Kc(); var Kg=this.Rendering; this.Rendering=1; for(var BD in AJ){ if(!BD||!AJ[BD])continue; if(AJ[BD]==1){ this.ShowCol(BD);} else{ this.HideCol(BD);}} this.Rendering=Kg; this.Update(); return false;}; _7h.prototype.ActionHideCol=function(CE){ var F6=CE?this.FCol:this.ACol,C=this.Cols; if(!F6||!C[F6]||!C[F6].CanHide||!C[F6].Visible)return false; if(this.FRow&&this.FRow.Space==null&&this.FCol==F6){ var Kh=this.GetNextCol(F6); if(!Kh)Kh=this.GetPrevCol(F6); if(Kh)this.Focus(this.FRow,Kh);} this.HideCol(F6); return true;}; _7h.prototype.ActionShowColLeft=function(CE){ var F6=CE?this.FCol:this.ACol,C=this.Cols; if(!F6||!C[F6])return false; var Hj=C[F6].Sec,S=this.ColNames,Au=C[F6].Pos-1; while(1){ while(S[Hj][Au]&&!C[S[Hj][Au]].CanHide&&!C[S[Hj][Au]].Visible)Au--; var Kh=S[Hj][Au]; if(Kh){ if(C[Kh].Visible)return false; this.ShowCol(Kh); if(this.FRow&&this.FCol==F6)this.Focus(this.FRow,Kh); return true;} Hj--; if(Hj<0)return false; Au=S[Hj].length-1;}}; _7h.prototype.ActionShowColRight=function(CE){ var F6=CE?this.FCol:this.ACol,C=this.Cols; if(!F6||!C[F6])return false; var Hj=C[F6].Sec,S=this.ColNames,Au=C[F6].Pos+1; while(1){ while(S[Hj][Au]&&!C[S[Hj][Au]].CanHide&&!C[S[Hj][Au]].Visible)Au++; var Kh=S[Hj][Au]; if(Kh){ if(C[Kh].Visible)return false; this.ShowCol(Kh); if(this.FRow&&this.FCol==F6)this.Focus(this.FRow,Kh); return true;} Hj++;Au=0; if(Hj>2)return false;}}; _7h.prototype.AddCol=function(F6,Hj,AO,width,HQ,type,caption){ if(this.Cols[F6])return null; var C=new _7e(); for(var BD in this.Def["C"])C[BD]=this.Def["C"][BD]; for(var Gy in this.Def)if(this.Def[Gy][F6]==null)this.Def[Gy][F6]=""; this.Cols[F6]=C; if(Hj!=0&&Hj!=2)Hj=1; C.Sec=Hj; var Jf=this.ColNames[Hj]; if(!(AO>=0&&AO<Jf.length))AO=Jf.length; else for(var i=Jf.length;i>AO;i--){ Jf[i]=Jf[i-1]; this.Cols[Jf[i]].Pos=i;} Jf[AO]=F6; C.Pos=AO; C.Name=F6; C.Index=F6; C.Group=0; if(type)C.Type=type; var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++)if(CE[i].Kind=="Header")CE[i][F6]=caption?caption:F6; C.Visible=false; C.MinWidth=this.Img.Ki+this.Img.Kj; var HR=F6+"Span";for(var BM in this.Def)this.Def[BM][HR]=1; if(width){C.Width=width;C.JZ=0;} else this.CalcWidth(F6,1); if(HQ)this.ShowCol(F6); return C;}; _7h.prototype.DelCol=function(F6){ var C=this.Cols[F6];if(!C)return; this.HideCol(F6); var Jf=this.ColNames[C.Sec]; for(var i=C.Pos;i<Jf.length-1;i++){ Jf[i]=Jf[i+1]; this.Cols[Jf[i]].Pos--;} Jf.length--; var AL=new Object(); for(var BD in this.Cols)if(BD!=F6&&!AL[BD])AL[BD]=this.Cols[BD]; this.Cols=AL;}; _7h.prototype.MoveCol=function(F6,Kk,right,Kl,Km){ var Cols=this.Cols,C=Cols[F6],Kn=Cols[Kk]; if(!C)return; var Hj=C.Sec,AO=C.Pos,KI=C.KK,Ko,Kp,Kq=this.ColNames[Hj][AO-1];if(!Kq)Kq=Hj; if(F6==Kk){ Ko=0; Kp=0; Kr=right?Hj+1:Hj-1;} else if(Kn){ Kr=Kn.Sec; Ko=Kn.Pos;if(right)Ko++; Kp=Kn.KK; if(right||Kp<0){ var Ks=right?this.GetNextCol(Kk):this.GetPrevCol(Kk); if(!Ks||Cols[Ks].Sec!=Kr)Kp=right?null:0; else Kp=Cols[Ks].KK; if(Ks&&Ks==this.MainCol)Kp--;} else if(Kk&&Kk==this.MainCol)Kp--;} else{ Kr=Kk-0+""==Kk?Kk-0:Hj; if(Kr<0||Kr>3)Kr=Hj; Ko=right?this.ColNames[Kr].length:0; Kp=right?null:0;}; var HU=this.GetSections(); if(Kr==Hj&&AO<Ko)Ko--; var S=this.ColNames[Hj]; for(var i=C.Pos;i<S.length-1;i++){ S[i]=S[i+1]; Cols[S[i]].Pos--;} S.length--; S=this.ColNames[Kr]; for(var i=S.length;i>Ko;i--){ S[i]=S[i-1]; Cols[S[i]].Pos++;} S[Ko]=F6; C.Pos=Ko; C.Sec=Kr; if(!C.Visible&&!C.Hidden)return; this.SetVPos(); var Ff=0; if(this.Kt){ Ff+=this.Ku(this.XH,F6,Kq,Km); Ff+=this.Ku(this.XF,F6,Kq,Km); for(var Ey=this.XB.firstChild;Ey;Ey=Ey.nextSibling)Ff+=this.Ku(Ey,F6,Kq,Km); Ff=1;} if(Kl)return; if(Ff){this.Render();return;} if(Kr!=Hj){ var Kv=this.GetSections(); if(Kv[0]!=HU[0]||Kv[1]!=HU[1]){this.Render();return;}} var KV="r"+Hj,Kw="r"+Kr,Kx=Kp!=null,T=this,KU=C.WidthPad?1:0,KH=0,Ky,H6,Kz; var G5=_7AQ[Hj],K0=_7AQ[Kr],K1=Kr!=Hj; var M=this.Cols[this.MainCol],Ka=M&&M.Sec==Hj&&M.KK>=0&&M.KK<=KI||this.MainCol==F6; var K2=M&&M.Sec==Kr&&M.KK>=0&&M.KK<=Kp,KS=this.ChildPages; function KR(row,Bi,K3){ if(KS){Bi=Bi.firstChild;K3=K3.firstChild;} var KT=Bi.firstChild.rows[0],K4=K3.firstChild.rows[0]; while(1){ if(KH)Ky=KT.cells[KI-1]; H6=KT.cells[KI]; if(KU)Kz=KT.cells[KI+1]; if(Kx){ var K5=K4.cells[Kp]; if(KH)K4.insertBefore(Ky,K5); K4.insertBefore(H6,K5); if(KU)K4.insertBefore(Kz,K5);} else{ if(KH)K4.appendChild(Ky); K4.appendChild(H6); if(KU)K4.appendChild(Kz);}; if(!KS||row.Page)break; KT=KT.parentNode.parentNode.parentNode.nextSibling; if(!KT||KT.firstChild.nodeType!=1)break; KT=KT.firstChild.rows[0]; K4=K4.parentNode.parentNode.parentNode.nextSibling.firstChild.rows[0];} for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(!AP.r1)continue; var KT=AP[KV],K4=AP[Kw],K6=AP[G5]!=null||AP.Def[G5]!=null,K7=K1?AP[K0]!=null||AP.Def[K0]!=null:K6; var i=0,Au=0;if(!K6)while(Au<KI)Au+=KT.cells[i++].colSpan; var K8=0,K9=0;if(!K7)while(K9<Kp)K9+=K4.cells[K8++].colSpan; if(K6||K7){ if(K1){ if(K6)KT.lastChild.colSpan-=1+KU+KH; else{ if(KU&&KT.cells[i].colSpan<=1)KT.deleteCell(i+1); KT.deleteCell(i); if(KH)KT.deleteCell(i-1);}; if(K7)K4.lastChild.colSpan+=1+KU+KH; else{ T.RefreshRow(AP);}}} else if(KT.cells[i]){ var LA=KU&&KT.cells[i].colSpan<=1; if(KH)Ky=KT.cells[i-1]; H6=KT.cells[i]; if(LA)Kz=KT.cells[i+1]; if(Kx){ var K5=K4.cells[K8]; if(KH)K4.insertBefore(Ky,K5); K4.insertBefore(H6,K5); if(LA)K4.insertBefore(Kz,K5);} else{ if(KH)K4.appendChild(Ky); K4.appendChild(H6); if(LA)K4.appendChild(Kz);}} if(AP._7AZ){ var Bi=KT.nextSibling.cells[0],K3=K4.nextSibling.cells[0]; if(Hj!=Kr){ Bi.colSpan-=1+KU+KH; K3.colSpan+=1+KU+KH;} if(AP._7AZ==4)KR(AP,Bi,K3);}}}; this.Debug(4,"Moving column ",F6);this.LB("MoveCol"); KH=0;if(Ka)KI--;if(K2)Kp--; if(this.L[Hj])KR(this.XH,this.L[Hj],this.L[Kr]); if(this.O[Hj])KR(this.XF,this.O[Hj],this.O[Kr]); KH=F6==this.MainCol;if(Ka)KI++;if(K2)Kp++; for(var row=this.XB.firstChild;row;row=row.nextSibling)if(row.r1&&row.State==4)KR(row,row[KV],row[Kw]); this.Update(); if(!Kl&&Grids.OnDisplaceRow){ var CE=this.GetFixedRows();for(var i=0;i<CE.length;i++)Grids.OnDisplaceRow(this,CE[i],F6); for(var AP=this.GetFirst();AP;AP=this.GetNext(AP))if(AP.r1)Grids.OnDisplaceRow(this,AP,F6);} this.Debug(4,"Column ",F6," moved in ",this.LC("MoveCol")," ms");}; _7h.prototype.LD=function(AP,F6,LE,HR,LF){ var H7=Get(AP,F6+"Merge"),LG=Get(AP,F6+"MergeEdit"); AP[LE+"Span"]=HR+LF; if(HR+LF==1)AP[LE+"ZSpan"]=2; AP[LE+"Merge"]=H7?H7:F6; AP[LE+"MergeEdit"]=LG?LG:F6; AP[LE+"Button"]=Get(AP,F6+"Button"); AP[LE+"Visible"]=Get(AP,F6+"Visible"); if(AP[LE+"Visible"]==-3)AP[LE+"Visible"]=AP[LE+"ZalVisible"]; if(LF<0){AP[F6+"ZalVisible"]=AP[F6+"Visible"];AP[F6+"Visible"]=-3;} AP[F6+"Span"]=LF<0?1:0; AP[F6+"MSpan"]=HR; if(AP.G4&&AP[F6+"RowSpan"]){ AP[LE+"RowSpan"]=AP[F6+"RowSpan"]; if(AP.firstChild){ this.LH(AP,LE,HR+LF); this.LH(AP,F6,LF<0?1:0);} for(var KT=AP.nextSibling;KT&&KT[LE+"RowSpan"]==0;KT=KT.nextSibling){ KT[LE+"Span"]=HR+LF; KT[F6+"Span"]=LF<0?1:0; KT[F6+"RowSpan"]=0; if(KT.firstChild){ this.LH(KT,LE,HR+LF); this.LH(KT,F6,LF<0?1:0);}}}}; _7h.prototype.Ku=function(row,F6,Kq,Km){ var C=this.Cols[F6],AM=this.Cols[Kq],Ff=0; for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(!AP.Spanned)continue; var HR=Get(AP,F6+"Span"); if(HR!=1){ var Jf=this.ColNames[AM?AM.Sec:Kq]; if(HR==0){ for(var Au=AM.Pos;Au&&!Get(AP,Jf[Au]+"Span");Au--); var LE=Jf[Au],LI=Get(AP,LE+"Span")-1; AP[LE+"Span"]=LI; if(LI==1)AP[LE+"ZSpan"]=2; AP[F6+"Span"]=1; if(AP.G4&&AP[LE+"RowSpan"]){ AP[F6+"RowSpan"]=AP[LE+"RowSpan"]; if(AP.firstChild){ this.LH(AP,LE,LI); this.LH(AP,F6);} for(var KT=AP.nextSibling;KT&&KT[LE+"RowSpan"]==0;KT=KT.nextSibling){ KT[LE+"Span"]=LI; KT[F6+"RowSpan"]=0; if(KT.firstChild){ this.LH(KT,LE,LI); this.LH(KT,F6);}}} Ff=1;} else{ var LE=Jf[AM?AM.Pos+1:0]; this.LD(AP,F6,LE,HR,-1); Ff=1;}} var Jf=this.ColNames[C.Sec],AO=C.Pos; var prev=Jf[AO-1]?Get(AP,Jf[AO-1]+"Span"):1,next=Jf[AO+1]?Get(AP,Jf[AO+1]+"Span"):1; if(prev==1&&(AP[Jf[AO-1]+"ZSpan"]||Km&&AP[Jf[AO-1]+"MSpan"]))prev=-1; if(next==1&&AP[Jf[AO+1]+"ZSpan"])next=-1; if(prev!=1||next!=1){ var Au=AO-1; if(prev==0)while(Au&&!Get(AP,Jf[Au]+"Span"))Au--; if(next==0||prev!=1&&(Km||LE==Jf[Au])||prev==-1){ var LE=Jf[Au],LI=Get(AP,LE+"Span")+1; AP[LE+"Span"]=LI; if(AP[LE+"Visible"]==-3)AP[LE+"Visible"]=AP[LE+"ZalVisible"]; AP[F6+"Span"]=0; if(AP.G4&&AP[LE+"RowSpan"]){ AP[F6+"RowSpan"]=AP[LE+"RowSpan"]; if(AP.firstChild)this.LH(AP,LE,LI); for(var KT=AP.nextSibling;KT&&KT[LE+"RowSpan"]==0;KT=KT.nextSibling){ KT[LE+"Span"]=LI; KT[F6+"RowSpan"]=0; if(KT.firstChild)this.LH(KT,LE,LI);}} Ff=1;} else if(next>1&&LE==Jf[AO+1]||next==-1){ this.LD(AP,Jf[AO+1],F6,Get(AP,Jf[AO+1]+"Span"),1); Ff=1;}}} return Ff;}; _7h.prototype.ChangeColsPositions=function(LJ,cols,LK){ for(var i=0;i<3;i++){ var Jf=new Array(),AJ=arguments[i],k=0; if(AJ)for(var j=0;j<AJ.length;j++){ var BD=this.Cols[AJ[j]]; if(BD){ BD.Sec=i; BD.Pos=k; Jf[k++]=AJ[j];}} this.ColNames[i]=Jf;} this.SetVPos();}; _7h.prototype.LL=function(GP){ var AN=_7i.createElement("B"); GP.appendChild(AN); if(GP.Page){ AN.Def=this.Def["R"]; var empty=1;} else{ var LM=Grids.AH; for(var BD in GP)if(!LM[BD])AN[BD]=GP[BD]; var empty=this.EmptyChildPages;}; AN.LN=1; AN.AggChildren=1; AN.Level=GP.Level+1; AN.CanEdit=0; AN.Expanded=0; AN.Visible=0; AN.State=2; AN.CanDelete=0; AN.CanSelect=0; AN.CanCopy=0; AN.Selected=0; AN.CanDrag=0; AN.r0=null;AN.r1=null;AN.r2=null; for(var BD in this.Cols){ AN[BD+"CanEdit"]=0; AN[BD+"Button"]=""; if(empty)AN[BD+"Visible"]=0;} if(empty)AN[this.MainCol+"Visible"]=1; return AN;}; _7h.prototype.LO=function(AN){ if(this.FRow==AN)this.FRow=AN.parentNode; var BC=AN.State==4&&AN.firstChild; for(var i=0;i<3;i++){ var AP=AN["r"+i]; if(!AP)continue; var Au=AP.parentNode; if(BC)Au.removeChild(AP.nextSibling); Au.removeChild(AP);} var GP=AN.parentNode; GP.removeChild(AN); AN.Removed=1; if(!GP.firstChild){ GP.CDef=AN.CDef; GP.AcceptDef=AN.AcceptDef;}}; _7h.prototype.LP=function(GP,HQ){ if(GP==this.XB){ if(!this.MainCol)return; for(var AP=GP.firstChild;AP;AP=AP.nextSibling)this.LP(AP,HQ);} else if(GP.Page){ for(var AP=GP.firstChild;AP;AP=AP.nextSibling)if(AP.firstChild)this.LQ(AP,HQ,null,1);} else this.LQ(GP,HQ,null,1);}; _7h.prototype.LQ=function(GP,HQ,AJ,LR){ var max=GP.Page?1e10:Get(GP,"MaxChildren"),LS=GP.firstChild,Em=0,I6=GP.Page?0:Get(GP,"MaxChildrenDiff"); if(!AJ){ if(!LS||!GP.Visible&&!GP.Page)return; if(LS.LN){ AJ=new Array(); for(var LT=GP.firstChild,Au=0;LT;LT=LT.nextSibling){ for(var AP=LT.firstChild;AP;AP=AP.nextSibling){ AJ[Au++]=AP; if(AP.Visible)Em++; if(LR&&AP.firstChild)this.LQ(AP,HQ,null,1);}}} else{ var Db=GP.childNodes.length; if(Db>max+I6){ AJ=new Array(); for(var AP=GP.firstChild,Au=0;AP;AP=AP.nextSibling){ AJ[Au++]=AP; if(AP.Visible)Em++; if(LR&&AP.firstChild)this.LQ(AP,HQ,null,1);}} else{ Em=Db; if(LR)for(var AP=GP.firstChild;AP;AP=AP.nextSibling)if(AP.firstChild)this.LQ(AP,HQ,null,1);}}} else{ var Db=AJ.length; if(Db>max+I6)for(var i=0;i<Db;i++)if(AJ[i].Visible)Em++; else Em=Db; if(LR)for(var i=0;i<Db;i++)if(AJ[i].firstChild)this.LQ(AJ[i],HQ,null,1);}; var T=this; function LU(row,HQ){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ T.LV(AP,HQ); if(AP.firstChild)LU(AP,HQ);}}; if(Em>max+I6){ var LW=Em<100?2:Em<1000?3:4,LX="0000",LY=this.GetText("Items"); var Em=0,body,LZ=GP.childNodes.length; GP._Count=Em; var La=LS.LN?LS.CDef:Get(GP,"CDef"); var Lb=LS.LN?LS.AcceptDef:Get(GP,"AcceptDef"); for(var i=0;i<AJ.length;i++){ if(AJ[i].Visible||!body){ if(!Em){ Em=max; body=this.LL(GP); body.CDef=La; body.AcceptDef=Lb;} Em--;} if(HQ&&GP.Expanded&&Af!=3&&AJ[i].r1)this.Lc(AJ[i]); body.appendChild(AJ[i]); AJ[i].Level=body.Level+1;} GP.CDef="*"; GP.AcceptDef="*"; if(LS.LN){ for(var i=0;i<LZ;i++)this.LO(GP.firstChild);} var KH=this.MainCol,Ld=0,Af=GP.State; if(GP.State==4)GP.State=2; function Le(Bb){ Bb+=""; return LX.slice(0,LW-Bb.length)+Bb;}; var Lf=this.Cols[this.MainCol],AM=this.IX(); for(var AP=GP.firstChild;AP;AP=AP.nextSibling){ for(var BD=AP.firstChild,Lg=0;BD;BD=BD.nextSibling)if(BD.Visible)Lg++; if(AP.Calculated)this.If(AP,AM,"CalcOrder",HQ); AP[KH+"Type"]="Html"; AP[KH+"Format"]=""; AP[KH]="<div nowrap"+_7E+">"+LY.replace(/\%d/,Le(Ld+1)).replace(/\%d/,Le(Ld+Lg))+"</div>"; if(HQ&&GP.Expanded&&Af!=3){ this.ShowRow(AP); this.RefreshCell(AP,KH);} AP.Visible=1; Ld+=Lg;} LU(GP,0);} else if(AJ){ if(_7V)for(var i=0;i<AJ.length;i++)GP.removeChild(AJ[i]); for(var i=0;i<AJ.length;i++)GP.appendChild(AJ[i]); if(LS.LN){ for(var AP=LS;AP&&AP.LN;AP=GP.firstChild)this.LO(GP.firstChild); LU(GP,HQ); if(HQ&&GP.Expanded&&Af!=3){ var r1=1; for(var AP=GP.firstChild;AP;AP=AP.nextSibling)if(!AP.r1){r1=0;break;} if(!r1){ this.Collapse(GP); GP.State=2; this._7l(GP); this.Expand(GP);} if(!this.HasChildren(GP)||!this.HN(GP))this.Lh(GP);} this.Li(GP);} if(HQ)this.Lj(AJ,LS);}}; _7h.prototype.Lk=function(GP,HQ){ var Em=0,LW=GP._Count<100?2:GP._Count<1000?3:4,LX="0000",LY=this.GetText("Items"),KH=this.MainCol; function Le(Bb){ Bb+=""; return LX.slice(0,LW-Bb.length)+Bb;}; for(var AP=GP.firstChild;AP;){ if(!AP.LN)continue; var BD=AP.childNodes.length; if(!BD){ var Ll=AP.nextSibling; this.DelRow(AP); AP=Ll; continue;} var S=LY.replace(/\%d/,Le(Em+1)).replace(/\%d/,Le(Em+BD)); if(S!=AP[KH]){ AP[KH]=S; this.RefreshCell(AP,KH);} Em+=BD; AP=AP.nextSibling;}}; _7h.prototype.Lj=function(AJ,LS){ var HU=this.GetSections(),KF=HU[0],KG=HU[1]; for(var j=KF;j<KG;j++){ var Es="r"+j,Au=AJ[0][Es]; if(Au)Au=Au.parentNode; else{ for(var i=0;i<AJ.length;i++)if(AJ[i][Es]){Au=AJ[i][Es].parentNode;break;} if(LS&&LS.LN&&Au)Au=AJ[i][Es].nextSibling;}; var KZ=j==1&&Grids.OnDisplaceRow!=null; if(Au)for(var i=0;i<AJ.length;i++){ if(!AJ[i][Es])continue; var BC=AJ[i]._7AZ?AJ[i][Es].nextSibling:null; Au.appendChild(AJ[i][Es]); if(BC)Au.appendChild(BC); if(KZ)Grids.OnDisplaceRow(this,AJ[i]);}}}; _7h.prototype.Lm=function(CZ,E){ if(!CZ)return; var E=E?E:this.Event,row=E.Row,F6=E.Col; if(!row||row.Page)return this.Ln(CZ); var D9=row[F6+"NoColor"];if(D9==null){D9=row.Def[F6+"NoColor"];if(D9==null&&this.Cols[F6])D9=this.Cols[F6].NoColor;} var Lo=row.NoColor;if(Lo==null)Lo=row.Def.NoColor; if(D9==null)D9=Lo; var A5=E.Width,CS=E.Height,x=E.IQ-E.X,y=E.IR-E.Y,Ll,Lp,AI=this.Img;if(CS==null)CS=-1;if(A5==null)A5=-1; var IB=E.w,Lq=E.z,Lr=E.AA,Ls=E.AB,Lt=0,KZ=0,X=this.IE-_7AR,Y=this.IF-_7AS; if(row.Space==0||row.Space>=3){ Ll=X+AI.Hk; Lp=X+this.HW.clientWidth;} else{ Ll=X+AI.Hk+(this.Hl?AI.Hm:AI.Hp); Lp=X+AI.Hk+this.Hl+this.Hn+(this.Hq?this.Hq-AI.Lu+AI.Hr:AI.Hp-AI.IP); if(this.ConstWidth&&!this.GetNextCol("_ConstWidth"))Lp-=this.Cols["_ConstWidth"].Width;}; if(this.Lv){ if(this.w){ var Ca=x-X-this.w+AI.Lw; if(Ca<0)IB=IB?IB-Ca:-Ca; Ca=Ca-x+Ll; if(Ca<0){Lt=-Ca;Ll-=Ca;}} if(this.z){ var Lx=this.MainTag.offsetWidth-AI.Lw; if(Lx<this.HW.offsetWidth)Lx=this.HW.offsetWidth; var Ca=x+A5-X+this.z-Lx; if(Ca>0)Lq=Lq?Lq+Ca:Ca; Ca=Ll+Lp-X+this.z-Lx+AI.Lw-AI.Ly-X; if(this.w>AI.Lw+AI.Hr)Ca+=AI.Ly+AI.Hk-this.w; else Ca+=AI.Lw-AI.Hr; if(Ca>0){KZ=Ca;Lp-=Ca;}} if(this.AA){ var Cb=y-Y-this.AA+AI.Lz+AI.L0; if(Cb<0)Lr=Lr?Lr-Cb:-Cb;} if(this.AB){ var L1=this.MainTag.offsetHeight-AI.Lz-AI.L2; if(L1<this.HW.offsetHeight)L1=this.HW.offsetHeight; var Cb=y+CS-Y+this.AB-L1; if(Cb>0)Ls=Ls?Ls+Cb:Cb;}} if(IB){x+=IB;A5-=IB;} if(Lq)A5-=Lq; if(Lr){y+=Lr;CS-=Lr;} if(Ls)CS-=Ls; var C=CZ.L3; if(C){ if(D9||A5<0||CS<0||!(CZ.Type&1)||!F6){for(var i in C)C[i].style.display="none";} else{ C.Left.style.left=x+"px"; C.Left.style.top=y+"px"; C.Left.style.height=CS+(_7Q?C.Left.Height:0)+"px"; C.Left.style.display=IB?"none":""; C.Top.style.left=x+"px"; C.Top.style.top=y+"px"; C.Top.style.width=A5+(_7Q?C.Top.Width:0)+"px"; C.Top.style.display=Lr?"none":""; C.L4.style.left=x+A5+"px"; C.L4.style.top=y+"px"; C.L4.style.height=CS+(_7Q?C.L4.Height:0)+"px"; C.L4.style.display=Lq?"none":""; C.Bottom.style.left=x+"px"; C.Bottom.style.top=y+CS+"px"; C.Bottom.style.width=A5+(_7Q?C.Bottom.Width:0)+"px"; C.Bottom.style.display=Ls?"none":"";}} var R=CZ.Row; if(R){ if(Lo||CS<0||!(CZ.Type&2)||Lp<0){for(var i in R)R[i].style.display="none";} else{ var L5=Ll,AM=this.Cols.Panel; if(AM&&AM.Visible&&(!row.Space&&!row["Sec0Html"]||row.Panel)&&F6!="Panel"&&AM.Pos==0&&AM.Sec==0){ R.Panel.style.top=y+"px"; R.Panel.style.left=Ll+"px"; R.Panel.style.height=CS+"px"; R.Panel.style.width=AM.Width+"px"; R.Panel.style.display=""; L5+=AM.Width;} else R.Panel.style.display="none"; if(L5<x){ R.Left.style.top=y+"px"; R.Left.style.left=L5+"px"; R.Left.style.height=CS+"px"; R.Left.style.width=(x-L5)+"px"; R.Left.style.display="";} else R.Left.style.display="none"; if(Lp>x+A5){ R.L4.style.top=y+"px"; R.L4.style.left=(x+A5)+"px"; R.L4.style.height=CS+"px"; R.L4.style.width=(Lp-x-A5)+"px"; R.L4.style.display="";} else R.L4.style.display="none"; var AY=AI.Style+"Hover"; if(row.Kind=="Header"){ if(R.Panel.className!=AY+"HeaderPanel"){ R.Panel.className=AY+"HeaderPanel"; R.Left.className=AY+"HeaderLeft"; R.L4.className=AY+"HeaderRight";}} else{ if(R.Panel.className!=AY+"RowPanel"){ R.Panel.className=AY+"RowPanel"; R.Left.className=AY+"RowLeft"; R.L4.className=AY+"RowRight";}}}} var R=CZ.L6; if(R){ if(Lo||CS<0||!(CZ.Type&4)||Lp<0){for(var i in R)R[i].style.display="none";} else{ var L5=Ll; if(CZ.Type&8){ var AM=this.Cols.Panel;if(AM&&AM.Visible&&(!row.Space||row.Space.Panel))L5+=AM.Width;} R.Left.style.left=L5+"px"; R.Left.style.top=y+"px"; R.Left.style.height=CS+(_7Q?R.Left.Height:0)+"px"; R.Left.style.display=Lt?"none":""; R.Top.style.left=L5+"px"; R.Top.style.top=y+"px"; R.Top.style.width=Lp-L5+(_7Q?R.Top.Width:0)+"px"; R.Top.style.display=Lr?"none":""; R.L4.style.left=Lp+"px"; R.L4.style.top=y+"px"; R.L4.style.height=CS+(_7Q?R.L4.Height:0)+"px"; R.L4.style.display=KZ?"none":""; R.Bottom.style.left=L5+"px"; R.Bottom.style.top=y+CS+"px"; R.Bottom.style.width=Lp-L5+(_7Q?R.Bottom.Width:0)+"px"; R.Bottom.style.display=Ls?"none":"";}} var AN=CZ.Edit; if(AN){ var AJ=this.H5(row,F6); var L5=x+AJ[0],CF=A5<AJ[0]+AJ[2]?A5-AJ[0]:AJ[2]; var L7=y+AJ[1],Ht=CS<AJ[1]+AJ[3]?CS-AJ[1]:AJ[3]; if(_7Q){CF+=AN.Edit.Width;Ht+=AN.Edit.Height;} L5-=AN.Edit.Left;L7-=AN.Edit.Top; L5-=AN.Edit.L8;L7-=AN.Edit.L9; CF+=AN.Edit.MA;Ht+=AN.Edit.MB; if(!_7P){L5--;CF+=2;} if(CF<0||Ht<0||!F6){for(var i in AN)AN[i].style.display="none";} else{ if(AJ[2]){y+=AJ[2];if(AJ[3])CS=AJ[3];} AN.Edit.style.left=L5+"px"; AN.Edit.style.top=L7+"px"; AN.Edit.style.width=CF+"px"; AN.Edit.style.height=Ht+"px"; AN.Edit.style.display=""; var CE=AN.Edit.firstChild; if(CE&&CE.style){ CE.style.marginLeft=(IB?-IB:0)+"px"; CE.style.marginTop=(Lr?-Lr:0)-(_7P?1:0)+"px";}}} CZ.Hidden=0; this.Refresh();}; _7h.prototype.Ln=function(CZ){ if(!CZ)return; for(var i in CZ)for(var j in CZ[i])CZ[i][j].style.display="none"; CZ.Type=0; CZ.Hidden=0;}; _7h.prototype.KA=function(CZ){ if(!CZ)return; for(var i in CZ)for(var j in CZ[i])if(CZ[i][j].parentNode)CZ[i][j].parentNode.removeChild(CZ[i][j]); CZ.Deleted=1;}; _7h.prototype.MC=function(CZ){ if(!CZ||!CZ.Type)return; for(var i in CZ)for(var j in CZ[i]){ CZ[i][j].MD=CZ[i][j].style.display; CZ[i][j].style.display="none";} CZ.Hidden=1;}; _7h.prototype.MF=function(CZ){ if(!CZ||!CZ.Hidden)return; for(var i in CZ)for(var j in CZ[i])CZ[i][j].style.display=CZ[i][j].MD; CZ.Hidden=0;}; _7h.prototype.MG=function(BQ,MH){ var E=document.createElement("div"); E.className=this.Img.Style+BQ; if(!MH){ E.style.position="absolute"; E.style.width="0px"; E.style.height="0px"; E.style.overflow="hidden";} B2(E); return E;}; _7h.prototype.MI=function(C){ if(!_7P){ var Cs=new Function("event","if(!"+this.K+".GridMouseWheel(event,-event.detail*40)) event.preventDefault();"); for(var i in C)C[i].addEventListener('DOMMouseScroll',Cs,false);} var AJ=["GridClick","GridDblClick","GridRightClick","GridMouseDown","GridMouseUp","GridMouseMove"]; var AN=["onclick","ondblclick","oncontextmenu","onmousedown","onmouseup","onmousemove"]; for(var i=0;i<AJ.length;i++){ var Cs=new Function("ev","return "+this.K+"."+AJ[i]+"(ev?ev:event);"); for(var j in C)C[j][AN[i]]=Cs;}}; _7h.prototype.ActionHoverCell=function(){return this.MJ(1);}; _7h.prototype.ActionHoverRow=function(){return this.MJ(2);}; _7h.prototype.ActionHoverRowCell=function(){return this.MJ(3);}; _7h.prototype.ActionHoverNone=function(){return this.MJ(0);}; _7h.prototype.MJ=function(type){ var E=this.Event,Cc=this.AE; if(this.MK)return; this.MK=1; if(E.Row==Cc.Row&&E.Col==Cc.Col&&E.ML==Cc.ML||!this.Hover)return; var CZ=this.KB; if(!CZ){ var AI=this.Img; CZ={}; var MM=_7Y?"FF3":""; var C={Left:this.MG("HoverCellBorderLeft"+MM),Top:this.MG("HoverCellBorderTop"+MM),L4:this.MG("HoverCellBorderRight"+MM),Bottom:this.MG("HoverCellBorderBottom"+MM)}; CZ.L3=C; if(_7Q){ C.Left.style.width=AI.MN+"px"; C.Left.Height=AI.MO; C.Top.style.height=AI.MP+"px"; C.Top.Width=AI.MQ; C.L4.style.width=AI.MR+"px"; C.L4.Height=AI.MT; C.Bottom.style.height=AI.MU+"px"; C.Bottom.Width=AI.MV;} this.MI(C); var R={Panel:this.MG("HoverRowPanel"),Left:this.MG("HoverRowLeft"),L4:this.MG("HoverRowRight")}; CZ.Row=R; var MW="if("+this.K+".ARow&&"+this.K+".ARow.Space) "+this.K+".ASpaceCol="; var MY=";"+this.K+".GridMouseMove(ev?ev:event);"; R.Panel.onmousemove=new Function("ev",MW+"'Panel'"+MY); R.Left.onmousemove=new Function("ev",MW+this.K+".GetPrevCol("+this.K+".ACol,"+this.K+".ARow)"+MY); R.L4.onmousemove=new Function("ev",MW+this.K+".GetNextCol("+this.K+".ACol,"+this.K+".ARow)"+MY); this.KB=CZ;} if(this.Hover!=3)type&=~2; CZ.Type=type; this.Lm(CZ);}; _7h.prototype.MZ=function(){ if(this.ARow&&this.ARow.r1&&this.ACol&&this.KB)this.Lm(this.KB,this.IC(this.ARow,this.ACol));}; _7h.prototype.Ma=function(clear){ var E=this.Event,Cc=this.AE; if(this.Mb)return; this.Mb=1; if(E.Row==Cc.Row&&E.Col==Cc.Col||!this.Hover||Grids.Bc&&(Grids.Bc.Action=="Select"||Grids.Bc.Action=="Fill"))return; if(this.Hover==2&&Cc.Row!=E.Row){ this.ColorRow(Cc.Row); if(!clear)this.ColorRow(E.Row);} else{ this.ColorCell(Cc.Row,Cc.Col); if(!clear)this.ColorCell(E.Row,E.Col);}; if(this.ColorClasses&48){ if(Cc.Row&&(this.ColorClasses&32||Cc.Row.Kind=="Header"||this.GetType(Cc.Row,Cc.Col)=="Panel"))this.RefreshCell(Cc.Row,Cc.Col); if(E.Row&&(this.ColorClasses&32||E.Row.Kind=="Header"||this.GetType(E.Row,E.Col)=="Panel")&&!clear)this.RefreshCell(E.Row,E.Col);} this.Refresh();}; _7h.prototype.ActionColorHover=_7h.prototype.Ma; _7h.prototype.HideHover=function(){ this.Ln(this.KB); var AP=this.Event.Row;this.Event.Row=null; this.Ma(); this.Event.Row=AP;}; _7h.prototype.Mc=function(Md){ if(Md&&!Md.Page){ if(this.ColorClasses&8)this.RefreshRow(Md); else this.ColorRow(Md);} var row=this.FRow; if(row&&!row.Page&&Md!=row){ if(this.ColorClasses&8)this.RefreshRow(row); else this.ColorRow(row);}}; _7h.prototype.Me=function(type){ type=5; var CZ=this.KC; if(!CZ){ var AI=this.Img; CZ={}; var C={Left:this.MG("FocusCellBorderLeft"),Top:this.MG("FocusCellBorderTop"),L4:this.MG("FocusCellBorderRight"),Bottom:this.MG("FocusCellBorderBottom")}; CZ.L3=C; if(_7Q){ C.Left.style.width=AI.Mf+"px"; C.Left.Height=AI.Mg; C.Top.style.height=AI.Mh+"px"; C.Top.Width=AI.Mi; C.L4.style.width=AI.Mj+"px"; C.L4.Height=AI.Mk; C.Bottom.style.height=AI.Ml+"px"; C.Bottom.Width=AI.Mm;} this.MI(C); var C={Left:this.MG("FocusRowBorderLeft"),Top:this.MG("FocusRowBorderTop"),L4:this.MG("FocusRowBorderRight"),Bottom:this.MG("FocusRowBorderBottom")}; CZ.L6=C; if(_7Q){ C.Left.style.width=AI.Mn+"px"; C.Left.Height=AI.Mo; C.Top.style.height=AI.Mp+"px"; C.Top.Width=AI.Mq; C.L4.style.width=AI.Mr+"px"; C.L4.Height=AI.Ms; C.Bottom.style.height=AI.Mt+"px"; C.Bottom.Width=AI.Mu;} this.MI(C); this.KC=CZ;} CZ.Type=type; this.Mv();}; _7h.prototype.Mv=function(){ if(this.FRow&&this.FRow.r1&&this.FPagePos==null){ var H6=this.IC(this.FRow,this.FCol); if(this.KC)this.Lm(this.KC,H6); if(this.EditMode&&this.KD)this.Lm(this.KD,H6);} else this.Ln(this.KC);}; _7h.prototype.Mw=function(type){ type=1; var CZ=this.KD; if(!CZ){ var AI=this.Img; CZ={}; var C={Left:this.MG("EditCellBorderLeft"),Top:this.MG("EditCellBorderTop"),L4:this.MG("EditCellBorderRight"),Bottom:this.MG("EditCellBorderBottom")}; CZ.L3=C; if(_7Q){ C.Left.style.width=AI.Mx+"px"; C.Left.Height=AI.My; C.Top.style.height=AI.Mz+"px"; C.Top.Width=AI.M0; C.L4.style.width=AI.M1+"px"; C.L4.Height=AI.M2; C.Bottom.style.height=AI.M3+"px"; C.Bottom.Width=AI.M4;} var E={Edit:this.MG("EditCell")}; CZ.Edit=E; E.Edit.Left=AI.M5; E.Edit.Top=AI.M6; E.Edit.Width=AI.M7; E.Edit.Height=AI.M8; E.Edit.L8=AI.M9; E.Edit.L9=AI.NA; E.Edit.MA=AI.NB; E.Edit.MB=AI.NC; if(!_7P){ var Cs=new Function("event","if(!"+this.K+".GridMouseWheel(event,-event.detail*40)) event.preventDefault();"); for(var i in CZ)for(var j in CZ[i])CZ[i][j].addEventListener('DOMMouseScroll',Cs,false);} this.KD=CZ;} CZ.Type=type; this.Lm(CZ,this.IC(this.FRow,this.FCol));}; _7h.prototype.ND=function(Cu,E){ if(!E){ E=this.Event; this.ND("",this.AE);} var row=E.Row; if(row){ if(row.r1){ if(row.Space)row.r1.style.cursor=Cu; else{ var C=this.Cols[E.Col]; if(C)row["r"+C.Sec].style.cursor=Cu;}}} else if(E.CellSection=="PagerHeader")this.NE.style.cursor=Cu;}; _7h.prototype.ActionCursorDefault=function(){this.AC[this.Event.Level]="default";}; _7h.prototype.ActionCursorPointer=function(){this.AC[this.Event.Level]=_7S?"hand":"pointer";}; _7h.prototype.ActionCursorResize=function(){this.AC[this.Event.Level]="w-resize";}; _7h.prototype.ActionCursorResizeGrid=function(){this.AC[this.Event.Level]="nw-resize";}; _7h.prototype.ActionCursorText=function(){this.AC[this.Event.Level]="text";}; _7h.prototype.ActionCursorMove=function(){this.AC[this.Event.Level]="move";}; _7h.prototype.ActionCursorDrag=function(){this.AC[this.Event.Level]=_7N?"default":"url(Drag.cur"+")";}; _7h.prototype.ActionCursorDragType=function(){ if(Grids.Bc.Action=="ColResize")return this.ActionCursorResize(); if(Grids.Bc.Action=="SelectPanel")return this.ActionCursorPointer(); if(Grids.Bc.Action=="Select")return this.ActionCursorDefault(); if(Grids.Bc.Action=="None")return this.ActionCursorDefault(); return this.ActionCursorDrag();}; _7h.prototype.NF=function(NG,row){ var D4=NG.Url; if(D4.search(/\*/)>=0){ NG=CopyObject(NG); if(row)D4=D4.replace(/\*Pos/g,row.Pos!=null?row.Pos:"").replace(/\*id/g,row.id!=null?row.id:"").replace(/\*Rows/g,row.Rows!=null?row.Rows:""); for(var i=0;i<3;i++){ var r1=new RegExp("\\*SortCols"+i,"g"),r2=new RegExp("\\*SortTypes"+i,"g"); D4=D4.replace(r1,this.W>i?this.SortCols[i]:"").replace(r2,this.W>i?this.SortTypes[i]&1:"");} NG.Url=D4;} return NG;}; _7h.prototype.AjaxCall=function(IO,Data,AT,row){ var T=this,AZ; if(!AT&&IO.Sync){AT=function(NH){AZ=NH;}} IO.Grid=this; var AS={}; for(var DU in IO)AS[DU]=IO[DU]; if(IO.Param)for(var DU in IO.Param)AS.Param[DU]=IO.Param[DU]; AS.RepeatText=IO==this.Source.Upload?"AskUploadTimeout":"AskTimeout"; if(Grids.OnDataSend&&Grids.OnDataSend(this,IO,Data,AT))return; AjaxCall(AS,Data,function(code,NI){if(!T.KE)T.NJ(code,NI,IO,AT,row,Data)}); return AZ;}; _7h.prototype.NJ=function(code,NI,IO,AT,row,Data){ if(code<0){ if(!Grids.OnDataError||!Grids.OnDataError(this,code,NI,IO,row)){ if(IO.AlertError)alert("TreeeGrid communication error \r\n\r\nURL: "+IO.Url+" \r\n\r\n"+code+" : "+NI);} if(AT)AT(code); return;} this.NK(NI); var NL=this.IO; if(!NL)NL=new Object(); if(NL.Message)alert(NL.Message); if(!NL.UpdateMessage||confirm(NL.UpdateMessage))this.NM(NI,IO,row); if(NL.ReloadMessage&&!confirm(NL.ReloadMessage))NL.Reload=0; if(Grids.OnDataReceive)Grids.OnDataReceive(this,row); var NH=NL.Result<0?NL.Result:0; if(NH)this.Debug(1,"Error result '",NH,"' received from server from ",IO.Name+"_Url='"+IO.Url+"'"); if(!NH&&NL.Reload==1)this.ReloadBody(null,0,"Reload"); if(AT)AT(NH);}; _7h.prototype.Communicate=AjaxCall; _7h.prototype.Communicate2=_7h.prototype.AjaxCall; _7h.prototype.ReadData=function(NG,AT){ this.Debug(4,"Loading XML data from ",this.NN(NG)); if(Grids.OnReadData&&Grids.OnReadData(this,NG,AT))return; if(NG.Url){ var NO=""; if(this.ColNames[1]&&this.ColNames[1].length){ NO=this.GetCfgRequest(NG.Format,"");} if(NO||this.Source.Session!=null)NO="<Grid><IO"+(this.Source.Session!=null?" Session='"+this.Source.Session+"'":"")+"/>"+NO+"</Grid>"; this.AjaxCall(this.NF(NG),NO,AT);} else if(NG.Tag){ var AI=this.NP(NG.Tag),DG; if(!AI){DG=-3;this.Debug(1,"Missing input tag named '",NG.Tag,"' from data source ",NG.Name+"_Tag");} else if(!AI.value){DG=-4;this.Debug(1,"Empty xml in tag named '",NG.Tag,"' from data source ",NG.Name+"_Tag");} else{ this.Debug(4,"Loading data from tag named '",NG.Tag,"' from data source ",NG.Name+"_Tag"); if(NG.Debug["in"])this.AV(NG,AI.value,"a XML loaded:"); DG=this.NM(AI.value,NG)?0:-4;}; if(AT)AT(DG);} else if(NG.Data){ this.Debug(4,"Loading data from data source ",NG.Name+"_Data"); if(NG.Debug["in"])this.AV(NG,NG.Data,"a XML loaded:"); var DG=this.NM(NG.Data,NG)?0:-4; if(AT)AT(DG);} else{ this.Debug(1,"No data source defined for ",NG.Name);if(AT)AT(-3);}}; _7h.prototype.NQ=function(){ this.FocusedPos=null; if(this.FRow){ this.Focused=this.FRow.id; if(this.FRow.Page){ if(!this.Focused)this.Focused=this.GetPageNum(this.FRow); this.FocusedPos=this.FPagePos;}} else this.Focused=null; this.FocusedCol=this.FCol;}; _7h.prototype.DownloadPage=function(row,AT){ if(Grids.OnDownloadPage&&Grids.OnDownloadPage(this,row,AT))return; row=this.NR(row); if(row.State>1){if(AT)AT(0);return;} if(!this.Source.Page.Url){ this.Debug(1,"No Page_Url set in <treegrid> tag"); if(AT)AT(-1);return;} var AJ=new Array(),Au=0; AJ[Au++]="<Grid><IO"+(this.Source.Session!=null?" Session='"+this.Source.Session+"'":"")+"/>"; AJ[Au++]=this.GetCfgRequest(this.Source.Page.Format); AJ[Au++]="<Body><B"; if(row.Copy)AJ[Au++]=" id='"+row.Copy+"'"; else if(row.id)AJ[Au++]=" id='"+row.id+"'"; if(row.Rows)AJ[Au++]=" Rows=\""+this.J3(row.Rows)+"\""; if(row.Page){ if(row.Pos!=null)AJ[Au++]=" Pos='"+row.Pos+"'"; else AJ[Au++]=" Pos='"+this.GetPageNum(row)+"'";} AJ[Au++]="/></Body></Grid>"; if(this.DebugFlags["page"]){ this.LB("Page"+(row.Page?this.GetPageNum(row):row.id)); this.Debug(4,"Downloading ",row.Page?"page "+this.GetPageNum(row):"children "+row.id," from ",this.NN(this.Source.Page));} this.AjaxCall(this.NF(this.Source.Page,row),AJ.join(""),AT,row);}; _7h.prototype.NS=function(row,F6,AT,Bb){ if(!this.Source.Cell.Url){ this.Debug(1,"No Cell_Url set in <treegrid> tag"); if(AT)AT(-1);return;} var AJ=new Array(),Au=0; AJ[Au++]="<Grid><IO"+(this.Source.Session!=null?" Session='"+this.Source.Session+"'":"")+"/>"; AJ[Au++]=this.GetCfgRequest(this.Source.Cell.Format); AJ[Au++]="<Body><B"; if(row.Copy)AJ[Au++]=" id='"+row.Copy+"'"; else if(row.id)AJ[Au++]=" id='"+row.id+"'"; AJ[Au++]=" Col='"+F6+"'"; AJ[Au++]=" Val='"+D0.Escape(Bb)+"'"; AJ[Au++]="/></Body></Grid>"; if(this.DebugFlags["page"]){ this.LB("Cell"+row.id+"_"+F6); this.Debug(4,"Downloading cell [",row.id,",",F6,"] (",Bb,") from ",this.NN(this.Source.Cell));} this.AjaxCall(this.NF(this.Source.Cell,row),AJ.join(""),AT,row);}; _7h.prototype.UploadChanges=function(row,AT){ if(this.J6)return this.J6.UploadChanges(row?row.MasterRow:null,AT); if(!this.AutoUpdate||row&&(!row.id||Is(row,"NoUpload"))){if(AT)AT(0);return;} if(Grids.OnSave&&Grids.OnSave(this,row,true)){if(AT)AT(0);return;} var AS=this.Source.Upload; if(!AS.Url){ this.Debug(1,"No Upload_Url set in <treegrid> tag"); if(AT)AT(-2);return;} var T=this; var Bb=row?this.GetChanges(row):this.GetXmlData(); if(Grids.OnUpload){var Dh=Grids.OnUpload(this,Bb,row);if(Dh!=null)Bb=Dh;} this.NT="Upload"; this.AjaxCall(AS,Bb,function(NU){ if(NU>=0)T.AcceptChanges(row); T.NT=null; if(Grids.OnAfterSave)Grids.OnAfterSave(T,NU); if(AT)AT(NU);}); return 0;}; _7h.prototype.Reload=function(AS,id,NV){ if(this.Rendering||this.Loading)return; if(Grids.OnReload&&Grids.OnReload(this))return; if(!AS)AS=this.Source; if(!AS)return; if(NV!=0&&this.Iz&&!this.Iz(1))return false; this.Debug(4,"Reloading grid"); this.Loading=1; this.Focus(); this.Disable(); if(this.RefreshDetail)this.RefreshDetail(null,1); if(this.id!=id)delete Grids[this.id]; Grids.CacheVersion=Math.floor(Math.random()*1e8); this.Clear(1); this.Enable(); var NW=TreeGrid(AS,this.MainTag,id,this.Index,this.AF); if(Grids.Active==this)Grids.Active=NW; return NW;}; _7h.prototype.ActionReload=function(){ if(!this.NX())return false; return this.Reload();}; _7h.prototype.Iz=function(NY){ var Ff=this.HasChanges?this.HasChanges():0; if(Grids.OnCanReload)return Grids.OnCanReload(this,Ff,NY); var Dh=this.ReloadChanged; if(!(Dh&4))Ff&=~2; if(Ff){ Dh&=3; if(Dh==3)Dh=confirm(this.GetAlert("CanReloadStart")+(Ff&1?this.GetAlert(NY?"CanCancelChanges":"CanReloadChanges"):"")+((Ff&3)==3?this.GetAlert("And"):"")+(Ff&2?this.GetAlert("CanReloadSelect"):"")+this.GetAlert("CanReloadEnd"))?1:0; if(Dh==1&&Ff&1&&!NY&&this.Save)this.Save(); return!!Dh;} return true;}; _7h.prototype.ReloadBody=function(AT,NZ,reason){ if(this.EditMode&&this.EndEdit(this.FRow,this.FCol,true)==-1)return; this.NT=reason?reason:"Reload"; this.Debug(4,"++++++++++ Reloading body rows due ",reason," ++++++++++");this.LB("ReloadBody"); this.NQ(); this.FRow=null;this.FCol=null; this.Clear(4); if(this.RefreshDetail)this.RefreshDetail(null,1); _7l(this.XB); this.ClearUndo(); Grids.CacheVersion=Math.floor(Math.random()*1e8); var T=this;this.ReadData(this.Source.Data,function(NU){T.Na(NU,AT,NZ);});}; _7h.prototype.Na=function(NU,AT,NZ){ var AS=this.Source.Data; if(NU<0){ this.Debug(1,"Reloading body failed with result ",NU); this.HideMessage(); if(!this.XB.firstChild)this.HY(); this.Render(); if(AT)AT(NU); return;} if(AS.Bonus)this.NM(CreateXML(AS.Bonus)); if(!this.XB.firstChild){ this.Debug(2,"No page (tag <B>) defined in input XML"); this.HY();} this.Nb(); this.Nc(2); if(this.LoadCfg)this.LoadCfg(); this.Nd(); if(NZ){ this.Render();} else{ if(this.UpdatePager)this.UpdatePager(); this.UpdateBody(); this.Ne(); if(this.FRow){ var Cq=this.FRow;this.FRow=null; this.Focus(Cq,this.FCol,this.FPagePos,1);} var CE=this.GetFixedRows();for(var i=0;i<CE.length;i++){ if(typeof(CE[i].Def)=="string"){ var AS=this.Def[CE[i].Def]; if(!AS)AS=this.Def["R"]; CE[i].Def=AS;} this.RefreshRow(CE[i]);} for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)this.RefreshRow(AP); this.HideMessage(); this.ShowPages(); this.Debug(4,"Reloading body finished in ",this.Nf("ReloadBody")," ms");}; this.NT=null; if(AT)AT(NU);}; _7h.prototype.ActionValidate=function(){ if(!this.Validate)return true; if(!this.NX())return false; var R=new Array(),C=new Array(),Au=0,T=this,Fj=this.Validate; function Ng(AP,cols){ for(var BD in cols){ var DI=T.G0(AP,BD,0); if(DI){ var Bb=T.GetString(AP,BD); try{if(Bb.search(new RegExp(DI,""))==-1){R[Au]=AP;C[Au]=BD;Au++;}} catch(H){alert("Wrong result mask at cell ["+AP.id+","+BD+"]");}}}}; for(var AP=this.GetFirst();AP;AP=this.GetNext(AP)){ if(Fj&2||AP.Added)Ng(AP,this.Cols);} if(Fj&2){ var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++)if(CE[i].Kind=="Data"||!CE[i].Kind)Ng(CE[i],this.Cols); for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Kind=="Space")Ng(AP);} if(Au){ if(Grids.OnValidateError){ var DG=Grids.OnValidateError(this,R,C); if(DG==1)return; if(DG==2)Au=0;} if(Au){ var DG=true,text=""; if(!(Fj&32))text=Get(R[0],C[0]+"ResultText"); text=text?"\n"+(this.ValidateText?this.ValidateText:""):this.ValidateText; if(text){ if(!(Fj&4))alert(text); if(Fj&4&&confirm(text))DG=false;} if(DG){ if(Fj&24)this.Focus(R[0],C[0]); if(Fj&16)this.StartEdit(R[0],C[0]); if(!(Fj&64)){ for(var i=0;i<Au;i++){ var H=Get(R[0],C[0]+"ResultText"); if(!H)H=this.GetAlert("Invalid"); R[i][C[i]+"Error"]=H; this.RefreshCell(R[i],C[i]);}} return false;}}} return true;}; _7h.prototype.Save=function(event){ var AS=this.Source.Upload; if(this.EditMode&&this.EndEdit(this.FRow,this.FCol,true)==-1){ if(event)CancelEvent(event); return false;} for(var i=0;i<Grids.length;i++){ var G=Grids[i]; if(G&&G!=this&&G.J6==this&&G.EditMode&&G.EndEdit(G.FRow,G.FCol,true)==-1){ if(event)CancelEvent(event); return false;}} if(event&&this.ActionValidate&&!this.ActionValidate())return false; if(!Grids.OnSave||!Grids.OnSave(this)){ if(AS.Url){ this.LB("Save");this.Debug(4,"Saving data to server to ",this.NN(AS)); var T=this,Bb=this.GetXmlData(); if(Grids.OnUpload){var Dh=Grids.OnUpload(this,Bb);if(Dh!=null)Bb=Dh;} this.NT="Upload"; this.AjaxCall(AS,Bb,function(NU){ if(NU>=0)T.AcceptChanges(); T.HideMessage(); T.ShowPages(); T.NT=null; if(Grids.OnAfterSave)Grids.OnAfterSave(T,NU); T.Debug(4,"Data saved to server sucessfully in ",T.Nf("Save")," ms");}); return;} else if(AS.Tag){ var AI=this.NP(AS.Tag); if(AI){ this.NQ(); var Bb=this.GetXmlData(); if(Grids.OnUpload){var Dh=Grids.OnUpload(this,Bb);if(Dh!=null)Bb=Dh;} AI.value=AS.Xml-0?Bb:Bb.replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/>/g,"&gt;");} var CE=this.Nh(AI); if(CE){ CE.method="POST"; if(this.Ni&&!this.Ni(event)){this.HideMessage();return false;} if(!event)CE.submit(); return true;} else{ this.Debug(1,"Cannot submit data to server, no <form> tag found");}} else if(AS.Data){ this.NM(AS.Data); var NL=this.IO; if(NL&&NL.Message)alert(NL.Message); if(!NL||NL.Result==null||NL.Result>=0)this.AcceptChanges();}} this.HideMessage();}; _7h.prototype.ActionSave=function(){ if(!this.NX())return false; return this.Save();}; function _7Aa(){ for(var i=0;i<Grids.length;i++){ var G=Grids[i]; if(G&&!G.KE&&G.Source.Check.Url&&G.Source.Check.Interval&&!G.Loading&&!G.Rendering&&G.Nj!=null){ if(++G.Nj>=G.Source.Check.Interval){ G.Nj=0; G.CheckForUpdates();}}}}; _7h.prototype.CheckForUpdates=function(AT){ if(this.Nk)return; var T=this,AS=this.Source.Check; this.Nk=1; var NO="<Grid><IO"+(this.Source.Session!=null?" Session='"+this.Source.Session+"'":"")+"/></Grid>"; this.AjaxCall(AS,NO,function(NU){ if(NU<0){ if(confirm(T.GetAlert("ErrCheck")))T.Source.Check.Interval=0;} T.Nk=0; if(AT)AT(NU);});}; _7h.prototype.Ae=function(Ad,Nl){ if(Nl==null)Nl=this.Cache; if(Nl==3||!Ad||(Ad+"").search(/\#|^javascript\:/i)>=0)return Ad; var Dh=Nl==1?Component.Version.replace(/\s/g,""):(Nl==2?this.CacheVersion:Grids.CacheVersion); if(Dh==null)return Ad; return Ad+((Ad+"").indexOf('?')>=0?"&":"?")+"_tgc="+escape(Dh);}; _7h.prototype.Nm=function(Nn){ var Update=Nn["Update"]; if(Update==null)Update=1; function No(row,Np){ if(!T.Copying)return; var Nq=row.id; for(var AP=T.GetFirst();AP;AP=T.GetNext(AP))if(AP.Copy==Np)AP.Copy=Nq; if(T.Cols[T.Nr])T.RefreshCell(row,T.Nr);}; function Ns(AP,Es,Gx){ if(AP[Gx]){ var Nt=AP[Gx]; Nt=(Nt+"").split(","); Nt=(Nt[0]<<16)+(Nt[1]<<8)+(Nt[2]-0); Es[Gx]=Nt; return 1;} return 0;}; var Nu=["CanEdit","CanFocus","CanDelete","CanSelect","CanExpand","Selected","Expanded"]; var Nv=["CanEdit","CanFocus","Error","Selected","Defaults","Suggest","EditEnum","EnumKeys","Tip"]; var Nw=["ClassOuter","ClassInner","HtmlPrefix","HtmlPostfix","Visible","ToolTip","Error","Type","Format","EditFormat","EditMask","ResultMask","IntFormat","Button","ButtonText","Enum"]; var Kg=this.AutoUpdate,T=this; this.AutoUpdate=false; var Nx=this.EditMode,Af=0,AL=new Array(); for(var AP=Nn.firstChild;AP;AP=AP.nextSibling){ var Es,Au=AP.Parent; if(Au!=null)Au=(Au-0)>=0?_7k(this.XB,Au-0):this.GetRowById(Au); if(AP.Added||AP.Moved){ var Ny=AP.Next?this.GetRowById(AP.Next):null;if(Ny&&Au&&Ny.parentNode!=Au)Ny=null; var LT=AP.Prev?this.GetRowById(AP.Prev):null;if(LT&&Au&&LT.parentNode!=Au)LT=null; if(AP.Next&&AP.Prev&&LT&&!Ny)Ny=LT.nextSibling;} if(AP.Added){ if(Au&&Au.State<2)continue; if(AP.id){ var KT=this.GetRowById(AP.id); if(KT){ if(KT.Added){ this.Nz(KT); No(KT,AP.id);} else{}}} Es=this.AddRow(Au,Ny,0,AP.id?1:0,AP.Def,null,1); if(Es){ if(AP.id)Es.id=AP.id; for(var i=0;i<Nu.length;i++)if(AP[Nu[i]]!=null)Es[Nu[i]]=AP[Nu[i]]; for(var BD in this.Cols){ if(AP[BD])Es[BD]=AP[BD]; for(var i=0;i<Nw.length;i++)if(AP[BD+Nw[i]]!=null)Es[BD+Nw[i]]=AP[BD+Nw[i]]; for(var i=0;i<Nv.length;i++)if(AP[BD+Nv[i]]!=null)Es[BD+Nv[i]]=AP[BD+Nv[i]]; Ns(AP,Es,BD+"Color");} Ns(AP,Es,"Color"); if(AP.Copy){ var H4=this.GetRowById(AP.Copy); while(H4&&H4.Copy)H4=this.GetRowById(H4); if(H4){ Es.Copy=H4.id; Es.Count=H4.State>=2?H4.childNodes.length:H4.Count; Es.State=0;}} Es.Def=AP.Def?AP.Def:Es.Def.Name; this.N0(Es,true); var N1=Au&&!Au.Expanded&&!Au.Page&&Au.firstChild==Es&&Au.lastChild==Es; if(N1){Es.Visible=1;this.Expand(Au);Es.Visible=0;} this.ShowRow(Es,0,0,1);N2=1; if(N1)this.Collapse(Au); this.N3(Es,1);}} else{ Es=this.GetRowById(AP.id); if(Es){ if(AP.Deleted){if(this.DeleteRowT)this.DeleteRowT(Es,2);} else{ if(AP.Moved){ this.N4(Es,Au,Ny,true);} if(AP.Selected!=null&&AP.Selected!=Es.Selected){ if(AP.Selected==2)Es.Selected=2; else this.SelectRow(Es);} if(AP.CanSelect!=null){ Es.CanSelect=AP.CanSelect; this.RefreshCell(Es,"Panel");} if(AP.Expanded!=null&&AP.Expanded!=Es.Expanded){ if(AP.Expanded)this.Expand(Es); else this.Collapse(Es);} if(AP.N5!=null){ Es.N5=AP.N5; this.Li(Es);} if(AP.CanDelete!=null){ Es.CanDelete=AP.CanDelete; this.RefreshCell(Es,"Panel");} var color=0; if(AP.CanEdit!=null){ Es.CanEdit=AP.CanEdit; color=1;} if(AP.CanFocus!=null){ Es.CanFocus=AP.CanFocus; color=1;} if(AP.Color!=null){ Ns(AP,Es,"Color"); color=1;} if(color)this.ColorRow(Es); for(var BD in this.Cols){ var Dh=AP[BD],Hw=0,BY=0; for(var i=0;i<Nw.length;i++)if(AP[BD+Nw[i]]!=null){Hw=1;Es[BD+Nw[i]]=AP[BD+Nw[i]];} for(var i=0;i<Nv.length;i++)if(AP[BD+Nv[i]]!=null){BY=1;Es[BD+Nv[i]]=AP[BD+Nv[i]];} BY|=Ns(AP,Es,BD+"Color"); if(BY)this.ColorCell(Es,BD); if(Dh!=null||Hw){ if(Nx&&this.FRow==Es&&this.FCol==BD){this.EndEdit(Es,BD);Af=1;} if(Dh!=null)this.SetString(Es,BD,Dh+""); this.RefreshCell(Es,BD); if(Af){this.StartEdit(Es,BD);Af=0;}}} Es.Def=AP.Def?AP.Def:Es.Def.Name; this.N0(Es,true); if(AP.NewId){ Es.id=AP.NewId; No(Es,AP.id);}}}}; if(Es){ AL[AL.length]=Es; if(Grids.OnUpdateRow)Grids.OnUpdateRow(this,Es,AP);}} var Lf=this.Cols[this.MainCol],N6=this.N7,N8=this.N9,OA=this.OB,N2=0,OC=Update&4&&(N6||N8||OA||Grids.OnRowFilter); for(j=0;j<AL.length;j++){ var Es=AL[j]; if(Update&1)this.AcceptChanges(Es); if(OC){ this.Recalculate(Es,null,0); var R=new Array(); for(var Nu=Es;!Nu.Page;Nu=Nu.parentNode)R[R.length]=Nu; for(var i=R.length-1;i>=0;i--){ var Nu=R[i]; if(Nu.Kind=="Data"&&(!Nu.Deleted||this.ShowDeleted)){ var Cq=Get(Nu,"CanFilter")&1&&(N6&&!N6(Nu)||N8&&!N8(Nu)||OA&&OA(Nu)); if(Grids.OnRowFilter)Cq=!Grids.OnRowFilter(this,Nu,!Cq); if(Cq){if(!Nu.Filtered)this.HideRow(Nu,false);} else if(Nu.Filtered){this.ShowRow(Nu,0,0,1);N2=1;} Nu.Filtered=Cq; if(Cq)break;}} if(this.FilterEmpty){ for(var Nu=Es;!Nu.Page;Nu=Nu.parentNode){ if(Nu.Filtered)continue; if((Get(Nu,"CanFilter")&2||Nu.LN)&&!this.HasChildren(Nu)){ if(!Nu.Deleted||this.ShowDeleted)this.HideRow(Nu); Nu.Filtered=1;}}}} if(Update&2)this.Recalculate(Es,null,1); if(Update&8&&this.SearchAction){ var Af=this.SearchType;if(Af==null)Af=176; var CE=this.OD(this.SearchExpression,Af); var Method=CE[1];CE=CE[0]; switch(this.SearchAction){ case "Select": if(!Is(Es,"CanSelect"))break; var OE=CE(Es); OE=typeof(OE)=="string"||OE>0; if(Es.Selected&&!OE)this.SelectRow(Es); else if(!Es.Selected&&OE){ this.SelectRow(Es); if(Af&8)this.ExpandParents(Es);} break; case "Mark": var Color=this.f["Found"+this.OF]; if(Af&1&&Method==1){ var OE=CE(Es); while(OE&&typeof(OE)=="string"){ Es[OE+"MarkColor"]=Color; if(this.ColorClasses&4){ Es[OE+"MarkClass"]="Found"+this.OF; this.RefreshCell(Es,OE);} else this.ColorCell(Es,OE); if(Af&8)this.ExpandParents(Es); OE=CE(Es,OE);}} else{ var OE=CE(Es)>0; if(OE){ Es.OG=Color; if(this.ColorClasses&4){ Es.OH="Found"+this.OF; this.RefreshRow(Es);} else this.ColorRow(Es); if(Af&8)this.ExpandParents(Es);}}; break;}}} this.AutoUpdate=Kg; if(N2)this.Update();}; var _7Ab=/\w+|\'[^\']*\'|\"[^\"]*\"|\/?\>[\s\S]*/g; var _7Ac=/^\w+(\s+(\w+\s*\=\s*(\'[^\']*\'|\"[^\"]*\")\s*)*)?\/?\>[\s\S]*$/; var _7Ad=/[^\s\/\>]/; _7h.prototype.OI=function(Dh){ if(Dh.indexOf('&#')>=0){ var AJ=Dh.match(/\&\#x\w*\;/gi); if(AJ)for(var i=0;i<AJ.length;i++)Dh=Dh.replace(AJ[i],String.fromCharCode(parseInt(AJ[i].slice(3),16))); var AJ=Dh.match(/\&\#\w*\;/gi); if(AJ)for(var i=0;i<AJ.length;i++)Dh=Dh.replace(AJ[i],String.fromCharCode(parseInt(AJ[i].slice(2),10)));} return Dh.replace(/\&lt\;/g,"<").replace(/\&gt\;/g,">").replace(/\&quot\;/g,"\"").replace(/\&apos\;/g,"'").replace(/\&amp\;/g,"&");}; _7h.prototype.OJ=function(OK,Ak,CA){ var OL=0,i,j,Au; for(Au=0;Ak.charCodeAt(Au)<=32;Au++); if(Ak.charAt(Au)!=Ak.charAt(Au+1)&&!Grids.AK[Ak.charCodeAt(Au+1)]){ OL=Ak.charAt(Au); Au++;} var AJ=Ak.split(Ak.charAt(Au)),OM=AJ.length; var AM=this.Par[AJ[1]],Au=2; if(AM)for(i=0;i<AM.length;i++){ var ON=AJ[Au++]; OK[AM[i]]=(ON-0)+""==ON?ON-0:ON;} if(OM>Au){ AM=this.Par[AJ[Au++]]; if(!AM)return; var Em=AJ[Au++]-0,OO=AM.length,AP; for(j=0;j<Au;j++)AJ[j]=null; if(_7P){ if(!OO){ AJ=new Array(); for(j=0;j<Em;j++)AJ[Au++]="<BR>";} else if(OL){ for(var OM=AJ.length;Au<OM;Au++){ var AN=AJ[Au].split(OL),GM=AN.length,Ey=1; while(Ey<GM){ AN[Ey]="<BR "+AM[0]+"=\""+AN[Ey]+"\"";Ey++; for(i=1;i<OO;i++){AN[Ey]=" "+AM[i]+"=\""+(AN[Ey]+"").replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\"/g,"&quot;")+"\"";Ey++;} AN[Ey-1]+=">";} AJ[Au]=AN.join("");}} else for(j=0;j<Em;j++){ AJ[Au]="<BR "+AM[0]+"=\""+AJ[Au]+"\"";Au++; for(i=1;i<OO;i++){AJ[Au]=" "+AM[i]+"=\""+(AJ[Au]+"").replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\"/g,"&quot;")+"\"";Au++;} AJ[Au-1]+=">";} while(Au<AJ.length)AJ[Au++]=null; OK.innerHTML=AJ.join("");} else if(Em){ var DU=_7i.createElement(CA),AP=DU; DU.parentNode=OK; OK.firstChild=DU; for(j=1;j<Em;j++){ AP=_7i.createElement(CA); AP.parentNode=OK; DU.nextSibling=AP; AP.previousSibling=DU; DU=AP;} OK.childNodes.length=Em; OK.lastChild=AP; AP=OK.firstChild; if(OL&&OO){ for(var OM=AJ.length;Au<OM;Au++){ var AN=AJ[Au].split(OL),GM=AN.length,Ey=1; while(Ey<GM){ for(i=0;i<OO;i++)AP[AM[i]]=AN[Ey++]; AP=AP.nextSibling;}}} else if(OO)for(j=0;j<Em;j++){ for(i=0;i<OO;i++)AP[AM[i]]=AJ[Au++]; AP=AP.nextSibling;}}}}; _7h.prototype.OP=function(AL,AN,AJ){ var name=this.OQ(AN,"N"),GM=AN.length-1; for(var j=1;j<GM;j+=2){ var Es=AN[j],Dh=AN[j+1].slice(1,-1); if(Es!='N'){ if(Dh.indexOf('&')>=0)Dh=this.OI(Dh); if(Es=='V')Es=""; AL[name+Es]=(Dh-0)+""==Dh?Dh-0:Dh;}} if(AN[GM].charCodeAt(0)!=47){ if(AJ[AJ.Pos].charCodeAt(0)==47)AJ.Pos++; else this.OR(_7i.createElement(),AN,AJ);}}; _7h.prototype.OR=function(AL,AN,AJ){ var GM=AN.length-1; for(var j=1;j<GM;j+=2){ var Dh=AN[j+1].slice(1,-1); if(Dh.indexOf('&')>=0)Dh=this.OI(Dh); if(AL[AN[j]]&&typeof(AL[AN[j]])=="function"){ this.Debug(2,"Wrong custom attribute name, probably in <Cfg> tag, conflicts with method name: ",AN[j]); continue;} AL[AN[j]]=(Dh-0)+""==Dh?Dh-0:Dh;} var B3=AN[GM]; if(B3.charCodeAt(0)==47||!AJ)return; if(B3.length>10||B3.search(_7Ad)>=0)this.OJ(AL,B3.slice(1)); var OM=AJ.length; while(AJ.Pos<OM){ var AN=this.OS(AJ);if(!AN)return; if(AN[0]=="U"){this.OP(AL,AN,AJ);continue;} if(AL.appendChild){ var BC=null,id=this.OQ(AN,"id"); if(id)for(var AP=AL.firstChild;AP;AP=AP.nextSibling)if(AP.id==id){BC=AP;break;} if(!BC){ if(this.NT){ if(this.NT=="Upload"||this.NT=="Check")this.Debug(2,this.NT+": data in server response ",this.NT+"_Url"," contain new fixed row '"+(id?id:"???")+"' definition, it is not possible to add new fixed rows by this response"); else this.Debug(2,"ReloadBody: data in ","Body_Url"," server response contain new fixed row '"+(id?id:"???")+"' definition, it is not possible to add new fixed rows via ReloadBody, define the fixed row in Layout xml only"); this.OR({},AN,AJ); continue;} BC=_7i.createElement("I");} if(AN[0]!="I")BC.Kind=AN[0]; AL.appendChild(BC);} else{ if(!AL.Children)AL.Children=new Array(); var BC=new Object(); AL.Children[AL.Children.length]=BC;}; this.OR(BC,AN,AJ);}}; _7h.prototype.OQ=function(AN,Attr){ var GM=AN.length-1; for(var j=1;j<GM;j+=2)if(AN[j]==Attr){ var Dh=AN[j+1].slice(1,-1); if(Dh.indexOf('&')>=0)Dh=this.OI(Dh); return(Dh-0)+""==Dh?Dh-0:Dh;}}; _7h.prototype.NK=function(Xml){ if(typeof(Xml)!="string"){ Xml=Xml.xml; if(!Xml)return;} this.IO=new Object; var AJ=Xml.match(/\<IO(\s+\w+\s*\=\s*(\'[^\']*\'|\"[^\"]*\"))*\s*\/?\>/g); if(!AJ)return; var AN=AJ[0].match(_7Ab); this.OR(this.IO,AN);}; _7h.prototype.OS=function(AJ){ var B3=AJ[AJ.Pos++]; if(B3.charCodeAt(0)==47)return null; while(1){ var AN=B3.match(_7Ab); if(!AN){ if(this.DebugFlags["problem"]){ this.Debug(1,"Invalid structure in XML data: "); this.Debug(35,"<"+B3);} return null;} var F8=AN[AN.length-1].charCodeAt(0);if(F8==47||F8==62){ if(this.DebugFlags["problem"]&&B3.search(_7Ac)<0){ this.Debug(1,"Invalid node structure in XML data: "); this.Debug(35,"<"+B3); var B3="<"+AN[0]+" "; for(var i=1;i<AN.length-2;i+=2)B3+=AN[i]+"="+AN[i+1]+" "; B3+=AN[AN.length-1]; this.Debug(1,"The invalid XML node structure was parsed to: "); this.Debug(35,B3);} return AN;} if(!AJ[AJ.Pos]){ if(this.DebugFlags["problem"]){ this.Debug(1,"Missing closing tag in XML data: "); this.Debug(35,"<"+B3);} return null;} B3+='<'+AJ[AJ.Pos++];}}; _7h.prototype.NM=function(Xml,NG,page){ if(typeof(Xml)!="string"){ var X=Xml.xml; if(!X){ if(window.XMLSerializer)X=(new XMLSerializer).serializeToString(Xml); if(!X)return false;} Xml=X;} if(this.CacheData&&NG==this.Source.Data)this.CacheData=Xml; this.IO=new Object; Xml=Xml.replace(/<!--[\s\S]*?-->/g,""); var Md=Xml.search(/\<Grid\>/); if(Md<0){ Md=Xml.search(/\&lt\;Grid(\>|\&gt\;)/); if(Md<0){ this.Debug(1,"No tag <Grid> found in XML data from "+this.NN(NG)); if(this.DebugFlags["ioerror"]&&!NG.Debug["in"])this.AV(NG,Xml," XML:"); if(!Grids.OnDataError||!Grids.OnDataError(this,-4,Xml,NG,page)){ if(NG.AlertError)alert("TreeeGrid communication error \r\n\r\nURL: "+NG.Url+" \r\n\r\n"+Xml);} return false;} Xml=this.OI(Md?Xml.slice(Md):Xml); Xml=Xml.replace(/\<\!\-\-([^\-]|\-[^\-]|\-+[^\-\>])*\-{2,}\>/g,""); Md=0;} Xml=Xml.slice(Md+1); var AJ=Xml.split('<'),OM=AJ.length; AJ.Pos=1; while(AJ.Pos<OM){ var AN=this.OS(AJ); if(!AN){ var B3=AJ[AJ.Pos-1].slice(1); if(B3.indexOf(OT)==0)continue; if(B3.indexOf("Grid")==0)break; this.Debug(1,"Missing enclosing tag </Grid> in the root level in XML data from "+this.NN(NG)); if(this.DebugFlags["ioerror"]&&!NG.Debug["in"])this.AV(NG,"<"+Xml," XML:"); return false;} var GM=AN.length-1; var OT=AN[0]; if(OT=="IO"){this.OR(this.IO,AN,AJ);continue;} if(OT=="Cfg"){this.OR(this,AN,AJ);continue;} if(OT=="Actions"){ for(var i=1;i<GM;i+=2){ var Es=AN[i],Dh=AN[i+1].slice(1,-1); if(Es.indexOf("KeyCodes")==0){ Dh=Dh.replace(/\s/g,"").split(","); for(var j=0;j<Dh.length;j++){ var x=Dh[j].split("="); if(x.length!=2)continue; this.l[x[1]]=x[0];}} else if(Es.search(/Parent|Size/)>=0)this.Mouse[Es]=Dh; else this.Actions[Es]=Dh;} continue;} if(OT=="Colors"){this.OR(this.g,AN,AJ);continue;} if(OT=="MenuCfg"){this.OR(this.MenuCfg,AN,AJ);continue;} if(OT=="Pager"){this.OR(this.Pager,AN,AJ);continue;} if(OT=="Def"){ if(AN[GM].charCodeAt(0)==47)continue; var X=this.Def; while(AJ.Pos<OM){ var AN=this.OS(AJ);if(!AN)break; var a=this.OQ(AN,"Name"); if(a){ var AS=X[a]; if(!AS){AS=new Object;X[a]=AS;} this.OR(AS,AN,AJ); if(AS.Def==null&&a!='R'&&a!='C')AS.Def="R"; AS.OU=0;}} continue;} if(OT=="Panel"){ var C=this.Cols[OT]; if(!C){ C=new _7e();C.Index=OT;this.Cols[OT]=C; var Jf=this.ColNames[0]; if(Jf.length&&Jf[0]!=OT){ for(var i=Jf.length;i>=0;i--){Jf[i]=Jf[i-1];Jf[i].Pos++;}} Jf[0]=OT;} this.OR(C,AN,AJ); C.Pos=0; C.Sec=0; C.Name=C.Index; continue;} var JW=-1; if(OT=="LeftCols")JW=0; else if(OT=="Cols")JW=1; else if(OT=="RightCols")JW=2; if(JW>=0){ if(AN[GM].charCodeAt(0)==47)continue; var Jf=this.ColNames[JW]; while(AJ.Pos<OM){ var AN=this.OS(AJ);if(!AN)break; var a=this.OQ(AN,"Name"); if(a){ var C=this.Cols[a]; if(!C){ C=new _7e(); if(this.NT){ if(this.NT=="Upload"||this.NT=="Check")this.Debug(2,this.NT+": data in server response ",this.NT+"_Url"," contain new column '"+a+"' definition, it is not possible to add new columns by this response"); else this.Debug(2,"ReloadBody: data in ","Body_Url"," server response contain contain new column '"+a+"' definition, it is not possible to add new columns via ReloadBody, define columns in Layout.xml only");} else{ C.Index=a; this.Cols[C.Index]=C; var AS=this.Def["C"];if(AS)for(var j in AS)C[j]=AS[j]; C.Pos=Jf.length; Jf[Jf.length]=C.Index; C.Sec=JW; C.Name=C.Index;}} this.OR(C,AN,AJ); C.JZ=C.Width==null;}} continue;} if(OT=="Par"){ if(AN[GM].charCodeAt(0)==47)continue; while(AJ.Pos<OM){ var AN=this.OS(AJ);if(!AN)break; var AM=new Object();this.OR(AM,AN,AJ); var a=AM["Name"],F8=AM["List"]; if(a)this.Par[a]=F8?F8.split(","):new Array();} continue;} if(OT=="Changes"){ var AL=_7i.createElement("B"); var OV=this.NT;this.NT=null; this.OR(AL,AN,AJ); this.NT=OV;; this.Nm(AL); continue;} if(OT=="Lang"){ if(AN[GM].charCodeAt(0)==47)continue; while(AJ.Pos<OM){ var AN=this.OS(AJ);if(!AN)break; var X=this.Lang[AN[0]]; if(!X){X=new Object;this.Lang[AN[0]]=X;} this.OR(X,AN,AJ);} var OW=this.Lang.Format; var CE=["LongDayNames","ShortDayNames","Day2CharNames","Day1CharNames","DayNumbers","LongMonthNames","LongMonthNames2","ShortMonthNames","Quarters","Halves"]; for(var i=0;i<CE.length;i++)if(typeof(OW[CE[i]])=="string")OW[CE[i]]=OW[CE[i]].split(","); _7q=OW; continue;} if(OT=="Toolbar"){this.OR(this.Toolbar,AN,AJ);continue;} if(OT=="Header"){this.OR(this.Header,AN,AJ);continue;} if(OT=="Root"){this.OR(this.Root,AN,AJ);continue;} if(OT=="Head"){this.OR(this.XH,AN,AJ);continue;} if(OT=="Foot"){this.OR(this.XF,AN,AJ);continue;} if(OT=="Filter"){if(!this.Filter)this.Filter=_7i.createElement("U");this.OR(this.Filter,AN,AJ);continue;} if(OT=="Group"){if(!this.Group)this.Group=_7i.createElement("U");this.OR(this.Group,AN,AJ);continue;} if(OT=="Search"){if(!this.OX)this.OX=_7i.createElement("U");this.OR(this.OX,AN,AJ);continue;} if(OT=="Solid"){ if(this.NT){ if(this.NT=="Upload"||this.NT=="Check")this.Debug(2,this.NT+": data in server response ",this.NT+"_Url"," contain Space row(s) definition, it is not possible to update solid Space rows directly, use <Changes> tag instead"); else this.Debug(2,"ReloadBody: data in ","Body_Url"," server response contain Space row(s) definition, it is not possible to update Space rows via ReloadBody, define the Space rows in Layout xml only"); this.OR({},AN,AJ);} else{ var AP=this.XH.lastChild; this.OR(this.XH,AN,AJ); for(AP=AP?AP.nextSibling:this.XH.firstChild;AP;AP=AP.nextSibling)if(!AP.Kind)AP.Kind="Space";}; continue;} if(OT=="Body"){ var XB=this.XB,AM=XB; if(page){ if(page.Pos==null&&!page.id)page.Pos=this.GetPageNum(page); while(AJ.Pos<OM){ var AN=this.OS(AJ); if(!AN){ if(AM==XB)break; if(!AM)AM=XB; else AM=AM.parentNode; continue;} var GM=AN.length-1,BC=null; var id=this.OQ(AN,"id"),Rows=this.OQ(AN,"Rows"),Pos=this.OQ(AN,"Pos"); if(id&&(id==page.id||id==page.Copy)||Rows&&Rows==page.Rows||Pos!=null&&Pos==page.Pos)BC=page; if(!BC)BC=_7i.createElement("B"); this.OR(BC,AN,AJ); if(AN[GM].charCodeAt(0)!=47)AM=BC;}} else if(this.NT=="Upload"||this.NT=="Check"){ this.Debug(2,this.NT+": data in server response ",this.NT+"_Url"," contain <Body> rows definition, it is not possible to update rows directly, use <Changes> tag instead"); this.OR({},AN,AJ);} else{ if(AN[GM].length>10||AN[GM].search(_7Ad)>=0)this.OJ(XB,AN[GM].slice(1)); while(AJ.Pos<OM){ var AN=this.OS(AJ); if(!AN){ if(AM==XB)break; AM=AM.parentNode; continue;} var GM=AN.length-1; if(AN[0]=="U"){this.OP(AL,AN,AJ);continue;} AL=_7i.createElement(AN[0]); AM.appendChild(AL); for(var j=1;j<GM;j+=2){ var Dh=AN[j+1].slice(1,-1); if(Dh.indexOf('&')>=0)Dh=this.OI(Dh); AL[AN[j]]=(Dh-0)+""==Dh?Dh-0:Dh;} var B3=AN[GM]; if(B3.charCodeAt(0)!=47){ AM=AL; if(B3.length>10||B3.search(_7Ad)>=0){this.OJ(AL,B3.slice(1));}}} var OY=this.XB.firstChild; if(OY&&OY.tagName=="I"){ AL=_7i.createElement("B"); this.XB.insertBefore(AL,OY); while(OY){ var OZ=OY.nextSibling; AL.appendChild(OY); OY=OZ;}}}; continue;} this.OR({},AN,AJ); this.Debug(2,"Unknown root tag '",OT,"' in XML data from ",this.NN(NG));} if(this.IO.Session!=null)this.SetSession(this.IO.Session); if(NG&&NG.Bonus){ this.Debug(4,"Loading XML data from ",NG.Name+"_Bonus"); if(NG.Debug["in"])this.AV(NG,NG.Bonus,"a bonus XML added:"); this.NM(NG.Bonus,{Name:NG.Name,Bonus:""});} return true;}; _7h.prototype.AddDataFromServer=function(xml){ this.NM(xml,{}); this.Update();}; _7h.prototype.SetSession=function(Oa){ if(Oa=="")Oa=null; this.Source.Session=Oa; if(Oa==null)Oa=""; if(this.SaveSession==1&&Grids.Jo)Grids.Jo(this.id+"&"+(this.SessionId?this.SessionId:"Session"),Oa?escape(Oa):""); else{ var Ob=this.SaveSession?this.SaveSession:this.id+"_"+(this.SessionId?this.SessionId:"Session"); var E=GetElem(Ob); if(!E){ E=document.createElement("input"); E.type="hidden"; E.id=Ob; B2(E);} E.value=Oa;}}; _7h.prototype.J3=function(Ep){ if(typeof(Ep)!="string"||Ep.search(/[\&\"\<\>\n]/)<0)return Ep; return Ep.replace(/\&/g,"&amp;").replace(/\"/g,"&quot;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\n/g,"&#x0A;");}; _7h.prototype.Oc=function(row){ var AP=row.nextSibling; while(AP&&AP.Deleted)AP=AP.nextSibling; return AP;}; _7h.prototype.Od=function(row){ var AP=row.previousSibling; while(AP&&AP.Deleted)AP=AP.previousSibling; return AP;}; _7h.prototype.Jn=function(row){ var S="",C=this.Cols; if(row.Deleted)S="D"; else if(row.Added){ var Gy=row.Def,GP=row.parentNode,next=this.Oc(row),prev=this.Od(row),Oe=Get(row,"Par"); S="A&"+(Oe?Oe:"")+"&"+Gy.Name+"&"+(GP.id?GP.id:GP.Pos!=null?GP.Pos:"")+"&"+(next&&next.id?next.id:"")+"&"+(row.Copy?row.Copy:""); for(var BD in C){ if(row[BD]!=null&&row[BD]!=Gy[BD]&&!C[BD].Formula&&(!row.Calculated||!row[BD+"Formula"])&&typeof(row[BD])!="function"){ S+="&"+BD+"&"+escape(row[BD]);}}} else if(row.Changed||row.Moved){ if(row.Changed)S="C"; if(row.Moved){ var Gy=row.Def,GP=row.parentNode,next=this.Oc(row),prev=this.Od(row); S="M&"+row.Moved+"&"+(GP.id?GP.id:GP.Pos!=null?GP.Pos:"")+"&"+(next&&next.id?next.id:"")+"'";} if(row.Changed){ if(row.Cells){ for(var i=0;i<row.Cells.length;i++)if(row[row.Cells[i]+"Changed"])S+="&"+BD+"&"+escape(row[row.Cells[i]]);} else{ for(var BD in C)if(row[BD+"Changed"])S+="&"+BD+"&"+escape(row[BD]);}}} return S;}; _7h.prototype.J4=function(row,F6,Bb){ if(this.DateStrings&&this.GetType(row,F6)=="Date"){ if(!Bb)return ""; var AS=DateToString(Bb,this.DateStrings==2?"yyyy-MM-dd HH:mm:ss":(this.DateStrings==1?null:this.DateStrings),this.G2(row,F6)?this.Lang.Format.ValueSeparator+this.Lang.Format.RangeSeparator:""); return AS;} return Bb;}; _7h.prototype.Of=function(row,BA,Og,Oh,Oi){ var S="",C=this.Cols,Jz=BA=="dtd",T=this; if(Is(row,"NoUpload"))return ""; function Oj(row,BD){ if(BD=="id")return; var Cp=Oh&1?Get(row,BD):row[BD]; if(Cp==null)Cp=""; Cp=T.J4(row,BD,Cp); if(Jz)S+="<U N='"+BD+"' V=\""+T.J3(Cp)+"\"/>"; else S+=" "+BD+"=\""+T.J3(Cp)+"\"";}; function Ok(row){ if(!Oi)return ""; var S=""; for(var i=0;i<Oi.length;i++){ var BD=Oi[i],Cp=Oh&1?Get(row,BD):row[BD]; if(Cp==null)continue; S+=" "+BD+"=\""+T.J3(Cp)+"\"";} return S;}; if(row.Deleted){ S="<I id=\""+this.J3(row.id)+"\" Deleted='1'"+(row.Added?" Added='1'":"")+Ok(row); if(Oh&2)for(var BD in C)Oj(row,BD); S+="/>";} else if(row.Added){ var Gy=row.Def,GP=row.parentNode,next=this.Oc(row),prev=this.Od(row),Oe=Get(row,"Par"); S="<I id=\""+this.J3(row.id)+"\" Added='1'"+(Oe?" Par='"+Oe+"'":"")+" Def='"+Gy.Name+"' Parent=\""+(GP.id?this.J3(GP.id):GP.Pos!=null?GP.Pos:"")+"\" Next=\""+(next&&next.id?this.J3(next.id):"")+"\" Prev=\""+(prev&&prev.id?this.J3(prev.id):"")+"\""; if(Og&&row.Selected)S+=" Selected='1'"; if(row.Copy)S+=" Copy='"+row.Copy+"'"; S+=Ok(row); if(Jz)S+=">"; if(this.Ol){ for(var i=0;i<this.Ol;i++){ var Es=this.IdNames[i]; if(row[Es]==null)row[Es]=Gy[Es]; if(Es!="Def")Oj(row,Es);}} for(var BD in C){ if(Oh&2||(Oh&1||row[BD]!=null&&(row[BD]!=Gy[BD]||!Gy[BD]))&&!this.Om[BD]&&(!C[BD].Formula&&(!row.Calculated||!row[BD+"Formula"]))){ Oj(row,BD);}} S+=Jz?"</I>":"/>";} else if(row.Changed||row.Moved){ S="<I id=\""+this.J3(row.id)+"\""; if(row.Changed)S+=" Changed='1'"; if(row.Moved){ var Gy=row.Def,GP=row.parentNode,next=this.Oc(row),prev=this.Od(row); S+=" Moved='"+row.Moved+"' Parent=\""+(GP.id?this.J3(GP.id):GP.Pos!=null?GP.Pos:"")+"\" Next=\""+(next&&next.id?this.J3(next.id):"")+"\" Prev=\""+(prev&&prev.id?this.J3(prev.id):"")+"\"";} if(Og&&row.Selected)S+=" Selected='1'"; S+=Ok(row); if(Jz)S+=">"; if(row.Changed){ if(row.Cells){ for(var i=0;i<row.Cells.length;i++)if(row[row.Cells[i]+"Changed"]||Oh&2)Oj(row,row.Cells[i]);} else{ for(var BD in C)if(row[BD+"Changed"]||Oh&2)Oj(row,BD);}} if(this.Ol&&row[this.Nr+"Changed"]&&!this.Cols[this.Nr])Oj(row,this.Nr); S+=Jz?"</I>":"/>";} else if(Og&&row.Selected){ S="<I id=\""+this.J3(row.id)+"\" Selected='1'"+Ok(row); if(Oh&2)for(var BD in C)Oj(row,BD); S+="/>";} return S;}; _7h.prototype.On=function(row,BA,Og,Oh,Oi){ var AJ=new Array(),Au=0; for(var AP=row.firstChild;AP;AP=AP.nextSibling){ AJ[Au++]=this.Of(AP,BA,Og,Oh,Oi); AJ[Au++]=this.On(AP,BA,Og,Oh,Oi);} return AJ.join("");}; _7h.prototype.HasChanges=function(row){ var DG=0; if(!row){ var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++)if(CE[i].Kind!="Filter")DG|=this.HasChanges(CE[i]); for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)DG|=this.HasChanges(AP); for(var Ey=this.XB.firstChild;Ey;Ey=Ey.nextSibling)for(var AP=Ey.firstChild;AP;AP=AP.nextSibling)DG|=this.HasChanges(AP);} else{ if(row.NoUpload-0||row.Def&&row.Def.NoUpload-0)return 0; for(var AP=row.firstChild;AP;AP=AP.nextSibling)DG|=this.HasChanges(AP); if(row.Added||row.Deleted||row.Changed||row.Moved)DG|=1; if(row.Selected)DG|=2;}; if(this.SaveSelected)DG&=~2; if(this.SaveValues)DG&=~1; return DG;}; _7h.prototype.GetChanges=function(row,type,Oh,Oi){ var Cq=this.Source.Upload.Format.toLowerCase(); var Oo="<IO"+(this.Source.Session!=null?" Session='"+this.Source.Session+"'":"")+"/>"; if(row)return "<Grid>"+Oo+"<Changes>"+this.Of(row,Cq,type==2,Oh,Oi)+"</Changes></Grid>"; var AJ=new Array(),Au=0; var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++)if(CE[i].Kind!="Filter")AJ[Au++]=this.Of(CE[i],Cq,type==2,Oh,Oi); for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)AJ[Au++]=this.Of(AP,Cq,type==2,Oh,Oi); for(var Ey=this.XB.firstChild;Ey;Ey=Ey.nextSibling)AJ[Au++]=this.On(Ey,Cq,type==2,Oh,Oi); return(type?"":"<Grid>"+Oo)+"<Changes>"+AJ.join("")+"</Changes>"+(type?"":"</Grid>");}; _7h.prototype.AcceptChanges=function(row,Op){ this.ClearUndo(); if(row){ if(row.Deleted){ if(row==this.FRow)this.FRow=null; this.DelRow(row);} else if(row.Added||row.Changed||row.Moved){ if(this.Ol){ var Oq=this.Cols["id"]; if(row.Changed){ var Ff=0,id=null,Af; for(var i=0;i<this.Ol;i++)if(row[this.IdNames[i]+"Changed"]){ if(!Ff){ id=row.id.split('$'); Ff=1; Af=id.length-this.Ol;} var x=Get(row,this.IdNames[i]); if(x==null)x=""; id[Af+i]=(x+"").replace(/\$/g,"_");} if(Ff){ row.id=id.join("$"); if(Oq)this.RefreshCell(row,"id");}} if(this.FullId&&(row.Changed&&Ff||row.Moved==2)){ var Em=this.Ol,T=this; if(row.Moved){ var a=row.id.split('$'),GP=row.parentNode,id=GP.id; if(!id)id=""; for(var i=a.length-Em;i<a.length;i++)id+="$"+a[i]; if(GP.Page)id=id.slice(1); row.id=id; if(Oq)T.RefreshCell(row,"id");} function Or(GP){ for(var AP=GP.firstChild;AP;AP=AP.nextSibling){ var a=AP.id.split('$'),id=GP.id; for(var i=a.length-Em;i<a.length;i++)id+="$"+a[i]; AP.id=id; if(Oq)T.RefreshCell(AP,"id"); if(AP.firstChild)Or(AP);}}; if(row.firstChild)Or(row);}} if(row.Changed){ var Hw=!(this.ColorClasses&1); if(row.Cells){ for(var i=0;i<row.Cells.length;i++)if(row[row.Cells[i]+"Changed"]){row[row.Cells[i]+"Changed"]=null;if(Hw)this.RefreshCell(row,row.Cells[i]);}} else{ for(var BD in this.Cols)if(row[BD+"Changed"]){row[BD+"Changed"]=null;if(Hw)this.RefreshCell(row,BD);}}} if(this.Ol&&(row.Changed||row.Moved)&&row[this.Nr+"Changed"])row[this.Nr+"Changed"]=null; row.Added=null; row.Changed=null; row.Moved=null; row.Copy=null; if(this.ColorClasses&1)this.RefreshRow(row); else this.ColorRow(row);} if(!Op&&this.RefreshDetail)this.RefreshDetail(); return;} var CE=this.GetFixedRows(),AP,Es,F8; for(AP=0;AP<CE.length;AP++)if(CE[AP].Kind!="Filter")this.AcceptChanges(CE[AP],1); for(AP=this.XS.firstChild;AP;AP=AP.nextSibling)this.AcceptChanges(AP,1); for(AP=this.GetFirst();AP;){ if(AP.Deleted){ Es=AP;F8=AP.Level; AP=this.GetNext(AP); if(F8!=null)while(AP&&AP.Level>F8)AP=this.GetNext(AP); this.AcceptChanges(Es,1);} else{ this.AcceptChanges(AP,1); AP=this.GetNext(AP);}} if(this.RefreshDetail)this.RefreshDetail();}; _7h.prototype.GetXmlData=function(type,Oi){ var Hd=""; if(type==null){type=this.Source.Upload.Type;Hd=this.Source.Upload.Flags;} if(!type&&!Hd)return this.GetChanges(); var FY; FY="changes,selected,body,data,all,settings,cookie,cfg,def,cols,other,lang,defaults,allcols,nodelete,noio,nogrid"; if(type&&type-0+""==type){ var Ak=type&7; type=this.Hf(type&~7,",,,settings,cfg,def,cols,,other,,lang,,cookie,,,,nogrid,noid"); if(Ak==3){type["changed"]=1;type["selected"]=1;} else type[["","changes","selected","","","","body","all"][Ak]]=1;} else type=this.Hc((type?type:"")+(Hd?","+Hd:""),FY); if(Oi==null)Oi=this.Source.Upload.Attrs; if(typeof(Oi)=="string")Oi=Oi.split(","); var Cq=this.Source.Upload.Format.toLowerCase(); var AJ=new Array(),Au=0,T=this; function Gw(Es,Dh){ if(typeof(Dh)=="boolean")Dh=Dh?1:0; else if(typeof(Dh)!="string"&&typeof(Dh)!="number")return ""; if(Es.charAt(0)=='_'){ if(Es.charAt(1)=='7')return ""; Es=Es.slice(1);} return " "+Es+"=\""+T.J3(Dh)+"\"";}; function Oj(Es,Dh){ if(accept&&(Es=="Added"||Es=="Deleted"||Es=="Moved"||Es=="Changed"||Es=="Parent"||Es=="Next"||Es=="Prev"))return; if(typeof(Dh)=="boolean")Dh=Dh?1:0; else if(typeof(Dh)!="string"&&typeof(Dh)!="number")return; if(Es.charAt(0)=='_'){ if(Es.charAt(1)=='7')return; Es=Es.slice(1);} AJ[Au++]=" "+Es+"=\""+T.J3(Dh)+"\"";}; function Os(Ot,AS){ var S="\n<"+Ot; for(var Es in AS)S+=Gw(Es,AS[Es]); AJ[Au++]=S+"/>";}; function Ou(Ot,AS,Ov){ if(accept&&AS.Deleted)return; AJ[Au++]="\n<"+Ot; if(AS.id)Oj("id",AS.id); if(AS.Def)Oj("Def",AS.Def.Name); if(Oi||Ow){ if(Oi)for(var Es=0;Es<Oi.length;Es++)Oj(Oi[Es],Oh&&AS.Def?Get(AS,Oi[Es]):AS[Oi[Es]]); if(Ow)Ox(AS);} else for(var Es in AS)if(!LM[Es])Oj(Es,Oh?Get(AS,Es):AS[Es]); if(!Ov)AJ[Au++]="/>";}; function Oy(AS){ if(!Oi)return; for(var Es=0;Es<Oi.length;Es++)Oj(Oi[Es],Oh&&AS.Def?Get(AS,Oi[Es]):AS[Oi[Es]]);}; function Oz(Ot,AS){ if(accept&&AS.Deleted)return; Ou(Ot,AS,1); AJ[Au++]=">"; for(var AP=AS.firstChild;AP;AP=AP.nextSibling)Oz(AP.tagName,AP); AJ[Au++]="\n</"+Ot+">";}; function Ox(AS){ for(var BD in T.Cols){ if(BD=="id")continue; var Cp=Oh&1?Get(AS,BD):AS[BD]; if(Cp==null)Cp=""; Cp=T.J4(AS,BD,Cp); AJ[Au++]=" "+BD+"=\""+T.J3(Cp)+"\"";}}; var LM=Grids.AH; if(!type["nogrid"])AJ[Au++]="<Grid>"; if(!type["noid"])AJ[Au++]="<IO"+(this.Source.Session!=null?" Session='"+this.Source.Session+"'":"")+"/>"; var Oh=type["defaults"]?1:0,accept=type["accepted"],Ow=type["allcols"]?2:0; if(type["changes"])AJ[Au++]=this.GetChanges(null,type["selected"]?2:1,Oh+Ow,Oi); if(type["selected"]&&!type["changes"]){ AJ[Au++]="\n<Changes>"; var CE=this.GetFixedRows(),Ow=type["allcols"]; for(var i=0;i<CE.length;i++)if(CE[i].Selected){AJ[Au++]="<I Selected='1'";Oj("id",CE[i].id);if(Ow)Ox(CE[i]);Oy(CE[i]);AJ[Au++]="/>";} for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Selected){AJ[Au++]="<I Selected='1'";Oj("id",AP.id);if(Ow)Ox(AP);Oy(AP);AJ[Au++]="/>";} for(var AP=this.GetFirst();AP;AP=this.GetNext(AP))if(AP.Selected){AJ[Au++]="<I Selected='1'";Oj("id",AP.id);if(Ow)Ox(AP);Oy(AP);AJ[Au++]="/>";} AJ[Au++]="\n</Changes>";} if(type["settings"]){ AJ[Au++]="\n"+this.GetCfgRequest(Cq); var C=this.Cols; var Cols=["LeftCols","Cols","RightCols"]; for(var i=0;i<3;i++){ var AL=this.ColNames[i]; if(AL.length){ AJ[Au++]="\n<"+Cols[i]+">"; for(var BD=0;BD<AL.length;BD++){ AJ[Au++]="\n<C"; Oj("Name",AL[BD]); Oj("Width",C[AL[BD]].Width); Oj("Visible",C[AL[BD]].Visible); AJ[Au++]="/>";} AJ[Au++]="\n</"+Cols[i]+">";}}} if(type["cookie"]){ AJ[Au++]="\n<Cfg";Oj("Cookie",this.SaveCfg(1));AJ[Au++]="/>";} if(type["cfg"]){ AJ[Au++]="\n<Cfg"; this.NQ(); var X=this.Hc("Path,Loading,This,Index,DefaultsVersion,TextVersion",null,1); for(var Es in this)if(!X[Es])Oj(Es,this[Es]); if(this.W){ Oj("SortCols",this.SortCols.join(",")); Oj("SortTypes",this.SortTypes.join(","));} AJ[Au++]="/>";} if(type["def"]){ AJ[Au++]="\n<Def>"; for(var AS in this.Def)Os("D",this.Def[AS]); AJ[Au++]="\n</Def>";} if(type["cols"]){ var C=this.Cols; var Cols=["LeftCols","Cols","RightCols"]; for(var i=0;i<3;i++){ var AL=this.ColNames[i]; if(AL.length){ AJ[Au++]="\n<"+Cols[i]+">"; for(var BD=0;BD<AL.length;BD++)Os("C",C[AL[BD]]); AJ[Au++]="\n</"+Cols[i]+">";}}} if(type["data"]||type["all"]){ var Rows=["Head","Foot","Solid"],O0=[this.XH,this.XF,this.XS]; for(var j=0;j<3;j++){ var CE=this.GetRows(O0[j]); if(CE.length){ AJ[Au++]="\n<"+Rows[j]+">"; for(var i=0;i<CE.length;i++)if(CE[i].Kind=="Data"||type["all"]){ if(CE[i].Cells)CE[i].Cells=CE[i].Cells.join(","); if(CE[i].Kind=="Toolbar"){var O1=CE[i]["Empty"];CE[i]["Empty"]="";} Ou("I",CE[i]); if(CE[i].Kind=="Toolbar")CE[i]["Empty"]=O1; if(CE[i].Cells)CE[i].Cells=CE[i].Cells.split(",");} AJ[Au++]="\n</"+Rows[j]+">";}}} if(type["body"]||type["data"]||type["all"]){ AJ[Au++]="\n<Body>"; for(var AN=this.XB.firstChild;AN;AN=AN.nextSibling){ var S="\n<B"; if(AN.id)S+=Gw("id",AN.id); for(var Es in AN)if(!LM[Es])S+=Gw(Es,AN[Es]); AJ[Au++]=S+">"; for(var AP=AN.firstChild;AP;AP=AP.nextSibling)Oz("I",AP); AJ[Au++]="\n</B>"} AJ[Au++]="\n</Body>";} if(type["other"]){ Os("MenuCfg",this.MenuCfg); Os("MenuColumns",this.Pager); Os("Pager",this.Pager); Os("Actions",this.Actions);} if(type["lang"]){ AJ[Au++]="\n<Lang>"; for(var i in this.Lang){ var Dh=this.Lang[i]; AJ[Au++]="\n<"+i; for(var Es in Dh){ if(Dh[Es]==null); else if(Dh[Es].join)Oj(Es,Dh[Es].join(",")); else Oj(Es,Dh[Es]);} AJ[Au++]="/>";} AJ[Au++]="\n</Lang>";} if(!type["nogrid"])AJ[Au++]="\n</Grid>"; return AJ.join(""); _7Ae("UploadType");}; _7h.prototype.Debug=function(Bg){ var FX=Bg&15,O2=this.DebugFlags; if(FX<=1&&!O2["error"]||FX==2&&!O2["problem"]||FX==4&&!O2["info"])return; var AS=this.O3,AY="GridDebug"; if(!AS){ var name="TreeGridDebug"; var AS=GetElem(name); if(!AS){ if(this.DebugWindow){ try{ var A5=window.open("",this.DebugWindow); if(A5){ AS=A5.document.body; AS.innerHTML=""; this.O4=A5.document;}} catch(H){}} if(!AS){ AS=document.createElement("div"); AS.id=name; AS.className=AY+"Tag"; AS.Ee=0; B2(AS); var AN=document.createElement("div"); AN.id=name+"Buttons"; AN.className=AY+"Buttons"; AN.innerHTML= "<button class='"+AY+"Button' id='"+name+"Max' onclick=\"var D=GetElem('"+name+"'),max=D.Max;D.Max=!max;for(var i=0;i<2;i++,D=D.nextSibling) if(max) D.className=D.className.replace(/Max$/,''); else D.className=D.className+'Max';this.innerHTML=max?'Max':'Normal'\">Max</button>"+"<button class='"+AY+"Button' onclick=\"GetElem('"+name+"').innerHTML='';\">Clear</button>"+"<button class='"+AY+"Button' onclick=\"GetElem('"+name+"').style.display='none';GetElem('"+name+"Buttons').style.display='none';\">Close</button>"; B2(AN);}} this.O3=AS;} if(!Grids.DebugHidden){AS.style.display="";AS.nextSibling.style.display="";} var GG=this.O4?this.O4:document; var Ep="",AJ=arguments; for(var i=1;i<AJ.length;i++){ var B3=AJ[i];if(!(Bg&64))B3=D0.Escape(B3).replace(/\n/g,"<br>"); if(i%2)Ep+=B3; else Ep+="<span class='"+AY+"Mark'>"+B3+"</span>";} if(AJ.length>1){ var T=GG.createElement(Bg&16?"span":"div"); T.innerHTML=(Bg&32?"":"<span class='"+AY+"Title'>["+this.Index+"] "+this.id+": </span>")+Ep+((Bg&80)==16?"; ":""); T.className=AY+(FX>3?"Info":["Stop","Error","Warning","List"][FX]); T.style.overflow="hidden"; AS.appendChild(T);} if(FX==14)AS.appendChild(GG.createElement("br")); if(FX==15)AS.appendChild(GG.createElement("hr")); AS.scrollTop=100000; if(_7P)this.O3.scrollHeight;}; _7h.prototype.JI=function(JG){ if(!this.DebugFlags["cookie"])return; var Cfg=Grids.JJ,E; Cfg.Data=JG; var JK=Cfg.JL(); if(this.Version&&JK!=parseInt(this.Version)){ this.Debug(3,"Data version (",this.Version,") is not the same as saved configuration version (",JK,"), saved configuration is deleted and default values from XML are used"); return;} this.Debug(15); this.Debug(35,"Cookie: "+JG); this.Debug(51,"Base settings: Version:",JK); var JM=Cfg.JN(),JO=Cfg.JN(),JP=Cfg.JN(),JQ=Cfg.JN(),JR=Cfg.JN(),JS=Cfg.JN(); this.Debug(51,"ShowDeleted=",this["ShowDeletedLap"]?"#":(JM&1?1:0)); this.Debug(51,"Sorted=",this["SortedLap"]?"Lap":(JM&2?1:0)); this.Debug(51,"AutoSort=",this["AutoSortLap"]?"Lap":(JM&4?1:0)); this.Debug(51,"Calculated=",this["CalculatedLap"]?"Lap":(JM&8?1:0)); this.Debug(51,"AutoUpdate=",this["AutoUpdateLap"]?"Lap":(JM&16?1:0)); this.Debug(51,"Panel.Visible=",this["HidePanelLap"]||this.Cols.Panel["VisibleLap"]?"Lap":(JM&32?0:1)); this.Debug(51,"ShowDrag=",this["ShowDragLap"]?"Lap":(JO&1?1:0)); this.Debug(51,"Pager.Visible=",this["ShowPagerLap"]||this.Pager["VisibleLap"]?"Lap":(JO&2?1:0)); this.Debug(51,"AllPages=",this["AllPagesLap"]?"Lap":(JO&4?1:0)); this.Debug(51,"Hover=",this["HoverLap"]?"Lap":((JO>>3)&3)); if(JO&32){E=Cfg.JL();if(E<10)E=10;this.Debug(51,"PagerWidth=",this["PagerWidthLap"]?"Lap":E);} this.Debug(51,"SortIcons=",this["SortIconsLap"]?"Lap":JP&3); if(JP&4){E=Cfg.JL();this.Debug(51,"CheckInterval=",this["CheckIntervalLap"]?"Lap":E);} if(JP&8){ var A5=Cfg.JL(),CS=Cfg.JL(); this.Debug(51,"Main tag size=",this["ResizingMainLap"]?"Lap":A5+","+CS);} if(JS&8){ var B3=Cfg.GetString(); this.Debug(51,"Style=",this["StyleLap"]?"Lap":B3);} var Em=(JP>>4)&3; this.Debug(14); if(Em){ if(this["SortColsLap"]||this["SortLap"])this.Debug(115,"Sorting setting is ignored: "); else this.Debug(115,"Sorting setting is used: "); for(var i=0;i<Em;i++){ var Bg=Cfg.JL(); var F6=Cfg.GetString(Bg&3); this.Debug(51,"[",F6,":",(Bg>>2),"]");}} else this.Debug(115,"No sorting setting present"); if(JQ&1){ this.Debug(14); var Em=Cfg.JL(); if(Em){ if(this["GroupColsLap"]||this["GroupLap"])this.Debug(115,"Grouping setting is ignored: "); else this.Debug(115,"Grouping setting is used: "); for(var i=0;i<Em;i++){ var Bg=Cfg.JL(); var F6=Cfg.GetString(Bg&3); this.Debug(51,"[",F6,":",(Bg>>2),"]");}} else this.Debug(115,"No grouping setting present. "); this.Debug(51,"Grouped=",this["GroupedLap"]?"Lap":(JS&1?0:1));} var Em=(JQ>>1)&3,CE=this.JU(); if(CE.length)this.Debug(14); if(Em){ if(this["FilterLap"])this.Debug(115,"Filter setting is ignored: "); else this.Debug(115,"Filter setting is used: "); var O5=["","==","!=","<","<=",">",">=","*|","x|","|*","|x","*|*","x|x"]; for(var i=0;i<Em;i++){ while(Cfg.Data&&Cfg.Data.charAt(0)!='+'){ var JV=Cfg.JN(),F6=Cfg.GetString(JV&3),Bb=Cfg.GetString(); this.Debug(51,"[",F6," ",O5[JV>>2]," ",Bb,"]");} Cfg.Data=Cfg.Data.slice(1);}} else if(CE.length)this.Debug(115,"No filter setting present. "); if(CE.length)this.Debug(51,"Filtered=",this["FilteredLap"]?"Lap":(JS&2?0:1)); if(JR&31){ this.Debug(14); this.Debug(115,"Search settings: "); if(JR&1){ var a=Cfg.JN(),AJ=["","Filter","Select","Mark","Find"]; this.Debug(51,"SearchAction=",AJ[a&7]); this.Debug(51,"SearchMethod=",a>>3);} if(JR&2)this.Debug(51,"SearchExpression=",Cfg.GetString()); if(JR&4)this.Debug(51,"SearchType=",Cfg.JL()); if(JR&8)this.Debug(51,"SearchDefs=",Cfg.GetString()); if(JR&16)this.Debug(51,"SearchCols=",Cfg.GetString()); this.Debug(51,"Searched=",this["SearchedLap"]?"Lap":(JS&4?0:1));} if(JQ&8){ this.Debug(14); if(this["ColsLap"])this.Debug(115,"Columns settings are ignored: "); else this.Debug(115,"Columns settings are used: "); var A5=0,JW=0; while(Cfg.Data&&Cfg.Data.charAt(0)!='+'){ var Bg=Cfg.JN(),F6=Cfg.GetString(Bg&3),AO=Cfg.JL(); var JY=Bg&12; var Cn=JY==4?-Cfg.JL():(JY==8?Cfg.JL():0); A5+=Cn; var BD=this.Cols[F6]; if(BD)this.Debug(51,"",F6,": [width:",BD["WidthLap"]?"Lap":(JY==12?"auto":A5),", pos:",this["ColsPosLap"]?"Lap":(Bg&32?"mid,"+AO:(AO&1?"left,":"right,")+(AO>>1)),", visible:",BD["VisibleLap"]?"Lap":(Bg&16?1:0),"]"); else this.Debug(51,"Unknown column ",F6);} Cfg.Data=Cfg.Data.slice(1);} if(JQ&16){ this.Debug(14);this.Debug(51,"Loaded collapsed / expanded state of all rows"); var BM=Cfg.Data.indexOf("+"); Cfg.Data=Cfg.Data.slice(BM+1); var BM=Cfg.Data.indexOf("+"); Cfg.Data=Cfg.Data.slice(BM+1);} if(JQ&32){ this.Debug(14);this.Debug(51,"Loaded selected state of all rows"); var BM=Cfg.Data.indexOf("+"); Cfg.Data=Cfg.Data.slice(BM+1);} if(JR&32){ this.Debug(14); var AJ=Cfg.GetString(); if(AJ){ this.Debug(115,"Custom attributes: "); AJ=AJ.split('@'); for(var i=0;i<AJ.length;i+=2){ var Bb=Cfg.GetString(); if((Bb-0)+""==Bb)Bb-=0; if(AJ[i]){ var AP=this.GetRowById(AJ[i]); if(AP)this.Debug(51,"row[",AJ[i],"].",AJ[i+1],"=",Bb); else this.Debug(51,"Unknown row id=",AJ[i]);} else this.Debug(51,"Cfg.",AJ[i+1],"=",Bb);}} else this.Debug(51,"No custom attributes saved");} if(this.SaveValues&&Cfg.Data){ this.Debug(14);this.Debug(51,"Loaded all cell values");} this.Debug(15);}; _7h.prototype.O6=function(AS){ if(!this.DebugFlags["error"])return; var O7=this.Hc(_7Af.join(",")); var O8=this.Hc("Url,Tag,Data,Format,Bonus,Timeout,Repeat,Method,Function,Namespace,Envelope,Xml,Param,Params,Cache,Debug,AlertError,Sync,Name"); var Attrs=this.Hc("id,MainTag,Debug,DebugWindow,Sync,Cache,CacheVersion,SuppressMessage,BasePath,AlertError,Format,Xml"); for(var Es in AS){ if(Attrs[Es.toLowerCase()])continue; if(O7[Es.toLowerCase()]){ for(var D3 in AS[Es]){ if(O8[D3.toLowerCase()]||Es=="Upload"&&(D3=="Type"||D3=="Attrs"||D3=="Flags")||Es=="Export"&&D3=="Type"||Es=="Check"&&D3=="Interval"||Es=="Text"&&D3=="Start")continue; this.Debug(2,"Tag <treegrid> contains unknown attribute ",Es+'_'+D3);} continue;} if(typeof(AS[Es])=="object"){ for(var i in AS[Es])if(AS[Es][i]!=null)this.Debug(2,"Tag <treegrid> contains unknown attribute ",Es+'_'+i);} else this.Debug(2,"Tag <treegrid> contains unknown attribute ",Es);}}; _7h.prototype.AV=function(AS,data,NI){ if(!data)return; var O9=data.length>500||data.indexOf('\n')>=0; if(O9)this.Debug(15); this.Debug(3,"AJAX for ",this.NN(AS),", "+NI); this.Debug(35+((data+"").search(/\<\/html\>/i)>=0?64:0),data); if(O9)this.Debug(15);}; _7h.prototype.NN=function(AS){ if(!AS||!AS.Name)return "Unknown data source"; var name=AS.Name; if(AS.Url)name+="_Url='"+AS.Url+"'"; else if(AS.Tag)name+="_Url='"+AS.Tag+"'"; else if(AS.Data)name+="_Data"; else if(AS.Bonus!=null)name+="_Bonus"; return name;}; _7h.prototype.LB=function(name){ this.t[name]=(new Date()).getTime();}; _7h.prototype.LC=function(name){ var Ak=this.t[name]; if(Ak==null)return null; this.t[name]=(new Date()).getTime()-Ak; return Math.round(this.t[name]/10)*10;}; _7h.prototype.PA=function(name){ var Ak=this.t[name]; this.t[name]=(new Date()).getTime()-(Ak?Ak:0);}; _7h.prototype.Nf=function(name){ var Ak=this.t[name]; if(Ak==null)return null; this.t[name]=null; return Math.round(((new Date()).getTime()-Ak)/10)*10;}; _7h.prototype.PB=function(name){ var Ak=this.t[name]; return Ak!=null&&Ak<1e12?Math.round(Ak/10)*10:null;}; _7h.prototype.PC=function(name){ var Ak=this.t[name]; this.t[name]=null; return Ak!=null&&Ak<1e12?Math.round(Ak/10)*10:null;}; _7h.prototype.ActionShowDebug=function(){ Grids.DebugHidden=0; this.Debug(13,"Debug shown");}; _7h.prototype.PD=function(row,F6,Items){ var R=null; if(this.G2(row,F6)){ R=Get(row,F6); if(R||R=="0")R=(R+"").split(this.Lang.Format.ValueSeparator); else R=[];} function PE(AI){ AI.Bool=1; AI.Value=0; for(var i=0;i<R.length;i++)if(R[i]==AI.Name)AI.Value=1;}; var AL=[],Au=0; for(var i=0;i<Items.length;i++){ var AI=Items[i],D4=AI.Name; if((D4+"").charAt(0)=='*'){ if(D4=="*All"){AI.Text=this.GetText("DefaultsAll");if(AI.Text)AL[Au++]=AI;AI.CheckAll=1;continue;} if(D4=="*Date"){AI.Text=this.GetText("DefaultsDate");if(AI.Text)AL[Au++]=AI;AI.PF=1;continue;} if(D4=="*Button"){AI.Text=this.GetText("DefaultsButton");if(AI.Text)AL[Au++]=AI;AI.PF=1;continue;} if(D4=="*Default"){ var PG=row[F6];row[F6]=null; AI.Text=this.KY(row,0,0,0,3,F6); row[F6]=PG; if(AI.Text){AL[Au++]=AI;AI.PH=row.Def[F6];AI.Name=AI.PH;} continue;} if(D4=="*FilterOff"&&row.Kind=="Filter"){AI.Text=this.GetText("DefaultsFilterOff");if(AI.Text)AL[Au++]=AI;AI.PF=1;continue;} if(D4.search(/^\*Rows/)>=0){ var T=this,X=new Object(),Y=new Object(),PJ=D4.search("CanFilter")>=0,PK=D4.search("Visible")>=0,Gy=D4.search("Def")>=0?row.Def:null,Fa=F6,PL=row.Kind=="Filter"?1:0; function PM(AP){ if(PJ){ if(!(Get(AP,"CanFilter")&1))return; if(T.Cols[F6].CanFilter==2&&Get(AP,F6+"CanFilter")==0)return;} if((!Gy||AP.Def==Gy)&&(!PK||AP.Visible)){ if(PL){ var Dh=Get(AP,Fa+"FilterValue"); if(!Dh)Dh=Get(AP,Fa);} else var Dh=Get(AP,Fa); if(Dh!=null){ if(X[Dh])X[Dh]++; else{X[Dh]=1;Y[Dh]=AP;}}}}; var PN=D4.match(/Col(\w*)\*/); if(PN)Fa=PN[1]; if(D4.search("Variable")>=0||D4.search("All")>=0){ for(var AP=this.GetFirst();AP;AP=this.GetNext(AP))PM(AP);} if(D4.search("Fixed")>=0||D4.search("All")>=0){ var CE=this.GetFixedRows(); for(var AP=0;AP<CE.length;AP++)if(CE[AP].Kind=="Data")PM(CE[AP]);} if(D4.search("Sibling")>=0){ var GP=row.parentNode; if(GP.Page)GP=this.XB.firstChild; for(var AP=GP.firstChild;AP;AP=this.GetNextSibling(AP))PM(AP);} var Em=D4.match(/\d\d*/),JM=new Array(),PO=0; if(Em)Em=Em[0]; var PP=0; if(this.Cols[F6]&&this.Cols[F6].CharCodes)PP=1; for(var x in X){ var Cc=new Object(); Cc.BD=X[x]; Cc.Dh=x; Cc.PQ=x; if(PP)Cc.PQ=this.UseCharCodes(Cc.PQ,F6); Cc.AP=Y[x]; JM[PO++]=Cc;} if(Em)JM.sort(function(a,Ey){return a.BD<Ey.BD?1:(a.BD>Ey.BD?-1:(a.PQ<Ey.PQ?-1:1));}); else JM.sort(function(a,Ey){return a.PQ<Ey.PQ?-1:1;}); if(!Em)Em=PO; for(var j=0;j<Em&&JM[j];j++){ AL[Au++]={Text:this.KY(JM[j].AP,0,0,0,3,Fa),PH:JM[j].Dh,Name:JM[j].Dh}; if(R)PE(AL[Au-1]);} if(row.Kind=="Filter")for(var j=0;j<Em;j++)if(AL[j+Au-Em].PH==="")AL[j+Au-Em].PH=String.fromCharCode(160); continue;}} if(this.GetType(row,F6)=="Date"&&isNaN(D4-0))D4=this.Lang.Format._7AF(D4); AI.Text=this.KY(row,0,0,0,3,F6,D4); AI.PH=D4; if(row.Kind=="Filter"&&AI.Text==="")AI.Text=String.fromCharCode(160); AL[Au++]=AI; if(R)PE(AI); if(AI.Items)AI.Items=this.PD(row,F6,AI.Items);} return AL;}; _7h.prototype.DZ=function(row,F6,PR,Click,Caption){ if(this.Editing!=1&&row.Kind!="Filter"&&row.Kind!="Search"&&row.Kind!="Group")return false; if(!PR&&this.Gw(row,F6,"DefaultsServer")>0){ var T=this; this.NS(row,F6,function(NH){ if(NH<0)T.Debug(1,"Failed downloading cell [",row.id,",",F6,"] from ",T.NN(T.Source.Cell)); else if(T.DebugFlags["page"])T.Debug(4,"Downloaded cell [",row.id,",",F6,"] in ",T.LC("Cell"+row.id+"_"+F6)," ms"); if(NH>=0)T.DZ(row,F6,1);},Get(row,F6)); return;} var M=Get(row,F6+"Defaults");if(M==null&&this.Cols[F6])M=this.Cols[F6]["Defaults"]; if(Grids.OnGetDefaults)M=Grids.OnGetDefaults(this,row,F6,M); if(!M)return false; M=DV.DW(M,1); if(!M)return false; M.Items=this.PD(row,F6,M.Items); if(this.G2(row,F6)){ M.Buttons=["Clear","Ok"]; M.Texts={Aq:this.GetAlert("MenuOk"),Clear:this.GetAlert("MenuClear"),FG:this.GetAlert("MenuAll")};} M.MinWidth=0; M.Cursor=Get(row,F6); M.Base=this.Img.Style+"Menu"; M.Class=this.Img.Style+"DefaultsMenu"; M=DV.DW(M); if(!M)return; if(Click){ var AM=this.IC(Click.Row,Click.Col); AM.X=AM.IQ+Click.X; AM.Y=AM.IR+Click.Y; AM.Align="left below"; AM.Width=0;AM.Height=0; M.MinWidth=null;} else{ var AM=this.IC(row,F6); AM.Align="right below"; AM.X=AM.IQ;AM.Y=AM.IR; if(F6==this.MainCol&&!row.Fixed){ var left=0,FX=row.Level;if(this.HideRootTree)FX--; if(FX>=0)left+=this.Img.Tree; if(FX>0)left+=FX*this.Img.Line; AM.X+=left;AM.Width-=left;}}; var T=this; M.OnSave=function(AI,Fj){ var Bb,PS=0; if(!AI){ Bb=Fj.join(T.Lang.Format.ValueSeparator); if(!Bb&&row.Kind=="Filter"){PS=1;row[F6+"Filter"]=0;}} else if(AI.PF){ if(AI.Name=="*Date"){if(T.PT)T.PT(row,F6);return;} if(AI.Name=="*Button"){if(Grids.OnButtonClick)Grids.OnButtonClick(T,row,F6);return;} if(AI.Name=="*FilterOff"){ Bb=null; row[F6+"Filter"]=0; PS=1;}} else{ Bb=AI.PH; if(T.GetType(row,F6)=="Date")Bb=T.PU(Bb,T.GetFormat(row,F6,1)); if(Bb-0+""==Bb)Bb-=0;}; M.Close(); T.PV(row,F6,Bb);}; M.OnClose=function(){ T.Dialog=null;}; if(this.Dialog)this.Dialog.Close(); M=ShowMenu(M,AM); this.Dialog=M; M.Row=row;M.Col=F6;M.Type="Defaults"; return true;}; _7h.prototype.ActionShowDefaults=function(CE){ var row=CE?this.FRow:this.ARow,F6=CE?this.FCol:this.ACol; if(!row||!F6)return false; if(this.Gw(row,F6,"Button")!="Defaults"&&this.Gw(row,F6,"RightButton")!="Defaults")return false; if(this.Dialog&&this.Dialog.Row==row&&this.Dialog.Col==F6){ this.Dialog.Close(); return true;} return this.DZ(row,F6);}; _7h.prototype.CloseDialog=function(Ci){ if(!this.Dialog)return; this.Dialog.Close(); this.Dialog=null;}; _7h.prototype.Disable=function(){ if(this.Cw)return; if(Grids.OnDisable)Grids.OnDisable(this); if(this.Dialog)this.Dialog.Close(); this.Cw=true; var AS=this.J9; if(!AS){ AS=document.createElement("div"); AS.className=this.Img.Style+"Disabled"; AS.style.position="absolute"; AS.innerHTML=_7D; B2(AS); this.J9=AS; if(this.IE==null){ var AJ=_7s(this.MainTag); this.IE=AJ[0];this.IF=AJ[1];}} var X=this.IE,Y=this.IF; if(this.HW){ X-=this.HW.offsetLeft;Y-=this.HW.offsetTop; if(!_7P){X+=this.MainTag.offsetLeft;Y+=this.MainTag.offsetTop;}} AS.style.left=X+"px"; AS.style.top=Y+"px"; AS.style.width=this.MainTag.offsetWidth; AS.style.height=this.MainTag.offsetHeight; AS.style.display="";}; _7h.prototype.Enable=function(){ if(!this.Cw)return; this.Cw=false; var AS=this.J9; if(AS)AS.style.display="none"; if(Grids.Focused!=this&&this.FRow)this.PW("Click","Outside",""); if(Grids.OnEnable)Grids.OnEnable(this);}; _7h.prototype.ShowMessage=function(Ai,Ci){ if(this.SuppressMessage==2||this.SuppressMessage&&!Ci||!Ai){ if(Ci)this.Disable(); return;} this.Disable(); if(!this.MainTag.offsetWidth||this.PX)return; if(_7F&&_7H<9.5)this.HideMessage(); if(this.Message){ var CA=this.Message,N2=this.J8; CA.className=this.Img.Style+"Message"; CA.style.width="";} else{ var CA=document.createElement("div"); CA.className=this.Img.Style+"Message"; CA.style.position="absolute"; CA.style.display=""; B2(CA); var N2=document.createElement("div"); N2.className=this.Img.Style+"MessageShadow"; N2.innerHTML=_7D; N2.style.display=""; N2.style.position="absolute"; document.body.insertBefore(N2,CA); this.Message=CA;this.J8=N2;}; CA.innerHTML=Ai; CA.style.visibility="";CA.style.display=""; var A5=this.MessageWidth;if(A5&&CA.offsetWidth<A5)CA.style.width=A5+"px"; if(this.CenterMessage){ var AJ=GetWindowSize(); CA.style.left=Math.floor((AJ[0]-CA.offsetWidth)/2)+"px"; CA.style.top=Math.floor((AJ[1]-CA.offsetHeight)/2)+"px";} else{ var X=this.IE,Y=this.IF; if(this.HW){ X-=this.HW.offsetLeft;Y-=this.HW.offsetTop; if(!_7P){X+=this.MainTag.offsetLeft;Y+=this.MainTag.offsetTop;}} CA.style.left=Math.floor(X+(this.MainTag.offsetWidth-CA.offsetWidth)/2)+"px"; CA.style.top=Math.floor(Y+(this.MainTag.offsetHeight-CA.offsetHeight)/2)+"px";}; N2.style.left=CA.style.left; N2.style.top=CA.style.top; N2.style.width=CA.offsetWidth+"px"; N2.style.height=CA.offsetHeight+"px"; if(Grids.OnShowMessage)Grids.OnShowMessage(this,CA); CA.style.visibility="visible"; N2.style.visibility="visible";N2.style.display="";}; _7h.prototype.HideMessage=function(){ this.Enable(); if(!this.Message)return; this.Message.style.display="none"; this.J8.style.display="none";}; _7h.prototype.Prompt=function(text,Gy,Cs,width){ if(!width)width=200;if(Gy==null)Gy=""; this["PromptFunc"]=Cs?Cs:function(){}; var B3="<div style='padding-bottom:10px;width:"+width+"px;'>"+text+"</div>"; B3+="<div style='padding-bottom:10px;'><input type='text' value='"+Gy+"' style='width:"+width+"px;'"; B3+=" onkeydown='if(event.charCode==13 || event.keyCode==13) {"+this.K+".HideMessage();"+this.K+".PromptFunc(this.value);} if(event.charCode==27 || event.keyCode==27) {"+this.K+".HideMessage();"+this.K+".PromptFunc(null);}'></div>"; B3+="<button onclick='"+this.K+".HideMessage();"+this.K+".PromptFunc(this.previousSibling.firstChild.value);' class='"+this.Img.Style+"CfgMenuButton'>"+this.Lang["MenuCfg"]["OK"]+"</button>"; B3+="<button onclick='"+this.K+".HideMessage();"+this.K+".PromptFunc(null);'class='"+this.Img.Style+"CfgMenuButton'>"+this.Lang["MenuCfg"]["Cancel"]+"</button>"; this.ShowMessage(B3); var AI=this.Message.getElementsByTagName("input")[0]; if(AI){AI.focus();AI.select();}}; _7h.prototype.PT=function(row,F6){ if(this.Cw)return; var M=Get(row,F6+"Calendar");if(M==null&&this.Cols[F6])M=this.Cols[F6]["Calendar"]; if(!M)M={}; else M=As(M); if(this.G2(row,F6)){ M.Range=1;} M.Date=Get(row,F6); M.Class=this.Img.Style+"Pick"; M.Text={Ap:this.GetAlert("DateToday"),Clear:this.GetAlert("DateClear"),Aq:this.GetAlert("DateOk")}; var AM=this.IC(row,F6); AM.X=AM.IQ;AM.Y=AM.IR; AM.Align="right below"; var T=this; M.OnSave=function(Bb){ T.PV(row,F6,Bb,Bb=="");}; M.OnClose=function(){ T.Dialog=null;}; if(this.Dialog)this.Dialog.Close(); M=Ar(M,AM); M.Row=row;M.Col=F6;M.Type="Calendar"; this.Dialog=M;}; _7h.prototype.ActionShowCalendar=function(CE){ var row=CE?this.FRow:this.ARow,F6=CE?this.FCol:this.ACol; if(!row||!F6||this.GetType(row,F6)!="Date"||!this.Editing&&row.Kind!="Filter"&&row.Kind!="Group"&&row.Kind!="Search")return false; if(this.Dialog&&this.Dialog.Row==row&&this.Dialog.Col==F6){ this.Dialog.Close(); return true;} this.PT(row,F6); return true;}; _7h.prototype.ActionShowLink=function(CE){ var row=CE?this.FRow:this.ARow,F6=CE?this.FCol:this.ACol; if(!row||!F6)return false; var Bg=this.GetType(row,F6); if(Bg=="Link"||Bg=="Img"){ var Dh=this.HJ(row,F6); if(Dh){ if(Grids.OnLinkClick&&Grids.OnLinkClick(this,row,F6,Dh[0],Dh[1]))return true; try{window.open(Dh[0],Dh[1]);} catch(H){}; return true;}} return false;}; _7h.prototype.ActionButtonClick=function(CE){ var row=CE?this.FRow:this.ARow,F6=CE?this.FCol:this.ACol; if(!row||!F6)return false; var BM=this.Gw(row,F6,"Button"); if(BM!="Button"&&BM!="Img"&&BM!="Html")return false; if(Grids.OnButtonClick){ if(this.EditMode)this.EndEdit(this.FRow,this.FCol,true); Grids.OnButtonClick(this,row,F6);} return true;}; _7h.prototype.ActionShowHelp=function(){try{window.open(this.Ae(this.PY(this.HelpFile)));}catch(H){};}; _7h.prototype.ActionShowPopupMenu=function(CE){ var row=CE?this.FRow:this.ARow,F6=CE?this.FCol:this.ACol; if(!row||!F6)return false; if(this.Dialog)this.Dialog.Close(); var C=this.Cols,G=this; function Gw(Gx){ var D3=Get(row,F6+Gx); if(!D3)D3=Get(row,Gx); if(!D3&&F6&&C[F6])D3=C[F6][Gx]; return D3;}; M=DV.DW(Gw("Menu")); if(!M)return false; M.Base=this.Img.Style+"Menu"; if(!M.Class)M.Class=this.Img.Style+"PopupMenu"; M.OnSave=function(AI){ if(Grids.OnContextMenu)return!Grids.OnContextMenu(G,row,F6,AI,AI.Name); alert("No OnContextMenu event defined"); return true;}; this.Dialog=ShowMenu(M,{X:this.Event.PZ,Y:this.Event.Pa}); return true;}; _7h.prototype.ShowDialog=function(row,F6,Aj,align,x,y){ if(!row||!F6||!Aj)return; var AM=this.IC(row,F6);AM.X=AM.IQ;AM.Y=AM.IR; if(!AM)return; this.CloseDialog(); if(x!=null&&y!=null){AM.X+=x;AM.Y+=y;AM.Align="left top";} else AM.Align=align?"left below":"right below"; var M={Body:Aj,Class:this.Img.Style+"Menu"}; M=ShowDialog(M,AM); this.Dialog=M; M.Grid=this; return M;}; _7h.prototype.CloseDialog=function(){ if(this.Dialog)this.Dialog.Close();}; _7h.prototype.ShowMenu=function(row,F6,FY,Pb,Cs,align,caption,x,y,Pc){ if(!row||!F6||!FY)return; var AM=this.IC(row,F6);AM.X=AM.IQ;AM.Y=AM.IR; if(!AM)return; this.CloseDialog(); if(x!=null&&y!=null){AM.X+=x;AM.Y+=y;AM.Align="left top";} else AM.Align=align?"left below":"right below"; var AI=[]; for(var i=0;i<FY.length;i++){ AI[i]={Name:i,Text:FY[i]}; if(Pb)AI[i].Icon=Pb[i];} var M={Class:this.Img.Style+"Menu",Items:AI}; if(caption)M.Header=caption; if(Cs){ var T=this; M.OnSave=function(AI){return Cs(AI.Name,T,row,F6,Pc);}} M=ShowMenu(M,AM); this.Dialog=M; M.Grid=this; return M;}; _7h.prototype.ShowTip=function(row,F6,Cv){ this.HideTip(); if(!Cv||!row||!F6)return; ShowTip({Body:Cv,Class:this.Img.Style+"Tip"},this.GetCell(row,F6),0);}; _7h.prototype.MoveRows=function(row,Pd,type,Pe){ var DG,Pf=row.parentNode; if(!Pd||Pd==row||type==0)return; switch(type){ case 1:DG=this.N4(row,null,Pd,true,null,Pe);break; case 2: if(Pd.firstChild&&Pd.firstChild.LN)Pd=Pd.lastChild; if(!Pe){ if(!Pd.Expanded&&!Pd.Page)this.Expand(Pd); if(Pd.State<4){ var T=this; setTimeout(function(){T.MoveRows(row,Pd,type);},100); return;}} DG=this.N4(row,Pd,null,true,null,Pe); break; case 3:DG=this.N4(row,Pd.parentNode,Pd.nextSibling,true,null,Pe,1);break;}; if(DG)this.UploadChanges(row); var Pg=row.parentNode; if(!this.J6&&Pf!=Pg&&(!Pf.Page||!Pg.Page)){ this.Recalculate(row,null,true); if(!Pf.Removed)this.Recalculate(Pf,null,true);} else{ if(this.Ph){this.RefreshGanttDependencies();}}}; _7h.prototype.Pi=function(AJ,Pd,type){ if(type==2){ if(!Pd.Expanded)this.Expand(Pd); if(Pd.State<4){ var T=this; setTimeout(function(){T.Pi(AJ,Pd,type);},100);return;}} this.MoveRows(AJ[0],Pd,type); for(var i=1;i<AJ.length;i++)this.MoveRows(AJ[i],AJ[i-1],3);}; _7h.prototype.MoveRowsToGrid=function(row,G,Pd,type,KM,Pj){ if(KM==null)KM=this.DragCopy; if(row.MasterRow&&G==this.J6){ G.MoveRows(row.MasterRow,Pd,type,1); return;} if(G.J6==this){ this.MoveRows(row,Pd?Pd.MasterRow:G.XB.firstChild.MasterRow,type,1); return;} var Pk=row.id&&!KM?1:0; var AP=Pk?G.GetRowById(row.id):null; if(AP){ if(Pd!=null){ if(!Pj){ if(type==2&&!Pd.Expanded){ this.Expand(Pd); if(Pd.State<4){ var T=this; setTimeout(function(){T.MoveRowsToGrid(row,G,Pd,type,KM);},100); return;}}} G.MoveRows(AP,Pd,type);} if(AP.Deleted&&!row.Deleted){if(G.DeleteRowT)G.DeleteRowT(AP,3);} else if(!row.Deleted)G.ShowRow(AP);} else{ var Gy=row.Def.Name;if(!G.Def[Gy])Gy=null; if(Pd==null){ AP=G.AddRow(null,null,1,Pk,Gy);} else{ switch(type){ case 1:AP=G.AddRow(null,Pd,1,Pk,Gy);break; case 2: if(!Pj){ if(!Pd.Expanded)G.Expand(Pd); if(Pd.State<4){ var T=this; setTimeout(function(){T.MoveRowsToGrid(row,G,Pd,type,KM);},100); return;}} AP=G.AddRow(Pd,null,1,Pk,Gy); break; case 3:AP=G.AddRow(Pd.parentNode,Pd.nextSibling,1,Pk,Gy);break;}}; if(!AP)return; if(row.Deleted&&G.DeleteRowT)G.DeleteRowT(AP,2);}; AP.Deleted=row.Deleted; if(Pk)AP.id=row.id; for(var BD in this.Cols)if(Get(row,BD)!=null&&BD!='id')AP[BD]=Get(row,BD); for(var BD in G.Cols)if(Get(row,BD)!=null&&BD!='id')AP[BD]=Get(row,BD); AP.Selected=row.Selected; if(KM!=2){ for(var Es=row.firstChild;Es;Es=Es.nextSibling){ this.MoveRowsToGrid(Es,G,AP,2,KM,1);}} if(row.Expanded){ G.Collapse(AP); G.Expand(AP);} else{ G.Expand(AP); G.Collapse(AP);}; G.RefreshRow(AP); G.Recalculate(AP,null,true); if(G.SortRow)G.SortRow(AP,null,true); if(Grids.OnRowMoveToGrid)Grids.OnRowMoveToGrid(this,row,G,AP,KM); if(!KM){if(this.DeleteRowT)this.DeleteRowT(row,2);} else this.UploadChanges(row); G.UploadChanges(AP); return AP;}; _7h.prototype.Pl=function(row,Def){ var AJ=Get(row.Page?this.Root:row,"AcceptDef"); if(AJ!=null)return(AJ+"").search(new RegExp("\\b"+Def+"\\b"))>=0; return 1;}; _7h.prototype.Pm=function(G,Pn,row,y,KM){ var type=-1,GP=row.parentNode; var Po=(GP.Page?1:0)||Is(GP,"AcceptChild"),Pp=Po,Pq=Is(row,"AcceptChild"); var Def=Get(Pn[0],"Def").Name; if(Pq&&!this.Pl(row,Def)){ if(!row.firstChild||!row.firstChild.LN||!this.Pl(row.firstChild))Pq=false;} if(!this.Pl(GP,Def)){Po=false;Pp=false;} if(row.firstChild&&row.firstChild.LN)Pq=false; if(row.LN){Po=false;Pp=false;} if(!KM&&G==this){ for(var i=0;i<Pn.length;i++){ var F8=row.Level-Pn[i].Level; if(Pn[i].Pr){ var AJ=[];this.Ps(Pn[i],AJ); if(F8>=0)for(var Au=row;F8;F8--)Au=Au.parentNode; for(var i=0;i<AJ.length;i++)if(Au==AJ[i]){type=0;break;}} else if(F8>0){ for(var Au=row;F8;F8--)Au=Au.parentNode; if(Au==Pn[i]){type=0;break;}} else if(!F8&&row==Pn[i])Pq=false;} if(Pn.length==1){ if(Pn[0]==row||Pn[0]==row.previousSibling)Po=false; if(Pn[0]==row||Pn[0]==row.nextSibling)Pp=false; if(Pn[0].Pr&&(AJ[AJ.length-1]==row||AJ[AJ.length-1]==row.previousSibling))Po=false; if(row==Pn[0].parentNode)Pq=false;}} if(GP.Deleted)type=0; if(row.Deleted)Pq=0; if(row.Fixed)type=0; if(type==-1){ var height=this.GetRowHeight(row),Pt=height/3-1,Pu=(height)/3*2,Pv=(Pu+Pt)/2; if(y==null)y=Pv; if(!this.MainCol){ Pt=(Pt+Pu)/2; Pu=Pt; Pq=false;} if(y<=Pt){ if(Po)type=1; else if(Pq)type=2; else if(Pp)type=3;} else if(y>=Pu){ if(Pp)type=3; else if(Pq)type=2; else if(Po)type=1;} else{ if(Pq)type=2; else if(y<Pv&&Po)type=1; else if(Pp)type=3; else if(Po)type=1;}; if(type==-1)type=0;} if(Grids.OnCanDrag)Grids.OnCanDrop=Grids.OnCanDrag; if(Grids.OnCanDrop){ var Bg=Grids.OnCanDrop(G,Pn[0],this,row,type,KM); if(Bg!=null)return Bg;} return type;}; _7h.prototype.ActionDragRow=function(){return this.StartDrag(0);}; _7h.prototype.ActionDragSelected=function(){return this.StartDrag(1);}; _7h.prototype.ActionDragCopy=function(){return this.StartDrag(0,2);}; _7h.prototype.ActionDragSelectedCopy=function(){return this.StartDrag(1,2);}; _7h.prototype.ActionDragCopyChildren=function(){return this.StartDrag(0,1);}; _7h.prototype.ActionDragSelectedCopyChildren=function(){return this.StartDrag(1,1);}; _7h.prototype.Pw=function(row,AJ){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(!AP.Visible||AP.Deleted)continue; if(AP.Selected){ if(Is(AP,"CanDrag")&&AP!=AJ[0])AJ[AJ.length]=AP;} else if(AP.firstChild)this.Pw(AP,AJ);}}; _7h.prototype.Px=function(AJ){ for(var AP=this.XB.firstChild;AP;AP=AP.nextSibling)this.Pw(AP,AJ);}; _7h.prototype.StartDrag=function(Og,KM){ var AS=Grids.Bc;if(!AS)return false; var row=AS.Row; if(!row||row.Fixed||row.Deleted||!this.Dragging)return false; if(Og&&!row.Selected||!Is(row,"CanDrag")||this.Cols[this.ACol]&&!this.Cols[this.ACol].CanDrag)return false; if(Og==null)Og=!!row.Selected; var AJ=[]; if(Og){AJ[0]=row;this.Px(AJ);} if(AJ.length>1)AS.Rows=AJ; if(this.EditMode&&this.EndEdit(this.FRow,this.FCol,true)==-1)return false; if(Grids.OnStartDrag&&Grids.OnStartDrag(this,AS.Row,AS.Col,!!AS.Rows))return false; AS.Action="Drag"; AS.Move=this.Py; AS.Pz=this.P0; AS.Copy=KM; AS.Cursor=document.documentElement.style.cursor; document.documentElement.style.cursor=_7N?"default":"url(Drag.cur"+")"; if(this.DragObject==1){ var P1=[[],[],[]],CA=this.P2(row); for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]=CA; this.P3(row,P1[0],P1[1],P1[2]); var B3=this.P4(row); for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]=B3; this.KY(row,P1[0],P1[1],P1[2]); for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]="</tr>"+_7C; var Aj="<div onmousemove='"+this.K+".MoveMouseObject(event);"+this.K+".GridMouseOver(event)' style='height:"+this.Hu+"px;overflow:hidden;display:inline;' align='left'>"+_7A+_7B+"<tr><td valign='top'>"+P1[0].join("")+"</td><td valign='top'>"+P1[1].join("")+"</td><td valign='top'>"+P1[2].join("")+"</td></tr>"+_7C+"</div>"; var AP=this.GetRow(row,this.Rtl?2:0);if(!AP)AP=this.GetRow(row,1); var Br={clientX:AS.X,clientY:AS.Y}; this.P5(AP,Br,3,Aj); var M=Grids.P6; if(M&&AS.Rows){ M.Tag.style.borderRight="5px groove gray"; M.Tag.style.borderBottom="5px groove gray";}} else if(this.DragObject==2){ var Aj="<div onmousemove='"+this.K+".MoveMouseObject(event);"+this.K+".GridMouseOver(event)'>"+this.GetText("DragObject"+(AJ.length>1?"More":"")+(KM?"Copy":"Move")).replace("%d",AJ.length>1?AJ.length:this.HK(row))+"</div>"; var Br={clientX:AS.X,clientY:AS.Y}; this.P5(null,Br,3,Aj); var M=Grids.P6; if(M)M.Tag.className=this.Img.Style+"DragObject";} return true;}; _7h.prototype.Py=function(P7){ var AS=Grids.Bc,row=this.ARow,Y=this.Event.Y;if(!AS)return false; this.P8=null; if(!row||row.Fixed){ if(!P7&&this.ScrollOnDrag&&this.Dropping)this.P9(row); if(!this.DropFixed||!row)row=null; else if(this.P8==1){ row=this.GetFirstVisible();Y=1;} else if(this.P8==2){ row=this.GetLastVisible(); while(!row.parentNode.Page)row=row.parentNode; Y=this.GetRowHeight(row)-1;} else row=null;} if(row!=AS.QA&&AS.QA)AS.QB.Li(AS.QA); if(row){ if(this.ExpandOnDrag&&this.ACol==this.MainCol&&this.HasChildren(row)&&!row.Expanded){ var x=this.Event.X-row.Level*this.Img.Line; if(x<this.Img.Tree&&x>=0)this.Expand(row);} var type=this.Dropping?this.Pm(AS.Grid,AS.Rows?AS.Rows:[AS.Row],row,Y):0; if(AS.Type!=type||row!=AS.QA){ this.Li(row,type); AS.Type=type; AS.QA=row; AS.QB=this;}} else{ AS.QA=null; AS.Type=0;}; return true;}; _7h.prototype.P0=function(){ var AS=Grids.Bc,G=AS.Grid,T=AS.QB;if(!AS)return false; if(Grids.Active&&Grids.Active!=AS.QB&&!Grids.Active.GetFirstVisible()){ if(this.Pl(Grids.Active.Root,AS.Row.Def.Name)){ T=Grids.Active; if(!T.Detail||T.XB.firstChild.MasterRow){ AS.Type=2;}}} if(Grids.OnEndDrag){ Grids.Bc=null; var Bg=Grids.OnEndDrag(G,AS.Row,T,AS.QA,AS.Type,AS.QC,AS.QD); if(Bg!=null)AS.Type=Bg; Grids.Bc=AS;} if(AS.Type&&!T.Cw){ this.QE(); if(AS.Rows){ T.Rendering=1; if(AS.Grid==T&&!AS.Copy)T.Pi(AS.Rows,AS.QA,AS.Type); else{ var Es=G.MoveRowsToGrid(AS.Rows[0],T,AS.QA,AS.Type,AS.Copy); for(var i=1;i<AS.Rows.length;i++)Es=G.MoveRowsToGrid(AS.Rows[i],T,Es,3,AS.Copy);}; for(var i=0;i<AS.Rows.length;i++)if(AS.Rows[i].Pr)T.UpdateRowHeight(AS.Rows[i]); T.Rendering=0; T.Update();} else if(AS.Grid==T&&!AS.Copy){ if(_7U)var AL=T.GetNextVisible(AS.Row); T.MoveRows(AS.Row,AS.QA,AS.Type); if(_7U&&AL)T.RefreshRow(AL);} else G.MoveRowsToGrid(AS.Row,T,AS.QA,AS.Type,AS.Copy); this.QF();} this.P8=null;if(G)G.P8=null; document.documentElement.style.cursor=AS.Cursor; if(AS.QA)this.Li(AS.QA); if(this.SaveValues)this.SaveCfg(); return true;}; _7h.prototype.QG=function(row,F6,Value){ var BA=this.GetFormat(row,F6,1),type=this.GetType(row,F6),DY=this.Lang.Format; switch(type){ case "Int": case "Float": if(Value===""&&DY.EmptyNumber!=null)return ""; var EX=this.G2(row,F6); Value=DY.StringToNumber(Value,BA,EX); return type=="Int"&&!EX?Math.round(Value):Value; case "Date": if(Value===""&&DY.EmptyDate!=null)return ""; if(Value==DY.NaN)return '/'; if(this.G2(row,F6))return this.PU(Value,BA?BA:""); return DY.StringToDate(Value,BA); return '/'; case "Text": case "Lines": if(!BA)return Value; var Cq=BA.split(BA.charAt(0)); if(Cq[2]!=""&&Value.slice(0,Cq[2].length)==Cq[2])Value=Value.slice(Cq[2].length); if(Cq[3]!=""&&Value.slice(Value.length-Cq[3].length,Value.length)==Cq[3])Value=Value.slice(0,Value.length-Cq[3].length); return Value; case "Pass":return Value; case "Link": if(!BA)BA="|0|1"; var Cq=BA.split(BA.charAt(0)); var Ad,text; var Dh=Get(row,F6); if(Dh==null)Dh='|'; else Dh+=""; var HF=Dh.charAt(0);if(!HF)HF='|'; Dh=Dh.split(HF); if(Cq[2]-0){ if(Cq[3]-0){ text=Value.search(/\sTEXT\: /); Ad=Value.slice(5,text).replace(/[\;\s]*$/,""); text=Value.slice(text+7);} else{Ad=Value;text=Dh[2];}} else{Ad=Dh[1]==null?"":Dh[1];text=Value;}; Value=HF+Ad; if(text!=null)Value+=HF+text; if(Dh[3])Value+=HF+Dh[3]; return Value; case "Img": if(!BA)BA="|0|1"; var Cq=BA.split(BA.charAt(0)); var src=Cq[2]-0?(Cq[3]-0||Cq[4]-0?5:0):null; var QH=Cq[3]-0?Value.search(new RegExp("W\\:\\d{0,3},H\\:\\d{0,3};\\sX\\:\\d{0,4},Y\\:\\d{0,4}","")):null; var QI=Cq[4]-0?Value.search(/\sURL\: /):null; var Dh=Get(row,F6); if(!Dh)Dh='|'; var HF=Dh.charAt(0); Dh=Dh.split(HF); if(src!=null){ if(QH)src=Value.slice(src,QH-1); else if(QI)src=Value.slice(src,QI); else src=Value.slice(src); src=src.replace(/[\;\s]*$/,"");} else src=Dh[1]==null?"":Dh[1]; if(QH){ if(QI)QH=Value.slice(QH,QI); else QH=Value.slice(QH); QH=QH.replace(/[\]\;\s]*$/,"").replace(/W\:/,HF).replace(/,H\:/,HF).replace(/;\sX\:/,HF).replace(/,Y\:/,HF);} else QH=Dh[2]==null?HF+HF+HF+HF:HF+Dh[2]+HF+Dh[3]+HF+Dh[4]+HF+Dh[5]; if(QI)QI=Value.slice(QI+6); else QI=Dh[6]==null?"":Dh[6]; Value=HF+src+QH+HF+QI; if(Dh[7])Value+=HF+Dh[7]; return Value; default: return Value;}}; _7h.prototype.QJ=function(row,F6){ if(!row.Spanned)return F6; var BD=Get(row,F6+"MergeEdit"); if(!BD){ BD=Get(row,F6+"Merge"); if(BD)BD=(BD+"").split(",")[0];} if(!BD||!this.Cols[BD])BD=F6; if(!this.Cols[BD].Visible&&!(Get(row,F6+"MergeType")&2))return; return BD;}; _7h.prototype.StartEdit=function(row,F6,PR){ if(row==null)row=this.FRow; if(F6==null)F6=this.FCol; if(!row||!F6||row.Page||!row.r1)return; if(this.EditMode||!this.CanEdit(row,F6))return; var C=this.Cols,Fa=F6; Fa=this.QJ(row,F6); if(Grids.OnStartEdit&&Grids.OnStartEdit(this,row,Fa))return; this.HideHint(); if(!PR&&Is(row,Fa+"EditServer")){ var T=this; this.NS(row,F6,function(NH){ if(NH>=0)T.StartEdit(row,F6,1);}); return;} var type=this.GetType(row,Fa); if(type=="Bool"||type=="Radio"||type=="Enum"&&this.CanEdit(row,F6)==2)return; this.ScrollIntoView(row,F6,null,null,1); this.Mw(); if(Grids.OnCustomStartEdit){ this.QK=Grids.OnCustomStartEdit(this,row,Fa,Get(row,Fa),this.KD.Edit.Edit,this.KD.Edit.Edit.offsetWidth-this.Img.M7); if(this.QK){this.EditMode=true;return;}} if(type=="Enum"){ var G9=this.G7(row,Fa),EX=this.Gw(row,Fa,"Range"),Dh=Get(row,Fa),Ik; if(EX){Ik=Dh?(Dh+"").split(this.Lang.Format.ValueSeparator):[Dh];Dh=Ik[0];} var M=this.GetEnum(row,Fa,"EnumMenu",G9); if(M){ M=DV.DW(M); if(!M)this.Debug(2,"Incorrect EnumMenu in [",this.HK(row),",",Fa,"]"); if(M&&EX){ for(var i=0;i<M.Items.length;i++){ var Es=M.Items[i].Name; for(var j=0;j<Ik.length;j++)if(Ik[j]==Es)M.Items[i].Value=1;}}} if(!M){ var QL=this.GetEnum(row,Fa,"Enum",G9); if(!QL){this.Ln(this.KD);return;} var G8=QL.slice(1).split(QL.charAt(0)); var GN=!Dh&&Dh!==0&&this.IndexEnum==1||Dh-0+""==Dh&&(Dh>=0&&Dh<G8.length||this.IndexEnum==1); var QM=this.GetEnum(row,Fa,"EditEnum",G9); QM=QM?QM.slice(1).split(HC.charAt(0)):G8; var HC=this.GetEnum(row,Fa,"EnumKeys",G9,1); if(HC)HC=HC.slice(1).split(HC.charAt(0)); var B3="{Items:[",Es; for(var i=0;i<G8.length;i++){ if(HC&&HC[i]!=null)Es=HC[i]; else if(GN)Es=i; else Es=G8[i]; if(i)B3+=","; B3+='{Name:"'+(Es+"").replace(/\"/g,'\\"')+'",'; if(EX){ B3+='Bool:1,'; for(var j=0;j<Ik.length;j++)if(Ik[j]==Es)B3+="Value:1,";} B3+='Text:"'+(G8[i]+"").replace(/\"/g,'\\"')+'"}';} B3+="]}"; M=DV.DW(B3); if(M&&this.Gw(row,F6,"Button")=="")M.ShowCursor=0;} if(!M){this.Ln(this.KD);return;} if(row.Kind=="Filter"){ var QN=Get(row,F6+"FilterOff");if(QN==null)QN=""; for(var i=0;i<M.Items.length;i++)if(M.Items[i].Name==QN)break; if(i==M.Items.length){ M.Items.unshift({Name:QN}); M.FW=0;DV.DW(M);}} M.MinWidth=0; M.Base=this.Img.Style+"Menu"; M.Class=this.Img.Style+"EnumMenu"; M.CloseClickHeader=1; if(Fa==F6&&!M.Header&&M.ShowCursor)M.Header="<div class='"+this.Img.Style+"EnumHeader'>"+this.HB(row,Fa,1)+"</div>"; M.Cursor=Get(row,Fa); if(EX){ M.Buttons=["Clear","Ok"]; M.Separator=this.Lang.Format.ValueSeparator; M.Texts={Aq:this.GetAlert("MenuOk"),Clear:this.GetAlert("MenuClear"),FG:this.GetAlert("MenuAll")};} var AM=this.IC(row,F6); if(Fa!=F6){ var AJ=this.H5(row,F6); AM.IQ+=AJ[0];AM.IR+=AJ[1]; AM.Width=AJ[2];AM.Height=AJ[3]; if(AM.Height<15)AM.Height=15;} AM.X=AM.IQ;AM.Y=AM.IR; if(F6==this.MainCol&&!row.Fixed){ var left=0,FX=row.Level;if(this.HideRootTree)FX--; if(FX>=0)left+=this.Img.Tree; if(FX>0)left+=FX*this.Img.Line; AM.X+=left;AM.Width-=left;} var T=this; M.OnSave=function(AI,Fj){ var Bb=""; if(AI)Bb=AI.Value!=null?AI.Value:AI.Name; else Bb=Fj.join(M.Separator); M.QO=1; M.Close(); T.PV(row,F6,Bb,Bb==QN);}; M.OnClose=function(){ if(!M.QO&&Grids.OnEndEdit)Grids.OnEndEdit(T,row,Fa,0,Bb); M.QO=0; T.EditMode=0; T.Ln(T.KD); T.Dialog=null;}; if(this.Dialog)this.Dialog.Close(); M=ShowMenu(M,AM); this.EditMode=1; this.Dialog=M; M.Row=row;M.Col=F6;M.Type="Enum"; return;} var QP=this.CanEdit(row,Fa)==2,color="",BJ=this.Img.Style; color=this.f[QP?"ViewedCell":"EditedCell"]+0xFFFFFF; if(Grids.OnGetColor){ var QQ=Grids.OnGetColor(this,row,F6,(color>>16)&255,(color>>8)&255,color&255,2); if(QQ!=null)color=QQ;} if(typeof(color)=="number")color="#"+Number(color).toString(16); if(Is(row,F6+"NoColor")||Is(row,"NoColor")||this.Cols[F6]&&this.Cols[F6].NoColor)color=""; var M=this.Gw(row,F6,"Edit"); if(!M)M={}; else M=As(M); M.Format=this.GetFormat(row,F6,1); M.IOFormat=M.Format; M.Type=type=="Int"||type=="Float"||type=="Date"||type=="Pass"?type:"Text"; M.EditMask=this.Gw(row,F6,"EditMask"); M.ResultMask=this.Gw(row,F6,"ResultMask"); M.ResultText=this.Gw(row,F6,"ResultText"); M.Range=this.Gw(row,F6,"Range"); M.Multi=type=="Lines"; M.ReadOnly=QP; M.Class=this.Img.Style+"Edit"+(row.Space?"Space":""); M.SaveMove=false; if(this.AutoCalendar)M.Calendar={Class:this.Img.Style+"Pick"}; var AL=this.Gw(row,F6,"Suggest"); if(AL){ AL=DV.DW(AL); AL.Base=this.Img.Style+"Menu"; AL.Class=this.Img.Style+"SuggestMenu"; AL.ShowCursor=0; AL.MinWidth=0; M.Defaults=AL; M.DefaultsReplace=this.Gw(row,F6,"SuggestReplace");} if(this.Gw(row,F6,"SuggestServer")>0){ M.OnDefaults=function(Gy,Bb){ T.NS(row,F6,function(NH){ if(NH<0)T.Debug(1,"Failed downloading cell [",row.id,",",F6,"] from ",T.NN(T.Source.Cell)); else if(T.DebugFlags["page"])T.Debug(4,"Downloaded cell [",row.id,",",F6,"] in ",T.LC("Cell"+row.id+"_"+F6)," ms"); if(NH>=0){ var AL=T.Gw(row,F6,"Suggest"); if(AL){ AL=DV.DW(AL); AL.Base=T.Img.Style+"Menu"; AL.Class=T.Img.Style+"SuggestMenu"; AL.ShowCursor=0; AL.MinWidth=0; M.DefaultsReplace=T.Gw(row,F6,"SuggestReplace"); M.DZ(AL);}}},Bb); return false;}} else if(Grids.OnSuggest){ M.OnDefaults=function(Gy,Bb){ var AL=Grids.OnSuggest(T,row,F6,Bb,Gy); if(AL==false||AL==null)return AL; AL=DV.DW(AL); AL.Base=T.Img.Style+"Menu"; AL.Class=T.Img.Style+"SuggestMenu"; AL.ShowCursor=0; AL.MinWidth=0; return AL;}} var Bb=this.GetString(row,Fa,4).replace(/\<br\>/g,"\n"); if(Grids.OnGetInputValue)Bb=Grids.OnGetInputValue(this,row,Fa,Bb); M.Value=Bb; if(type=="Link"||type=="Img"){ var Value=Get(row,Fa),BA=this.GetFormat(row,Fa,1); if(!Value)Value='|'; else Value+=""; Value=Value.split(Value.charAt(0)); if(!BA)BA="|0|1"; var Cq=BA.split(BA.charAt(0)); var Bb="",DI="^"; if(type=="Link"){ for(var i=1;i<4;i++)if(!Value[i])Value[i]=""; if(Cq[2]-0){ if(Cq[3]-0){Bb+="URL: ";DI+="URL\\: ";} Bb+=Value[1];DI+=".*";} if(Cq[3]-0){ if(Cq[2]-0){ if(Cq[1]-0==2){Bb+="\n";DI+="\\r?\\n";} else{Bb+="; ";DI+="; ";}; Bb+="TEXT: ";DI+="TEXT\\: ";} Bb+=Value[2];DI+=".*";} DI+="$";} else{ for(var i=1;i<7;i++)if(!Value[i])Value[i]=""; if(Cq[2]-0){ if(Cq[3]-0||Cq[4]-0){Bb+="SRC: ";DI+="SRC: ";} Bb+=Value[1];DI+=".*";} if(Cq[3]-0){ var Dh="W:"+Value[2]+",H:"+Value[3]+"; X:"+Value[4]+",Y:"+Value[5]; var D3="W\\:\\d{0,3},H\\:\\d{0,3};\\sX\\:\\d{0,4},Y\\:\\d{0,4}"; if(Cq[2]-0&&Cq[1]-0==2){Bb+="\n"+Dh;DI+="\\r?\\n"+D3;} else{Bb+=" ["+Dh+"]";DI+=" \\["+D3+"]";}} if(Cq[4]-0){ if(DI.length>1){ if(Cq[1]-0==2){Bb+="\n";DI+="\\r?\\n";} else{Bb+="; ";DI+="; ";}} Bb+="URL: "+Value[6]; DI+="URL: .*";} DI+="$";}; if(Cq[1]-0)M.Multi=1; M.EditMask=DI; M.Value=Bb;} if(M.Multi){ M.ParentAutoSize=1; M.MaxHeight=Get(row,"MaxEditHeight"); M.MinHeight=this.H5(row,F6)[3]; if(_7P)M.MinHeight++; M.AcceptEnters=this.AcceptEnters;} var AM={Tag:this.KD.Edit.Edit}; var T=this; M.OnSave=function(Bb,QR,QS,QT){ var empty=QT==""; if(Grids.OnEndEdit){ var DG=Grids.OnEndEdit(T,row,Fa,1,Bb); if(DG==-1)return false; if(DG)return;} if(M.Multi&&T.HH(row,Fa))Bb=Bb.replace(/\r/g,""); var QU=Get(row,Fa); if(Grids.OnSetInputValue)Bb=Grids.OnSetInputValue(T,row,Fa,Bb); if(Grids.OnValueChanged)Bb=Grids.OnValueChanged(T,row,Fa,Bb); var Ff=T.SetValue(row,Fa,Bb); if(Ff){ if(T.ColorClasses&1)T.RefreshRow(row); else{T.ColorRow(row);T.RefreshCell(row,F6);}; T.UpdateRowHeight(row,1); if(row.Space!=null&&row.RelWidth)T.Il(row); M.QO=1; if(row[Fa+"Error"])row[Fa+"Error"]=""; if(T.SortRow)T.SortRow(row,Fa,true); if(Grids.OnAfterValueChanged)Grids.OnAfterValueChanged(T,row,Fa); T.Mv(); if(row.Kind=="Filter"){ var QN=Get(row,Fa+"FilterOff"); if(T.Paging==3&&!(T.OnePage&2)&&!T.Iz()){ Ff=false; T.SetValue(row,Fa,QU); T.RefreshCell(row,F6);} else if((QN!=null&&Bb==QN||Bb===""||!Bb&&empty&&(type=="Int"||type=="Float"))&&row[Fa+"Filter"]&&Get(row,Fa+"DefaultFilter")!=0){ T.SetFilterOp(row,Fa,0);} else if(Bb!=QN||QN==null)T.DoFilter(row,Fa);} if(T.SaveValues)T.SaveCfg();} if(_7I)T.Update();}; M.OnClose=function(){ if(!M.QO&&Grids.OnEndEdit)Grids.OnEndEdit(T,row,Fa,0,Bb); M.QO=0; T.EditMode=false; T.Ln(T.KD); T.Edit=null; M.QO=null;}; M.OnResize=function(CS,QV){ var E=T.IC(T.FRow,T.FCol); if(M.QW==null)M.QW=E.Height-parseInt(AM.Tag.firstChild.style.height); E.Height=CS+M.QW; T.Lm(T.KD,E);}; Cz(M,AM); AM.Tag.firstChild.style.backgroundColor=color; this.EditMode=true; this.Edit=M; return;}; _7h.prototype.EndEdit=function(row,F6,save,QX){ if(!row||!F6)return null; var C=this.Cols[F6]; if(!this.EditMode||!this.CanEdit(row,F6))return null; if(this.QK){ var Bb=Grids.OnCustomEndEdit(this,row,F6,save,this.QK); this.Ln(this.KD); this.EditMode=false; if(save)this.PV(row,F6,Bb);} else if(this.Edit){ if(save)this.Edit.Save(); else this.Edit.Close();} else if(this.Dialog){ this.Dialog.Close();} return;}; _7h.prototype.NX=function(){ if(this.EditMode&&this.EndEdit(this.FRow,this.FCol,true)==-1)return false; for(var i=0;i<Grids.length;i++){ var G=Grids[i]; if(G&&G.EditMode&&G.EndEdit(G.FRow,G.FCol,true)==-1)return false;} return true;}; _7h.prototype.ActionStartEdit=function(){ var row=this.FRow,F6=this.FCol; if(this.EditMode||!row||row.Page||!F6||!this.CanEdit(row,F6))return false; this.StartEdit(row,F6);return true;}; _7h.prototype.ActionCancelEdit=function(){ if(!this.EditMode)return false; return this.EndEdit(this.FRow,this.FCol,false)===false;}; _7h.prototype.ActionAcceptEdit=function(){ if(!this.EditMode)return false; var DG=this.EndEdit(this.FRow,this.FCol,true); return DG===false||DG===true;}; _7h.prototype.ActionChangeBool=function(CE){ var row=CE?this.FRow:this.ARow,F6=CE?this.FCol:this.ACol; if(!row||!F6||this.GetType(row,F6)!="Bool"||this.CanEdit(row,F6)!=1)return false; var Bb=this.GetValue(row,F6)?0:1; if(Grids.OnEndEdit&&Grids.OnEndEdit(this,row,F6,true,Bb))return false; if(Grids.OnValueChanged)Bb=Grids.OnValueChanged(this,row,F6,Bb); this.SetValue(row,F6,Bb); if(Grids.OnAfterValueChanged)Grids.OnAfterValueChanged(this,row,F6); this.RefreshCell(row,F6); if(row.Kind=="Filter"&&this.DoFilter)this.DoFilter(row,F6); return true;}; _7h.prototype.ActionChangeRadioLeft=function(){this.QY(1);}; _7h.prototype.ActionChangeRadioRight=function(){this.QY(0);}; _7h.prototype.QY=function(shift){ var Md=this.FRow,LS=this.FCol; if(!Md||!LS||this.GetType(Md,LS)!="Radio"||this.CanEdit(Md,LS)!=1)return false; var Cq=this.GetFormat(Md,LS); if(!Cq)return false; Cq=Cq.split(Cq.charAt(0)); var QZ=Cq[1]-0; if(QZ&16)return false; var Dh=this.GetValue(Md,LS); if(Dh==null||Dh===""){ if(shift)Dh=Cq.length-8; else Dh=0;} else if(shift){ if(Dh>0)Dh--; else if(QZ&8&&Dh==0)Dh--; else Dh=Cq.length-8;} else{ if(Dh<Cq.length-8)Dh++; else if(QZ&8&&Dh==Cq.length-8)Dh++; else Dh=0;}; this.PV(Md,LS,Dh);}; _7h.prototype.ActionChangeRadio=function(){ var E=this.Event;if(!E.Special)return false; var Bb=E.Special.replace("Radio",""); if(!(Bb-0))return false; var Cq=this.GetFormat(this.ARow,this.ACol); if(!Cq)return false; Cq=Cq.split(Cq.charAt(0)); var QZ=Cq[1]-0; Bb--; if(QZ&16){ var QU=Get(this.ARow,this.ACol); Bb=1<<Bb; if(QU&Bb)Bb=QU&~Bb; else Bb|=QU;} else if(QZ&8&&Get(this.ARow,this.ACol)==Bb)Bb=null; this.PV(this.ARow,this.ACol,Bb); return true;}; _7h.prototype.PV=function(row,F6,Bb,PS){ var Fa=F6; Fa=this.QJ(row,F6); if(Bb-0+""==Bb)Bb-=0; if(this.EditMode){ if(this.EndEdit(row,F6,0)==-1)return false;} else if(Grids.OnEndEdit&&Grids.OnEndEdit(this,row,Fa,true,Bb))return false; if(Grids.OnValueChanged)Bb=Grids.OnValueChanged(this,row,Fa,Bb); if(this.SetValue(row,Fa,Bb)){ if(this.SaveValues)this.SaveCfg(); if(this.SortRow)this.SortRow(row,F6,true); if(Grids.OnAfterValueChanged)Grids.OnAfterValueChanged(this,row,Fa); this.RefreshCell(row,F6); this.Qa(row,Fa); this.UpdateRowHeight(row,1); this.Mv(); if(row.Kind=="Filter"&&this.DoFilter){ this.Qb(row,F6); if(PS){ if(row[F6+"Filter"])this.SetFilterOp(row,F6,0);} else this.DoFilter(row,F6);}}}; _7h.prototype.Qc=function(Br){ if(!Br)return ""; var shift=Br.shiftKey;alt=Br.altKey;Qd=Br.ctrlKey; if(shift==null)shift=Grids.Keys[16]; if(Qd==null)Qd=Grids.Keys[17]; if(alt==null)alt=Grids.Keys[18]; return(shift?"Shift":"")+(Qd?"Ctrl":"")+(alt?"Alt":"");}; _7h.prototype.Qe=function(name,AY){ var Db=_7Ag.length,DG=0,E=this.Event; for(var i=0;i<Db;i++){ var Es=_7Ag[i]; E.Level=Es; if(E[Es]){ var DG=this.PW(name,E[Es],AY); if(DG)return DG&&DG<100;}} return 0;}; _7h.prototype.Qf=function(name,AY){ if(this.Dialog)return this.PW(name,this.Dialog.Type,AY); if(!this.EditMode)return this.PW(name,"",AY); if(this.HG(this.FRow,this.FCol)){ var DG=this.PW(name,"EditMultiline",AY); if(DG)return DG;} return this.PW(name,"Edit",AY);}; _7h.prototype.PW=function(name,target,AY){ var E=this.Event; E.Name=name; E.Prefix=AY; E.Qg=target; this.ARow=E.Row;this.ACol=E.Col; var AM; if(target=="Cell")AM=AY?[AY+name+target,name+target,AY+name,name]:[name+target,name]; else AM=AY?[AY+name+target,name+target]:[name+target]; for(var i=0;i<AM.length;i++){ var Qh="On"+AM[i],row=E.Row,F6=E.Col,AJ; if(Grids[Qh]&&!_7Ah[Qh]){ try{ var DG=Grids[Qh](this,E); if(DG)return DG;} catch(H){this.Debug(1,"Global event handler '",(Grids[Qh]+"").replace(/[\n\r]/g," "),"' for event ",Qh," failed with exception: "+(H.message?H.message:H));}} if(row&&F6){ var Qi=F6+Qh; AJ=row[Qi]; if(!AJ&&row.Def)AJ=row.Def[Qi];} if(!AJ&&row){ AJ=row[Qh]; if(!AJ&&row.Def)AJ=row.Def[Qh];} if(!AJ&&F6){ var C=this.Cols[F6]; if(C)AJ=C[Qh];} if(AJ){ AJ=this.Qj(AJ,Qh); if(AJ){ try{ var DG=AJ.apply(this,[E]); if(DG)return DG;} catch(H){this.Debug(1,"Cell action [",row.id,",",F6,"] '",(AJ+"").replace(/[\n\r]/g," "),"' for event ",Qh," failed with exception: "+(H.message?H.message:H));}}} var AJ=this.Actions[Qh]; if(AJ){ AJ=this.Qj(AJ,Qh); if(AJ){ try{ var DG=AJ.apply(this,[E]); if(DG)return DG;} catch(H){this.Debug(1,"Action '",(AJ+"").replace(/[\n\r]/g," "),"' for event ",Qh," failed with exception: "+(H.message?H.message:H));}}}} return 0;}; var _7Ai=/\/\*(\*[^\/]|[^\*])*\*\/|\"(\\\\|\\\"|[^\"])*\"|\'(\\\\|\\\'|[^\'])*\'|[a-zA-Z_\$]+|[0-9][0-9a-fA-A]*|[^\'\"0-9a-zA-Z_\s]+/g; var _7Aj={"break":1,"case":1,"catch":1,"continue":1,"default":1,"delete":1,"do":1,"else":1, "false":1,"finally":1,"for":1,"function":1,"if":1,"in":1,"instanceof":1,"new":1,"null":1,"return":1,"switch":1, "this":1,"throw":1,"true":1,"try":1,"typeof":1,"var":1,"void":1,"while":1,"width":1, "arguments":1,"Array":1,"Boolean":1,"Date":1,"decodeURI":1,"decodeURIComponent":1,"encodeURI":1,"encodeURIComponent":1, "Error":1,"escape":1,"Function":1,"Infinity":1,"isFinite":1,"isNaN":1,"Math":1,"NaN":1,"Number":1,"Object":1, "parseFloat":1,"parseInt":1,"RegExp":1,"String":1,"undefined":1,"unescape":1,"Event":1}; _7h.prototype.Qj=function(value,name){ if(typeof(value)=="function")return value; var Dh=this.ActionFormulas[value];if(Dh)return Dh; Dh=(value+"").match(_7Ai),DG=false; if(!Dh)return null; for(var j=0;j<Dh.length;j++){ if(Dh[j].search(/^\'|\"|\/\*/)==0)continue; if(Dh[j].search(/^[a-zA-Z_\$]/)==0){ var Bb=Dh[j].toUpperCase(); if(Bb=="AND")Dh[j]="&&"; else if(Bb=="OR")Dh[j]="||"; else if(Dh[j]=="return")DG=true; else if(!_7Aj[Dh[j]]&&(!j||Dh[j-1].search(/\.$/)<0)){ var Cq=Dh[j],Qk=false; var N1=this["Action"+Cq]; if(!N1&&Cq.search(/F$/)>0){ Cq=Cq.slice(0,Cq.length-1); N1=this["Action"+Cq]; if(N1){ if(!Dh[j+1]||Dh[j+1].indexOf('(')!=0)Cq+="(1)"; else Dh[j+1]="(1,"+Dh[j+1].slice(1); Qk=true;} else Cq=Dh[j];} if(!N1&&window[Cq]==null){ this.Debug(1,"Unknown property '",Cq,"' in event action ",name," = ",value); this["Action"+Cq]=new Function("return false;"); N1=true;} if(N1){ if(!Qk&&(!Dh[j+1]||Dh[j+1].indexOf('(')!=0))Cq+="()"; Dh[j]="this.Action"+Cq;}}}} Dh=Dh.join(""); try{Dh=new Function("Event",(DG?"":"return ")+Dh.replace(/\\/g,"\\\\"));} catch(H){this.Debug(1,"Wrong syntax in event action ",name," = '",value,"', exception message: ",H.message?H.message:H);Dh=new Function("return false;");}; this.ActionFormulas[value]=Dh; return Dh;}; _7h.prototype.ChangeAction=function(name,value){ if(!value){this.Actions[name]=null;return;} this.Actions[name]=value;}; var _7Ag=["Edge","Special","PartType","Part","CellState","CellEdit","CellKind","CellSection","Cell","Section","RowKind","RowSection","Grid"]; var _7Ah={OnFocus:1,OnClick:1,OnRightClick:1,OnDblClick:1,OnMouseDown:1,OnMouseUp:1,OnMouseMove:1}; _7h.prototype.Ql=function(Br,Qm){ var E={},row=Qm?Qm:this.ARow,F6,AI=this.Img,AJ;if(!Qm)this.ACol=null; E.PZ=Br.clientX;E.Pa=Br.clientY;E.Row=row;E.Sec=this.ASec; var AJ=_7u(Br);E.IQ=AJ[0]-_7AR;E.IR=AJ[1]-_7AS; if(_7N&&Br.type=="DOMMouseScroll")return this.Event; var X=AJ[0]-this.IE,Y=AJ[1]-this.IF; if((X<0||X>=this.Qn||Y<0||Y>=this.Qo)){ var Eu=1; if(row&&row.Tag){ var AJ=_7s(row.r1); if(E.IQ>=AJ[0]&&E.IQ<=AJ[0]+row.r1.offsetWidth&&E.IR>=AJ[1]&&E.IR<=AJ[1]+row.r1.offsetHeight)Eu=0;} if(Eu){ E.Row=null;E.Pt=-10000;E.Pu=10000;E.Qp=-10000;E.Qq=10000; E.Grid="Outside"; this.ASec=null;E.Sec=null; if(Grids.Active==this&&!Qm)Grids.Active=null; return E;}} if(Grids.Active!=this&&!Qm){ var G=Grids.Active; Grids.Active=this; if(G)G.GridMouseOver(Br);} E.Grid="Grid"; E.Edge="Inside"; if(this.ResizingMain){ if(Y>this.Qo-_7a){ if(X>this.Qn-_7Z){ E.Edge="Resize"; E.Qr=this.Qn-_7Z-X;} else E.Qs=this.Qn-_7Z-X;}} if(!row){ E.RowKind="NoRow"; if(this.ASec==-1){ E.RowSection="VScroll"; var Cc=this.Qt.parentNode; E.Qp=Cc.offsetLeft-X; E.Qq=E.Qp+Cc.offsetWidth; E.Pt=-Y; E.Pu=E.Pt+Cc.offsetHeight;} else if(this.ASec==-2||this.ASec==-3||this.ASec==-4||this.ASec==-5){ E.RowSection=this.ASec==-3?"HScroll":"Other"; var Cc=this.Qu.parentNode; if(this.ASec==-2)Cc=Cc.previousSibling; if(this.ASec==-4)Cc=Cc.nextSibling; if(this.ASec==-5){Cc=Cc.nextSibling;if(this.ShortHScroll&&Cc.nextSibling)Cc=Cc.nextSibling;} E.Qp=Cc.offsetLeft-X; E.Qq=E.Qp+Cc.offsetWidth; E.Pt=Cc.parentNode.offsetTop-Y; E.Pu=E.Pt+Cc.offsetHeight;} else if(this.ASec==-6){ var GP=this.Qv.parentNode,Qw=this.Qv,Qx=Qw.firstChild; X-=GP.offsetLeft;Y-=GP.offsetTop; if(_7P&&!_7U){X-=Qw.offsetLeft;Y-=Qw.offsetTop;} if(_7P){X-=Qw.clientLeft;Y-=Qw.clientTop;} if(Y<this.NE.offsetHeight){ if(X<=this.Mouse.EdgeSize){E.Edge="PagerHeaderLeft";E.Qs=this.Mouse.EdgeSize-X;} else if(X>=Qx.offsetWidth-this.Mouse.EdgeSize){E.Edge="PagerHeaderRight";E.Qr=Qx.offsetWidth-this.Mouse.EdgeSize-X;} else{E.Qr=this.Mouse.EdgeSize-X;E.Qs=Qx.offsetWidth-X-this.Mouse.EdgeSize;}; E.CellSection="PagerHeader"; E.Cell="Empty"; E.Qp=-X;E.Qq=GP.offsetWidth-X; E.Pt=-Y;E.Pu=this.NE.offsetHeight-Y;} else{ Y-=this.Qy.offsetTop-this.Qy.scrollTop; if(_7P&&!_7U)Y-=this.Qy.firstChild.offsetTop; if(this.Qy.clientTop)Y-=this.Qy.clientTop; X-=this.Qy.offsetLeft; var Qz=this.Q0.firstChild,Q1=this.Q2(); E.Qp=-X;E.Qq=this.Qy.firstChild.offsetWidth-X; var Au=Math.floor(Y/Q1); if(Au<0); else if(X>Qz.offsetWidth){ E.Cell="Empty"; E.Pt=-Y;E.Pu=this.Qy.offsetHeight-Y; E.Qp=Qz.offsetWidth-X;E.Qq=GP.offsetWidth-X;} else if(Au<this.Q0.childNodes.length){ E.Special="PagerPage"+(Au+1); E.Cell="PagerPage"; Y-=this.Q0.childNodes[Au].offsetTop; E.Pt=-Y;E.Pu=Q1-Y;} else{ E.Cell="Empty"; Y-=this.Q0.offsetHeight; E.Pt=-Y;E.Pu=this.Qy.offsetHeight-Y;}; E.CellSection="PagerBody";}; E.X=X; E.Y=Y; E.RowSection="Pager"; E.Col="Pager";} else E.RowSection="Other"; return E;} E.RowSection="Row"; var GC=row.Kind=="Header"; if(GC){E.RowKind="HeaderRow";E.CellSection="Header";} else if(row.Space){E.RowKind="SpaceRow";E.CellSection="Space";E["Section"]="All";} else if(row.Fixed){E.RowKind="FixedRow";E.CellSection="Fixed";} else{E.RowKind="BodyRow";E.CellSection="Body";}; E.CellKind="Kind"+row.Kind; if(row.Space){ var F6=this.ASpaceCol,H6=this.GetCell(row,F6); if(row.Tag){ var IG=_7s(row.r1); X+=this.IE-IG[0],Y+=this.IF-IG[1]; Y-=row.r1.firstChild.offsetTop; if(_7P)Y-=row.r1.clientTop;} else{ Y-=row.r1.parentNode.parentNode.offsetTop+row.r1.firstChild.offsetTop; if(_7P)Y-=row.r1.offsetTop+row.r1.clientTop;}; if(H6){ X-=H6.offsetLeft+AI.Hk+row.r1.firstChild.offsetLeft; if(_7P)X-=row.r1.offsetLeft+row.r1.clientLeft; E.Width=H6.offsetWidth; E.Height=H6.offsetHeight; E.Qq=E.Width-X; E.Pu=E.Height-Y;}} else{ var Hj;X-=AI.Hk; if(X<this.Hl){Hj=0;X-=AI.Hm;E["Section"]="Left";} else{ X-=this.Hl; if(X<this.Hn){Hj=1;E["Section"]="Mid";var Ho=this.GetScrollLeft();X-=AI.Hp-Ho;} else{ X-=this.Hn; if(X<this.Hq){Hj=2;E["Section"]="Right";X-=AI.Hr;} else{E.Y=Y;E.Cell="Empty";return E;}}}; var S=this.ColNames[Hj],KP=row&&row.Spanned,left=0,Q3=X; for(var i=0;i<S.length;i++){ var BD=this.Cols[S[i]]; if(BD.Visible||KP&&Get(row,S[i]+"Span")>1){ var Ca=KP?this.KL(row,S[i]):BD.Width; X-=Ca;left+=Ca;} if(X<0){ F6=S[i]; var A5=KP?this.KL(row,F6):BD.Width; X+=A5;left-=A5; E.Qq=A5-X; E.Width=A5; break;}} if(row[F6+"Visible"]==-2){ var AP=this.Q4(row,F6); if(AP){row=AP;this.ARow=AP;E.Row=AP;}} var AP=row.r1,CS=AP.offsetHeight; if(row.G4&&row[F6+"RowSpan"]>1){ var H6=this.GetCell(row,F6); if(H6)CS=H6.offsetHeight;} if(!row.Fixed){ var Q5=this.GetScrollTop(); Y-=this.IH-Q5; var top=this.Hx(row); if(top<Q5)E.AA=Q5-top; if(top+CS>this.N[1].offsetHeight+Q5)E.AB=top+CS-this.N[1].offsetHeight-Q5; Y-=top+AI.Hy;} else{ if(row.Fixed=="Foot")Y-=this.II+AI.IJ+AI.IK; else Y-=this.IL+AI.IM+AI.IN; Y-=AP.offsetTop;}; E.Height=CS; E.Pu=CS-Y; var G5=_7AQ[Hj]; if(row[G5]!=null||row.Def[G5]!=null){ E["CellKind"]="KindUser"; E.Y=Y;E.Pt=-Y; E.Width=[this.Hl,this.Hn,this.Hq][Hj]; E.X=Q3;E.Qp=-Q3; E.Qq=E.Width-Q3; E.Q6=Hj; return E;} if(X<0){E.Y=Y;E.Cell="Empty";return E;} if(Hj==1){ if(left<Ho)E.w=Ho-left; if(left+A5>this.Hn-AI.IP+Ho)E.z=left+A5-this.Hn+AI.IP-Ho;}}; E.X=X;E.Y=Y;E.Col=F6;E.Qp=-X;E.Pt=-Y; if(F6=="_ConstWidth"){ this.ARow=null; E.Col=null; E.Row=null; E.RowKind="NoRow"; E.RowSection="Other"; E.CellKind=null; return E;} if(!Qm)this.ACol=F6; if(!F6){E.Cell="Empty";return E;} var Q7=F6+"Type",type=row[Q7],AS=row.Def,C=this.Cols[F6]; if(type==null){ type=AS[Q7]; if(C&&type==null){ type=C.Type; if(row.Kind=="Filter"&&!_7AP[type]&&type!="Panel")type="Text";}} if(Grids.OnGetType)type=Grids.OnGetType(this,row,F6,type); var G3=this.CanFocus(row,F6),BN=this.CanEdit(row,F6,type,G3); E.Cell="Cell"; if(BN)E.CellEdit="Editable"; else if(G3)E.CellEdit="ReadOnly"; else E.CellEdit="NoFocus"; if(row!=this.FRow||F6!=this.FCol)E.CellState="Regular"; else if(!this.EditMode)E.CellState="Focused"; else if(BN==2)E.CellState="Viewed"; else E.CellState="Edited"; E.Part=GC?"Caption":"Content"; E.Type=type;E.CanEdit=BN;E.CanFocus=G3; if(GC){ var Q8=this.Mouse.EdgeSize,A5=row.Spanned?this.KL(row,F6):C.Width; if(X<=Q8){var Kq=this.GetPrevCol(F6);if(!Kq||!this.Cols[Kq].CanResize)Q8=0;} if(X<=Q8){E.Edge="HeaderLeft";E.Qr=-X;E.Qs=Q8-X;} else if(C.CanResize&&X>=A5-Q8-AI.Ki){E.Edge="HeaderRight";E.Qr=C.Width-Q8-AI.Ki-X;E.Qs=C.Width-X;} else{E.Qr=Q8-X;E.Qs=A5-Q8-AI.Ki-X;}} var Q9=null; if(!Es&&F6==this.MainCol&&!row.Fixed){ Q9=row.Level*AI.Line+AI.Kj; if(this.HideRootTree)Q9-=AI.Line; if(X<Q9+AI.Tree){ var Ak=Is(row,"CanExpand")&&this.HasChildren(row); if(Ak&&X>=Q9){ E.Qp=Q9-X; E.Qq=Q9+AI.Tree-X; E.PartType="Expand";} else{ E.Qq=Q9-X+(Ak?0:AI.Tree); E.PartType="Nothing";}; E.Part="Tree"; return E;} E.Qp=Q9+AI.Tree-X;} if(type=="Panel"){ E.Part="Panel";var RA=AI.Panel; if(row.Fixed&&(row.Kind=="Group"||row.Kind=="Filter"||row.Kind=="Search")){ var x=Math.floor((E.Qq-E.Qp-RA)/2); if(X>=x&&X<=x+RA){ E.Qp=x-X; E.Qq=x-X+RA; E.PartType="Panel"+row.Kind+"ed";return E;} if(X<x)E.Qq=x-X; else E.Qp=x+RA-X; E.PartType=row.Kind=="Filter"?"PanelOff":"SpaceOff"; return E;} var Es="Panel",EA=Es+"Off",x=0,Bb=row[F6];if(Bb==null)Bb=AS[F6]; if(GC){Es="Header";EA=Es+"Off";} E.PartType=EA; if(Bb){ var H6=this.GetCell(row,F6); if(H6){ for(var AP=H6.firstChild,i=0;AP;AP=AP.nextSibling,i++){ if(_7T&&AP.tagName.toLowerCase()=='i')AP=AP.firstChild; x+=AP.offsetWidth; if(X<x){ E.Qp=x-X-AP.offsetWidth; E.Qq=X-x; Bb=(Bb+"").split(','); E.PartType=Es+Bb[i]; return E;}}} E.Qp=x-X; return E;} if(this.Dragging&&C.Move)x+=RA;if(X<x){if(Is(row,"CanDrag"))E.PartType=Es+"Move";E.Qp=x-X-RA;E.Qq=x-X;return E;} if(this.Selecting&&C.Select)x+=RA;if(X<x){if(Is(row,"CanSelect"))E.PartType=Es+"Select";E.Qp=x-X-RA;E.Qq=x-X;return E;} if(this.Deleting&&C.Delete)x+=RA;if(X<x){if(Is(row,"CanDelete"))E.PartType=Es+"Delete";E.Qp=x-X-RA;E.Qq=x-X;return E;} if(this.Copying&&C.Copy)x+=RA;if(X<x){if(Is(row,"CanCopy"))E.PartType=Es+"Copy";E.Qp=x-X-RA;E.Qq=x-X;return E;} E.Qp=x-X; return E;} var RB=F6+"Button",Bo=row[RB];if(Bo==null){Bo=AS[RB];if(C&&Bo==null)Bo=C.Button;} var RC=F6+"RightButton",RD=row[RC];if(RD==null){RD=AS[RC];if(C&&RD==null)RD=C.RightButton;} var right=1,RE="",RF=""; if(Bo==null&&BN==1&&type=="Date"&&RD!="Date"&&!this.AutoCalendar)Bo="Date"; else if(Bo){ if(Bo=="Sort"){ if(this.SortIcons<=1){if(!(Get(row,F6+"Visible")<0))E.Special="Sort";} if(this.SortIcons>=2){ var H6=this.GetCell(row,F6); if(H6){ var CS=Math.floor(H6.offsetHeight/2); if(Y<=CS){E.Pu=CS-Y;RE="Up";} else{E.Pt=CS-Y;RE="Down";}}} if(this.SortIcons==3){if(!(Get(row,F6+"Visible")<0))E.Special="Sort"+RE;}} else if(Bo=="Filter"&&!BN)Bo=null; if(row.Space&&Bo=="Defaults")RF="Space"; var RB=F6+"ButtonPos",GM=row[RB];if(GM==null){GM=AS[RB];if(C&&GM==null)GM=C.ButtonPos;} if(GM==0)right=0; else if(GM==1&&C&&C.WidthPad&&!RD){RD=Bo;Bo=null;}} if(RD&&!(Get(row,F6+"Visible")<0)){ if(E.Qq<=C.WidthPad){ E.Qp=E.Qq-C.WidthPad; if(RE)E.Special="Sort"+RE; E.PartType="Side"+RD;E.Part="Side";return E;} if(C.WidthPad)E.Qq-=C.WidthPad;} if(Bo&&!(Get(row,F6+"Visible")<0)){ if(right){ var A5=AI[Bo+RF+"Right"]+AI.Ki; if(E.Qq<=A5){ E.Qp=E.Qq-A5; if(RE)E.Special="Sort"+RE; E.PartType="Side"+Bo;E.Part="Side";return E;} E.Qq-=A5;} else{ var A5=AI[Bo+RF+"Left"];if(Q9==null)A5+=AI.Kj; if(-E.Qp<A5){ E.Qq=E.Qp+A5; if(RE)E.Special="Sort"+RE; E.PartType="Side"+Bo;E.Part="Side";return E;} E.Qp+=A5; X-=A5;}} if(type=="Button"){E.Part="Button";E.PartType="Button"+F6;return E;} if(BN){ E.PartType="Edit"+type; if(type=="Enum"&&BN==2)E.PartType="Nothing"; if(type=="Bool"){ var x=Math.floor((E.Qq-E.Qp-AI.Bool)/2); if(X>=x&&X<=x+AI.Bool&&BN==1){ E.Qp=x-X; E.Qq=x-X+AI.Bool; E.PartType="EditBool";return E;} if(X<x)E.Qq=x-X; else E.Qp=x+AI.Bool-X; E.PartType="Nothing"; return E;} if(type=="Radio"){ var H6=this.GetCell(row,F6),Ij=0; var AJ=H6.getElementsByTagName("nobr"); if(!AJ.length)AJ=H6.getElementsByTagName("td"); else if(_7P||_7F)Ij=1; if(AJ.length){ var GP=AJ[0].parentNode.parentNode.parentNode; var x=X-GP.offsetLeft,y=Y-GP.offsetTop; for(var i=0;i<AJ.length;i++){ var a=AJ[i];if(Ij)a=a.lastChild; if(x>=a.offsetLeft&&x<a.offsetLeft+a.offsetWidth&&y>=a.offsetTop&&y<a.offsetTop+a.offsetHeight&&BN==1){ E.Special="Radio"+(i+1); E.Qp=a.offsetLeft-x; E.Qq=a.offsetLeft+a.offsetWidth-x; E.Pt=a.offsetTop-y; E.Pu=a.offsetTop+a.offsetHeight-y; return E;}}} E.PartType="Nothing"; E.Qp=-2;E.Qq=2;E.Pt=-2;E.Pu=2;}} else if(type=="DropCols"){ var BJ=this.GetCell(row,F6).firstChild.firstChild.rows[0].cells; for(var i=1;i<BJ.length;i++){ if(X<BJ[i].offsetLeft){ E.Special="DropCol"+i; E.Qp=BJ[i-1].offsetLeft-X; E.Qq=BJ[i].offsetLeft-1-X; break;}} if(i==BJ.length){ E.Special="DropCol"+i; E.PartType="DropEmpty"; E.Qp=BJ[i-1].offsetLeft-X;} else E.PartType="DropCol";} else if(type=="Img"||type=="Link"){ var Dh=this.HJ(row,F6); if(Dh){ var AI=this.GetCell(row,F6); if(AI){ AI=AI.firstChild; var x=AI.offsetLeft,y=AI.offsetTop,A5=AI.offsetWidth,CS=AI.offsetHeight; if(X>=x&&X<=x+A5&&Y>=y&&Y<=y+CS){ E.Qp=x-X;E.Qq=x+A5-X; E.Pt=y-Y;E.Pu=y+CS-Y; E.PartType="Link"; return E;} if(Y<y)E.Pu=y-Y; else if(Y>y+CS)E.Pt=y+CS-Y; else if(X<x)E.Qq=x-X; else E.Qp=x+A5-X;}} E.PartType="Nothing";} else if(type=="Gantt"){ E.PartType="Gantt"; E.Qp=0;E.Qq=0;E.Pt=0;E.Pu=0;} else{ E.PartType="Nothing";}; return E;}; function _7Ak(Br){ try{ if(Grids){ for(var i=0;i<Grids.length;i++){ var G=Grids[i]; if(G&&G.J6&&!G.KE){ var AN=G.XB.firstChild; if(AN&&AN.MasterRow)G.J7(AN.MasterRow); AN.MasterRow=null;}} for(var i=0;i<Grids.length;i++){ var G=Grids[i]; if(G&&!G.KE){ if(G.EditMode){ try{G.EndEdit(G.FRow,G.FCol,0,1);} catch(H){}} G.Clear(1);}}}} catch(H){}}; function _7Al(){ var G=Grids.Active,scroll=0; if(Grids.Bc&&G&&G.P8){ var Ak=G.RG.scrollTop; if(G.P8==1){ G.RG.scrollTop-=G.P*50;} else{ G.RG.scrollTop+=G.P*50;}; if(Ak!=G.RG.scrollTop)scroll++;} if(Grids.Bc&&G&&G.RH){ var Ak=G.RI.scrollLeft; if(G.RH<0)G.RI.scrollLeft-=G.Q*50; else if(G.RH>0)G.RI.scrollLeft+=G.Q*50; if(Ak!=G.RI.scrollLeft)scroll++;} if(scroll)G.Scrolled(); if(G&&G.RJ){ G.RK++; if(G.RK*50==G.TipEnd){G.HideTip();G.RK=-1e5;} else if(G.RK*50==G.TipStart){ var Cv=Grids.OnTip?Grids.OnTip(G,G.ARow,G.ACol,G.RJ,G.Event.PZ,G.Event.Pa,G.Event.X,G.Event.Y):G.RJ; if(Cv)ShowTip({Body:Cv,Class:G.Img.Style+"Tip"},G.GetCell(G.Event.Row,G.Event.Col),0); else G.RK=-1e5;}} for(var i=0;i<Grids.length;i++){ var G=Grids[i];if(!G)continue; if(G.RL&&!G.Rendering&&!G.Loading&&new Date()-G.RL>G.PageTime){ G.RL=null; G.ShowPages();}}}; function RM(){ if(_7R)_7w(); for(var i=0;i<Grids.length;i++){ var G=Grids[i]; if(G&&!G.KE){ G.UpdatePos(!G.NoScroll); G.UpdateHeights();}}}; function _7Am(Br){ if(!Br)Br=window.event; var Bq=Br.keyCode;if(!Bq)Bq=Br.charCode; Grids.Keys[Bq]=true; if(Bq==45)Grids.DB=!Grids.DB; var DG=true; if(Grids.Focused&&!Grids.Focused.Cw)DG=Grids.Focused.RN(Br); if(!DG)CancelEvent(Br);}; function _7An(Br){ if(!Br)Br=window.event; var Bq=Br.keyCode;if(!Bq)Bq=Br.charCode; if(!Bq)Grids.Keys=new Array(); else Grids.Keys[Bq]=null;}; function _7Ao(Br){ if(!Br)Br=window.event; var DG=true; var Bq=Br.keyCode?Br.keyCode:Br.charCode; if(Grids.RO==Bq){ Grids.RO=0; DG=false;} if(Grids.Focused&&!Grids.Focused.Cw){ if(Grids.OnKeyPress){ if(Grids.OnKeyPress(Grids.Focused,Bq,Br))return true;} if(Bq==9)DG=false;} if(!DG)CancelEvent(Br);}; _7h.prototype.RN=function(Br){ if(this.Cw)return true; var Bq=Br.keyCode?Br.keyCode:Br.charCode; var AY=this.Qc(Br); if(Grids.OnKeyDown&&Grids.OnKeyDown(this,Bq,Br,this.l[Bq],AY))return true; var Md=this.FRow,LS=this.FCol,target=""; if(this.EditMode){ if(this.HG(this.FRow,this.FCol)){ if(_7Q&&(Bq==38||Bq==40))this.Cd=(new Date).getTime()+100; if(Bq==13&&AY.search(/Alt|Ctrl/)<0&&this.HH(Md,LS)&&this.CanEdit(Md,LS)==1)return true;}} var DG=this.Qf(this.l[Bq],AY); if(DG){ CancelEvent(Br); Grids.RO=Bq;} else Grids.RO=0; return!DG;}; _7h.prototype.GridClick=function(Br){ if(Br){ var Ca=Br.clientX-this.RP,Cb=Br.clientY-this.RQ; var Bh=this.Mouse.ClickSize; if(Ca>Bh||Ca<-Bh||Cb>Bh||Cb<-Bh)return false;} if(this.Cd>new Date())return; var E=this.Event,DG=false; if(!E.Row||E.Row.Kind!="Header")this.RR=0; this.HideTip(); if(E.Type=="Button"){ var T=this,row=E.Row,F6=E.Col; function RS(RT){ var data=row[F6+"ReloadData"]; var RU=row[F6+"Tab"]-0; if(RU){ row[F6]=1; var C=row.Cells; for(var i=0;i<C.length;i++){ if(F6!=C[i]&&row[C[i]+"Tab"]==RU){ row[C[i]]=0;}} T.Calculate(1,1,1); T.RefreshRow(row);} if(data&&RT!=null){ data=data.split(data.charAt(0)); data=data[RT+1];} if(data){ T.Source.Data.Url=null;T.Source.Data.Tag=null;T.Source.Data.Data=null; if((data+"").search(/\s*\</)>=0)T.Source.Data.Data=data; else if(GetElem(data))T.Source.Data.Tag=data; else T.Source.Data.Url=data; T.ReloadBody(null,0,"Reload");}}; if(row[F6+"Menu"]){ if(!this.Dialog||this.Dialog.Row!=row||this.Dialog.Col!=F6){ var M=row[F6+"Menu"];M=M.split(M.charAt(0)); var AL=new Array(),Au=0; for(var i=1;i<M.length;i++){ AL[Au]=M[i];if(!AL[Au])AL[i]="&nbsp;"; Au++;} var BQ=Get(row,F6+"ClassButton"); this.ShowMenu(row,F6,AL,null,function(Bb){ T.CloseDialog(); var RU=row[F6+"Tab"]-0; if(RU){ row[F6+"IconChecked"]=M[Bb+1]; RS(Bb);} var I1=row[F6+"Actions"]; if(I1){ I1=I1.split(I1.charAt(0)); I1=I1[Bb+1]; if(I1){ I1=T.IV(I1,row.Cells,1); var AM=new TCalc();AM.Row=row;AM.Col=F6;AM.Grid=T;AM["Value"]=row[F6]; I1(AM); T.Calculate(1,1,1);}}},1,null,null,null,null,null,BQ,null);}} else RS(); if(this.DoAction&&E.Row[E.Col+"Action"]){ if(this.EditMode)this.EndEdit(this.FRow,this.FCol); DG=this.DoAction(E.Row,E.Col); this.Calculate(1,1,1);}} if(Grids.OnClick&&E.Row&&E.Col)DG=Grids.OnClick(this,E.Row,E.Col,E.X,E.Y,false,Br)||DG; if(!DG)DG=this.Qe("Click",this.Qc(Br)); if((this.DetailOn&7)==2)this.ActionShowDetail(); if(E.Row==this.FRow&&E.Col==this.FCol){ this.RV(this.FRow,this.FCol); this.RW(this.FRow,this.FCol);} if(DG&&E.Type!="Html"&&Br)CancelEvent(Br); this.RX=(new Date).getTime(); if(this.SelectingText&&DG&&Br&&(Br.ctrlKey||Br.shiftKey))this.HV(Br);}; _7h.prototype.GridDblClick=function(Br){ if(Br){ var Ca=Br.clientX-this.RP,Cb=Br.clientY-this.RQ; var Bh=this.Mouse.ClickSize; if(Ca>Bh||Ca<-Bh||Cb>Bh||Cb<-Bh)return false;} var E=this.Event,DG=false; if(Grids.OnDblClick)DG=Grids.OnDblClick(this,E.Row,E.Col,E.X,E.Y,Br); if(!DG)DG=this.Qe("DblClick",this.Qc(Br)); if((this.DetailOn&7)==3)this.ActionShowDetail(); if(DG)CancelEvent(Br); return!DG;}; _7h.prototype.GridRightClick=function(Br){ var E=this.Event,DG=false; if(Grids.OnRightClick)DG=Grids.OnRightClick(this,E.Row,E.Col,E.X,E.Y,Br); if(!DG)DG=this.Qe("RightClick",this.Qc(Br)); if(DG)CancelEvent(Br); return!DG;}; _7h.prototype.GridMouseDown=function(Br){ if(this.Cw)return true; var E=this.Event,row=E.Row,F6=E.Col,DG=false; this.RP=Br.clientX;this.RQ=Br.clientY; if(Br.which!=null)this.RY=Br.which; else if(Br.button&1)this.RY=1; else if(Br.button&2)this.RY=3; else if(Br.button&4)this.RY=2; E.Button=this.RY; if(!DG&&(this.ASec>=0||this.ASec==-6&&E.CellSection=="PagerHeader")){ if(this.EditMode&&this.DragEdit&&(row!=this.FRow||F6!=this.FCol)&&row&&F6)this.EndEdit(this.FRow,this.FCol,1); if(!this.EditMode){ var AS=new _7f(); AS.Event={};for(var H in E)AS.Event[H]=E[H]; AS.Action=null; AS.X=Math.floor(Br.clientX/_7r);AS.Y=Math.floor(Br.clientY/_7r); AS.Row=row;AS.Col=F6; AS.Grid=this; AS.RZ=E.X;AS.Ra=E.Y; AS.QA=row;AS.Rb=F6; AS.QC=AS.X;AS.QD=AS.Y; AS.QB=this; if(Grids.Bc)this.GridMouseUp(Br); Grids.Bc=AS;}} if(!DG&&Grids.OnMouseDown)DG=Grids.OnMouseDown(this,row,F6,E.X,E.Y,Br); if(!DG)DG=this.Qe("MouseDown",this.Qc(Br)); if(DG)CancelEvent(Br); if(!_7P&&!this.SelectingText&&E.Q6==null)return false; return!DG;}; _7h.prototype.GridMouseUp=function(Br){ var E=this.Event,row=E.Row,F6=E.Col,DG=false,AS=Grids.Bc; if(AS&&AS.Action){ if(AS.Pz)DG=AS.Pz.apply(this); if(DG&&_7P){ this.Cd=(new Date).getTime()+100; this.RX=this.Cd;} Grids.Bc=null; this.Rc(); this.GridMouseOver(Br,1);} if(!DG&&Grids.OnMouseUp)DG=Grids.OnMouseUp(this,row,F6,E.X,E.Y,Br); if(!DG)DG=this.Qe("MouseUp",this.Qc(Br)); if(DG)CancelEvent(Br); return!DG;}; _7h.prototype.GridMouseOver=function(Br,Ix){ var E=this.Event,Ca,Cb; if(Br){Ca=Br.clientX-E.PZ;Cb=Br.clientY-E.Pa;} else{Ca=0;Cb=0;Ix=1;Br={clientX:E.PZ,clientY:E.Pa}}; if(Ca>=E.Qp&&Ca<=E.Qq&&Cb>=E.Pt&&Cb<=E.Pu&&this.ARow==E.Row&&this.ASec==E.Sec&&!Ix&&Grids.Active==this){ E.X+=Ca;E.Y+=Cb; E.Qp-=Ca;E.Pt-=Cb; E.Qq-=Ca;E.Pu-=Cb; E.PZ+=Ca;E.Pa+=Cb; E.IQ+=Ca;E.IR+=Cb; if(E.Type=="Gantt")this.ActionHoverGantt(); return;} if(this.Rd)return false; this.Rd=1; E=this.Ql(Br); if(E.Qq>E.Qs)E.Qq=E.Qs; if(E.Qp<E.Qr)E.Qp=E.Qr; if(E.w){var Re=E.X-E.w;if(-E.Qp>Re)E.Qp=-Re;} if(E.z){var Rf=E.Width-E.X-E.z;if(E.Qq>Rf)E.Qq=Rf;} if(E.AA){var Rg=E.Y-E.AA;if(-E.Pt>Rg)E.Pt=-Rg;} if(E.AB){var Rh=E.Height-E.Y-E.AB;if(E.Pu>Rh)E.Pu=Rh;} E.I=0;E.J=0; var DG=0,AY=this.Qc(Br),row=E.Row,F6=E.Col,Cc=this.AE;if(!Cc)Cc=[]; var AL=[],Ff=null,Ri=null,Db=_7Ag.length; for(var i=0;i<Db;i++){ var Es=_7Ag[i]; if(E[Es]&&(E[Es]!=Cc[Es]||i<=8&&Cc.Col!=F6||i<=12&&(Cc.Row!=row||Ix))){ Ri=i;if(Ff==null)Ff=i; AL[i]=Es;}} if(Ri==1&&Ff==1&&E.RowSection=="Pager"){Ri=8;Ff=7;AL[7]=_7Ag[7];AL[8]=_7Ag[8];} if(Ri==9&&Ff==9){Ff=6;AL[6]=_7Ag[6];AL[7]=_7Ag[7];AL[8]=_7Ag[8];} this.MK=0;this.Mb=0;this.Rj=0; for(var i=Ff;i<=Ri;i++){this.AC[_7Ag[i]]=null;this.AD[_7Ag[i]]=null;} var O2=this.DebugFlags["event"],Rk=""; if((Ri>=2||Ri==null)&&this.Rl)this.HideHint(); if(Grids.OnMouseOver)Grids.OnMouseOver(row,F6,this.Event.X,this.Event.Y,Br); if(O2)Rk+="row="+(E.Row?(E.Row.id?E.Row.id:"???"):"none")+"; col="+(F6?F6:"none")+"; "; for(var i=Ff;i<=Ri;i++)if(AL[i]){ var Es=AL[i]; this.Event=Cc; Cc.Level=Es; DG=this.PW("MouseOut",Cc[Es],AY); if(DG)break; this.Event=E; E.Level=Es; DG=this.PW(Grids.Bc?"DragOver":"MouseOver",E[Es],AY); if(O2)Rk+=Es+"="+E[Es]+"; "; if(row&&F6){ var Cu=this.Gw(row,F6,E[Es]+"Cursor"); if(Cu==null&&E[Es]=="Cell")this.Gw(row,F6,"Cursor"); if(Cu)this.AC[_7Ag[i]]=Cu;} var Cv=this.Gw(row,F6,E[Es]+"Title"); if(Cv==null&&E[Es]=="Cell"){ Cv=this.Gw(row,F6,"Error"); if(Cv==null)Cv=this.Gw(row,F6,"Title"+Get(row,F6)); if(Cv==null)Cv=this.Gw(row,F6,"Title"); if(Cv==null)Cv=this.Gw(row,F6,"ToolTip"); if(Cv==null)Cv=this.Gw(row,F6,"Tip");} if(Cv==1){this.AD[_7Ag[i]]=this.GetString(row,F6);} else if(Cv!=null)this.AD[_7Ag[i]]=Cv; if(DG)break;} if(Ff!=null){ for(var i=0;i<Db;i++)if(this.AC[_7Ag[i]]){this.ND(this.AC[_7Ag[i]]);break;} if(i==Db)this.ND(""); for(var i=0;i<Db;i++)if(this.AD[_7Ag[i]]){this.Rm(this.AD[_7Ag[i]]);break;} if(i==Db)this.Rm("");} if(Ri>=4){ if(!this.MK)this.Ln(this.KB); if(!this.Mb)this.Ma(1); if(this.Pager.Visible&&!this.Rj)this.HoverPager(); this.Refresh();} this.AE=E; this.Event=E; if(E.Type=="Gantt")this.ActionHoverGantt(); if(DG&&DG<100)CancelEvent(Br); if(O2&&Rk)this.Debug(3,Rk); this.Rd=0; return!DG;}; _7h.prototype.GridMouseMove=function(Br){ this.GridMouseOver(Br); if(Grids.P6)this.MoveMouseObject(Br); var DG=false; if(Grids.Bc)DG=this.Rn(Br); if(Grids.OnMouseMove&&!DG)DG=Grids.OnMouseMove(row,F6,this.Event.X,this.Event.Y,Br); if(!DG)DG=this.Qe("MouseMove",this.Qc(Br)); if(DG)CancelEvent(Br); return!DG;}; _7h.prototype.GridSelectStart=function(Br){ return this.SelectingText?true:false;}; _7h.prototype.Rn=function(Br,P7){ var AS=Grids.Bc; if(AS&&!AS.Action){ var Ca=Math.floor(Br.clientX/(Br.type?_7r:1))-AS.X,Cb=Math.floor(Br.clientY/(Br.type?_7r:1))-AS.Y; var a=this.Mouse.DragSize; if(Ca>=a||Ca<=-a||Cb>=a||Cb<-a){ var E=this.Event;this.Event=AS.Event; var DG=this.Qe("Drag",this.Qc(Br)); this.Event=E; if(DG){ AS.Ro=true; if(this.SelectingText)this.HV(Br);} else{ if(this.SelectingText)Grids.Bc=null; else{AS.Action="None";AS.Move=function(){return true;}}; this.Rp(AS.Row,AS.Col);}}} AS=Grids.Bc; if(AS&&AS.Move){ AS.QC=Math.floor(Br.clientX/(Br.type?_7r:1));AS.QD=Math.floor(Br.clientY/(Br.type?_7r:1)); var DG=AS.Move.apply(this,[P7]); this.GridMouseOver(Br); if(this.SelectingText)this.HV(Br); if(_7J&&!this.SelectingText&&window.getSelection){ S=getSelection();if(S)S.collapse();} return DG;} return false;}; function _7Ap(Br){ if(!Br)Br=window.event; var DG=true,CE=Grids.Focused; if(CE&&!CE.Cw){ var C=(new Date).getTime(); if(CE.RX&&CE.RX+100>C)CE.RX=null; else{ CE.CloseDialog(true); CE.RR=0; var AY=CE.Qc(Br); var DG=CE.PW("Click","Outside",AY); if(!DG){CancelEvent(Br);return;} Grids.Focused=null;}}}; function _7Aq(Br){ try{var GG=document.documentElement;}catch(Br){return;}; var G=Grids.Active; if(G){ if(!G.Cw)G.GridMouseOver(Br); if(_7P&&Br.clientX<0&&Br.clientY<0||!_7P&&!Br.relatedTarget){ if(Grids.Bc)_7Ar(Br);}}}; function DocMouseMove(Br){ if(!Br)Br=event; var DG=true; if(Br.Handled)return true; var AS=Grids.Bc; if(AS){ var G=AS.Grid; if(Grids.P6)G.MoveMouseObject(Br); DG=!G.Rn(Br,true); if(!G.EditMode)G.Refresh();} if(!DG)CancelEvent(Br);}; function _7Ar(Br){ if(!Br)Br=event; var DG=true; var AS=Grids.Bc; if(AS&&AS.Pz){ DG=!AS.Pz.apply(AS.QB); if(Grids.P6)AS.QB.Rc(Br);} Grids.Bc=null; if(!DG)CancelEvent();}; function _7y(Br){ if(!Br)Br=window.event; var DG=true; if(Grids.Active&&!Grids.Active.Cw&&!Grids.Active.NoVScroll)DG=Grids.Active.GridMouseWheel(Br,_7F&&_7H<9.5?-Br.wheelDelta:Br.wheelDelta); if(!DG)CancelEvent(Br); return DG;}; _7h.prototype.GridMouseWheel=function(Br,Rq){ if(this.Cw||this.NoVScroll||this.Event.Grid=="Outside")return true; if(this.ASec==-6){ var AM=this.Qy; if(AM.offsetHeight<AM.firstChild.offsetHeight){ AM.scrollTop-=Rq; return false;}} if(this.EditMode&&this.HG(this.FRow,this.FCol))return true; if(this.Qt.parentNode.style.display)return true; this.RG.scrollTop-=Rq; this.Scrolled(); this.GridMouseMove(Br); return false;}; _7h.prototype.SpaceMouseMove=function(Br,AO){ var AP=_7k(this.XS,AO); if(!AP)return; this.ARow=AP; this.ASec=3; this.ASpaceCol=this.TmpSpaceCol; this.TmpSpaceCol=null;}; _7h.prototype.Rp=function(row,F6){ if(_7N&&!Grids.OnDisplayRow){ var T=this,AN=[],Rr,Rs,Rt,Fj=this.RG.scrollTop,CZ=this.RI.scrollLeft; for(var i=0;i<3;i++)if(this.N[i])AN[i]=this.N[i].scrollTop; if(this.L[1])Rr=this.L[1].scrollLeft; Rs=this.N[1].scrollLeft; if(this.O[1])Rt=this.O[1].scrollLeft; var M=this.MainTag;M.style.overflow="visible"; for(var i=0;i<3;i++)if(this.N[i])this.N[i].scrollTop=AN[i]; this.RG.scrollTop=Fj;this.RI.scrollLeft=CZ; if(this.L[1])this.L[1].scrollLeft=Rr; this.N[1].scrollLeft=Rs; if(this.O[1])this.O[1].scrollLeft=Rt; setTimeout(function(){ M.style.overflow="hidden"; for(var i=0;i<3;i++)if(T.N[i])T.N[i].scrollTop=AN[i]; T.RG.scrollTop=Fj;T.RI.scrollLeft=CZ; if(T.L[1])T.L[1].scrollLeft=Rr; T.N[1].scrollLeft=Rs; if(T.O[1])T.O[1].scrollLeft=Rt;},10);}}; _7h.prototype.Ru=function(row,F6,Ep){ var Cc=new Object(),Dh; if(Grids.OnGetExportValue){ Dh=Grids.OnGetExportValue(this,row,F6,Ep); if(Dh!=null)return Dh;} Dh=Get(row,F6+"ExportValue");if(Dh!=null)return Ep+Dh; var Value=Get(row,F6),type=this.GetType(row,F6),BA=this.GetFormat(row,F6),DY=this.Lang.Format; switch(type){ case "Text": Value=DY.Ez(Value,BA); if(Value=="")return " x:str=''"+Ep; Value=Value.replace(/\&/g,"&amp;").replace(/\</g,"&lt;"); if(this.ExportType&4)return ' x:str="'+Value.replace(/\"/g,"&quot;")+'"'+Ep+Value; return Ep+Value; case "Int": case "Float": if(Value===""&&DY.EmptyNumber!=null)return " x:str=''"+Ep; if(typeof(Value)=="string"&&this.G2(row,F6))return Ep+DY.NumberToString(Value,BA,1); if(isNaN(Value-0))return " x:str=''"+Ep; Value-=0; if(this.ExportRound)Value=Math.round(Value*this.ExportRound)/this.ExportRound; return " x:num='"+Value+"'"+Ep+DY.NumberToString(Value,BA); case "Date": if(Value===""&&DY.EmptyDate!=null)return " x:str=''"+Ep; if(this.ExportType&64){ var Rv=Get(row,F6+"ExportFormat"); if(!Rv)Rv=this.Cols[F6].ExportFormat; if(Rv)BA=Rv;} if(typeof(Value)=="string"&&this.G2(row,F6))return Ep+DY.DateToString(Value,BA,1); var BQ="gd",Cq=BA.toLowerCase(); if(!BA||Cq=='d'||Cq=='m')BQ="sd"; else if(Cq=='t')BQ="st"; else if(Cq.length>1){ if(BA.search(/[dMy]/)<0)BQ="st"; else if(BA.search(/[hHmst]/)<0)BQ="sd";} var EV=(Value/60000-(new Date(Value)).getTimezoneOffset()-Date.UTC(1900,0,1)/60000)/1440; var Bb=DY.DateToString(Value-0,BA); return " class='"+BQ+(this.ExportType&64?"' x:str='"+Bb:"' x:num='"+(EV+2))+"'"+Ep+Bb; case "Bool": if(BA){ BA=(BA+"").split((BA+"").charAt(0)); if(BA.length>2)return Ep+BA[Value?2:1];} return Ep+(Value?1:0); case "Enum": Value=this.HB(row,F6,1); if(Value==="")return " x:str=''"+Ep; return Ep+Value; case "Lines": Value=DY.Ez(Value,BA); if(Value=="")return " x:str=''"+Ep; Value=Value.replace(/\&/g,"&amp;").replace(/\</g,"&lt;"); if(this.ExportType&4&&Value.indexOf('\n')<0)return ' x:str="'+Value.replace(/\"/g,"&quot;")+'"'+Ep+Value.replace(/\n/g,"<br>"); return Ep+Value.replace(/\n/g,"<br>"); case "Link": if(!Value||!Value.split)return Ep; Value=Value.split(Value.charAt(0)); var LT="",GR=""; if(BA){ BA=BA.split(BA.charAt(0)); if(BA[3])LT=BA[3]; if(BA[4])GR=BA[4]; Value[1]=(BA[5]&1&&this.BaseUrl?this.BaseUrl:"")+(BA[1]?BA[1]:"")+Value[1]+(BA[2]?BA[2]:"");} if(!Value[1]||Value[1].search(/javascript\:/)>=0)Value[1]=""; if(this.ExportType&4&&Value[2])Ep=' x:str="'+Value[2].replace(/\"/g,"&quot;")+'"'+Ep; return Ep+LT+"<a href='"+D0.Escape(Value[1])+"'>"+(Value[2]?Value[2]:Value[1])+"</a>"+GR; case "Img": if(!Value||!Value.split)return Ep; Value=Value.split(Value.charAt(0)); if(Value[6]=="")return Ep; var LT="",GR=""; if(BA){ BA=BA.split(BA.charAt(0)); if(BA[3])LT=BA[3]; if(BA[4])GR=BA[4]; Value[6]=(BA[7]&2&&this.BaseUrl?this.BaseUrl:"")+(BA[5]?BA[5]:"")+Value[6]+(BA[6]?BA[6]:"");} if(!Value[6]||Value[6].search(/javascript\:/)>=0)Value[6]=""; return Ep+LT+"<a href='"+D0.Escape(Value[6])+"'>"+this.GetText("Picture")+"</a>"+GR; case "Radio": if(!BA)return Ep+Value+""; BA=BA.split(BA.charAt(0)); if(BA.length<=7)return Ep+Value+""; Value-=0; if(!Value||Value<0)Value=0; Value+=7; if(Value>=BA.length)Value=BA.length-1; return Ep+BA[Value]; default: return Ep;}}; _7h.prototype.Rw=function(Rx,Cs,AJ,Au,Ey,AO,Em){ if(this.CancelProgress){ this.HideMessage(); this.CancelProgress=0; return;} var i,AP,Cols=this.GetVisibleCols(true),C=this.Cols,T=this; var cols=new Array(),H4=0; if(this.ExportType&8){ for(var i=0;i<3;i++){ for(var j=0;j<this.ColNames[i].length;j++){ var Fa=this.ColNames[i][j]; if(C[Fa].CanExport)cols[H4++]=Fa;}}} else{ for(i=0;i<Cols.length;i++)if(C[Cols[i]].CanExport)cols[H4++]=Cols[i];}; Cols=cols; if(!Ey){ AJ=new Array();Au=0; AJ[Au++]='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">'; AJ[Au++]='<head><meta http-equiv=Content-Type content="text/html; charset=utf-8"></head><body>'; AJ[Au++]='<style>td {white-space:nowrap} br {mso-data-placement:same-cell;} .sd {mso-number-format:"Short Date";} .st {mso-number-format:"Short Time";} .gd {mso-number-format:"General Date";}</style>'; AJ[Au++]='<!--[if gte mso 9]><xml><o:OfficeDocumentSettings><o:Colors><o:Color><o:Index>37</o:Index><o:RGB>#F0F0E0</o:RGB></o:Color><o:Color><o:Index>38</o:Index><o:RGB>#F6F6F6</o:RGB></o:Color></o:Colors></o:OfficeDocumentSettings></xml><![endif]-->'; if(this.ExportType&16)AJ[Au++]="<!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>"+this.id+"</x:Name><x:WorksheetOptions><x:NoSummaryRowsBelowDetail/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]-->"; if(this.ExportPrefix)AJ[Au++]=this.ExportPrefix; AJ[Au++]="<table border='1' bordercolor='silver' style='table-layout:fixed;border-collapse:collapse;border:1px solid black'>"; for(i=0;i<Cols.length;i++)AJ[Au++]="<col width='"+C[Cols[i]].Width+"'>"; for(var CZ=this.XH.lastChild;CZ;CZ=CZ.previousSibling)if(CZ.Kind=="Header")break;} var O5=["","","","&lt;","&lt;=","&gt;","&gt;="]; var PJ=this.ExportType&1,exp=(this.ExportType&18)==0?1:0,Ry=this.ExportType&16?1:0; function AddRow(AP,Rz){ if(!Is(AP,"CanExport"))return; if(!AP.Visible&&(!AP.Filtered||!PJ))return; var Cq=AP.Kind=="Filter"; if(Cq&&PJ)return; if(Ry&&!AP.Fixed){ var KR=""; if(!(T.ExportType&2)){ for(var GP=AP.parentNode;GP&&!GP.Page;GP=GP.parentNode)if(!GP.Expanded){KR="display:none;";break;}} AJ[Au++]="\r\n<tr style='mso-outline-level:"+AP.Level+";"+(!AP.Expanded&&!(T.ExportType&2)?"mso-outline-parent:collapsed;":"")+KR+"'>";} else AJ[Au++]="\r\n<tr>"; for(var i=0;i<Cols.length;i++){ R0=Rz; if(KH==Cols[i]&&AP.Level>0&&!(T.ExportType&32))R0+="padding-left:"+AP.Level*Iu+"px;"; var Fa=Cols[i]; if(AP.Spanned){ Fa=T.KO(AP,Fa); span=Get(AP,Fa+"Span"); if(span){ span=0; var F6=T.GetNextCol(Fa,AP); while(F6!=Cols[i]&&Cols[i]){i++;span++;} i--; span=" colspan="+span;} else span="";} else span=""; if(i==R1)R0+="border-right:1px solid black;"; else if(i==Md)R0+="border-left:1px solid black;"; if(AP.Kind=="Header"){ R0+="background:#F0F0E0;font-weight:bold;"; if(AP==CZ)R0+="border-bottom:1px solid black;";} else if(C[Fa].Sec!=1)R0+="background:#F6F6F6;"; var Bg=T.GetType(AP,Fa); if(Bg=="Lines")R0+="white-space:normal;"; if(!Cq)Ep=T.Ru(AP,Fa,">"); else{ var JV=Get(AP,Fa+"Filter"); if(!JV)Ep=""; else{ var Cp="<b style='color:red;'>"; var R2=""; if(JV==2||JV==8||JV==10||JV==12)R0+="text-decoration:line-through;"; if(JV<=6)Ep=Cp+" "+O5[JV]+" </b>"; else{ if(JV!=7&&JV!=8)Ep=Cp+"*</b>"; if(JV!=9&&JV!=10)R2=Cp+"*</b>"}; Ep=">"+Ep+T.GetString(AP,Fa)+R2;}}; var Rv=Get(AP,Fa+"ExportFormat"); if(!Rv)Rv=T.Cols[Fa].ExportFormat; if(Rv&&(!(T.ExportType&64)||Bg!="Date"))R0+=" mso-number-format:"+Rv+";"; if(R0)R0=" style='"+R0+"'"; if(Get(AP,Fa+"Visible")==0)Ep=">"; AJ[Au++]="<td"+span+R0+Ep+"</td>";} AJ[Au++]="</tr>"; return true;}; var KH=this.MainCol,Iu=30,R1=-1,Md=-1,R0="",span="",Ep,type; for(i=0;i<Cols.length;i++){ if(C[Cols[i]].Sec==0)R1=i; if(C[Cols[i]].Sec==2){Md=i;break;}} if(!Ey){ var CE=this.GetRows(this.XH); for(i=0;i<CE.length;i++)AddRow(CE[i],"background:#F6F6F6;"+(i==CE.length-1?"border-bottom:1px solid black;":"")); if(this.ExportRows){ var Ey=this.GetFirst(),FX=1000,Em=0; if(Ey)while(1){ if(!Ey.Visible&&(!Ey.Filtered||!PJ))FX=Ey.Level; else{ FX=1000; Em++;}; Ey=this.GetNext(Ey,exp); while(Ey&&Ey.Level>FX)Ey=this.GetNext(Ey,exp); if(!Ey)break;}} Ey=this.GetFirst();FX=1000;AO=0;} while(Ey){ if(AddRow(Ey,""))FX=1000; else FX=Ey.Level; Ey=this.GetNext(Ey,exp); while(Ey&&Ey.Level>FX)Ey=this.GetNext(Ey,exp); if(FX==1000&&this.ExportRows&&Ey){ AO++; if(!(AO%this.ExportRows)){ this.ShowMessage(this.GetText("ExportProgress").replace('%d',AO).replace('%d',Em).replace('%d',Math.floor(AO/Em*100)).replace('%d',this.K+".CancelProgress=1;")); setTimeout(function(){ T.Rw(Rx,Cs,AJ,Au,Ey,AO,Em);},10); return;}}} var CE=this.GetRows(this.XF); for(i=0;i<CE.length;i++)AddRow(CE[i],"background:#F6F6F6;"+(i?"":"border-top:1px solid black;")); AJ[Au++]="</table>"; if(this.ExportPostfix)AJ[Au++]=this.ExportPostfix; AJ[Au++]="</body></html>"; this.HideMessage(); this.CancelProgress=0; if(Rx&&Cs)Cs.apply(Rx,[AJ.join("")]);}; _7h.prototype.ActionExport=function(){ var E=this.Source.Export; if(E.Type&1){ if(!this.Iz())return false; var Bb="",Sec=["LeftCols","Cols","RightCols"]; for(var i=0;i<3;i++){ Bb+="<"+Sec[i]+">"; var Jf=this.ColNames[i]; for(var j=0;j<Jf.length;j++){ var F6=Jf[j],C=this.Cols[F6]; if(F6!="Panel")Bb+="<C Name='"+F6+"' Width='"+C.Width+"' Visible='"+(C.Visible?1:0)+"'/>";} Bb+="</"+Sec[i]+">";} this.R3("<Grid><IO"+(this.Source.Session!=null?" Session='"+this.Source.Session+"'":"")+"/>"+this.GetCfgRequest(E.Format)+Bb+"</Grid>");} else{ if(this.Rw)this.Rw(this,this.R3); else _7Ae("SimpleExport");}; return true;}; _7h.prototype.R3=function(Bb){ if(Grids.OnExport&&Grids.OnExport(this,Bb))return; var E=this.Source.Export; var AS=document.createElement("form"); AS.method="POST"; AS.action=E.Url; AS.acceptCharset="UTF-8"; var AI=document.createElement("input"); AI.type="hidden"; AI.name=E.Data;if(!AI.name)AI.name="Data"; if(!E.Xml)Bb=Bb.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"); AI.value=Bb; AS.appendChild(AI); for(var i in E.Param){ AI=document.createElement("input"); AI.type="hidden"; AI.name=i; AI.value=E.Param[i]; AS.appendChild(AI);} if(E.Params){ var AJ=E.Params.split('&'); for(var i=0;i<AJ.length;i++){ var B3=AJ[i].split('='); if(B3[0]){ AI=document.createElement("input"); AI.type="hidden"; AI.name=unescape(B3[0]); AI.value=unescape(B3[1]); AS.appendChild(AI);}}} document.body.appendChild(AS); AS.submit(); document.body.removeChild(AS);}; _7h.prototype.GetStringFilter=function(row,F6){ var Dh=Get(row,F6+"FilterValue"); if(Dh==null)Dh=this.GetString(row,F6,3); else Dh+=""; if(Grids.OnGetFilterValue)Dh=Grids.OnGetFilterValue(this,row,F6,Dh); return Dh;}; _7h.prototype.GetNumberFilter=function(row,F6){ var Dh=Get(row,F6+"FilterValue"); if(Dh==null)Dh=Get(row,F6); if(Dh===""&&this.EmptyNumber==null)Dh=0; if(Grids.OnGetFilterValue)Dh=Grids.OnGetFilterValue(this,row,F6,Dh); if(Dh&&typeof(Dh)=="string"&&this.G2(row,F6)){ Dh=Dh.split(this.Lang.Format.ValueSeparator)[0]; var R4=Dh.indexOf(this.Lang.Format.RangeSeparator); if(R4>=0)Dh=Dh.slice(0,R4)-0; else Dh-=0;} return Dh;}; _7h.prototype.R5=function(){ var CE="",C=this.Cols,R=this.GetFixedRows(); var O5=["","==","!=","<","<=",">",">="]; var R6=["","==0","!=0","<0","<=0",">0",">=0"]; for(var i=0;i<R.length;i++){ var AP=R[i]; if(AP.Kind!="Filter")continue; for(var BD in this.Cols){ var EW=AP[BD+"Filter"]-0;if(!EW)continue; var G3=C[BD].CanFilter; if(!G3)continue; if(CE)CE+=" &&"; if(G3==2)CE+="(Get(Row,'"+BD+"CanFilter')==0||"; var type=this.GetType(AP,BD),EX=this.G2(AP,BD); if(type=="Text"||type=="Lines"||type=="Link"||type=="Img"||type=="Html"||type=="Abs"||type=="Gantt"||type=="List"||type=="Enum"&&Get(AP,BD)-0+""!=Get(AP,BD)||EW>6){ var Bb=this.GetString(AP,BD,3); var R7=Get(AP,BD+"FilterType");if(R7==null)R7=Get(AP,"FilterType");if(!R7)R7=0; var R8=this.K+".GetStringFilter(Row,'"+BD+"')"; if(C[BD].CharCodes){ R8=this.K+".UseCharCodes("+R8+",'"+BD+"')"; Bb=this.UseCharCodes(Bb,BD);} if(R7&8){ var R9=C[BD].WhiteChars; Bb=Bb.replace(R9,""); R8=R8+".replace("+R9+",'')";} Bb=(Bb+"").replace(/\\/g,"\\\\").replace(/\'/g,"\\\'"); if(this.HH&&this.HH(AP,BD))Bb=Bb.replace(/\n/,"\\n"); if(EX&&(EW<=2||EW>=7)){ if(EW==2||EW==8||EW==10||EW==12)CE+="!"; CE+="("; var AJ=Bb.split(this.Lang.Format.ValueSeparator); for(var j=0;j<AJ.length;j++){ if(j)CE+=" || "; if(AJ[j]==String.fromCharCode(160))CE+=R8+(EW&1?"==":"!=")+"''"; else if(EW<=2)CE+=" CompareStrings("+R8+",'"+AJ[j]+"',"+R7+")==0"; else if(EW<=8)CE+="!CompareStrings("+R8+".slice(0,String('"+AJ[j]+"').length),'"+AJ[j]+"',"+R7+")"; else if(EW<=10)CE+="!CompareStrings("+R8+".slice("+R8+".length-String('"+AJ[j]+"').length,"+R8+".length),'"+AJ[j]+"',"+R7+")"; else if(EW<=12)CE+="SearchString("+R8+",'"+AJ[j]+"',"+R7+")>=0";} CE+=")";} else if(Bb==String.fromCharCode(160))CE+=R8+(EW&1?"==":"!=")+"''"; else if(EW<=6)CE+=" CompareStrings("+R8+",'"+Bb+"',"+R7+")"+R6[EW]; else if(EW<=8)CE+=(EW==8?" ":" !")+"CompareStrings("+R8+".slice(0,String('"+Bb+"').length),'"+Bb+"',"+R7+")"; else if(EW<=10)CE+=(EW==10?" ":" !")+"CompareStrings("+R8+".slice("+R8+".length-String('"+Bb+"').length,"+R8+".length),'"+Bb+"',"+R7+")"; else if(EW<=12)CE+=(EW==12?" !":" ")+"(SearchString("+R8+",'"+Bb+"',"+R7+")>=0)";} else{ var R8=this.K+".GetNumberFilter(Row,'"+BD+"')"; var Bb=EX?Get(AP,BD):this.GetValue(AP,BD); if(type=="Enum"){ var QN=Get(AP,BD+"FilterOff"); if(Bb>QN)Bb--;} if(EX&&Bb&&EW<=2&&typeof(Bb)=="string"){ var Bb=Get(AP,BD);if(!Bb)Bb=""; if(EW==2)CE+="!"; CE+="("; var AJ=Bb.split(this.Lang.Format.ValueSeparator); for(var j=0;j<AJ.length;j++){ var AN=AJ[j].split(this.Lang.Format.RangeSeparator); if(j)CE+=" || "; if(AN[1])CE+=R8+">="+AN[0]+" && "+R8+"<="+AN[1]; else CE+=R8+"=="+AN[0];} CE+=")";} else{ if(!Bb){ if(Bb==="")Bb="''"; if(this.EmptyNumber&&(EW==1||EW==2))Bb="="+Bb;} CE+=" "+R8+O5[EW]+Bb;}}; if(G3==2)CE+=")";}} this.N7=CE?new Function("Row","return "+CE):null;}; _7h.prototype.DoFilter=function(row,F6){ if(!this.Filtering)return; if(row){ if(!row[F6+"Filter"]){ var Gy=Get(row,F6+"DefaultFilter"); if(Gy==0)return; if(Gy>0)row[F6+"Filter"]=Gy; else{ var type=this.GetType(row,F6); row[F6+"Filter"]=type=="Text"||type=="Lines"||type=="Link"||type=="Img"||type=="Html"||type=="Abs"||type=="Gantt"||type=="List"?11:1;}; this.RefreshCell(row,F6);}} this.SaveCfg(); if(Grids.OnCanFilter)if(!Grids.OnCanFilter(this,false))return; this.R5(); this.SA(); var T=this,Kl=this.G4; function filter(){ T.Ln(T.KB); T.SB(Kl); T.SC(Kl); T.HideMessage(); if(Kl)T.Render(); if(Grids.OnFilterFinish)Grids.OnFilterFinish(T);}; if(this.RowCount<this.SynchroCount)filter(); else{this.ShowMessage(this.GetText("DoFilter"));setTimeout(filter,10);}}; _7h.prototype.SA=function(Kl){ var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++){ var row=CE[i]; if(row.Kind!="Filter")continue; var Ff=false; for(var BD in this.Cols){ var SD=row[BD+"Filter"]?1:0; row[BD+"Changed"]=SD; if(SD)Ff=true;} row.Changed=Ff; if(!Kl)this.RefreshRow(row);}}; _7h.prototype.SE=function(Kl){ for(var Au=this.XB.firstChild;Au;Au=Au.nextSibling)this.SF(Au,Kl);}; _7h.prototype.SF=function(row,Kl){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(AP.Filtered)continue; this.SF(AP,Kl); if((Get(AP,"CanFilter")&2||AP.LN)&&!this.HasChildren(AP)){ if(!AP.Deleted||this.ShowDeleted){ if(this.Paging||Kl)AP.Visible=0; else this.HideRow(AP);} AP.Filtered=1;}}}; _7h.prototype.SB=function(Kl){ if(!this.Filtering||!this.Filtered)return; this.Debug(4,"Filtering rows");this.LB("Filter"); var SG=this.OnePage&2&&!this.AllPages&&this.Paging?this.GetFPage():null; if(this.Paging==3&&!SG){ if(!this.AllPages)this.V=0; this.ReloadBody(null,0,"Filter"); return;} if(this.Paging>0&&!Kl&&!SG)this.SH(); var FRow=this.FRow;this.FRow=null; var Count=0,FX=1000,T=this,Kg=this.Rendering; if((this.Rendering||this.Loading)&&!Kl)Kl=1; if(!Kl)this.Rendering=true; var Lf=this.Cols[this.MainCol],N6=this.N7,N8=this.N9,OA=this.OB; function SI(AP){ if(AP.Kind=="Data"&&(!AP.Deleted||T.ShowDeleted)){ var Cq=Get(AP,"CanFilter")&1&&(N6&&!N6(AP)||N8&&!N8(AP)||OA&&OA(AP)); if(Cq&&T.StandardFilter==2&&T.HasChildren(AP))Cq=0; if(Grids.OnRowFilter)Cq=!Grids.OnRowFilter(T,AP,!Cq); if(T.Paging||Kl)AP.Visible=!Cq; else{ if(Cq){if(!AP.Filtered)T.HideRow(AP,false,Kl,1);} else if(AP.Filtered)T.ShowRow(AP,0,0,1);}; AP.Filtered=Cq; return Cq;} return true;}; function SJ(Au){ for(var AP=Au.firstChild;AP;AP=AP.nextSibling)SJ(AP); if(Au.Calculated)T.If(Au,Calc,"CalcOrder",!Kl,0,1); if(SI(Au))Count++;}; if(SG){ var Calc=this.IX(); for(var AP=SG.firstChild;AP;AP=AP.nextSibling)SJ(AP); if(this.FilterEmpty&&(N6||N8||OA||Grids.OnRowFilter))this.SF(SG,Kl); if(this.ChildPaging)this.LP(SG,!Kl);} else{ if(this.StandardFilter){ var Calc=this.IX(); for(var AP=this.GetFirst();AP;AP=this.GetNextSibling(AP))SJ(AP);} else for(var AP=this.GetFirst();AP;AP=this.GetNext(AP)){ if(FX<AP.Level)continue; if(SI(AP)){FX=AP.Level;Count++;} else FX=1000;} if(this.FilterEmpty&&(N6||N8||OA||Grids.OnRowFilter))this.SE(Kl); if(this.ChildPaging)this.LP(this.XB,!Kl);}; if(!Kl)this.Rendering=Kg; this.FRow=FRow;this.SK(); if(this.MainCol)this.SL(!Kl,1); if(Kl){ this.LC("Filter"); return Count;} if(SG){SG.State=3;this.SM(SG);} if(this.Paging>0&&!SG){ this.CreatePages(); this.SN();} else{ this.Update(); this.HideMessage();}; this.Ne(); if(this.Calculating&&this.Calculated){ if(_7K||this.RowCount<this.SynchroCount){ this.Calculate(true,true);this.HideMessage();} else{ this.ShowMessage(this.GetText("Calculate")); var T=this;setTimeout(function(){T.Calculate(true,true);T.HideMessage();},10);}} else this.Calculate(1,0,0,1); this.LC("Filter"); this.Debug(4,"TreeGrid filtered in ",this.PB("Filter")," ms"); return Count;}; _7h.prototype.ShowFilter=function(row,F6){ if(this.Cw||!row)return; var AS=this.Dialog; if(AS&&AS.Row==row&&AS.Col==F6){ this.CloseDialog(); return true;} var M=DV.DW(Get(row,F6+"FilterMenu")); if(!M)M={}; if(!M.Items)M.Items=[]; var SO=Get(row,F6+"MenuItems"); if(SO){ SO=(SO+"").split(","); for(var Es=0;Es<SO.length;Es++){ var i=SO[Es]; if(i>=0&&i<=12){ M.Items[M.Items.length]={ Name:i,Text:this.Lang["MenuFilter"]["F"+i], Icon:"<u class='"+this.Img.Style+"Filter"+i+"Left'>"+_7D+"</u>"};}}} else{ var Bg=this.GetType(row,F6); var a=7; if(Bg=="Bool")a=2; else if(Bg=="Text"||Bg=="Lines"||Bg=="Link"||Bg=="Img"||Bg=="Html"||Bg=="Abs"||Bg=="Gantt"||Bg=="List")a=13; for(var i=0;i<a;i++){ M.Items[M.Items.length]={ Name:i,Text:this.Lang["MenuFilter"]["F"+i], Icon:"<div class='"+this.Img.Style+"Filter"+i+"Menu'>"+_7D+"</div>"};}}; M.MinWidth=0; M.Base=this.Img.Style+"Menu"; M.Class=this.Img.Style+"FilterMenu"; M.CloseClickHeader=1; if(M.ShowCursor==null)M.ShowCursor=0; M.Cursor=Get(row,F6+"Filter"); if(!M.Cursor)M.Cursor=0; M.Header="<div class='"+this.Img.Style+"Filter"+M.Cursor+"Menu'>"+_7D+"</div>"; var AM=this.IC(row,F6); AM.X=AM.IQ;AM.Y=AM.IR; AM.AlignHeader="left middle"; var T=this; M.OnSave=function(AI,Fj){ T.SetFilterOp(row,F6,AI.Name-0);}; M.OnClose=function(){ T.Dialog=null;}; ShowMenu(M,AM); this.Dialog=M; M.Row=row;M.Col=F6;M.Type="Filter"; return true;}; _7h.prototype.ActionShowFilterMenu=function(CE){ return this.ShowFilter(CE?this.FRow:this.ARow,CE?this.FCol:this.ACol);}; _7h.prototype.Qb=function(row,F6){ var rel=this.Gw(row,F6,"Related"); if(rel){ rel=rel.split(","); for(var i=0;i<rel.length;i++){ if(!row[rel[i]+"Filter"]){row[rel[i]+"Filter"]=1;this.RefreshCell(row,rel[i]);}}} var Hw=this.Gw(row,F6,"Refresh"),QQ=this.Gw(row,F6,"Clear"); if(Hw||QQ){ Hw=(Hw+","+QQ).split(","); for(var i=0;i<Hw.length;i++){ if(Hw[i]&&row[Hw[i]+"Filter"]){row[Hw[i]+"Filter"]=0;this.RefreshCell(row,Hw[i]);}}}}; _7h.prototype.SetFilterOp=function(row,F6,JV){ if(!row)return; this.CloseDialog(); if(row[F6+"Filter"]==JV||!row[F6+"Filter"]&&!JV||this.Paging==3&&!(this.OnePage&2)&&!this.Iz())return; row[F6+"Filter"]=JV; this.Qb(row,F6); if(this.EditMode){ var SP=this.FRow;SQ=this.FCol; if(this.EndEdit(SP,SQ,true)&&row==SP&&F6==SQ)return;} this.RefreshCell(row,F6); this.DoFilter();}; _7h.prototype.ChangeFilter=function(cols,SR,SS,ST){ cols=FD(cols); SR=FD(SR); SS=FD(SS); var CE=this.JU()[0]; if(!CE)return; var Cc=new Object(); CE.Changed=cols.length?1:0; for(var i=0;i<cols.length;i++){ var F6=cols[i]; Cc[F6]=1; CE[F6]=SR[i]; CE[F6+"Filter"]=SS[i]-0; CE[F6+"Changed"]=1;} for(var F6 in this.Cols){ if(!Cc[F6]){ CE[F6]=null; CE[F6+"Filter"]=0; CE[F6+"Changed"]=0;}} this.RefreshRow(CE); if(!ST)this.DoFilter();}; _7h.prototype.ActionFilterOff=function(){return this.SU(0);}; _7h.prototype.ActionFilterOn=function(){return this.SU(1);}; _7h.prototype.SU=function(Bb){ if(!this.Filtering||this.Filtered==Bb)return false; if(Grids.OnCanFilter&&!Grids.OnCanFilter(this,false))return false; var SG=this.OnePage&2&&!this.AllPages&&this.Paging?this.GetFPage():null; if(this.Paging==3&&!SG){ this.Filtered=Bb; if(!this.AllPages)this.V=0; var CE=this.JU(); for(var i=0;i<CE.length;i++)this.SV(CE[i]); this.SaveCfg(); this.ReloadBody(null,0,"Filter"); return true;} if(Bb)this.Filtered=true; else{ var N6=this.N7; this.N7=null;}; var T=this; function filter(){ T.SB(); T.SC(); if(!Bb){ T.Filtered=false; T.N7=N6;} T.SaveCfg(); if(Grids.OnFilterFinish)Grids.OnFilterFinish(T); var CE=T.JU(); for(var i=0;i<CE.length;i++)T.SV(CE[i]);}; if(this.RowCount<this.SynchroCount)filter(); else{this.ShowMessage(this.GetText("DoFilter"));setTimeout(filter,10);}; return true;}; _7h.prototype.FilterTextRange=function(F6,Bb,Kl){ var HF=this.Lang.Format.ValueSeparator; if(Bb){ Bb=(Bb+"").split(HF); for(var i=0;i<Bb.length;i++)Bb[i]=Bb[i].replace(/[\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}\/]/g,"\\$&"); Bb="(^|\\"+HF+")("+Bb.join('|')+")($|\\"+HF+")"; var CE=this.K+".GetStringFilter(Row,'"+F6+"').search(/"+Bb+"/)<0";} else CE="1"; this.OB=new Function("Row","return "+CE); this.DoFilter(Kl);}; _7h.prototype.Focus=function(row,F6,SW,HQ){ var Md=this.FRow,LS=this.FCol; if(!row){ if(this.EditMode&&this.EndEdit(Md,LS,true)==-1)return null; this.FRow=null; this.FCol=null; this.FPagePos=null; this.Mc(Md); this.Ln(this.KC); this.CloseDialog(); return true;} this.SX(); var G9=this.Paging?this.GetRowPage(row):null; if(SW!=null&&!row.Page)SW=null; if(this.Paging&&G9&&G9!=row&&G9.State!=4){ if(HQ&&!(G9.State<2)){ if(this.AllPages)this.SM(G9); else this.GoToPage(G9);} else{ SW=this.GetPagePos(row); row=this.GetRowPage(row); if(!this.AllPages)this.V=this.GetPageNum(G9);}} if(row.Page&&row.State==4){ return this.Focus(this.PagePosToRow(row,SW),F6);} if(Md==row&&LS==F6&&(SW==null||SW==this.FPagePos))return false; if(row.G4&&F6&&row[F6+"RowSpan"]==0)return false; if(F6&&!this.Cols[F6]&&!row.Space)F6=this.SY(row); var G3=this.CanFocus(row,F6); if(SW==null&&!G3)return null; if(SW!=null&&row.State==4){ var AP=this.PagePosToRow(row,SW); row=AP?AP:this.GetLastVisible(row,1); SW=null;} if(this.EndEdit(Md,LS,true)==-1)return null; this.SZ=G3==2?this.FRow:null; this.Sa=G3==2?this.FCol:null; this.FRow=row; this.FPagePos=SW; if(F6&&G3)this.FCol=F6; else if(this.FCol&&(!this.GetCell(row,this.FCol)||!this.CanFocus(row,this.FCol)))this.FCol=null; if(!this.N[1])return null; if(HQ&&!row.Page&&!row.Fixed){ if(this.ShowRow)this.ShowRow(row); var GP=row.parentNode,exp=false; while(GP&&!GP.Page){ if(!GP.Expanded){exp=true;this.Expand(GP);} GP=GP.parentNode;} if(exp){ var T=this; setTimeout(function(){ T.ScrollIntoView(row,T.FCol,SW);},100);}} this.Mc(Md); this.ScrollIntoView(row,this.FCol,SW); this.Sb(); this.CloseDialog(); this.Me(); var DG=this.PW("Focus","",""); if((this.DetailOn&7)==1)this.ActionShowDetail(1); if(Grids.OnFocus)Grids.OnFocus(this,row,F6,Md,LS,SW); this.Refresh(); return true;}; _7h.prototype.ActionFocus=function(){return this.Focus(this.ARow,this.ACol)!=null;}; _7h.prototype.ActionChangeFocus=function(){return this.Focus(this.ARow,this.ACol)==true;}; _7h.prototype.ActionFocusRow=function(){return this.Focus(this.ARow,null)!=null;}; _7h.prototype.ActionBlur=function(){ if(this.StaticCursor)return this.EditMode?this.EndEdit(this.FRow,this.FCol,1)!=-1:true; return this.Focus(null,null);}; _7h.prototype.SX=function(){ var CE=Grids.Focused; if(CE!=this){ if(CE&&!CE.Cw){ CE.CloseDialog(true); if(!CE.PW("Click","Outside",""))return false;} Grids.Focused=this;}}; function GetKey(event){ return event.keyCode?event.keyCode:event.charCode;}; function CopyObject(DU){ if(DU&&DU.constructor){ var Sc=new DU.constructor(),Au,JV; for(Au in DU){ JV=DU[Au]; if(JV&&typeof(JV)=="object"&&JV.constructor)Sc[Au]=CopyObject(JV); else Sc[Au]=JV;} return Sc;} else return DU;}; function CreateXML(Ep){ var Sd=null; try{ if(Ep.charCodeAt(0)<=32){ for(var i=0;i<Ep.length&&Ep.charCodeAt(i)<=32;i++); Ep=Ep.slice(i);} if(window.DOMParser){ Sd=(new DOMParser()).parseFromString(Ep,"text/xml"); if(Sd&&Sd.firstChild&&Sd.firstChild.tagName.toLowerCase()=='parsererror')Sd=null;} else if(window.ActiveXObject&&(!Grids||!Grids.NoTryActiveX)){ Sd=new ActiveXObject("Microsoft.XMLDOM"); Sd.async="false"; Sd.loadXML(Ep);}} catch(H){}; if((!Sd||!Sd.firstChild)&&window._7As)return _7As(Ep); return Sd;}; if(window.Node&&Node.prototype&&Node.prototype.__defineGetter__){ Node.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this);});} function CompareStrings(MW,MY,type){ var Se=!!MW.localeCompare&&type&2; if(type&4){ if(Se){MW=MW.toLocaleLowerCase();MY=MY.toLocaleLowerCase();} else{MW=MW.toLowerCase();MY=MY.toLowerCase();}} if(type&8){MW=MW.replace(/\s/g,"");MY=MY.replace(/\s/g,"");} if(Se)return MW.localeCompare(MY); else return MW<MY?-1:(MW>MY?1:0);}; function _7At(MW,MY,type){ if(!MW||!MY)return 0; if(type&4){ if(Se){MW=MW.toLocaleLowerCase();MY=MY.toLocaleLowerCase();} else{MW=MW.toLowerCase();MY=MY.toLowerCase();}} if(type&8){MW=MW.replace(/\s/g,"");MY=MY.replace(/\s/g,"");} var Db=MW.length<MY.length?MW.length:MY.length; for(var i=0;i<Db;i++){ if(MW.charCodeAt(i)!=MY.charCodeAt(i))return i;} return Db;}; function SearchString(MW,MY,type){ var Se=MW.localeCompare!=null&&type&2; if(type&4){ if(Se){MW=MW.toLocaleLowerCase();MY=MY.toLocaleLowerCase();} else{MW=MW.toLowerCase();MY=MY.toLowerCase();}} if(type&8){MW=MW.replace(/\s/g,"");MY=MY.replace(/\s/g,"");} return MW.search(MY.replace(/[\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}\/]/g,"\\$&"));}; function _7Au(text,CA,Sf,height,width){ if(!text)return; if(typeof(CA)=="string")CA=GetElem(CA); if(!CA||CA.offsetHeight<40)return; Sf=Sf?" class='"+Sf+"'":""; CA.innerHTML="<div style='visibility:hidden;position:absolute;left:0px;top:0px;'><div "+Sf+">"+text+"</div></div>"; var A5=CA.firstChild.offsetWidth; if(width&&A5<width)A5=width; var B3="<table style='margin-left:0px;' width='100%' height='100%'"+_7B; var Em=height?Math.floor(CA.offsetHeight/height+0.3):1; if(Em<1)Em=1; for(var i=0;i<Em;i++)B3+="<tr><td valign='middle' align='center'>"+"<div"+Sf+" style='width:"+A5+"px;'>"+text+"</div></td></tr>"; B3+=_7C; CA.innerHTML=B3; if(_7U)CA.firstChild.rows[0].style.height=CA.firstChild.offsetHeight+"px";}; function _7Ae(Sg){ alert("Module \""+Sg+"\" is not available !");}; if(!Array.prototype.shift){ Array.prototype.shift=function(){ var AJ=this[0]; for(var i=0;i<this.length;i++)this[i]=this[i+1]; this.length--; return AJ;}; Array.prototype.unshift=function(){ var Db=arguments.length; for(var i=this.length-1;i>=0;i--)this[i+Db]=this[i]; for(var i=0;i<Db;i++)this[i]=arguments[i];}} if(!Function.prototype.apply){ Function.prototype.apply=function(K,Sh){ K.Si=this; if(!Sh)return K.Si(); var F8=Sh.length; if(!F8)return K.Si(); if(F8==1)return K.Si(Sh[0]); if(F8==2)return K.Si(Sh[0],Sh[1]); if(F8==3)return K.Si(Sh[0],Sh[1],Sh[2]);}} if(!window.encodeURIComponent){ window.encodeURIComponent=function(B3){ return escape(B3).replace(/\@/g,"%40").replace(/\+/g,"%2B").replace(/\//g,"%2F").replace(new RegExp("%21","g"),"!").replace(new RegExp("%7E","g"),"~").replace(new RegExp("%27","g"),"'").replace(new RegExp("%28","g"),"(").replace(new RegExp("%29","g"),")")}} function SetEvent(name,id,Cs){ if(!Grids[name]){ Grids[name]=function(G){ if(G&&G.id&&Grids[name+"_"+G.id])return Grids[name+"_"+G.id].apply(this,arguments); if(Grids[name+"_"])return Grids[name+"_"].apply(this,arguments);}} if(id||id==0)Grids[name+"_"+id]=Cs; else Grids[name+"_"]=Cs;}; function AddEvent(name,id,Cs){ if(!Grids[name]){ Grids[name]=function(G){ var DG=null,Sj=null; for(var i=0;i<10;i++){ if(G&&G.id&&Grids[name+"_"+G.id+"_"+i]){ DG=Grids[name+"_"+G.id+"_"+i].apply(this,arguments); if(DG!=null)Sj=DG;}} for(var i=0;i<10;i++){ if(Grids[name+"_"+i]){ DG=Grids[name+"_"+i].apply(this,arguments); if(DG!=null)Sj=DG;}} return Sj;}} else DelEvent(name,id,Cs); if(id||id==0)name=name+"_"+id; for(var i=0;i<10;i++){ if(Grids[name+"_"+i]==null){Grids[name+"_"+i]=Cs;break;}}}; function DelEvent(name,id,Cs){ if(id||id==0)name=name+"_"+id; for(var i=0;i<10;i++){ if(Grids[name+"_"+i]==Cs)Grids[name+"_"+i]=null;}}; _7h.prototype.ActionDragGantt=function(){return this.Sk(31);}; _7h.prototype.ActionDragGanttResize=function(){return this.Sk(1);}; _7h.prototype.ActionDragGanttNew=function(){return this.Sk(2);}; _7h.prototype.ActionDragGanttMove=function(){return this.Sk(4);}; _7h.prototype.Sk=function(type){ var AS=Grids.Bc;if(!AS)return false; var row=AS.Row,F6=AS.Col,options=this.Gw(row,F6,"GanttOptions"); var AJ=this.GetGanttXY(row,F6,AS.RZ,AS.Ra); if(!AJ)return false; var max=this.Mouse.EdgeSize-0,Cc; AJ.Sl=this.Cols[F6]["GanttWidth"]; if(AJ.Sm&&type&4&&options&64){ AJ.Object=AJ.Sm; AJ.Sn=AJ.Sl-AJ.So; AJ.Sp=3; AJ.Type=3; AJ.Sq=type&8&&options&128;} else if(AJ.Flow&&type&5&&options&32){ if(type&1){ if(AJ.FlowX<=max){AJ.Sp=1;AJ.Sn=AJ.Sl-AJ.FlowX;} else if(AJ.FlowX>=AJ.Flow.offsetWidth-max){AJ.Sp=2;AJ.Sn=AJ.Flow.offsetWidth-AJ.FlowX;}} if(!AJ.Sp&&type&4){AJ.Sp=3;AJ.Sn=AJ.Sl/2;} AJ.Object=AJ.Flow.parentNode; AJ.Type=2;} else if(AJ.Main&&type&13&&options&144){ if(type&1&&options&16&&AJ.MainType!="Milestone"){ if(AJ.MainX<=max&&AJ.MainPos!=2){AJ.Sp=this.Rtl?2:1;AJ.Sn=this.Rtl?AJ.MainX:AJ.Sl-AJ.MainX;} else if(AJ.MainX>=AJ.Main.offsetWidth-max&&AJ.MainPos!=1){AJ.Sp=this.Rtl?1:2;AJ.Sn=this.Rtl?AJ.Sl-AJ.Main.offsetWidth+AJ.MainX:AJ.Main.offsetWidth-AJ.MainX;}} if(!AJ.Sp&&type&4&&options&16){AJ.Sp=3;AJ.Sn=AJ.MainType=="Milestone"?AJ.Sl-AJ.MainX:AJ.Sl/2;AJ.Sq=type&8&&options&128;} else if(!AJ.Sp&&type&8&&options&128)return this.Sr(0,AJ); AJ.Object=AJ.MainType=="Milestone"?AJ.Main:AJ.Main.parentNode; AJ.Type=1;} else if(type&2){ var Ss=row[F6+"Gdw"],St; var I5=this.Su(row,F6,"Start"); St=this.Cols[F6].Sv; St=St-0+Math.floor(AS.RZ/AJ.Sl)*AJ.Sl/Ss; var Bb=Get(row,I5); var Kg=this.Ph;this.Ph=0; this.Calculated=0; if(!Bb&&options&16){ this.QE(); this.SetValue(row,I5,St,1); var Sw=this.Su(row,F6,"End"); if(Sw)this.SetValue(row,Sw,St,1); else{Sw=this.Su(row,F6,"Duration");if(Sw)this.SetValue(row,Sw,1,1);}; this.QF(row,I5); this.Iy(row,F6,1); AJ=this.GetGanttXY(row,F6,AS.RZ,null); if(AJ.Main){ AJ.Sl=this.Cols[F6]["GanttWidth"]; AJ.Sp=2; AJ.Object=AJ.Main.parentNode; AJ.Sn=AJ.Main.offsetWidth-AJ.MainX; this.GetCell(row,F6).style.cursor="e-resize"; AJ.Type=1;}} else if(options&32){ var I5=this.Su(row,F6,"Flow"); if(I5){ Bb=Get(row,I5); Bb=(Bb?Bb+this.Lang.Format.ValueSeparator:"")+(St-0); this.SetValue(row,I5,Bb,1); this.Iy(row,F6,1); AJ=this.GetGanttXY(row,F6,AS.RZ,null); if(AJ.Flow){ AJ.Sl=this.Cols[F6]["GanttWidth"]; AJ.Sp=2; AJ.Object=AJ.Flow.parentNode; AJ.Sn=AJ.Flow.offsetWidth-AJ.FlowX; this.GetCell(row,F6).style.cursor="e-resize"; AJ.Type=2;}}} this.Calculated=1; this.Ph=Kg;} if(!AJ.Sp)return false; AJ.Sx=parseInt(AJ.Object.style.width); if(AJ.Type==1&&AJ.Main2){ AJ.Sy=AJ.Main2.parentNode; var A5=parseInt(AJ.Sy.style.width); AJ.Sx+=A5; AJ.D1=A5/AJ.Sx; AJ.Sz=parseInt(AJ.Sy.style[this.Rtl?"marginRight":"marginLeft"]); if(!AJ.Sz)AJ.Sz=0;} AJ.S0=parseInt(AJ.Object.style[this.Rtl?"marginRight":"marginLeft"]); if(!AJ.S0)AJ.S0=0; AJ.S1=0; AS.Gantt=AJ; AS.Action="DragGantt"; AS.Move=this.S2; AS.Pz=this.S3; this.S4(AS.X,AS.Y,null,AJ.Sp==3?1:0); return true;}; _7h.prototype.S2=function(){ var AS=Grids.Bc;if(!AS)return false; var Ca=AS.QC-AS.X,AJ=AS.Gantt,margin=this.Rtl?"marginRight":"marginLeft"; AS.X+=Ca; AJ.S1+=Ca; var Ff=Math.ceil((AJ.S1-AJ.Sn)/AJ.Sl)*AJ.Sl; if(AJ.Sp==3){ if(AJ.Sq&&this.ARow!=AS.Row&&this.ARow&&AJ.Type!=3){ AJ.Object.style[margin]=AJ.S0+"px"; if(AJ.Sy)AJ.Sy.style[margin]=AJ.Sz+"px"; AS.X-=AJ.S1; return this.Sr(0,AJ);} AJ.Object.style[margin]=(AJ.S0+Ff)+"px"; if(AJ.Sy)AJ.Sy.style[margin]=(AJ.Sz+Ff)+"px";} else if(AJ.Sp==2){ var A5=AJ.Sx+Ff; if(A5<0)A5=0; if(AJ.Sy){ var Jh=Math.round(A5*AJ.D1); AJ.Sy.style.width=Jh+"px"; AJ.Object.style[margin]=Math.round(AJ.S0+Ff*AJ.D1)+"px"; AJ.Object.style.width=(A5-Jh)+"px";} else AJ.Object.style.width=A5+"px";} else if(AJ.Sp==1){ var A5=AJ.Sx-Ff; var x=AJ.S0+Ff; if(A5<0)A5=0; AJ.Object.style[margin]=x+"px"; if(AJ.Sy){ var Jh=Math.round(A5*AJ.D1); AJ.Sy.style.width=Jh+"px"; AJ.Sy.style[margin]=Math.round(AJ.Sz+Ff*AJ.D1)+"px"; AJ.Object.style.width=(A5-Jh)+"px";} else AJ.Object.style.width=A5+"px";} this.S5(AS.Col,this.Event.X); return true;}; _7h.prototype.S3=function(){ var AS=Grids.Bc;if(!AS)return false; var AJ=AS.Gantt,row=AS.Row,F6=AS.Col;this.S6=null; this.RH=null; var Ff=Math.ceil((AJ.S1-AJ.Sn)/AJ.Sl)*AJ.Sl; if(Ff){ var Ss=row[F6+"Gdw"]; if(AJ.Type==3){ var I5=this.Su(row,F6,"Flags"); if(I5){ var Bb=Get(row,I5),DY=this.Lang.Format; Bb=(Bb+"").split(DY.ValueSeparator); var Dh=Bb[AJ.S7]-0; if(Dh){ Bb[AJ.S7]=Dh+Ff/Ss; this.SetValue(row,I5,Bb.join(DY.ValueSeparator),1); return true;}}} else if(AJ.Type==2){ var I5=this.Su(row,F6,"Flow"); if(I5){ var Bb=Get(row,I5),DY=this.Lang.Format; Bb=(Bb+"").split(DY.ValueSeparator); var Dh=Bb[AJ.FlowIndex]; if(Dh){ if(AJ.Sx+(AJ.Sp==1?-Ff:Ff)>=AJ.Sl||AJ.Sp==3){ Dh=Dh.split(DY.RangeSeparator); if(!Dh[1])Dh[1]=Dh[0]; if(AJ.Sp==3){ Dh[0]=Dh[0]-0+Ff/Ss; Dh[1]=Dh[1]-0+Ff/Ss;} else{ Dh[AJ.Sp-1]-=0; Dh[AJ.Sp-1]+=Ff/Ss;}} else Dh=[]; Bb[AJ.FlowIndex]=Dh.join(DY.RangeSeparator); this.SetValue(row,I5,this.I2(Bb.join(DY.ValueSeparator)),1); return true;}}} else if(AJ.Type==1){ if(AJ.Sp==3){ var I5=this.Su(row,F6,"Start"); if(I5){ if(AJ.MainType=="Milestone"){ var Bb=Get(row,I5); if(Bb)this.SetValue(row,I5,Bb+Ff/Ss,1); else{ I5=this.Su(row,F6,"End"); this.SetValue(row,I5,Get(row,I5)+Ff/Ss,1);}} else{ this.GanttStart(); var Bb=Get(row,I5); Bb+=Ff/Ss; this.SetValue(row,I5,Bb,1); var Sw=this.Su(row,F6,"End"); if(Sw){ var Bb=Get(row,Sw); Bb+=Ff/Ss; this.SetValue(row,Sw,Bb,1);} this.GanttEnd(row,I5);}; return true;}} else if(AJ.Sx+(AJ.Sp==1?-Ff:Ff)>=AJ.Sl){ if(AJ.Sp==1){ var I5=this.Su(row,F6,"Start"); var Bb=Get(row,I5); Bb+=Ff/Ss; var Sw=this.Su(row,F6,"Duration"); if(Sw){ var Dh=Get(row,Sw); Dh+=-Ff/AJ.Sl; this.GanttStart(); this.SetValue(row,Sw,Dh,1); this.SetValue(row,I5,Bb,1); this.GanttEnd(row,I5);} else this.SetValue(row,I5,Bb,1);} else{ var I5=this.Su(row,F6,"End"); if(I5){ var Bb=Get(row,I5); Bb+=Ff/Ss; this.SetValue(row,I5,Bb,1);} else{ I5=this.Su(row,F6,"Duration"); if(I5){ var Bb=Get(row,I5); Bb+=Ff/AJ.Sl; this.SetValue(row,I5,Bb,1);}}}} else{ var I5=this.Su(row,F6,"Start"); if(I5){ this.GanttStart(); this.SetValue(row,I5,null,1); var Sw=this.Su(row,F6,"End"); if(Sw)this.SetValue(row,Sw,null,1); var Sw=this.Su(row,F6,"Duration"); if(Sw)this.SetValue(row,Sw,null,1); this.GanttEnd(row,I5); return true;}}}} this.RefreshCell(row,F6); return false;}; _7h.prototype.S8=function(row,F6,JW){ var I5=this.Su(row,F6,"Flags"); if(!I5)return false; var Bb=Get(row,I5); if(!Bb)return false; this.GanttStart(); var HF=this.Lang.Format.ValueSeparator; Bb=(Bb+"").split(HF); Bb.splice(JW,1); this.SetValue(row,I5,Bb.join(HF),1); var Sw=this.Su(row,F6,"FlagTexts"); if(Sw){ var Bb=Get(row,Sw); if(Bb){ Bb=(Bb+"").split(HF); Bb.splice(JW,1); this.SetValue(row,Sw,Bb.join(HF),1);}} this.GanttEnd(row,I5); this.S6=null; return true;}; _7h.prototype.ActionDeleteGanttFlag=function(){ var row=this.ARow,F6=this.ACol; var AJ=this.GetGanttXY(row,F6,this.Event.X,this.Event.Y); if(!AJ||!AJ.Sm)return false; if(!(this.Gw(row,F6,"GanttOptions")&64))return false; return this.S8(row,F6,AJ.S7);}; _7h.prototype.S9=function(row,F6){ var I5=this.Su(row,F6,"Flags"); if(!I5)return false; this.GanttStart(); this.SetValue(row,I5,null,1); var Sw=this.Su(row,F6,"FlagTexts"); if(Sw)this.SetValue(row,Sw,null,1); this.GanttEnd(row,I5); this.S6=null; return true;}; _7h.prototype.TA=function(row,F6){ this.GanttStart(); var I5=this.Su(row,F6,"Start"); if(I5)this.SetValue(row,I5,null,1); I5=this.Su(row,F6,"End"); if(I5)this.SetValue(row,I5,null,1); I5=this.Su(row,F6,"Duration"); if(I5)this.SetValue(row,I5,null,1); this.GanttEnd(row,I5); this.S6=null; return true;}; _7h.prototype.ActionDeleteGanttMain=function(){ var row=this.ARow,F6=this.ACol; var AJ=this.GetGanttXY(row,F6,this.Event.X,this.Event.Y); if(!AJ||!AJ.Main)return false; if(!(this.Gw(row,F6,"GanttOptions")&16))return false; return this.TA(row,F6);}; _7h.prototype.TB=function(row,F6,JW){ var I5=this.Su(row,F6,"Flow");if(!I5)return false; if(JW!=null){ var Bb=Get(row,I5);if(!Bb)return false; var HF=this.Lang.Format.ValueSeparator; Bb=(Bb+"").split(HF); Bb.splice(JW,1); this.SetValue(row,I5,Bb.join(HF),1);} else this.SetValue(row,I5,null,1); this.S6=null; return true;}; _7h.prototype.ActionDeleteGanttFlow=function(){ var row=this.ARow,F6=this.ACol; var AJ=this.GetGanttXY(row,F6,this.Event.X,this.Event.Y); if(!AJ||!AJ.Flow)return false; if(!(this.Gw(row,F6,"GanttOptions")&32))return false; return this.TB(row,F6,AJ.FlowIndex);}; _7h.prototype.TC=function(row,F6){ this.GanttStart(); this.TD(row,F6,1); var AM=["Start","End","Duration","Complete","Resources","Flow","Flags","FlagTexts","Dependencies","DependencyTexts"]; for(var i=0;i<AM.length;i++){ var I5=this.Su(row,F6,AM[i]); if(I5)this.SetValue(row,I5,null,1);} this.GanttEnd(row,F6); this.S6=null; return true;}; _7h.prototype.ActionDeleteGanttAll=function(CE){ var row=CE?this.FRow:this.ARow,F6=CE?this.FCol:this.ACol; if(!row||(this.Gw(row,F6,"GanttOptions")&240)!=240)return false; return this.TC(row,F6);}; _7h.prototype.ActionSetGanttPercent=function(){ var row=this.ARow,F6=this.ACol; var AJ=this.GetGanttXY(row,F6,this.Event.X,this.Event.Y); if(!AJ||!AJ.Main||AJ.MainType=="Milestone")return false; if(!(this.Gw(row,F6,"GanttOptions")&16))return false; var I5=this.Su(row,F6,"Complete"); if(!I5)return false; var A5=AJ.Main.parentNode.offsetWidth; var x=AJ.MainX; if(AJ.MainPos)A5+=AJ.Main2.parentNode.offsetWidth; if(AJ.MainPos==2)x+=AJ.Main2.parentNode.offsetWidth; var CF=this.Cols[F6]["GanttWidth"];x=Math.round(x/CF)*CF; var Bb=Math.round(x/A5*100); this.SetValue(row,I5,Bb,1); this.S6=null; return true;}; _7h.prototype.TE=function(row,F6){ var I5=this.Su(row,F6,"Complete"); if(!I5)return false; var Bb=Get(row,I5),T=this; this.Prompt(this.GetAlert("GanttPercentEdit"),Bb,function(Bb){ if(Bb==null)return false; if(isNaN(Bb)||Bb<0||Bb>100){alert(T.GetAlert("ErrGanttPercentEdit"));return;} T.SetValue(row,I5,Bb,1); T.S6=null;}); return true;}; _7h.prototype.TF=function(row,F6){ var I5=this.Su(row,F6,"Resources"); if(!I5)return false; var Bb=Get(row,I5),T=this; if(this.DZ(row,I5,0,{Row:row,Col:F6,X:this.Event.X-5,Y:this.Event.Y-5},this.GetText("AssignGanttResource"))){this.S6=null;return true;} this.Prompt(this.GetAlert("GanttResourceEdit"),Bb,function(Bb){ if(Bb==null)return; T.SetValue(row,I5,Bb,1); T.S6=null;}); return true;}; _7h.prototype.ActionEditGanttResource=function(){ var row=this.ARow,F6=this.ACol; var AJ=this.GetGanttXY(row,F6,this.Event.X,this.Event.Y); if(!AJ||!AJ.Main)return false; if(!(this.Gw(row,F6,"GanttOptions")&8))return false; return this.TF(row,F6,AJ.S7);}; _7h.prototype.TG=function(row,AP,F6){ var I5=this.Su(row,F6,"Dependencies"); var TH=this.Su(row,F6,"DependencyLags"); if(!I5||!TH)return false; var Bb=Get(row,I5),TI=Get(row,TH),HF=this.Lang.Format.ValueSeparator,T=this; if(!Bb)return false; TI=TI?(TI+"").split(HF):[]; Bb=(Bb+"").split(HF); for(var j=0;j<Bb.length;j++){ if(Bb[j]==AP.id){ this.Prompt(this.GetAlert("GanttDependencyLagEdit"),TI[j],function(Bb){ if(Bb==null)return; Bb-=0;if(!Bb)Bb=""; TI[j]=Bb; T.SetValue(row,TH,TI.join(HF),1); T.S6=null;}); return true;}} return false;}; _7h.prototype.ActionEditGanttDependencyLag=function(){ var row=this.ARow,F6=this.ACol,HF=this.Lang.Format.ValueSeparator; var AJ=this.GetGanttXY(row,F6,this.Event.X,this.Event.Y); if(!AJ)return false; if(!(this.Gw(row,F6,"GanttOptions")&128))return false; var I5=this.Su(row,F6,"Dependencies"); if(!I5)return false; var a=AJ.DependencyStartLeft;if(!a)a=AJ.DependencyStartRight; if(a){ a=(a+"").split(HF); var Bb=Get(row,I5); if(Bb){ Bb=(Bb+"").split(HF); for(var i=0;i<Bb.length;i++)if(Bb[i]==a[0]){ var AP=this.GetRowById(Bb[i]); if(!AP)return false; this.TG(row,AP,F6); return true;}}} return false;}; _7h.prototype.TJ=function(row,F6,JW){ var I5=this.Su(row,F6,"FlagTexts"); if(!I5)return false; var Bb=Get(row,I5),HF=this.Lang.Format.ValueSeparator,T=this; Bb=Bb?(Bb+"").split(HF):[]; this.Prompt(this.GetAlert("GanttFlagEdit"),Bb[JW],function(Dh){ if(Dh==null)return; Dh=(Dh+"").replace(HF,HF==','?';':','); Bb[JW]=Dh; T.SetValue(row,I5,Bb.join(HF),1); T.S6=null;}); return true;}; _7h.prototype.ActionEditGanttFlag=function(){ var row=this.ARow,F6=this.ACol; var AJ=this.GetGanttXY(row,F6,this.Event.X,this.Event.Y); if(!AJ||!AJ.Sm)return false; if(!(this.Gw(row,F6,"GanttOptions")&64))return false; return this.TJ(row,F6,AJ.S7);}; _7h.prototype.ActionNewGanttFlag=function(){ var row=this.ARow,F6=this.ACol,T=this,X=this.Event.X,HF=this.Lang.Format.ValueSeparator; var AJ=this.GetGanttXY(row,F6,this.Event.X,this.Event.Y); if(!AJ)return false; if(!(this.Gw(row,F6,"GanttOptions")&64))return false; var I5=this.Su(row,F6,"Flags"); if(!I5)return false; this.Prompt(this.GetAlert("GanttFlagEdit"),"",function(Dh){ if(Dh==null)return; var A5=X/row[F6+"Gdw"],CF=this.Cols[F6]["GanttWidth"],St; St=this.Cols[F6].Sv-0; St+=Math.round(A5/CF)*CF; var Bb=Get(row,I5); Bb=Bb?(Bb+"").split(HF):[]; var JW=Bb.length; Bb[JW]=St; T.GanttStart(); T.SetValue(row,I5,Bb.join(HF),1); var Sw=T.Su(row,F6,"FlagTexts"); if(Sw){ Bb=Get(row,Sw); Bb=Bb?(Bb+"").split(HF):[]; Dh=(Dh+"").replace(HF,HF==','?';':','); Bb[JW]=Dh; T.SetValue(row,Sw,Bb.join(HF),1);} T.GanttEnd(row,I5); T.S6=null;});}; _7h.prototype.ActionNewGanttMilestone=function(){ var row=this.ARow,F6=this.ACol,X=this.Event.X,HF=this.Lang.Format.ValueSeparator; var AJ=this.GetGanttXY(row,F6,this.Event.X,this.Event.Y); if(!AJ)return false; if(!(this.Gw(row,F6,"GanttOptions")&16))return false; var I5=this.Su(row,F6,"Start"),Sw=this.Su(row,F6,"End"); if(!I5||!Sw||Get(row,I5)||Get(row,Sw))return false; var A5=X/row[F6+"Gdw"],CF=this.Cols[F6]["GanttWidth"],St; St=this.Cols[F6].Sv-0; St+=Math.round(A5/CF)*CF; this.SetValue(row,I5,St,1); this.S6=null; return true;}; _7h.prototype.ActionDragGanttDependency=function(){return this.Sr(1);}; _7h.prototype.Sr=function(Ci,AJ){ var AS=Grids.Bc;if(!AS)return false; var row=AS.Row,F6=AS.Col; if(!(this.Gw(row,F6,"GanttOptions")&128))return false; if(!AJ)AJ=this.GetGanttXY(row,F6,AS.RZ,AS.Ra); if(!AJ)return false; if(!AJ.Main&&Ci){ if(!this.TK(AJ,row,F6,AS.RZ))return false; AS.X+=AJ.Main.parentNode.offsetLeft-AS.RZ+AJ.MainX; AS.Y+=Math.floor(AJ.Main.parentNode.offsetTop+AJ.Main.offsetHeight/2-AS.Ra); AJ.TL=1;} var TM=GetWindowScroll(),TN=TM[0]/_7r,TO=TM[1]/_7r; if(_7P)TN-=_7Q?document.body.clientLeft:(_7R?document.documentElement.clientLeft:0); TN+=2; AS.Gantt=AJ; AS.Action="DragGanttDependency"; AS.Move=this.TP; AS.Pz=this.TQ; var AN=document.body,Fj=document.createElement("div"); Fj.innerHTML="<div class='"+this.Img.Style+"GanttDepVert' style='margin-top:0px;"+this.TR+"'>"+_7D+"</div>"; Fj.style.overflow="hidden"; Fj.style.height="0px"; Fj.style.left=(AS.X+TN)+"px"; Fj.style.top=(AS.Y+TO)+"px"; Fj.style.position="absolute"; if(_7P&&!_7S)AN.insertBefore(Fj,AN.firstChild); else AN.appendChild(Fj); AJ.TS=Fj; var TT=Fj.cloneNode(1); AN.insertBefore(TT,Fj); AJ.TU=TT; var CZ=document.createElement("div"); CZ.innerHTML="<div class='"+this.Img.Style+"GanttDepHorzIn' style='margin-top:0px;'>"+_7D+"</div>"; CZ.style.overflow="hidden"; CZ.style.fontSize="1px"; CZ.style.lineHeight="1px"; CZ.style.width="0px"; CZ.style.left=(AS.X+TN)+"px"; CZ.style.top=(AS.Y+TO)+"px"; CZ.style.position="absolute"; AN.insertBefore(CZ,Fj); AJ.Ck=CZ; return true;}; _7h.prototype.TP=function(){ var AS=Grids.Bc;if(!AS)return false; var Ca=AS.QC-AS.X,Cb=AS.QD-AS.Y,TV=Math.floor(Cb/2),AJ=AS.Gantt; var Fj=AJ.TS,CZ=AJ.Ck,TT=AJ.TU,TW=this.TX; var TM=GetWindowScroll(),TN=TM[0]/_7r,TO=TM[1]/_7r; if(_7P)TN-=_7Q?document.body.clientLeft:(_7R?document.documentElement.clientLeft:0); TN+=2; if(Cb>=0){ Fj.style.top=(AS.Y+TO)+"px"; Fj.style.height=(TV+TW)+"px"; TT.style.top=(AS.Y+TV+TW+TO)+"px"; TT.style.height=TV+"px"; CZ.style.top=(AS.Y+TV+TO)+"px";} else{ Fj.style.top=(AS.QD-TV+TW*2+TO)+"px"; Fj.style.height=(TV-Cb)+"px"; TT.style.top=(AS.QD+TW+TO)+"px"; TT.style.height=(-TV+TW)+"px"; CZ.style.top=(AS.QD-TV+TO)+"px";}; TT.style.left=(AS.QC+TN)+"px"; if(Ca>=0){ CZ.style.left=(AS.X+TW+TN)+"px"; CZ.style.width=Ca+"px";} else{ CZ.style.left=(AS.QC+TW*2+TN)+"px"; CZ.style.width=(-Ca)+"px";}; this.S5(AS.Col,this.Event.X); this.P9(this.ARow); return true;}; _7h.prototype.TQ=function(){ var AS=Grids.Bc;if(!AS)return false; var AJ=AS.Gantt,row=AS.Row,F6=AS.Col,HF=this.Lang.Format.ValueSeparator; var DY=this.GetGanttXY(AS.QC,AS.QD); var AN=document.body;AN.removeChild(AJ.TS);AN.removeChild(AJ.TU);AN.removeChild(AJ.Ck); this.RH=null; if(row!=this.ARow&&DY&&this.Gw(this.ARow,this.ACol,"GanttOptions")&128){ if(!DY.Main)this.TK(DY,this.ARow,this.ACol,DY.RZ); var I5=this.Su(row,F6,"Dependencies"),Sw=this.Su(row,F6,"DependencyTypes"); if(I5){ var Bb=Get(row,I5),id=this.ARow.id; Bb=Bb?(Bb+"").split(HF):[]; for(var i=0;i<Bb.length;i++)if(Bb[i]==id)break; Bb[i]=id; Bb=Bb.join(HF); if(Sw){ var Bg=Get(row,Sw); Bg=Bg?(Bg+"").split(HF):[]; for(var j=0;j<i;j++)if(!Bg[j])Bg[j]=""; var Cp=this.Rtl?"f":"s",EW=this.Rtl?"s":"f",TY=EW,TZ=Cp; if(AJ.Main){ var Ta=AJ.MainX,Tb=AJ.Main.offsetWidth; if(AJ.MainPos)Tb+=AJ.Main2.offsetWidth; if(AJ.MainPos==2)Ta+=AJ.Main2.offsetWidth; TY=Ta<Tb/2?Cp:EW;} if(DY.Main){ var Tc=DY.MainX,Jh=DY.Main.offsetWidth; if(DY.MainPos)Jh+=DY.Main2.offsetWidth; if(DY.MainPos==2)Tc+=DY.Main2.offsetWidth; TZ=Tc<Jh/2?Cp:EW;} Bg[i]=TY+TZ; this.GanttStart(); this.SetValue(row,Sw,Bg.join(HF),1); this.SetValue(row,I5,Bb,1); this.GanttEnd(row,I5);} else this.SetValue(row,I5,Bb,1); return true;}} var Ai=this.GetAlert("ErrGanttDep"); if(Ai){Grids.Bc=null;alert(Ai);} return false;}; _7h.prototype.Td=function(row,AP,F6,AJ,AO){ var HF=this.Lang.Format.ValueSeparator; if(AO==null){ var I5=this.Su(row,F6,"Dependencies"); if(!I5)return; var Bb=Get(row,I5); if(!Bb)return; Bb=(Bb+"").split(HF); for(var j=0;j<Bb.length;j++)if(Bb[j]==AP.id)return this.Td(row,AP,F6,AJ,j); return;} var Bg=row[F6+"Gdeptype"]; if(Bg)Bg=(Bg+"").split(HF)[AO]; var B3=row[F6+"Gdate"+(Bg&&Bg.charAt(0)=='s'||!row[F6+"Gdatecnt"]?1:2)]/row[F6+"Gdw"]; if(AJ&&AJ[row.id])B3+=AJ[row.id][1]; var H=AP[F6+"Gdate"+(Bg&&Bg.charAt(1)=='f'&&row[F6+"Gdatecnt"]?2:1)]/AP[F6+"Gdw"]; var Te=row[F6+"Gdeplag"]; if(Te)Te=(Te+"").split(HF)[AO]; if(Te){ var R1=this.Cols[F6]["GanttDataUnits"]; if(R1)R1=_7Av[R1]; if(!R1)R1=1; B3+=Math.ceil(R1*Te);} return B3-H;}; _7h.prototype.Tf=function(row,F6,Tg,HQ){ var I5=this.Su(row,F6,"Start"); if(!I5)return; var Sw=this.Su(row,F6,"End"); var Bb=Get(row,I5); this.SetValue(row,I5,Bb+Tg,HQ); if(Sw){ Bb=Get(row,Sw); if(Bb)this.SetValue(row,Sw,Bb+Tg,HQ);}}; _7h.prototype.Th=function(row,AP,F6){ var Tg=this.Td(row,AP,F6); if(Tg<=0)return false; this.Ti=1; this.GanttStart(); this.Tf(AP,F6,Tg); this.GanttEnd(AP,this.Su(AP,F6,"Start")); return true;}; _7h.prototype.Tj=function(row,F6,AJ,Pj){ if(AJ[row.id]){if(++AJ[row.id][2]>10)return 0;} else AJ[row.id]=[row,0,1]; var HF=this.Lang.Format.ValueSeparator,Ff=0; var a=row[F6+"Gdepfs"],Ey=row[F6+"Gdepff"]; if(a&&Ey)a+=HF; a+=Ey; if(a){ a=(a+"").split(HF); for(var i=0;i<a.length;i++){ var AP=this.GetRowById(a[i]);if(!AP)continue; if(Pj)Ff+=this.Tj(AP,F6,AJ,1); var H=this.Td(AP,row,F6,AJ); if(H>AJ[row.id][1]){AJ[row.id][1]=H;Ff++;}}} return Ff;}; _7h.prototype.Tk=function(row,F6,AJ,Pj){ var HF=this.Lang.Format.ValueSeparator,Ff=0; var a=row[F6+"Gdepss"],Ey=row[F6+"Gdepsf"]; if(a&&Ey)a+=HF; a+=Ey; if(a){ a=(a+"").split(HF); for(var i=0;i<a.length;i++){ var AP=this.GetRowById(a[i]);if(!AP)continue; if(AJ[AP.id]){if(++AJ[AP.id][2]>10)continue;} else AJ[AP.id]=[AP,0,1]; var H=this.Td(row,AP,F6,AJ); if(H>AJ[AP.id][1]){AJ[AP.id][1]=H;Ff++;} if(Pj)Ff+=this.Tk(AP,F6,AJ,1);}} return Ff;}; _7h.prototype.Tl=function(F6,HQ,AJ){ if(!AJ){ AJ={}; for(var i=0;i<10;i++){ var Ff=0; for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP)){ if(!AP[F6+"Gdepss"]&&!AP[F6+"Gdepsf"]){ Ff+=this.Tj(AP,F6,AJ,1);}} if(!Ff)break;} if(!i)return false;} if(HQ){ Ff=0;for(var a in AJ)if(AJ[a][1]>0)Ff++; if(Ff>this.SynchroCount/2){ this.ShowMessage((this.GetText("CorrectDep")+"").replace("%d",Ff)); var T=this;setTimeout(function(){ T.Tm(F6,HQ,AJ); T.HideMessage();},10); return;}} this.Tm(F6,HQ,AJ);}; _7h.prototype.Tm=function(F6,HQ,AJ){ this.Ph=0; var Kg=this.Calculated;this.Calculated=0; this.QE(); var AN=[]; for(var a in AJ)if(AJ[a][1]>0){ this.Tf(AJ[a][0],F6,AJ[a][1],HQ); for(var AP=AJ[a][0].parentNode;AP&&!AP.Page&&AP.Calculated;AP=AP.nextSibling)if(!AP["_GA"]){AN[AN.length]=AP;AP["_GA"]=1;}} this.QF(); this.Calculated=Kg; this.Calculate(HQ,0,0,0,1); for(var a in AJ)if(AJ[a][1]>0)this.Iy(AJ[a][0],F6,HQ,1); for(var i=0;i<AN.length;i++){this.Iy(AN[i],F6,HQ,1);AN[i]["_GA"]=null;} if(this.Tn(HQ,F6))this.Iw(HQ,F6); else{ this.To(HQ,F6); for(var a in AJ)if(AJ[a][1]>0)this.Iy(AJ[a][0],F6,HQ); for(var i=0;i<AN.length;i++)this.Iy(AN[i],F6,HQ);}; this.Ph=1; this.Tp(); if(HQ)this.Tq(); this.Im(HQ); return true;}; _7h.prototype.ActionCorrectAllDependencies=function(){ for(var F6 in this.Cols)if(this.Cols[F6].Type=="Gantt")this.Tl(F6,1);}; _7h.prototype.Tr=function(row,AP,F6){ var I5=this.Su(row,F6,"Dependencies"); if(!I5)return; var Bb=Get(row,I5),HF=this.Lang.Format.ValueSeparator; if(!Bb)return; Bb=(Bb+"").split(HF); for(var j=0;j<Bb.length;j++){ if(Bb[j]==AP.id){ Bb.splice(j,1);Bb=Bb.join(HF); this.SetValue(row,I5,Bb,1);row[F6+"Gdependency"]=Bb; this.Ti=1; var Sw=this.Su(row,F6,"DependencyTypes"); if(Sw){ var Bg=Get(row,Sw); if(Bg){ Bg=(Bg+"").split(HF); if(Bg.length>j){ Bg.splice(j,1);Bg=Bg.join(HF); this.SetValue(row,Sw,Bg,1);row[F6+"Gdeptype"]=Bg;}}} var Sw=this.Su(row,F6,"DependencyLags"); if(Sw){ var Bg=Get(row,Sw); if(Bg){ Bg=(Bg+"").split(HF); if(Bg.length>j){ Bg.splice(j,1);Bg=Bg.join(HF); this.SetValue(row,Sw,Bg,1);row[F6+"Gdeplag"]=Bg;}}}}}}; _7h.prototype.TD=function(row,F6,Ts){ var I5=this.Su(row,F6,"Dependencies"); if(!I5)return false; var HF=this.Lang.Format.ValueSeparator; var a=row[F6+"Gdepfs"],Ey=row[F6+"Gdepff"]; if(a&&Ey)a+=HF; a+=Ey; if(!a&&!row[F6+"Gdependency"])return false; if(!Ts)this.GanttStart(); if(a){ a=(a+"").split(HF); for(var i=0;i<a.length;i++){ var AP=this.GetRowById(a[i]); if(AP)this.Tr(AP,row,F6);}} if(row[F6+"Gdependency"]){ this.SetValue(row,I5,"",1); row[F6+"Gdependency"]=""; this.Ti=1;} if(row[F6+"Gdeptype"]){ var Sw=this.Su(row,F6,"DependencyTypes"); this.SetValue(row,Sw,"",1); row[F6+"Gdeptype"]="";} if(row[F6+"Gdeplag"]){ var Sw=this.Su(row,F6,"DependencyLags"); this.SetValue(row,Sw,"",1); row[F6+"Gdeplag"]="";} if(!Ts)this.GanttEnd(row,I5); return true;}; _7h.prototype.ActionDeleteGanttDependencies=function(CE,Ts){ var row=CE?this.FRow:this.ARow,F6=CE?this.FCol:this.ACol; if(!row||!(this.Gw(row,F6,"GanttOptions")&128))return false; return this.TD(row,F6);}; _7h.prototype.ActionDeleteGanttDependency=function(){ var row=this.ARow,F6=this.ACol,HF=this.Lang.Format.ValueSeparator; var AJ=this.GetGanttXY(row,F6,this.Event.X,this.Event.Y); if(!AJ)return false; if(!(this.Gw(row,F6,"GanttOptions")&128))return false; var a=AJ.DependencyEndRight;if(!a)a=AJ.DependencyEndLeft; if(a){ a=(a+"").split(HF); for(var i=0;i<a.length;i++){ var AP=this.GetRowById(a[i]); if(AP){this.Tr(AP,row,F6);return true;}}} var I5=this.Su(row,F6,"Dependencies"); if(!I5)return false; var a=AJ.DependencyStartLeft;if(!a)a=AJ.DependencyStartRight; if(a){ a=(a+"").split(HF); var Bb=Get(row,I5); if(Bb){ Bb=(Bb+"").split(HF); for(var i=0;i<Bb.length;i++)if(Bb[i]==a[0]){ Bb.splice(i,1); this.SetValue(row,I5,Bb.join(HF),1); return true;}}} return false;}; var _7Av={ "m":60000,"m5":60000*5,"m10":60000*10,"m15":60000*15,"m30":60000*30, "h":3600000,"h2":3600000*2,"h3":3600000*3,"h6":3600000*6,"h8":3600000*8,"h12":3600000*12, "d":86400000,"w":86400000*7,"w1":86400000*7, "M":86400000*30.4,"M3":86400000*30.4*3,"M6":86400000*30.4*6,"y":86400000*365}; TCalc.prototype.ganttpercent=function(Tt,Tu,Tv,Kq,Tw){ if(!Kq)Kq=this.Col; var sum=0,AJ=this.GetChildren(),Db=AJ.length,G=this.Grid; var DY=[],AM=[],Em=0; for(var i=0;i<Db;i++){ var AP=AJ[i],B3=Get(AP,Tt),H=Get(AP,Tu),Au=Get(AP,Kq); if(B3&&H&&Au!=null){ H=new Date(H);this.Grid.Tx(H,Tv); var F8=H-B3;DY[i]=F8;AM[i]=Au;Em+=F8;}} for(var i=0;i<Db;i++){ if(!AM[i])continue; sum+=AM[i]*DY[i];} return sum?Math.round(sum/Em):"";}; TCalc.prototype.ganttpercentduration=function(Ty,Kq,Tw){ if(!Kq)Kq=this.Col; var sum=0,AJ=this.GetChildren(),Db=AJ.length,G=this.Grid; var DY=[],AM=[],Em=0; for(var i=0;i<Db;i++){ var AP=AJ[i],F8=Get(AP,Ty),Au=Get(AP,Kq); if(F8&&Au!=null){DY[i]=F8;AM[i]=Au;Em+=F8;}} for(var i=0;i<Db;i++){ if(!AM[i])continue; sum+=AM[i]*DY[i];} return sum?Math.round(sum/Em):"";}; TCalc.prototype.ganttduration=function(Tz,T0,T1){ if(!T0)T0=this.Col; if(!T1)T1="d"; var AJ=this.GetChildren(),Db=AJ.length,max=0; var AS=Get(this.Row,Tz);if(!AS)return 0; AS=new Date(AS); for(var i=0;i<Db;i++){ var AP=AJ[i],BM=Get(AP,Tz),F8=Get(AP,T0); if(!BM||!F8)continue; BM=new Date(BM);this.Grid.Tx(BM,T1,F8); if(BM-AS>max)max=BM-AS;} return max/_7Av[T1];}; _7h.prototype.T2=function(BM,Ak){ if(Ak=='m')BM.setSeconds(0,0); else if(Ak=='m5')BM.setMinutes(Math.floor(BM.getMinutes()/5)*5,0,0); else if(Ak=='m10')BM.setMinutes(Math.floor(BM.getMinutes()/10)*10,0,0); else if(Ak=='m15')BM.setMinutes(Math.floor(BM.getMinutes()/15)*15,0,0); else if(Ak=='m30')BM.setMinutes(Math.floor(BM.getMinutes()/30)*30,0,0); else if(Ak=='h')BM.setMinutes(0,0,0); else if(Ak=='h2')BM.setHours(Math.floor(BM.getHours()/2)*2,0,0,0); else if(Ak=='h3')BM.setHours(Math.floor(BM.getHours()/3)*3,0,0,0); else if(Ak=='h6')BM.setHours(Math.floor(BM.getHours()/6)*6,0,0,0); else if(Ak=='h8')BM.setHours(Math.floor(BM.getHours()/8)*8,0,0,0); else if(Ak=='h12')BM.setHours(Math.floor(BM.getHours()/12)*12,0,0,0); else{ BM.setHours(0,0,0,0); if(Ak=='w')BM.setDate(BM.getDate()-BM.getDay()); else if(Ak=='w1')BM.setDate(BM.getDate()-BM.getDay()+1); else if(Ak=='M')BM.setDate(1); else if(Ak=='M3')BM.setMonth(Math.floor(BM.getMonth()/3)*3,1); else if(Ak=='M6')BM.setMonth(Math.floor(BM.getMonth()/6)*6,1); else if(Ak=='y')BM.setMonth(0,1);}}; _7h.prototype.T3=function(BM,Ak){ if(Ak=='m')BM.setUTCSeconds(0,0); else if(Ak=='m5')BM.setUTCMinutes(Math.floor(BM.getUTCMinutes()/5)*5,0,0); else if(Ak=='m10')BM.setUTCMinutes(Math.floor(BM.getUTCMinutes()/10)*10,0,0); else if(Ak=='m15')BM.setUTCMinutes(Math.floor(BM.getUTCMinutes()/15)*15,0,0); else if(Ak=='m30')BM.setUTCMinutes(Math.floor(BM.getUTCMinutes()/30)*30,0,0); else if(Ak=='h')BM.setUTCMinutes(0,0,0); else if(Ak=='h2')BM.setUTCHours(Math.floor(BM.getUTCHours()/2)*2,0,0,0); else if(Ak=='h3')BM.setUTCHours(Math.floor(BM.getUTCHours()/3)*3,0,0,0); else if(Ak=='h6')BM.setUTCHours(Math.floor(BM.getUTCHours()/6)*6,0,0,0); else if(Ak=='h8')BM.setUTCHours(Math.floor(BM.getUTCHours()/8)*8,0,0,0); else if(Ak=='h12')BM.setUTCHours(Math.floor(BM.getUTCHours()/12)*12,0,0,0); else{ BM.setUTCHours(0,0,0,0); if(Ak=='w')BM.setUTCDate(BM.getUTCDate()-BM.getUTCDay()); else if(Ak=='w1')BM.setUTCDate(BM.getUTCDate()-BM.getUTCDay()+1); else if(Ak=='M')BM.setUTCDate(1); else if(Ak=='M3')BM.setUTCMonth(Math.floor(BM.getUTCMonth()/3)*3,1); else if(Ak=='M6')BM.setUTCMonth(Math.floor(BM.getUTCMonth()/6)*6,1); else if(Ak=='y')BM.setUTCMonth(0,1);}}; _7h.prototype.T4=function(BM,Ak,BD){ if(!BD)BD=1; if(Ak=='m')BM.setMinutes(BM.getMinutes()+BD); else if(Ak=='m5')BM.setMinutes(BM.getMinutes()+BD*5); else if(Ak=='m10')BM.setMinutes(BM.getMinutes()+BD*10); else if(Ak=='m15')BM.setMinutes(BM.getMinutes()+BD*15); else if(Ak=='m30')BM.setMinutes(BM.getMinutes()+BD*30); else if(Ak=='h')BM.setHours(BM.getHours()+BD); else if(Ak=='h2')BM.setHours(BM.getHours()+BD*2); else if(Ak=='h3')BM.setHours(BM.getHours()+BD*3); else if(Ak=='h6')BM.setHours(BM.getHours()+BD*6); else if(Ak=='h8')BM.setHours(BM.getHours()+BD*8); else if(Ak=='h12')BM.setHours(BM.getHours()+BD*12); else if(Ak=='d')BM.setDate(BM.getDate()+BD); else if(Ak=='w'||Ak=='w1')BM.setDate(BM.getDate()+BD*7); else{ if(Ak=='M')BM.setMonth(BM.getMonth()+BD); else if(Ak=='M3')BM.setMonth(BM.getMonth()+BD*3); else if(Ak=='M6')BM.setMonth(BM.getMonth()+BD*6); else if(Ak=='y')BM.setFullYear(BM.getFullYear()+BD);}}; _7h.prototype.T5=function(BM,Ak,BD){ if(!BD)BD=1; if(Ak=='m')BM.setUTCMinutes(BM.getUTCMinutes()+BD); else if(Ak=='m5')BM.setUTCMinutes(BM.getUTCMinutes()+BD*5); else if(Ak=='m10')BM.setUTCMinutes(BM.getUTCMinutes()+BD*10); else if(Ak=='m15')BM.setUTCMinutes(BM.getUTCMinutes()+BD*15); else if(Ak=='m30')BM.setUTCMinutes(BM.getUTCMinutes()+BD*30); else if(Ak=='h')BM.setUTCHours(BM.getUTCHours()+BD); else if(Ak=='h2')BM.setUTCHours(BM.getUTCHours()+BD*2); else if(Ak=='h3')BM.setUTCHours(BM.getUTCHours()+BD*3); else if(Ak=='h6')BM.setUTCHours(BM.getUTCHours()+BD*6); else if(Ak=='h8')BM.setUTCHours(BM.getUTCHours()+BD*8); else if(Ak=='h12')BM.setUTCHours(BM.getUTCHours()+BD*12); else if(Ak=='d')BM.setUTCDate(BM.getUTCDate()+BD); else if(Ak=='w'||Ak=='w1')BM.setUTCDate(BM.getUTCDate()+BD*7); else{ if(Ak=='M')BM.setUTCMonth(BM.getUTCMonth()+BD); else if(Ak=='M3')BM.setUTCMonth(BM.getUTCMonth()+BD*3); else if(Ak=='M6')BM.setUTCMonth(BM.getUTCMonth()+BD*6); else if(Ak=='y')BM.setUTCFullYear(BM.getUTCFullYear()+BD);}}; _7h.prototype.T6=function(BM){ if(!BM)return null; if(BM-0==BM)return new Date(BM-0); var Bh=new Date(BM); if(!isNaN(Bh))return Bh; return new Date(this.Lang.Format._7o(BM));}; _7h.prototype.T7=function(BM,Ak,DY){ BM=(BM+"").split(DY.ValueSeparator); for(var i=0;i<BM.length;i++){ var a=BM[i].split(DY.RangeSeparator); a[0]=this.T6(a[0]);if(Ak)this.T8(a[0],Ak); if(!a[1])a[1]=new Date(a[0]); else{a[1]=this.T6(a[1]);if(Ak)this.T8(a[1],Ak);}; if(a[0]>a[1]){var T9=a[1];a[1]=a[0];a[0]=T9;} this.Tx(a[1],Ak?Ak:"m"); BM[i]=a;} return BM;}; _7h.prototype.UA=function(row,F6,Gx,Gy){ var UB=F6+Gx,Bb=row[UB]; if(Bb==null){ Bb=row.Def[UB]; if(Bb==null){Bb=this.Cols[F6][Gx];if(Bb==null)return Gy;}} if(!this.Cols[Bb])return Bb; var Dh=row[Bb];if(Dh!=null)return Dh; Dh=row.Def[Bb]; if(Dh!=null)return Dh; return Gy;}; _7h.prototype.To=function(HQ,F6){ if(!F6){for(var F6 in this.Cols)if(this.Cols[F6].Type=="Gantt")this.To(HQ,F6);return;} var C=this.Cols[F6],width=C["GanttWidth"],T1=C["GanttUnits"],Ss=width/_7Av[T1]; var AJ=new Array,Au=0,CZ=this.Header,St=C.Sv,UC=C.UD,options=C["GanttHeaderOptions"],DY=this.Lang.Format; var R0=" class='"+this.Img.Style+"Gantt"; if(St==1e16||UC==-1)return; AJ[Au++]="<div"+R0+"Header'>"; for(var i=1;i<=5;i++){ var Ak=C["GanttHeader"+i],Cq=C["GanttFormat"+i]; if(!Ak||!_7Av[Ak])continue; AJ[Au++]=_7A+R0+"HeaderTable'"+_7B+"<tr>"; var BM=new Date(St);this.T8(BM,Ak); var UE=new Date(UC);this.T8(UE,Ak); var CF=0; if(St-BM){ var Bh=new Date(BM); this.Tx(BM,Ak); CF=Math.round(((BM>UE?UC:BM)-St)*Ss); AJ[Au++]="<td><div style='overflow:hidden;white-space:nowrap;width:"+CF+"px;'><div"+R0+"Header"+i+"'>"+(options&1?DY["Cont"]:DY["ContLeft"]+DY.DateToString(Bh,Cq)+(BM>UE?DY["ContRight"]:""))+"</div></div></td>"; if(BM>UE)UE=UC;} while(1){ var Bh=new Date(BM); this.Tx(BM,Ak); if(BM>UE)break; var A5=Math.round((BM-St)*Ss); AJ[Au++]="<td><div style='overflow:hidden;white-space:nowrap;width:"+(A5-CF)+"px;'><div"+R0+"Header"+i+"'>"+DY.DateToString(Bh,Cq)+"</div></div></td>"; CF=A5;} if(UC-UE){ AJ[Au++]="<td><div style='overflow:hidden;white-space:nowrap;width:"+Math.round((UC-UE)*Ss)+"px;'><div"+R0+"Header"+i+"'>"+(options&1?DY["Cont"]:DY.DateToString(Bh,Cq)+DY["ContRight"])+"</div></div></td>";} AJ[Au++]="</tr>"+_7C;} CZ[F6]=AJ.join("")+"</div>"; CZ[F6+"Type"]="Html"; CZ[F6+"NoHint"]=1; if(HQ&&CZ.r1){ var HU=this.GetSections(); for(var i=HU[0];i<HU[1];i++)CZ["r"+i].firstChild.style.height="1px"; CZ.Height=null; this.RefreshCell(CZ,F6); this.UpdateRowHeight(CZ);}}; _7h.prototype.Tn=function(HQ,F6){ if(!F6){for(var F6 in this.Cols)if(this.Cols[F6].Type=="Gantt")this.Tn(HQ,F6);return;} var C=this.Cols[F6]; var width=C["GanttWidth"];if(!width){width=18;C["GanttWidth"]=width;} var T1=C["GanttUnits"];if(!T1){T1='d';C["GanttUnits"]=T1;} var Ss=width/_7Av[T1]; var Cq=C.Sv,F8=C.UD; C.Sv=1e16;C.UD=-1; for(var AP=this.GetFirst();AP;AP=this.GetNext(AP))this.Iy(AP,F6,0,1); var A5=Math.round((C.UD-C.Sv)*Ss); if(A5<C.MinWidth)A5=C.MinWidth; if(A5!=C.Width&&!C.RelWidth){ if(HQ&&!this.Loading&&!this.Rendering)this.SetWidth(F6,A5-C.Width); else C.Width=A5; C.JZ=false;} return Cq!=C.Sv||F8!=C.UD;}; _7h.prototype.Iw=function(HQ,F6,Ig){ if(!this.Gantt)return; if(!F6){for(var F6 in this.Cols)if(this.Cols[F6].Type=="Gantt")this.Iw(HQ,F6);return;} if(this.Lang.Format.GMT-0){this.T8=this.T3;this.Tx=this.T5;} else{this.T8=this.T2;this.Tx=this.T4;}; this.Tn(HQ,F6); this.To(HQ,F6); for(var AP=this.GetFirst();AP;AP=this.GetNext(AP))if(!Ig||AP.Calculated)this.Iy(AP,F6,0,2); this.Tp(F6); for(var AP=this.GetFirst();AP;AP=this.GetNext(AP))if(!Ig||AP.Calculated)this.Iy(AP,F6,HQ==null||HQ,3); if(HQ)this.Update();}; _7h.prototype.RefreshGantt=_7h.prototype.Iw; _7h.prototype.Iy=function(row,F6,HQ,type){ if(!row||row.Fixed)return; if(!F6){for(var F6 in this.Cols)if(this.Cols[F6].Type=="Gantt")this.Iy(row,F6,HQ,type);return;} var DY=this.Lang.Format,AI=this.Img,Ff=0,C=this.Cols[F6]; var width=C["GanttWidth"],T1=C["GanttUnits"],Ss=width/_7Av[T1]; var Tv=C["GanttRound"];if(!Tv)Tv=T1; var UF=C["GanttChartRound"];if(!UF)UF='m'; var left=C["GanttLeft"],right=C["GanttRight"]; row[F6+"Gantt"]=1; row[F6+"Gdw"]=Ss; var UG=this.UA(row,F6,"GanttStart"),UH=this.UA(row,F6,"GanttEnd"),UI=this.UA(row,F6,"GanttDuration"); var AL=UG+T1+UH+Tv+UI; var AS=this.r[AL]; if(AS){UG=AS[0];UH=AS[1];UJ=AS[2];} else{ UG=this.T6(UG);UH=this.T6(UH); if(!UH&&UI){ UH=new Date(UG); var UK=C["GanttDataUnits"]; if(UI>1){ if(UK)this.Tx(UH,T1,UI-1); else new Date(UH+UI);}} if(UH&&UG>UH){UG=null;UH=null;} if(UG)this.T8(UG,Tv); if(UH){this.T8(UH,Tv);this.Tx(UH,Tv);} var UJ=0; if(!UG&&UH||!UH&&UG){ if(!UG)UG=UH; UH=new Date((UG-0)+AI.GanttMilestone/Ss); UJ=1;} this.r[AL]=[UG,UH,UJ];}; var UL=this.UA(row,F6,"GanttFlow"); if(UL){ var UM=this.Gw(row,F6,"GanttFlowRound",Tv); var UN=this.r[UL+UM]; if(!UN){UN=this.T7(UL,UM,DY);this.r[UL+UM]=UN;} UL=UN;} var Hd=this.UA(row,F6,"GanttFlags"); if(Hd){ var UN=this.r[Hd+Tv]; if(!UN)UN=this.T7(Hd,Tv,DY); Hd=UN;} var UO=this.UA(row,F6,"GanttResources"); var St=C.Sv,UC=C.UD; if(!type||type==1){ var UP=null,UQ=null; if(UL){ var UP=UL[0][0]; var UQ=UL[UL.length-1][1]; if(UP>UG)UP=UG; if(UQ<UH)UQ=UH;} else{ UP=UG;UQ=UH; if(!UQ&&UP)UQ=UP; if(!UP&&UQ)UP=UQ;}; if(Hd){ if(Hd[0][0]<UP)UP=Hd[0][0]; if(Hd[Hd.length-1][1]>UQ)UQ=Hd[Hd.length-1][1];} if(UO){ var Bn=UH?UH:UG; if(Bn){ var A5=(UO+"").length*AI.GanttResource+AI.GanttEnd; if(!right)right=0; A5-=width*(right-1); Bn=new Date(Bn-0+A5/width*_7Av[T1]); if(Bn>UQ)UQ=Bn;}} if(UP){ var AL="F1"+Tv+left+UF+(UP-0); var EW=this.r[AL]; if(!EW){ UP=new Date(UP); if(left){this.T8(UP,Tv);UP.setMilliseconds(-1);this.T8(UP,Tv);} this.T8(UP,UF,0); this.r[AL]=UP;} else UP=EW; if(!type&&row[F6+"F1"]!=UP)Ff=1; row[F6+"F1"]=UP; if(!St||St>UP){ St=UP; var min=C["GanttMin"];if(min&&typeof(min)=="string"){min=this.T6(min)-0;C["GanttMin"]=min;} if(min&&St<min)St=new Date(min); if(C.Sv>St){C.Sv=St;Ff=2;}}} else row[F6+"F1"]=null; if(UQ){ var AL="F2"+Tv+right+UF+(UQ-0); var EW=this.r[AL]; if(!EW){ UQ=new Date(UQ); if(right)this.Tx(UQ,Tv,right); this.T8(UQ,Tv);UQ.setMilliseconds(-1); this.T8(UQ,UF); this.Tx(UQ,UF); this.r[AL]=UQ;} else UQ=EW; if(!type&&row[F6+"F2"]!=UQ&&!Ff)Ff=1; row[F6+"F2"]=UQ; if(!UC||UC<UQ){ UC=UQ; var max=C["GanttMax"];if(max&&typeof(max)=="string"){max=this.T6(max)-0;C["GanttMax"]=max;} if(max&&UC>max)UC=new Date(max); if(C.UD<UC){C.UD=UC;Ff=2;}}} else row[F6+"F2"]=null; if(type==1)return;} if(!type||type==2){ var BI,Bn; if(UG&&UH){BI=UG-St;Bn=UH-St;} else{BI=(UC-St)/2;Bn=BI;}; BI=Math.ceil(BI*Ss),Bn=Math.ceil(Bn*Ss); var UR=this.UA(row,F6,"GanttDependencies"); if(UR&&this.Ph!=0)this.Ph=1; var Bg=this.UA(row,F6,"GanttDependencyTypes"); var Te=this.UA(row,F6,"GanttDependencyLags"); var Hw=!type&&this.Ph&&(row[F6+"Gdate1"]!=BI||row[F6+"Gdate2"]!=Bn||row[F6+"Gdependency"]!=UR||row[F6+"Gdeptype"]!=Bg||row[F6+"Gdeplag"]!=Te); row[F6+"Gdate1"]=BI; row[F6+"Gdate2"]=Bn; row[F6+"Gdependency"]=UR; row[F6+"Gdeptype"]=Bg; row[F6+"Gdeplag"]=Te; if(Hw){ this.Tp(F6); if(HQ)this.Tq(F6);} if(type==2)return;} if(!St||!UC)return; if(!type&&Ff){ if(Ff==2){ if(this.RowCount<this.SynchroCount&&!this.Paging||!HQ)this.Iw(HQ,F6); else{var T=this;this.ShowMessage(this.GetText("GanttUpdate"));setTimeout(function(){T.Iw(HQ,F6);T.HideMessage();if(HQ)T.Update();},10);}; return;} if(this.US(HQ,F6))return;} var AY=AI.Style+"Gantt",R0=" class='"+AY,UT=""; var UU=this.Gw(row,F6,"GanttClass");if(UU)UT=" "+AI.Style+UU; var B3="",CA=0,UV=this.Rtl; var options=this.Gw(row,F6,"GanttOptions"); if(_7P){var AJ=new Array(),Au=0;} var background=this.UA(row,F6,"GanttBackground"); if(background){ var UW=this.Gw(row,F6,"GanttBackgroundRepeat")+""; var AL="gantt"+background+UW+T1+(St-0)+UU+(UC-0); if(!this.r[AL]){ background=this.T7(background,null,DY); var Ag=UW.search(/[\,\;\|]/); if(Ag>=0)Ag=(UW+"").split(UW.charAt(Ag)); else Ag=[UW]; var AN=new Array,Ey=0; for(var i=0;i<background.length;i++){ var Ak=Ag[i],BM=background[i][0],Bn=background[i][1],CF=Math.round((Bn-BM)*Ss); if(!CF)CF=1; if(!BM)continue; if(Ak&&_7Av[Ak]){ var Bh=new Date(BM);this.T8(Bh,Ak); var UX=new Date(St);this.T8(UX,Ak);UX=new Date(UX-1);this.T8(UX,Ak); BM=new Date(UX-(Bh-BM)); while(BM<UC){ var A5=Math.round((BM-St)*Ss); CA++;AN[Ey++]="|"+A5+"|0|"+CF+"|||"+AY+(UT?"Back"+(i+1)+UT:"")+"Back"+(i+1)+"||"; this.Tx(BM,Ak);}} else if(Bn>St&&BM<UC){ if(!(BM-Bn)){this.Tx(Bn,T1);CF=Math.round((Bn-BM)*Ss);} A5=Math.round((BM-St)*Ss); AN[Ey++]="|"+A5+"|0|"+CF+"|||"+AY+(UT?"Back"+(i+1)+UT:"")+"Back"+(i+1)+"||"; CA++;}} this.r[AL]=AN.join(""); this.r[AL+"Cnt"]=CA;} if(_7P)AJ[Au++]=this.r[AL]; else B3+=this.r[AL]; row[F6+"Gback"]=CA; CA=this.r[AL+"Cnt"];} if(UJ){ row[F6+"Gdate"]=CA++;row[F6+"Gdatecnt"]=0; var A5=(UG-St)*Ss; if(_7P)AJ[Au++]=["|",A5,"|0||||",AY,UT?"Milestone"+UT:"","Milestone||"].join(""); else B3+="|"+A5+"|0||||"+AY+(UT?"Milestone"+UT:"")+"Milestone||";} else if(UG){ row[F6+"Gdate"]=CA; var complete=this.UA(row,F6,"GanttComplete"); var A5=(UG-St)*Ss; var CF=Math.ceil((UH-UG)*Ss); if(!isNaN(complete)){ if(complete<0)complete=0;if(complete>100)complete=100; var Tb=complete==100?CF:Math.floor(CF/100*complete);if(Tb>0&&Tb<3)Tb=3; var Jh=CF-Tb; if(Jh>0&&Jh<3&&CF>=6){Jh=3;Tb=CF-Jh;} if(_7P){ if(Tb){CA++;AJ[Au++]=["|",(A5+(UV?Jh:0)),"|0|",Tb,"||<div",R0,(complete==100?100:90),UT?"Out"+UT+(complete==100?100:90):"","Out'><div",R0,(complete==100?100:90),UT?"In"+UT+(complete==100?100:90):"","In'>",_7D,"</div></div>|||"].join("");} if(Jh){CA++;AJ[Au++]=["|",(A5+(UV?0:Tb)),"|0|",Jh,"||<div",R0,(complete==0?0:10),UT?"Out"+UT+(complete==0?0:10):"","Out'><div",R0,(complete==0?0:10),UT?"In"+UT+(complete==0?0:10):"","In'>",_7D,"</div></div>|||"].join("");}} else{ if(Tb){CA++;B3+="|"+(A5+(UV?Jh:0))+"|0|"+Tb+"||<div"+R0+(complete==100?100:90)+(UT?"Out"+UT+(complete==100?100:90):"")+"Out'><div"+R0+(complete==100?100:90)+(UT?"In"+UT+(complete==100?100:90):"")+"In'>"+_7D+"</div></div>|||";} if(Jh){CA++;B3+="|"+(A5+(UV?0:Tb))+"|0|"+Jh+"||<div"+R0+(complete==0?0:10)+(UT?"Out"+UT+(complete==0?0:10):"")+"Out'><div"+R0+(complete==0?0:10)+(UT?"In"+UT+(complete==0?0:10):"")+"In'>"+_7D+"</div></div>|||";}}} else{ if(_7P)AJ[Au++]=["|",A5,"|0|",CF,"||<div",R0,UT?"NullOut"+UT:"","NullOut'><div",R0,UT?"NullIn"+UT:"","NullIn'>",_7D,"</div></div>|||"].join(""); else B3+="|"+A5+"|0|"+CF+"||<div"+R0+(UT?"NullOut"+UT:"")+"NullOut'><div"+R0+(UT?"NullIn"+UT:"")+"NullIn'>"+_7D+"</div></div>|||"; CA++;}; if(options&2){ if(_7P)AJ[Au++]=["|",(A5+(UV?CF-10:-10)),"|0|",20,"|||",AY,UT?"OutLeft"+UT:"","OutLeft|||",(A5+(UV?-10:CF-10)),"|0|",20,"|||",AY,UT?"OutRight"+UT:"","OutRight||"].join(""); else B3+="|"+(A5+(UV?CF-10:-10))+"|0|"+20+"|||"+AY+(UT?"OutLeft"+UT:"")+"OutLeft|||"+(A5+(UV?-10:CF-10))+"|0|"+20+"|||"+AY+(UT?"OutRight"+UT:"")+"OutRight||"; CA+=2;} row[F6+"Gdatecnt"]=CA-row[F6+"Gdate"];} else{row[F6+"Gdate"]=null;row[F6+"Gdatecnt"]=null;}; if(UL){ row[F6+"Gflow"]=CA;CA+=UL.length;row[F6+"Gflowcnt"]=UL.length; for(var i=0;i<UL.length;i++){ var A5=(UL[i][0]-St)*Ss; var CF=Math.ceil((UL[i][1]-UL[i][0])*Ss); if(_7P)AJ[Au++]=["|",A5,"|0|",CF,"||<div",R0,UT?"FlowOut"+UT:"","FlowOut'><div",R0,UT?"FlowIn"+UT:"","FlowIn'>",_7D,"</div></div>|||"].join(""); else B3+="|"+A5+"|0|"+CF+"||<div"+R0+(UT?"FlowOut"+UT:"")+"FlowOut'><div"+R0+(UT?"FlowIn"+UT:"")+"FlowIn'>"+_7D+"</div></div>|||";}} else row[F6+"Gflow"]=null; var UY=this.UA(row,F6,"GanttMark"); if(UY){ var UZ=this.Gw(row,F6,"GanttMarkRound","m"); var AL="gantt"+UY+UZ+T1+(St-0)+UU+(UC-0); if(!this.r[AL]){ var G1="",Em=0; UY=this.T7(UY,UZ,DY); for(var i=0;i<UY.length;i++){ if(UY[i][0]<St||UY[i][1]>UC)continue; var A5=(UY[i][0]-St)*Ss; var CF=Math.ceil((UY[i][1]-UY[i][0])*Ss); G1+="|"+A5+"|0|"+CF+"|||"+AY+(UT?"Mark"+UT:"")+"Mark||"; Em++;} this.r[AL]=G1; this.r[AL+"Cnt"]=Em;} if(_7P)AJ[Au++]=this.r[AL]; else B3+=this.r[AL]; row[F6+"Gmark"]=CA; CA+=this.r[AL+"Cnt"];} if(_7P)AJ[Au++]="|0|0||||||"; else B3+="|0|0||||||"; row[F6+"Gdep"]=CA++; row[F6+"Gdeprep"]=null; if(UO&&UH){ row[F6+"Gres"]=CA++; if(_7P)AJ[Au++]=["|",((UH-St)*Ss+AI.GanttEnd),"|0|||<div",R0,UT?"Resource"+UT:"","Resource'>",D0.Escape(UO),"</div>|||"].join(""); else B3+="|"+((UH-St)*Ss+AI.GanttEnd)+"|0|||<div"+R0+(UT?"Resource"+UT:"")+"Resource'>"+D0.Escape(UO)+"</div>|||";} if(Hd){ var Ua=this.UA(row,F6,"GanttFlagTexts"); row[F6+"Gflag"]=CA; var Ub=Ua?(Ua+"").split(DY.ValueSeparator):[],GI=0; var Uc=AI.GanttFlag;Uc=Math.ceil((width-Uc)/2); for(var i=0;i<Hd.length;i++){ do{ if(_7P)AJ[Au++]=["|",Math.floor((Hd[i][0]-St)*Ss+Uc),"|0||||",AY,UT?"Flag"+UT:"","Flag||"].join(""); else B3+="|"+Math.floor((Hd[i][0]-St)*Ss+Uc)+"|0||||"+AY+(UT?"Flag"+UT:"")+"Flag||"; this.Tx(Hd[i][0],T1); CA++;}while(Hd[i][0]<Hd[i][1]);} row[F6+"Gflagcnt"]=CA-row[F6+"Gflag"];} else row[F6+"Gflag"]=null; row[F6]=_7P?AJ.join(""):B3; if(HQ)this.RefreshCell(row,F6); return B3;}; _7h.prototype.US=function(HQ,F6){ if(!F6){for(var BD in this.Cols)if(this.Cols[BD].Type=="Gantt")this.US(HQ,BD);return;} var N6=null,N8=null,BY=false; for(var AP=this.GetFirst();AP;AP=this.GetNext(AP)){ var UP=AP[F6+"F1"],UQ=AP[F6+"F2"]; if(UP&&(UP<N6||!N6))N6=UP; if(UQ&&UQ>N8)N8=UQ;} var C=this.Cols[F6]; if(C.Sv-N6){C.Sv=new Date(N6);BY=true;} if(C.UD-N8){C.UD=new Date(N8);BY=true;} if(BY){ if(this.RowCount<this.SynchroCount&&!this.Paging||!HQ)this.Iw(HQ); else{var T=this;this.ShowMessage(this.GetText("GanttUpdate"));setTimeout(function(){T.Iw(HQ);T.HideMessage();if(HQ)T.Update();},10);}} return BY;}; _7h.prototype.Tp=function(F6){ if(!F6){for(var BD in this.Cols)if(this.Cols[BD].Type=="Gantt")this.Tp(BD);return;} var Ud=this.Img.GanttStart,Dy=this.Img.GanttEnd; var HF=this.Lang.Format.ValueSeparator,AY=this.Img.Style+"GanttDep",margin=this.Rtl?"margin-right:":"margin-left:"; var TW=this.TX,Ue=this.TR; var Te=this.Cols[F6]["GanttDataUnits"],Uf=0; if(Te)Te=_7Av[Te]; if(!Te)Te=1; if(TW==null){ var BM=document.createElement("div"); BM.className=AY+"Vert GridTmpTag"; this.MainTag.appendChild(BM); var B3=GetStyle(BM); var GM=parseInt(B3.borderLeftWidth);if(!GM)GM=0; var Ug=parseInt(B3.borderRightWidth);if(!Ug)Ug=0; var A5=parseInt(B3.width);if(!A5)A5=0; TW=A5?GM:0; Ue=_7Q?"width:"+(A5+GM+Ug)+"px;":""; this.TX=TW; this.TR=Ue; this.MainTag.removeChild(BM);} if(!this.Uh){ var Ui=_7D; if(_7W||_7K)Ui="<div style='width:1px;height:1px;overflow:hidden;'></div>"; this.Uh=[ "<div class='"+AY+"HorzOut' style='"+margin, "<div class='"+AY+"Icon' style='"+margin, "<div class='"+AY+"Vert' style='"+Ue+margin, "<div class='"+AY+"VertBottom' style='"+Ue+margin, "<div class='"+AY+"VertTop' style='"+Ue+margin, "<div class='"+AY+"VertBottom3' style='"+Ue+margin, "<div class='"+AY+"VertBottom2' style='"+Ue+margin, "<div class='"+AY+"VertTop2' style='"+Ue+margin, "px;'>"+_7D+"</div>", "px;width:", "px;'><div class='"+AY+"HorzIn'>"+Ui+"</div></div>", "px;'><div class='"+AY+"HorzTop'>"+Ui+"</div></div>", "px;'><div class='"+AY+"HorzBottom'>"+Ui+"</div></div>", "px;'><div class='"+AY+"ArrowRight'>"+_7D+"</div></div>", "px;'><div class='"+AY+"ArrowLeft'>"+_7D+"</div></div>", "", "", "<div class='"+AY+"First'>"+_7D+"</div>", "px;'><div class='"+AY+"HorzInLag'>"+Ui+"</div></div>", "",]; var CZ=this.Uh; for(var i=0;i<13;i++)CZ[i+20]=CZ[i].replace("class='","class='"+AY+"Err "); for(var i=13;i<15;i++)CZ[i+20]=CZ[i].replace("Arrow","ArrowErr"); CZ[38]=CZ[18].replace("class='","class='"+AY+"LagErr ");} var AI={},R=[],AL=[],T=[],DY=[],AM=[],Uj=F6+"Gdependency",Sw=F6+"Gdeptype",TH=F6+"Gdeplag",Uk=F6+"Gdw"; for(var AP=this.GetFirst(),Db=0;AP;AP=this.GetNext(AP))if(AP.Visible){AI[AP.id]=Db;R[Db++]=AP;} for(var JW=0;JW<Db;JW++){ var AP=R[JW],a=AP[Uj]; if(a){ a=a.split?a.split(HF):[a]; var Ak=AP[Sw],F8=AP[TH],Ey=[]; T[JW]=Ak?(Ak+"").toLowerCase().split(HF):[]; if(F8){ F8=(F8+"").split(HF); for(var i=0;i<F8.length;i++)F8[i]=Math.ceil(F8[i]*AP[Uk]*Te); DY[JW]=F8;} else DY[JW]=[]; for(var i=0;i<a.length;i++){ var Ul=AI[a[i]]; if(Ul!=null){ Ey[Ey.length]=Ul; if(!AM[Ul])AM[Ul]=[JW]; else AM[Ul][AM[Ul].length]=JW;}} AL[JW]=Ey;}} delete AI; var Um=F6+"Gdepss",Un=F6+"Gdepsf",Uo=F6+"Gdepfs",Up=F6+"Gdepff"; for(var JW=0;JW<Db;JW++){ var Au=AL[JW],B3="",Cq="",AP=R[JW]; if(Au)for(var i=0;i<Au.length;i++){ if(T[JW][i]&&T[JW][i].charAt(0)=='s')B3+=(B3?HF:"")+R[Au[i]].id; else Cq+=(Cq?HF:"")+R[Au[i]].id;} AP[Um]=B3;AP[Un]=Cq; var Au=AM[JW],B3="",Cq=""; if(Au)for(var i=0;i<Au.length;i++){ var Es=AL[Au[i]];if(Es)for(var j=0;j<Es.length;j++)if(Es[j]==JW)break; if(T[Au[i]][j]&&T[Au[i]][j].charAt(1)!='s')Cq+=(Cq?HF:"")+R[Au[i]].id; else B3+=(B3?HF:"")+R[Au[i]].id;} AP[Uo]=B3;AP[Up]=Cq;} var AJ={}; var Cn=[]; var Uq=F6+"Gdate1",Ur=F6+"Gdate2",Us=F6+"Gdatecnt",Ut=F6+"Gdepdata",Uu=F6+"Gdeprep",Uv=[2,6,7,2]; var Uw=0,Ux=this.Cols[F6]["GanttMaxDependencies"];if(Ux==null)Ux=100; for(var JW=0;JW<Db;JW++){ var AP=R[JW],Uy=[],N2=[],H6,Uz=0; var a=AJ[JW],AN=[],Ey=0; if(a){ for(var i=0;i<a.length;i+=2){ var A5=a[i]-TW; for(var j=0;j<Cn.length;j++)if(Cn[j]==A5||Cn[j]==-A5){Cn.splice(j,1);Uw=Cn.length;break;}}} var CJ=Cn.join("|"); var Es=AL[JW],Bg; if(Es){ var Tb=AP[Uq]-Ud,Jh=AP[Ur]+Ud,A5; for(var i=0;i<Es.length;i++){ var U0=Es[i];if(!U0)continue; if(!R[U0])continue; var Au=AM[U0];if(Au)for(var j=0;j<Au.length;j++)if(Au[j]==JW){Au[j]=null;break;} if(T[JW][i]&&T[JW][i].charAt(1)!='s')Bg=2; else Bg=0; var U1=DY[JW][i],NH=0;if(!U1)U1=0; if(T[JW][i]&&T[JW][i].charAt(0)=='s'){ if(AP[Uq]+U1-1>R[U0][Bg?Ur:Uq]){NH=20;Bg+=4;Uf++;} A5=Tb+U1; if(U1<0)N2.push(0,AP[Uq]+U1,-U1,18+NH); else if(U1>0)N2.push(0,AP[Uq],U1-Ud,18+NH); N2.push(0,U1<=0?A5:A5-Ud+TW,Ud,10+NH);} else{ if(AP[AP[Us]?Ur:Uq]+U1-1>R[U0][Bg?Ur:Uq]){NH=20;Bg+=4;Uf++;} A5=Jh+U1; if(U1<0)N2.push(0,AP[Ur]+U1+Ud,-U1-Ud,18+NH); else if(U1>0)N2.push(0,AP[Ur],U1,18+NH); N2.push(0,U1<0?A5:A5-Ud,Ud+TW,10+NH);}; Uy[Uz++]=3+NH;Uy[Uz++]=A5-TW; if(AJ[U0]){AJ[U0][AJ[U0].length]=A5;AJ[U0][AJ[U0].length]=Bg;} else AJ[U0]=[A5,Bg]; if(A5>=TW)Cn[Uw++]=NH?TW-A5:A5-TW; if(Uw>Ux)Uw=0;}} if(a){ for(var i=0;i<a.length;i+=2){ var T9=a[i+1]&3,NH=a[i+1]&4?20:0; if(T9==1){ var A5=a[i],CF=AP[Uq]-Ud; if(A5<CF)N2.push(0,A5,CF-A5+Ud,18+NH); else if(A5>CF)N2.push(0,CF+Ud,A5-CF-Ud,18+NH); N2.push(0,A5<=CF?A5:A5-Ud+TW,Ud,10+NH); Uy[Uz++]=4+NH;Uy[Uz++]=A5-TW;} else if(T9==3){ var A5=a[i],CF=AP[Ur]+Ud; if(A5<CF)N2.push(0,A5,CF-A5-Ud,18+NH); else if(A5>CF)N2.push(0,CF-Ud,A5-CF,18+NH); N2.push(0,A5<CF?A5:A5-Ud,Ud+TW,10+NH); Uy[Uz++]=4+NH;Uy[Uz++]=A5-TW;}}} var Au=AM[JW],U2=0,U3=0,U4=0; if(Au||a){ var min=1e6,max=0,U5=1e6,CK=0,U6=1e6,CL=0; var Tb=AP[Uq]-Dy,Jh=AP[Ur]+Dy;} if(Au){ for(var i=0;i<Au.length;i++){ var U0=Au[i];if(!U0)continue; var Es=AL[U0];if(Es)for(var j=0;j<Es.length;j++)if(Es[j]==JW){Es[j]=null;break;} var KT=R[U0],A5=0,Bg; if(T[U0][j]&&T[U0][j].charAt(0)=='s'){A5=KT[Uq]-Ud;Bg=1;} else{A5=KT[Ur]+Ud;Bg=3;}; if(DY[U0][j])A5+=DY[U0][j]; var U7=Bg==3&&!KT[Us]?A5-KT[Ur]+KT[Uq]-Ud*2:A5; if(T[U0][j]&&T[U0][j].charAt(1)!='s'){ if(A5>=Jh){ if(max<A5)max=A5; var H=0; if(U7-Jh+Dy-1>Ud){H=20;U4=20;Bg+=4;Uf++;} Uy[Uz++]=3+H;Uy[Uz++]=A5-TW;} else{ if(U6>A5)U6=A5;}} else{ if(A5<=Tb){ Uy[Uz++]=3;Uy[Uz++]=A5-TW; if(min>A5)min=A5;} else{ if(CL<A5)CL=A5; if(U7-Tb-Dy-1>Ud){U2=20;Bg+=4;Uf++;}}}; if(AJ[U0]){AJ[U0][AJ[U0].length]=A5;AJ[U0][AJ[U0].length]=Bg;} else AJ[U0]=[A5,Bg]; Cn[Uw++]=Bg&4?TW-A5:A5-TW; if(Uw>Ux)Uw=0;}} if(a){ for(var i=0;i<a.length;i+=2){ var A5=a[i],T9=a[i+1]&3; if(T9==0){ if(A5<=Tb){ Uy[Uz++]=4;Uy[Uz++]=A5-TW; if(min>A5)min=A5;} else{ if(CK<A5){ CK=A5; if(a[i+1]&4)U3=20;}}} else if(T9==2){ if(A5>=Jh){ if(max<A5)max=A5; var H=0; if(a[i+1]&4){H=20;U4=H;} Uy[Uz++]=4+H;Uy[Uz++]=A5-TW;} else{ if(U5>A5)U5=A5;}}}} if(Au||a){ var U8=0,U9=0; if(min!=1e6){ N2.push(1,Tb-TW-1,Dy+TW+1,13,0,min,Tb-min+TW,10);} if(max){ N2.push(1,Jh-Dy,Dy+TW,14+U4,0,Jh,max-Jh+TW,10+U4);} if(U5!=1e6){ N2.push(0,U5,Jh-U5+TW,11); U9|=2;} if(CK){ N2.push(0,Tb,CK-Tb+TW,11+U3); U8|=2;} if(U6!=1e6){ N2.push(0,U6,Jh-U6+TW,12); Uy[Uz++]=5;Uy[Uz++]=U6-TW; U9|=1;} if(CL){ N2.push(0,Tb,CL-Tb+TW,12+U2); Uy[Uz++]=5+U2;Uy[Uz++]=CL-TW; U8|=1;} if(U8){ if(U8&1){Uy[Uz++]=6+U2;Uy[Uz++]=Tb-TW;} if(U8&2){Uy[Uz++]=7+U3;Uy[Uz++]=Tb-TW;} N2.push(1,Tb-TW-1,Dy+TW+1,13+(U2|U3));} if(U9){ Uy[Uz++]=Uv[U9];Uy[Uz++]=Jh-TW; N2.push(1,Jh-Dy,Dy+TW+1,14+U4);}} var VA=N2.length,VB=Uz++; var X=VA||VB?VA+"|"+VB+"|"+(VA?N2.join("|"):"")+(VA&&VB?"|":"")+(VB?Uy.join("|"):"")+(CJ?"|"+CJ:""):(CJ?"0|0|"+CJ:""); var Bb=AP[Ut];if(!Bb)Bb=""; if(Bb!=X){AP[Ut]=X;AP[Uu]=1;}} this.Ti=0; this.Cols[F6].GanttErrors=Uf;}; _7h.prototype.VC=function(row,F6){ var AS=row[F6+"Gdepdata"],AJ=[],Au=0,C=this.Uh; if(AS){ AS=AS.split('|'); var VD=AS[0]-0+2,VE=AS[1]-0+VD; AJ[Au++]=""; for(var i=2;i<VD;i+=4){AJ[Au++]=C[AS[i]];AJ[Au++]=AS[i+1];AJ[Au++]=C[9];AJ[Au++]=AS[i+2];AJ[Au++]=C[AS[i+3]];} for(;i<VE;i+=2){AJ[Au++]=C[AS[i]];AJ[Au++]=AS[i+1];AJ[Au++]=C[8];} for(;AS[i];i++){ if(AS[i]<0){AJ[Au++]=C[22];AJ[Au++]=-AS[i];AJ[Au++]=C[28];} else{AJ[Au++]=C[2];AJ[Au++]=AS[i];AJ[Au++]=C[8];}} if(Au>1)AJ[0]=C[17];} return AJ.join("");}; _7h.prototype.Tq=function(F6,page){ if(this.Rendering||this.Loading)return; if(!F6){for(var BD in this.Cols)if(this.Cols[BD].Type=="Gantt")this.Tq(BD,page);return;} if(!page){for(var Au=this.XB.firstChild;Au;Au=Au.nextSibling)this.Tq(F6,Au);return;} for(var AP=page.firstChild;AP;AP=AP.nextSibling){ if(AP[F6+"Gdeprep"]){ var H6=this.GetCell(AP,F6);if(H6)H6=H6.firstChild; var UR=AP[F6+"Gdep"]; if(H6&&UR!=null){ H6.childNodes[AP[F6+"Gdep"]].innerHTML=this.VC(AP,F6); var Gn=this.VF; if(Gn==null){Gn=_7AI(GetStyle(this.GetCell(AP,F6)));this.VF=Gn;} var CZ=H6.parentNode.parentNode.offsetHeight-Gn; H6.style.height=CZ+"px"; AP[F6+"Gdeprep"]=null;}} if(AP.firstChild)this.Tq(F6,AP);}}; _7h.prototype.RefreshGanttDependencies=function(HQ,F6){ if(!this.Gantt)return; if(!F6){for(var F6 in this.Cols)if(this.Cols[F6].Type=="Gantt")this.RefreshGanttDependencies(HQ,F6);return;} this.Tp(); if(HQ==null||HQ)this.Tq();}; _7h.prototype.GetGanttXY=function(row,F6,X,Y){ if(typeof(row)=="number"){ var E=this.Ql({clientX:row,clientY:F6},this.ARow); row=E.Row;F6=E.Col;X=E.X;Y=E.Y;} if(!row||!F6||!row[F6+"Gantt"])return null; var H6=this.GetCell(row,F6),AJ={};if(!H6)return null; H6=H6.firstChild; AJ.RZ=X;AJ.Ra=Y; var AS=row[F6+"Gdate"]; if(AS!=null){ AS=H6.childNodes[AS]; if(!AS)return null; var BM=AS.firstChild;if(!BM)BM=AS; var y=Y-AS.offsetTop-BM.offsetTop; var Em=row[F6+"Gdatecnt"]; if(y>=0&&y<BM.offsetHeight||Y==null){ if(this.Ph){ if(X<AS.offsetLeft){ var B3=this.Rtl?'f':'s',x=AS.offsetLeft-X; if(x<=this.Img.GanttStart+2){var a=row[F6+"Gdeps"+B3];if(a)AJ.DependencyStartLeft=a;} if(x<=this.Img.GanttEnd+2){var a=row[F6+"Gdepf"+B3];if(a)AJ.DependencyEndLeft=a;}} var AL=Em==2||Em==4?AS.nextSibling:AS; if(X>=AL.offsetLeft+AL.offsetWidth){ var Cq=this.Rtl?'s':'f',x=X-AL.offsetLeft-AL.offsetWidth; if(x<=this.Img.GanttStart+2){var a=row[F6+"Gdeps"+Cq];if(a)AJ.DependencyStartRight=a;} if(x<=this.Img.GanttEnd+2){var a=row[F6+"Gdepf"+Cq];if(a)AJ.DependencyEndRight=a;}}} if(X>=AS.offsetLeft&&X<AS.offsetLeft+AS.offsetWidth){ AJ.Main=BM;AJ.MainX=X-AS.offsetLeft; if(Em==2||Em==4){AJ.Main2=AS.nextSibling.firstChild;AJ.MainPos=1;} else AJ.MainPos=0;} else if(Em==2||Em==4){ AS=AS.nextSibling; if(AS&&X>=AS.offsetLeft&&X<AS.offsetLeft+AS.offsetWidth){ AJ.Main=AS.firstChild;AJ.MainX=X-AS.offsetLeft; AJ.Main2=AS.previousSibling.firstChild;AJ.MainPos=2;}}} if(AJ.Main){ if(Em){ var M=AJ.Main.className.match(/\d+/); AJ.MainType=M?M[0]-0:null;} else AJ.MainType="Milestone";}} var CE=row[F6+"Gflow"]; if(CE!=null){ CE=H6.childNodes[CE]; var Em=row[F6+"Gflowcnt"]; for(var i=0;i<Em&&CE;i++){ var y=Y-CE.offsetTop-CE.firstChild.offsetTop; if((Y==null||y>=0&&y<CE.firstChild.offsetHeight)&&X>=CE.offsetLeft&&X<CE.offsetLeft+CE.offsetWidth){AJ.Flow=CE.firstChild;AJ.FlowIndex=i;AJ.FlowX=X-CE.offsetLeft;break;} CE=CE.nextSibling;}} var CE=row[F6+"Gflag"]; if(CE!=null){ CE=H6.childNodes[CE]; var Em=row[F6+"Gflagcnt"]; for(var i=0;i<Em&&CE;i++){ if(Y>=0&&Y<CE.offsetHeight&&X>=CE.offsetLeft&&X<CE.offsetLeft+CE.offsetWidth){AJ.Sm=CE;AJ.S7=i;AJ.So=X-CE.offsetLeft;break;} CE=CE.nextSibling;}} return AJ;}; _7h.prototype.VG=function(row,F6,X,Y){ if(Grids.Bc&&Grids.Bc.Row==row)return false; var DY=this.S6,Cc,options=this.Gw(row,F6,"GanttOptions"); var AJ=options&17?this.GetGanttXY(row,F6,X,Y):null; if(AJ){ AJ.Row=row;AJ.Col=F6; Cc=AJ.Sm; if(!Cc)Cc=AJ.Flow; if(!Cc)Cc=AJ.Main; AJ.Cc=Cc; AJ.VH=options;} if(DY&&DY.Cc&&DY.Cc!=Cc&&DY.VH&1){ var BQ=DY.Row[DY.Col+"Gantt"]; if(DY.Sm&&DY.VH&64){ DY.Sm.className=DY.Sm.className.replace(/\s\w+Hover/,""); this.Rm("");} else if(DY.Flow&&DY.VH&32)DY.Flow.className=DY.Flow.className.replace(/\s\w+Hover/,""); else if(DY.Main&&DY.VH&144){ DY.Main.className=DY.Main.className.replace(/\s\w+Hover\w*/,""); if(DY.Main2)DY.Main2.className=DY.Main2.className.replace(/\s\w+Hover\w*/,"");}} if(AJ&&Cc&&(!DY||DY.Cc!=Cc)&&options&1){ BQ=""; var AY=" "+this.Img.Style+"Gantt"; if(AJ.Sm&&options&64){ AJ.Sm.className+=AY+"FlagHover"; var Ub=this.UA(row,F6,"GanttFlagTexts"); if(Ub){ Ub=(Ub+"").split(this.Lang.Format.ValueSeparator); if(Ub[AJ.S7])this.Rm(Ub[AJ.S7]);}} else if(AJ.Flow&&options&32)AJ.Flow.className+=AY+"FlowHover"; else if(AJ.Main&&options&144){ if(AJ.MainType=="Milestone")AJ.Main.className+=AY+"MilestoneHover"; else{ AJ.Main.className+=AY+"HoverOut"; if(AJ.Main2)AJ.Main2.className+=AY+"HoverOut";}}} if(AJ&&options&48&&!Grids.Bc){ var Cu="",max=this.Mouse.EdgeSize; if(Cc&&(Cc==AJ.Main&&options&16&&(AJ.MainX<=max&&AJ.MainPos!=2||AJ.MainX>=AJ.Main.offsetWidth-max&&AJ.MainPos!=1)&&AJ.MainType!="Milestone"||Cc==AJ.Flow&&options&32&&(AJ.FlowX<=max||AJ.FlowX>=AJ.Flow.offsetWidth-max)))Cu="e-resize"; if(!DY||DY.VI!=Cu||row!=this.J5||F6!=this.VJ)this.GetCell(row,F6).style.cursor=Cu; AJ.VI=Cu;} this.S6=AJ; return true;}; _7h.prototype.ActionHoverGantt=function(){ if(this.Event.Type=="Gantt")return this.VG(this.ARow,this.ACol,this.Event.X,this.Event.Y);}; _7h.prototype.Su=function(row,F6,Gx){ var UB=F6+"Gantt"+Gx,Bb=row[UB]; if(Bb==null){ Bb=row.Def[UB]; if(Bb==null){Bb=this.Cols[F6]["Gantt"+Gx];if(Bb==null)return null;}} if(this.Cols[Bb])return Bb; return null;}; _7h.prototype.TK=function(AJ,row,F6,X){ var Cc=row[F6+"Gdate"]; if(Cc==null)return false; var H6=this.GetCell(row,F6);if(!H6)return false; Cc=H6.firstChild.childNodes[Cc]; var Em=row[F6+"Gdatecnt"]; var BM=Em?Cc.firstChild:Cc; if(Em==2||Em==4){ var Bn=Cc.nextSibling.firstChild; if(X<Cc.offsetLeft+Cc.offsetWidth){AJ.Main=BM;AJ.Main2=Bn;AJ.MainPos=1;} else{AJ.Main=Bn;AJ.Main2=BM;AJ.MainPos=2;}; if(X<Cc.offsetLeft+(BM.offsetWidth+Bn.offsetWidth)/2)AJ.MainX=5; else AJ.MainX=AJ.Main.offsetWidth-8;} else{AJ.Main=BM;AJ.MainX=X<Cc.offsetLeft+BM.offsetWidth/2?5:BM.offsetWidth-5;AJ.MainPos=0;}; return true;}; _7h.prototype.GanttStart=function(){ this.QE(); this.VK=this.Ph; this.Ph=0; this.Calculated=0;}; _7h.prototype.GanttEnd=function(row,F6){ this.QF(); this.Calculated=1; this.Ph=this.VK; if(row)this.Recalculate(row,F6,1); if(this.Ph&&this.Ti){this.Tp();this.Tq();}}; _7h.prototype.ActionGanttMenu=function(){ var row=this.ARow,F6=this.ACol,X=this.Event.X,Y=this.Event.Y; var AJ=this.GetGanttXY(row,F6,X,Y); if(!AJ)return false; var T=this,options=this.Gw(row,F6,"GanttOptions"),HF=this.Lang.Format.ValueSeparator; var M=DV.DW(this.Gw(row,F6,"Menu"),1); if(!M)M={}; if(!M.Items)M.Items=[]; var AI=M.Items,Au=AI.length,TN=0; if(Au!=TN){AI[Au++]={Name:"-"};TN=Au;} if(AJ.Sm&&options&64){ var Ai=this.GetText("DelGanttFlag"); if(Ai)AI[Au++]={AT:this.S8,Param:[row,F6,AJ.S7],Text:Ai}; var Ai=this.GetText("EditGanttFlag"); if(Ai)AI[Au++]={AT:this.TJ,Param:[row,F6,AJ.S7],Text:Ai}} if(AJ.Flow&&options&32){ var Ai=this.GetText("DelGanttFlowPart"); if(Ai)AI[Au++]={AT:this.TB,Param:[row,F6,AJ.FlowIndex],Text:Ai}} if(AJ.Main&&options&16){ if(AJ.MainType=="Milestone"){ var Ai=this.GetText("DelGanttMilestone"); if(Ai)AI[Au++]={AT:this.TA,Param:[row,F6],Text:Ai}} else{ var Ai=this.GetText("DelGanttMain"); if(Ai)AI[Au++]={AT:this.TA,Param:[row,F6],Text:Ai}; if(this.Su(row,F6,"Complete")){ var Ai=this.GetText("SetGanttPercent"); if(Ai)AI[Au++]={AT:this.VL,Param:[row,F6,X,Y,this.ActionSetGanttPercent],Text:Ai}; var Ai=this.GetText("EditGanttPercent"); if(Ai)AI[Au++]={AT:this.TE,Param:[row,F6],Text:Ai};}}} if(AJ.Main&&options&8&&this.Su(row,F6,"Resources")){ var Ai=this.GetText("EditGanttResource"); if(Ai)AI[Au++]={AT:this.TF,Param:[row,F6],Text:Ai}} if(options&128){ var DY=this.Gw(row,F6,"GanttDependencyLags"); if(DY){ var a=row[F6+"Gdepss"],Ey=row[F6+"Gdepsf"]; if(a&&Ey)a+=HF; a+=Ey; if(a){ a=(a+"").split(HF); for(var i=0;i<a.length;i++){ var AP=this.GetRowById(a[i]); var Ai=this.GetText("EditGanttDepLag"); if(AP&&Ai)AI[Au++]={AT:this.TG,Param:[row,AP,F6],Text:Ai.replace("%d",this.HK(AP))}}}}} if(Au!=TN){AI[Au++]={Name:"-"};TN=Au;} if(options&128){ var Fj=[["Gdepss","Gdepsf","DelGanttDepStart"],["Gdepfs","Gdepff","DelGanttDepEnd"]],VM=Au; for(var j=0;j<Fj.length;j++){ var a=row[F6+Fj[j][0]],Ey=row[F6+Fj[j][1]]; if(a&&Ey)a+=HF; a+=Ey; if(a){ a=(a+"").split(HF); for(var i=0;i<a.length;i++){ var AP=this.GetRowById(a[i]); var Ai=this.GetText(Fj[j][2]); if(AP&&Ai)AI[Au++]={AT:this.Tr,Param:j==0?[row,AP,F6]:[AP,row,F6],Text:Ai.replace("%d",this.HK(AP))}}}} if(VM!=Au){ var Ai=this.GetText("DelAllGanttDep"); if(Ai)AI[Au++]={AT:this.TD,Param:[row,F6],Text:Ai.replace("%d",Au-VM)}}} if((options&144)==144){ var I5=this.Su(row,F6,"Start"),Sw=this.Su(row,F6,"End"),VN=0; if(!Sw)Sw=this.Su(row,F6,"Duration"); if(I5&&Sw){ var H=Get(row,I5),Ak=Get(row,Sw); if(H||Ak){ var Ai=this.GetText(H&&Ak?"DelGanttMainDep":"DelGanttMilestoneDep");VN=1; if(Ai)AI[Au++]={AT:function(row,F6){T.TD(row,F6);T.TA(row,F6);},Param:[row,F6],Text:Ai}}}} if(options&32){ var I5=this.Su(row,F6,"Flow"),UL=0; if(I5&&Get(row,I5)){ var Ai=this.GetText("DelGanttFlow");UL=1; if(Ai)AI[Au++]={AT:this.TB,Param:[row,F6],Text:Ai}}} if(options&64){ var I5=this.Su(row,F6,"Flags"); if(I5&&Get(row,I5)){ var Ai=this.GetText("DelGanttFlags"); if(Ai)AI[Au++]={AT:this.S9,Param:[row,F6],Text:Ai}}} if((options&240)==240){ if(VM!=Au){ var Ai=this.GetText("DelGanttAll"); if(Ai)AI[Au++]={AT:this.TC,Param:[row,F6],Text:Ai}}} if(Au!=TN){AI[Au++]={Name:"-"};TN=Au;} if(!AJ.Sm&&options&64&&this.Su(row,F6,"Flags")){ var Ai=this.GetText("NewGanttFlag"); if(Ai)AI[Au++]={AT:this.VL,Param:[row,F6,X,Y,this.ActionNewGanttFlag],Text:Ai}} if(!AJ.Main&&options&16&&VN){ var Ai=this.GetText("EditGanttPercent"); if(Ai)AI[Au++]={AT:this.TE,Param:[row,F6],Text:Ai}} if(!AJ.Main&&options&8&&this.Su(row,F6,"Resources")){ var Ai=this.GetText("EditGanttResource"); if(Ai)AI[Au++]={AT:this.TF,Param:[row,F6],Text:Ai}} if(Au!=TN){AI[Au++]={Name:"-"};TN=Au;} if(this.Cols[F6].GanttErrors){ var Ai=this.GetText("CorrectRelatedDependencies"); if(Ai){ var AJ={},Ff=this.Tj(row,F6,AJ,1); Ff+=this.Tk(row,F6,AJ,1); if(Ff)AI[Au++]={AT:this.Tl,Param:[F6,1,AJ],Text:Ai}} var Ai=this.GetText("CorrectAllDependencies"); if(Ai)AI[Au++]={AT:this.Tl,Param:[F6,1],Text:Ai}} if(Au&&Au==TN)AI.length=Au-1; if(!Au)return false; M.Base=this.Img.Style+"Menu"; M.Class=this.Img.Style+"GanttMenu"; var AM=this.IC(row,F6); AM.X=AM.IQ+X; AM.Y=AM.IR+Y; AM.Align="left below"; AM.Width=0;AM.Height=0; M.OnSave=function(AI){ if(AI.AT)AI.AT.apply(T,AI.Param); else{ if(Grids.OnContextMenu)return!Grids.OnContextMenu(T,row,F6,JW,M[JW]); alert("No OnContextMenu event defined");}; return true;}; M.OnClose=function(){T.Dialog=null;}; if(this.Dialog)this.Dialog.Close(); M=ShowMenu(M,AM); this.Dialog=M; M.Row=row;M.Col=F6;M.Type="Gantt"; return true;}; _7h.prototype.VL=function(row,F6,X,Y,UP,UQ,VO){ var AP=this.ARow,BD=this.ACol,x=this.Event.X,y=this.Event.Y; this.ARow=row;this.ACol=F6;this.Event.X=X;this.Event.Y=Y; if(UP)UP.apply(this); if(UQ)UQ.apply(this); if(VO)VO.apply(this); this.ARow=AP;this.ACol=BD;this.Event.X=x;this.Event.Y=y;}; _7h.prototype.GroupRows=function(Cols,VP){ if(!this.Grouping)return false; if(this.Paging==3&&!(this.OnePage&4)&&!this.Iz())return; var T=this; function Fu(){ T.DoGrouping(Cols,VP,null,function(DG){ T.SaveCfg(); if(DG){ T.HideMessage(); T.ShowPages();}});}; if(this.RowCount<this.SynchroCount&&!this.Paging)Fu(); else{this.ShowMessage(this.GetText("Group"));setTimeout(Fu,10);}}; _7h.prototype.DoGrouping=function(Cols,VP,Main,AT){ if(!this.Grouping)return false; if(typeof(Cols)=="string")Cols=Cols.split(','); if(typeof(VP)=="string")VP=VP.split(','); if(Cols&&!Cols[0])Cols=null; if(Grids.OnGroup&&Grids.OnGroup(this,Cols,VP,Main))return; if(!this.DoSort){_7Ae("Sort");return;} this._7Aw=new Array(); for(var i=0;i<this.Z;i++){ var F6=this.GroupCols[i]; if(F6!=this.MainCol&&this.Cols[F6].CanGroup!=2)this._7Aw[this._7Aw.length]=this.GroupCols[i];} var VQ=this.Paging==3&&(!(this.OnePage&4)||this.AllPages); var VR=!Cols&&(this.GroupFlags&2&&this._7Ax!=null&&(this.W!=this._7Ax||this.SortCols.join(',')!=this._7Ay.join(',')||this.SortTypes.join(',')!=this._7Az.join(','))); if(this.Z){ if(VQ){ this.GroupCols=new Array(); this.GroupTypes=new Array(); this.Z=0; this.VS();} else this.VT(Cols&&Cols.length||VR,AT);} this.GroupCols=new Array(); this.GroupTypes=new Array(); if(Cols){ this.VU(); for(var i=0,Au=0;i<Cols.length;i++){ var BD=this.Cols[Cols[i]]; if(!BD)continue; this.GroupCols[Au]=Cols[i]; this.GroupTypes[Au]=VP?VP[i]:BD.GroupType; if(!this.GroupTypes[Au])this.GroupTypes[Au]=0; Au++;} this.Z=Au; this.VV(); if(Main&&this.Cols[Main])this.MainCol=Main;} else{ this.Z=0; if(VR){ this.W=this._7Ax; this._7Ax=null; this.SortCols=CopyObject(this._7Ay); this.SortTypes=CopyObject(this._7Az); this.VW(); if(!VQ)this.VX();}}; this.SetVPos(); if(!this.Z&&!VQ){ if(AT&&typeof(AT)=="function")AT(true); return;} if(this.FRow&&this.FRow.Def&&this.FRow.Def.Group){ this.Focus(null,null);} if(VQ){ this.Calculate(1,0,0,1); this.Clear(0); var VY=this.VZ(); this.Update(); if(this.Z){this.Va(this.SortCols,this.SortTypes);this.VW();} this.SaveCfg(); this.ReloadBody(null,VY,"Group");} else this.GroupAll(0,AT);}; _7h.prototype.VU=function(){ if(this.GroupFlags&2&&this._7Ax==null){ this._7Ax=this.W; this._7Ay=CopyObject(this.SortCols); this._7Az=CopyObject(this.SortTypes);}}; _7h.prototype.Vb=function(){ var Vc=this.GroupCols.join(","); var AJ=new Array(),Au=0,QC=new Array(),Vd=0,AS=this.Def; for(var Gy in AS){ if(!AS[Gy].Group)continue; var Ve=AS[Gy].GroupCols; if(Ve==null)QC[Vd++]=AS[Gy]; else if(!Ve)continue; else{ Ve=Ve.split(Ve.charAt(0)); for(var i=1;i<Ve.length;i++){ if(Vc.search(new RegExp("^"+Ve[i].replace(/\./g,"\\.").replace(/\*/g,".*")+"$","g"))>=0){AJ[Au++]=AS[Gy];break;}}}} for(var i=0;i<Vd;i++)if(QC[i].Name!="Group")AJ[Au++]=QC[i]; for(var i=0;i<Vd;i++)if(QC[i].Name=="Group")AJ[Au++]=QC[i]; this.e=AJ;}; _7h.prototype.Vf=function(Vg){ var Def=this.e,Vh=null,BD=this.GroupCols[Vg]; for(var i=0;i<Def.length;i++){ var AO=Def[i].GroupCol; if(AO==null){if(!Vh)Vh=Def[i];} AO=(AO+"").split(","); for(var j=0;j<AO.length;j++){ if(Vg==AO[j]||BD==AO[j]||Vg==this.GroupCols.length+(AO[j]-0))return Def[i];}} var AS=this.Cols[BD].GroupDef; if(AS&&Def[AS])return Def[AS]; if(Vh)return Vh; return this.Def["Group"];}; _7h.prototype.VV=function(){ this.Vb(); var AS=this.e; for(var i=0;i<AS.length;i++)if(AS[i].Action){ var I1=this.IV(AS[i].Action,null,1); var AM=new TCalc();AM.Row=AS[i];AM.Grid=this; I1(AM); this.Im(); break;} for(var i=0;i<AS.length;i++)if(AS[i].GroupMain&&this.Cols[AS[i].GroupMain]){this.MainCol=AS[i].GroupMain;return;} if(this.GroupMain&&this.Cols[this.GroupMain]){this.MainCol=this.GroupMain;return;} if(this.MainCol)return; var Main=this.ColNames[0][0]; if(Main=="Panel")Main=this.ColNames[0][1]; if(!Main)Main=this.ColNames[1][0]; this.MainCol=Main;}; _7h.prototype.VS=function(){ this.MainCol=this._7A0; this.Root.CDef=this.RootCDef; this.Root.AcceptDef=this.Vi; this.Root[this.MainCol+"NumberSort"]=this.Vj; if(this.UngroupAction){ var I1=this.IV(this.UngroupAction,null,1); var AM=new TCalc();AM.Grid=this; I1(AM); this.Im();}}; _7h.prototype.Va=function(Vk,Vl){ var Vm=new Array(),Af=new Array(),Vn=this.GroupCols.length,Au=0; if(this.GroupFlags&12){ Vm[Au]=this.MainCol; Af[Au]=this.GroupFlags&4?0:1; Au++;} for(var i=0;i<Vk.length;i++){ for(var j=0;j<Vn;j++)if(Vk[i]==this.GroupCols[j]&&Vk[i]!=this.MainCol||Vk[i]==this.MainCol&&this.GroupFlags&12)break; if(j==Vn){ Vm[Au]=Vk[i]; Af[Au]=Vl[i]; if(++Au==3)break;}} this.SortCols=Vm;this.SortTypes=Af;this.W=Vm.length; this.JT(); return Au!=i;}; _7h.prototype.GroupAll=function(Vo,AT){ if(!this.DoSort){_7Ae("Sort");return;} if(!this.Grouping)return; if(!this.Grouped){ if(AT)AT(true); return;} var Def=this.Def,Vp=this.Paging; var SG=this.Paging&&this.OnePage&4&&!this.AllPages?this.GetFPage():null; this.Paging=0; var Vk=CopyObject(this.SortCols),Vl=CopyObject(this.SortTypes); for(var Vg=0;Vg<this.GroupCols.length;Vg++){ var AS=null,BD=this.GroupCols[Vg],C=this.Cols[BD]; if(!C){ this.GroupCols=new Array(); this.VT(Vo,AT); return;} var AS=this.Vf(Vg); if(Grids.OnGetGroupDef)AS=Def[Grids.OnGetGroupDef(this,BD,AS.Name)]; var Vq=AS.EditCols; if(Vq)Vq=(Vq+"").split(','); this.Vr(SG,this.GroupCols[Vg],this.GroupTypes[Vg],AS,Vq,Vg!=0);} var OO=this.MaxGroupLength,LM=Grids.AH; function Vs(row){ if(row.Def&&row.Def.Group&&row.childNodes.length>OO){ var AP=_7i.createElement("I"); row.parentNode.insertBefore(AP,row); for(var i in row)if(!LM[i])AP[i]=row[i]; for(var i=0;i<OO;i++)AP.appendChild(row.firstChild); Vs(AP); Vs(row);} else{ for(var AP=row.firstChild;AP;AP=AP.nextSibling)if(AP.firstChild)Vs(AP);}}; if(OO>1)Vs(SG?SG:this.XB.firstChild); this.Paging=Vp; if(this.Va(Vk,Vl)&&!Vo)this.VW(); if(Vo){ this.Calculate(); for(var i=0;i<this.Z;i++){ var F6=this.GroupCols[i]; if(F6!=this.MainCol&&this.Cols[F6].CanGroup!=2)this.Cols[this.GroupCols[i]].Visible=0;} this.Vt(0);} else if(AT){ var T=this; function Vu(){ var DG=T.VX(); if(typeof(AT)=="function")AT(DG);}; if(this.RowCount<this.SynchroCount)Vu(); else setTimeout(Vu,10);} else this.VX();}; _7h.prototype.VX=function(){ this.Calculate(1,1,0,0,1); if(Grids.OnGroupFinish)Grids.OnGroupFinish(this); var SG=this.Paging&&this.OnePage&4&&!this.AllPages?this.GetFPage():null; if(this.Sorting&&this.Sorted&&this.W){ if(SG)this.Vv(SG); else{ this.DoSort(); for(var Au=this.XB.firstChild;Au;Au=Au.nextSibling)this.HX(Au);}} else{ if((this.Paging==1||this.Paging==2)&&!SG)this.CreatePages(); if(this.ChildPaging)this.LP(this.XB);}; if(this.FRow&&(!this.FRow.parentNode||!this.FRow.parentNode.tagName))this.FRow=null; if(this.SB)this.SB(1); this.SetVPos(); this.SL(0,1); this.SC(0); if(this.Gantt)this.Iw(0); if(this.VZ()){this.Render();return false;} else{ if(this.Paging==2||this.Paging==1&&!this.AllPages)this.SN(); else this.UpdateBody(); return true;}}; _7h.prototype.VZ=function(){ this.Clear(0); this.Rendering=1; var AJ=new Array(),Au=0; for(var i=0;i<this.Z;i++){ var F6=this.GroupCols[i]; if(F6!=this.MainCol&&this.Cols[F6].CanGroup!=2)AJ[Au++]=this.GroupCols[i];} var VY=this.ChangeColsVisibility?this.ChangeColsVisibility(this._7Aw,AJ,1):0; this.Vt(1); this._7Aw=null; this.Rendering=0; if(!VY){ this.VW();} return VY;}; _7h.prototype.Vt=function(refresh){ for(var F6 in this.Cols){ var C=this.Cols[F6]; if(C.Vw){ if(C.Visible&&refresh)this.SetWidth(F6,C.Vw-C.Width,0,1); else C.Width=C.Vw; C.Vw=null;}} var Lf=this.Cols[this.MainCol]; if(Lf&&Lf.GroupWidth){ Lf.Vw=Lf.Width; if(Lf.Visible&&refresh)this.SetWidth(this.MainCol,Lf.GroupWidth-Lf.Width,0,1); else Lf.Width=Lf.GroupWidth;}}; _7h.prototype.Vr=function(row,F6,type,AS,Vx,Vy){ if(!this.Cols[F6]){ alert("Unknown grouping column "+F6);return;} this.W=1; this.SortCols=[F6]; this.SortTypes=[type&14]; if(!row){ if(!Vy){ var Kg=this.Sorted;this.Sorted=true;this.Vz=2; this.DoSort(0,1); this.Vz=null;this.Sorted=Kg;} row=this.XB.firstChild;} else{ var V0=row.MaxChildren; row.MaxChildren=1e10; this.Vv(row,0,1); row.MaxChildren=V0;}; if(!AS)AS=this.Def["Group"]; var QU="@Start#",Em=0,Cc,C=this.Cols[F6],Dh,V1=AS[F6+"MaxChars"]; var M=this.MainCol,GK=M+"Type",V2=M+"Format",ME=M+"Enum",V3=M+"IntFormat",V4=M+"Visible",V5=M+"Related",V6=M+"Refresh",V7=M+"Range",V8=M+"CanEdit"; var Q7=F6+"Type",G3=F6+"Format",BN=F6+"Enum",Vg=F6+"IntFormat",PQ=F6+"Visible",V9=F6+"Related",WA=F6+"Refresh",WB=F6+"Range"; var AP=row.firstChild; var WC=AS.ParentCDef!=null,La=row.CDef,WD=1,WE=AS.ParentAcceptDef!=null,Lb=row.AcceptDef; var GP=row.Page?this.Root:row; while(AP){ if(AP.Def&&AP.Def.Group||!Is(AP,"CanGroup")){ this.Vr(AP,F6,type,AS,Vx); AP=AP.nextSibling;} else if(AP.Deleted&&(!this.ShowDeleted||this.GroupTypes&128)){ AP=AP.nextSibling;} else{ if(WC){ GP.CDef=AS.ParentCDef; WC=0;} if(WE){ GP.AcceptDef=AS.ParentAcceptDef; WE=0;} if(WD){ var Es=Get(GP,F6+"NumberSort"); GP[M+"NumberSort"]=Es==null?C.Type=="Int"||C.Type=="Float"||C.Type=="Date":Es; WD=0;} var Bb=Get(AP,F6+"SortValue"); if(Bb==null)Bb=this.GetString(AP,F6,2); if(Grids.OnGetSortValue)Bb=Grids.OnGetSortValue(this,AP,F6,Bb,0,1); var Es=AP.nextSibling; if(C.CharCodes)Bb=this.UseCharCodes(Bb,F6); if(type&6)Bb=type&2?Bb.toLocaleLowerCase():Bb.toLowerCase(); if(type&8)Bb=Bb.replace(this.Cols[F6].WhiteChars,""); if(type&16&&!Bb&&Bb!=0||type&64&&Bb==0){AP=Es;continue;} if(V1)Bb=(Bb+"").slice(0,V1); if(QU!=Bb){ Em++; Cc=_7i.createElement("I"); row.insertBefore(Cc,AP); Cc.Def=AS; Cc.CDef=La; Cc.AcceptDef=Lb; Cc.Kind=AS.Kind; Cc.Expanded=AS.Expanded?1:0; Cc.Spanned=AS.Spanned?1:0; Cc.Calculated=AS.Calculated?1:0; Cc.Level=row.Level+1; Cc.State=4; Cc.Visible=1; if(V1){ Cc[M]=Bb; Cc[V8]=0;} else Cc[M]=Get(AP,F6); Dh=Get(AP,Q7); if(Dh==null)Dh=C.Type; if(Dh!=null)Cc[GK]=Dh; Dh=Get(AP,G3); if(Dh==null)Dh=C.Format; if(Dh!=null)Cc[V2]=Dh; Dh=Get(AP,BN); if(Dh==null)Dh=C.Enum; if(Dh!=null)Cc[ME]=Dh; Dh=Get(AP,Vg); if(Dh==null)Dh=C.WF; if(Dh!=null)Cc[V3]=Dh; Dh=Get(AP,WB); if(Dh!=null)Cc[V7]=Dh; Dh=Get(AP,WA); if(Dh==null)Dh=C.Refresh; if(Dh!=null)Cc[V6]=Dh; Dh=Get(AP,V9); if(Dh==null)Dh=C.Related; if(Dh){ var WG=Dh.split(","); var WH=this.Gw(AP,WG[0],"Enum"),WI=WH.length,WJ=WG.length; for(var i=0;i<WJ;i++)Cc[WG[i]]=Get(AP,WG[i]); if(WJ==1){ for(var i=0;i<WI;i++){ var WK=Get(AP,BN+i); if(!WK)WK=C["Enum"+i]; if(WK)Cc[ME+i]=WK;}} else if(WJ==2){ var WL=this.Cols[WG[1]]; for(var i=0;i<WI;i++){ var WM=Get(AP,BN+i); if(!WM)WM=WL["Enum"+i]; if(!WM)continue; var WN=WM.length,WO=BN+i+"_",WP="Enum"+i+"_",WQ=ME+i+"_"; for(var j=0;j<WN;j++){ var WK=Get(AP,WO+j); if(!WK)WK=C[WP+j]; if(WK)Cc[WQ+j]=WK;}}} Cc[V5]=Dh;} if(Vx){ for(var i=0;i<Vx.length;i++){ var BD=Vx[i]; if(BD=="Main"||BD=="MainCol"){ Cc[M+"CopyTo"]="Children,"+F6; Cc[M+"CanEdit"]=1; Cc[F6]=AP[F6];} else{ Cc[BD+"CopyTo"]="Children,"+BD; Cc[BD+"CanEdit"]=1; Cc[BD]=AP[BD];}} Cc._7A1=1;} Cc[V4]=1; QU=Bb;} Cc.appendChild(AP); AP.Level=Cc.Level+1; AP=Es;}} if(Cc&&type&32&&Em==1){ while(Cc.firstChild)row.insertBefore(Cc.firstChild,Cc); row.removeChild(Cc);}}; _7h.prototype.VT=function(Vo,AT){ var Vc=this.GroupCols; if(!Vc||Vc.length==0||!this.Grouping)return; if(!this.Grouped){ if(AT)AT(true); return;} this.VS(); this.Clear(0); this.WR(); this.Z=0; this.GroupCols=new Array(); this.GroupTypes=new Array(); if(Vo)return; if(AT){ var DG=this.VX(); if(typeof(AT)=="function")AT(DG);} else this.VX();}; _7h.prototype.WR=function(){ var AP=this.GetFirst(),Es; while(AP){ Es=this.GetNext(AP); if(AP.Def&&AP.Def.Group){ var GP=AP.parentNode; while(AP.firstChild)GP.insertBefore(AP.firstChild,AP); GP.removeChild(AP);} AP=Es;}}; _7h.prototype.WS=function(CE,type){ var F6=CE?this.FCol:this.ACol; if(!F6||!this.Cols[F6]||!this.Cols[F6].CanGroup)return false; for(var i=0;i<this.Z;i++)if(this.GroupCols[i]==F6)return false; var Cols=CopyObject(this.GroupCols),VP=CopyObject(this.GroupTypes); if(type==0){Cols.unshift(F6);VP.unshift(this.Cols[F6].GroupType);} else if(type==1){Cols[this.Z]=F6;VP[this.Z]=this.Cols[F6].GroupType;} this.GroupRows(Cols,VP); return true;}; _7h.prototype.ActionGroupBy=function(CE){return this.WS(CE,0);}; _7h.prototype.ActionGroupByLast=function(CE){return this.WS(CE,1);}; _7h.prototype.ActionUngroupBy=function(CE){ var F6=CE?this.FCol:this.ACol; if(!F6||!this.Cols[F6]||!this.Cols[F6].CanGroup)return false; var Cols=new Array(),VP=new Array(); for(var i=0;i<this.Z;i++){ if(this.GroupCols[i]==F6)break; Cols[i]=this.GroupCols[i]; VP[i]=this.GroupTypes[i];} if(i==this.Z)return false; for(i++;i<this.Z;i++){ Cols[i-1]=this.GroupCols[i]; VP[i-1]=this.GroupTypes[i];} this.GroupRows(Cols,VP); return true;}; _7h.prototype.ActionGroupOff=function(){ if(!this.Grouping||!this.Grouped)return false; if(this.RowCount<this.SynchroCount&&!this.Paging)this.WT(); else{this.ShowMessage(this.GetText("Group"));var T=this;setTimeout(function(){T.WT();},10);}; return true;}; _7h.prototype.WT=function(){ if(!this.Grouping||!this.Grouped)return false; var VQ=this.Paging==3&&(!(this.OnePage&4)||this.AllPages); if(VQ){ this.Grouped=false; for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Kind=="Group")this.SV(AP); this.SaveCfg(); this.ReloadBody(null,false,"Group"); return true;} if(this.Z){ this.VS(); this.Clear(0); this.WR(); var Kg=this.GroupCols;this.GroupCols=[];this.Z=0; this._7Aw=Kg; this.VX(); this.GroupCols=Kg;this.Z=Kg.length;} this.Grouped=false; for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Kind=="Group")this.SV(AP); this.SaveCfg(); return true;}; _7h.prototype.ActionGroupOn=function(){ if(!this.Grouping||this.Grouped)return false; if(this.RowCount<this.SynchroCount&&!this.Paging)this.WU(); else{this.ShowMessage(this.GetText("Group"));var T=this;setTimeout(function(){T.WU();},10);}; return true;}; _7h.prototype.WU=function(){ if(!this.Grouping||this.Grouped)return false; this.Grouped=true; var VQ=this.Paging==3&&(!(this.OnePage&4)||this.AllPages); if(VQ){ for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Kind=="Group")this.SV(AP); this.SaveCfg(); this.ReloadBody(null,false,"Group"); return true;} if(this.Z){ this.VV(); this.GroupAll();} for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Kind=="Group")this.SV(AP); this.SaveCfg(); return true;}; _7h.prototype.VW=function(Hj,WV){ var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++)if(CE[i].Kind=="Header"){this.RefreshRow(CE[i]);this.UpdateRowHeight(CE[i]);}}; _7h.prototype.ActionColResize=function(){ var AS=Grids.Bc;if(!AS)return false; var F6=this.WW(AS.Col,AS.RZ),C=this.Cols[F6]; if(!F6)return false; if(F6=="Pager"){if(!this.Pager.CanResize)return true;} else if(!this.ColResizing||!C.CanResize)return true; AS.WX=F6; this.CloseDialog(); if(F6=="Pager"||this.Paging&&this.AllPages||this.RowCount>this.SynchroCount){ this.S4(AS.X,AS.Y,F6=="Pager"); AS.In=false;} else AS.In=true; AS.Action="ColResize"; AS.Move=this.WY; AS.Pz=this.WZ; this.ND("e-resize"); return true;}; _7h.prototype.WY=function(){ var AS=Grids.Bc;if(!AS)return false; var F6=AS.WX,C=this.Cols[F6],Ca=AS.QC-AS.X; if(F6&&F6!="Pager"){ if(C.RelWidth){C.Ja=C.RelWidth;C.RelWidth=null;} if(C.Sec!=1){ if((this.L[0]?this.L[0].offsetWidth:0)+(this.L[2]?this.L[2].offsetWidth:0)+(this.Rtl?-Ca:Ca)+_7Z+40>this.MainTag.offsetWidth)return false;}} if(AS.In)this.SetWidth(F6,this.Rtl?-Ca:Ca); else if(F6&&F6!="Pager"&&C.JZ)C.JZ=false; if(AS.In)AS.X+=Ca; else AS.I=Ca; if(AS.Col&&AS.Col!="Pager"&&(C.RelWidth||C.JZ)){this.WZ();Grids.Bc=null;} return true;}; _7h.prototype.WZ=function(){ var AS=Grids.Bc;if(!AS)return false; var F6=AS.WX,C=this.Cols[F6]; var Ca=AS.In?0:AS.QC-AS.X; if(F6=="Pager"){ this.Pager.Width+=Ca; if(this.Pager.Width<=10)this.Pager.Width=10; this.Kc(); this.Qv.style.width=this.Pager.Width+"px"; this.SaveCfg(); this.Update();} else{ if(this.RowCount<this.SynchroCount){ Grids.Bc=null; this.Wa(F6,Ca,AS.Col);} else{ this.ShowMessage(this.GetText("ColWidth")+" '"+this.GetCaption(F6)+"'"); status=this.GetText("ColWidth"); var T=this;setTimeout(function(){T.Wa(F6,Ca,AS.Col);},10);}; this.Cd=(new Date).getTime()+100;}; return true;}; _7h.prototype.Wa=function(F6,Ca,Wb){ this.SetWidth(F6,Ca); this.SaveCfg(); this.HideMessage(); this.VW(); status="";}; _7h.prototype.WW=function(F6,x){ var Ca=this.Mouse.EdgeSize; var C=this.Cols; if(F6=="Pager"){ x-=this.Rtl?Ca:this.Pager.Width; if(x>=-Ca&&x<0&&this.Pager.CanResize)return F6; return null;} if(x<Ca){ if(!F6||F6=="Panel")return null; if(!this.Rtl)F6=this.GetPrevCol(F6);} else{ if(F6&&C[F6].Sec==1&&C[F6].Width>=this.L[1].offsetWidth){ x+=this.GetScrollLeft();} while(F6&&x>C[F6].Width){x-=C[F6].Width;F6=this.GetNextCol(F6);} if(!F6||C[F6].Width-x>=Ca)return null;}; if(!F6||!C[F6].CanResize)return null; return F6;}; _7h.prototype.ActionDropColMove=function(){ var AS=Grids.Bc;if(!AS)return false; var F6=AS.Col,C=this.Cols[F6]; if(this.EditMode&&this.EndEdit(this.FRow,this.FCol,1)==-1)return false; var row=AS.Row,Wc=AS.Col; var BJ=this.GetCell(row,F6).firstChild.firstChild.rows[0].cells,H6; for(var i=1;i<BJ.length;i++)if(AS.RZ<BJ[i].offsetLeft){AO=i-1;break;} if(i==BJ.length)AO=i-1; var Bb=row[Wc];if(!Bb)return false; Bb=(Bb+"").split(','); if(AO<0||AO>=Bb.length)return false; AS.Wd=Bb[AO]; AS.Pos=AO; if(_7N){ var Ia=this.We(AS.Row,AS.Col,AO); if(Ia)Ia.innerHTML=Ia.innerHTML;} BJ[AO].className+=" "+this.Img.Style+"HeaderGroupFocus"; var Aj="<div onmousemove='"+this.K+".GridMouseMove(event);' class='"+this.Img.Style+"HeaderDrag "+this.Img.Style+"HeaderText' style='width:"+BJ[AO].offsetWidth+"px'>"+BJ[AO].innerHTML+"</div>"; var Br={clientX:AS.X,clientY:AS.Y}; this.P5(BJ[AO],Br,3,Aj); AS.Action="DropColMove"; AS.Move=this.Wf; AS.Pz=this.Wg; return true;}; _7h.prototype.ActionColMove=function(){ var AS=Grids.Bc;if(!AS)return false; var F6=AS.Col,C=this.Cols[F6]; if(this.EditMode&&this.EndEdit(this.FRow,this.FCol,1)==-1)return false; if(F6=="Pager"||!this.ColMoving||C.CanMove==0||!C.Visible)return false; var H6=this.GetCell(this.ARow,F6);H6.className+=" "+this.Img.Style+"HeaderFocus"; if(C.WidthPad&&H6.colSpan<2)H6.nextSibling.className+=" "+this.Img.Style+"HeaderFocus"; var Wh="",Em=0; if(!this.Wi){ this["ZARow"]=this.ARow; Wh=this.K+".ARow="+this.K+".ZARow;";} AS.Span=this.ARow.Spanned?Get(this.ARow,AS.Col+"Span"):0; var HR=AS.Span; if((C.Wj||HR>1)&&(!this.Wi||!C.CanGroup)){ var Aj=_7A+" onmousemove='"+Wh+this.K+".GridMouseMove(event);'"+_7B+"<tr>",Fu=this.Cols[F6].Group; for(var BD=F6;BD&&(Fu&&Fu==this.Cols[BD].Group||HR>0);BD=this.GetNextCol(BD),HR--){ Em++; Aj+="<td><div class='"+this.Img.Style+"HeaderDrag "+this.Img.Style+"HeaderText' style='width:"+C.Width+"px'>"+this.KY(AS.Row,0,0,0,3,BD)+"</div></td>";} Aj+="</tr>"+_7C;} else{Aj="<div onmousemove='"+Wh+this.K+".GridMouseMove(event);' class='"+this.Img.Style+"HeaderDrag "+this.Img.Style+"HeaderText' style='width:"+C.Width+"px'>"+this.KY(AS.Row,0,0,0,3,F6)+"</div>";Em=1;}; if(C.Sec==1){ var Jf=this.ColNames[1]; for(var i=0;i<Jf.length;i++)if(this.Cols[Jf[i]].Visible)Em--; if(!Em)return false;} if(F6)this.ND(Aj?this.Img.DragMore:this.Img.DragOne); var Br={clientX:AS.X,clientY:AS.Y}; this.P5(H6,Br,this.Wi?3:1,Aj); AS.Action="ColMove"; AS.Move=this.Wf; AS.Pz=this.Wg; return true;}; _7h.prototype.Wf=function(){ var AS=Grids.Bc;if(!AS)return false; var C=this.Cols,Wk=this.ARow,Kk=this.ACol; if(this.Wi){ if(Wk&&Wk.Space&&Wk[Kk+"Type"]=="DropCols"&&C[AS.Wd?AS.Wd:AS.Col].CanGroup&&this.Event.Special){ var Ko=this.Event.Special.replace("DropCol","")-1; var Bb=Wk[Kk],F6=AS.Wd?AS.Wd:AS.Col; if(Bb&&Ko>=0){ Bb=(Bb+"").split(','); if(F6==Bb[Ko]||F6==Bb[Ko-1])Ko=-1;} if(Ko>=0)this.Wl(Wk,Kk,0,null,Ko); else this.Wm(); if(AS.Wd){var H6=this.We(AS.Row,AS.Col,AS.Pos);H6.className=H6.className.replace(/Group\w+/,"GroupFocus");} AS.Wn=Ko; AS.Rb=Kk; AS.QA=Wk; return true;} if(AS.Wd){ var H6=this.We(AS.Row,AS.Col,AS.Pos);H6.className=H6.className.replace(/Group\w+/,"GroupDelete"); this.Wm(); AS.QA=null; AS.Wn=-1; return true;} if(!Wk||Wk.Kind!="Header"){ this.Wm(); AS.QA=null; return true;}} if(!Kk||!C[Kk]||!C[Kk].CanMove){ this.Wm(); AS.QA=null; return true;} var x=this.Event.X; if(!Wk||Wk.Kind!="Header"){ var Br={clientX:AS.QC,clientY:AS.QD}; var E=this.Ql(Br,AS.Row);  Kk=E.Col;x=E.X; if(!Kk){this.Wm();AS.QA=null;return true;}} this.S5(Kk,x); var Hj=C[Kk].Sec,Fa=this.GetSections(),Jf=this.ColNames[1],Wo=0,type=0,A5=C[Kk].Width/2; if(Wk&&Wk.Kind=="Header"&&Wk.Spanned&&Get(Wk,Kk+"Span")>1)A5=this.GetCell(Wk,Kk).offsetWidth/2; if(x>A5)type=1; var G=C[AS.Col].Group,BD=type==1?this.GetNextCol(Kk):this.GetPrevCol(Kk),Vc=BD&&BD!=AS.Col?C[BD].Group:0,Wd=C[Kk].Group; if(Hj!=C[AS.Col].Sec&&(C[AS.Col].CanMove!=2||G&&!C[AS.Col].Wj)||BD==AS.Col&&Hj==C[AS.Col].Sec||Kk==AS.Col&&(C[Kk].CanMove!=2||Hj!=1||type==0&&(Jf[0]!=Kk||Fa[0]!=1&&BD!="Panel")||type==1&&(Jf[Jf.length-1]!=Kk||Fa[1]!=2))){ this.Wm(); AS.QA=null; return true;} if(C[AS.Col].Wj){ if((Vc==G||Wd==G)&&AS.Col!=Kk){ if(C[Kk].CanMove!=2||type!=1||C[Jf[Jf.length-1]].Group!=G||Fa[1]!=2){ this.Wm();AS.QA=null;return true;} Wo=1;} G=0;} if(G){ if(type==0&&Vc!=G||type==1&&Wd!=G){ this.Wm();AS.QA=null;return true;}} else{ if(Vc&&Vc==Wd){ this.Wm();AS.QA=null;return true;}}; AS.Wp=type; AS.Rb=Kk; AS.QA=Wk; var row=Wk&&Wk.Kind=="Header"?Wk:(this.Wi?null:AS.Row); if(row)this.Wl(row,Kk,type,Hj!=C[AS.Col].Sec||Kk==AS.Col||Wo); else this.Wm(); this.ND(this.Img.DragOne); return true;}; _7h.prototype.Wg=function(){ var AS=Grids.Bc;if(!AS)return false; var C=this.Cols; this.Wm(); this.RH=null; this["ZARow"]=null; if(AS.QA||AS.Wn==-1){ this.CloseDialog(); if(AS.Wn!=null&&(AS.Wn==-1||AS.QA.Kind!="Header")){ var T=this; function Wq(row,F6,Bb){ if(Grids.OnValueChanged)Bb=Grids.OnValueChanged(T,row,F6,Bb); if(T.SetValue(row,F6,Bb,1)&&Grids.OnAfterValueChanged)Grids.OnAfterValueChanged(T,row,F6); T.Il(row);}; if(AS.Wd&&AS.Row!=AS.QA){ var Bb=AS.Row[AS.Col]; Bb=Bb?(Bb+"").split(','):new Array(); var Cols=new Array(),k=0; for(var i=0;i<Bb.length;i++)if(i!=AS.Pos)Cols[k++]=Bb[i]; Wq(AS.Row,AS.Col,Cols.join(',')); if(AS.QA){ Bb=AS.QA[AS.Rb]; Bb=Bb?(Bb+"").split(','):new Array(); Cols=new Array();k=0; for(var i=0;i<Bb.length;i++){ if(i==AS.Wn)Cols[k++]=AS.Wd; Cols[k++]=Bb[i];} if(i==AS.Wn)Cols[k++]=AS.Wd; Wq(AS.QA,AS.Rb,Cols.join(','));}} else if(AS.Wn>=0){ var Bb=AS.QA[AS.Rb]; Bb=Bb?(Bb+"").split(','):new Array(); var Cols=new Array(),k=0; for(var i=0;i<AS.Wn;i++)if(i!=AS.Pos)Cols[k++]=Bb[i]; Cols[k++]=AS.Wd?AS.Wd:AS.Col; for(var i=AS.Wn;i<Bb.length;i++)if(i!=AS.Pos)Cols[k++]=Bb[i]; Wq(AS.QA,AS.Rb,Cols.join(','));}} else{ if(AS.Wp==1&&AS.QA.Kind=="Header"&&AS.QA.Spanned&&Get(AS.QA,AS.Rb+"Span")>1){ var Fa=this.GetNextCol(AS.Rb,AS.QA); if(Fa&&C[Fa].Sec==C[AS.Rb].Sec){AS.Rb=Fa;AS.Wp=0;} else AS.Rb=this.GetLastCol(C[AS.Rb].Sec); } if(C[AS.Col].Wj||AS.Span>1){ var BD=this.GetNextCol(AS.Col),LE=AS.Col,Fu=C[AS.Col].Group,HR=AS.Span; this.MoveCol(AS.Col,AS.Rb,AS.Wp,1); while(BD&&(Fu&&Fu==C[BD].Group||HR>1)){ var D9=this.GetNextCol(BD); this.MoveCol(BD,LE,1,1,1); LE=BD;BD=D9; HR--;} this.SaveCfg(); this.Render(); this.GridMouseOver(); if(Grids.OnColMove)Grids.OnColMove(this,AS.Col); return;} this.MoveCol(AS.Col,AS.Rb,AS.Wp); this.SaveCfg(); if(Grids.OnColMove)Grids.OnColMove(this,AS.Col);}; if(_7r!=1){var CZ=AS.Row;setTimeout(function(){_7AO(CZ.r1);},10);} this.GridMouseOver();} this.RefreshCell(AS.Row,AS.Col);if(AS.Wd)this.Il(AS.Row); this.Update(); this.Cd=(new Date).getTime()+100; return true;}; _7h.prototype.Wl=function(row,F6,right,Eu,AO){ if(!this.Wr){ this.Wr={Top:this.MG("DragColInsideTop",1),Bottom:this.MG("DragColInsideBottom",1)}} var E=this.IC(row,F6); if(AO!=null){ var H6=this.We(row,F6,AO); E.IQ+=H6.offsetLeft; E.Width=H6.offsetWidth;} var top=this.Wr.Top,Ws=this.Wr.Bottom; top.style.top=(E.IR-top.offsetHeight)+"px"; top.style.left=(E.IQ+(right?E.Width:0)-Math.floor(top.offsetWidth/2))+"px"; top.className=this.Img.Style+(Eu?"DragColOutsideTop":"DragColInsideTop"); Ws.style.top=(E.IR+E.Height)+"px"; Ws.style.left=top.style.left; Ws.className=this.Img.Style+(Eu?"DragColOutsideBottom":"DragColInsideBottom");}; _7h.prototype.Wm=function(){ if(!this.Wr)return; document.body.removeChild(this.Wr.Top); document.body.removeChild(this.Wr.Bottom); this.Wr=null;}; _7h.prototype.We=function(row,F6,AO){ var BJ=this.GetCell(row,F6,1).firstChild.firstChild.rows[0].cells; return BJ[AO];}; _7h.prototype.ActionGridResize=function(){ var AS=Grids.Bc,AI=this.Img;if(!AS)return false; this.CloseDialog(); if(this.ResizingMain&2){ AS.Width=this.HW.offsetWidth+(_7Q?AI.Ly:0);} if(this.ResizingMain&1){ AS.Height=this.HW.offsetHeight+(_7Q?AI.Wt:0);} AS.Wu=new Object(); var M=["Top","Bottom","Left","Right"],S=["Color","Style","Width"]; for(var i=0;i<4;i++)for(var j=0;j<3;j++){var B3="border"+M[i]+S[j];AS.Wu[B3]=this.MainTag.style[B3];} AS.MinWidth=AS.Width-(this.N[1].offsetWidth?this.N[1].offsetWidth:this.L[1].offsetWidth)+AI.Wv+25+_7Z+AI.Ww; if(AS.MinWidth<this.MinTagWidth)AS.MinWidth=this.MinTagWidth; if(AS.MinWidth<this.MinWidth)AS.MinWidth=this.MinWidth; AS.MaxWidth=this.MaxTagWidth; AS.MinHeight=AS.Height-this.N[1].offsetHeight+AI.Wx+this.Hu+_7a+AI.Wy; var CE=this.GetFixedRows(); for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)CE[CE.length]=AP; for(var i=0;i<CE.length;i++)if(CE[i].RelHeight&&CE[i].r1)AS.MinHeight-=CE[i].r1.offsetHeight-(CE[i].MinHeight?CE[i].MinHeight:0); if(AS.MinHeight<this.MinTagHeight)AS.MinHeight=this.MinTagHeight; if(AS.MinHeight<this.MinHeight)AS.MinHeight=this.MinHeight; AS.MaxHeight=this.MaxTagHeight; AS.Height+=AI.L0+AI.L2; this.Rendering=1; this.Cw=1; if(!(this.ResizingMain&4)){ AS.Wz=this.HW.nextSibling; this.HW.parentNode.removeChild(this.HW); AS.Hidden=true; this.MC(this.KC);} this.MainTag.style.border="1px dashed black"; AS.Action="GridResize"; AS.Move=this.W0; AS.Pz=this.W1; return true;}; _7h.prototype.W0=function(){ var AS=Grids.Bc;if(!AS)return false; if(this.ResizingMain&2){ var A5=AS.Width+(this.Rtl?AS.X-AS.QC:AS.QC-AS.X); if(A5<AS.MinWidth){AS.X=AS.QC-A5+AS.MinWidth;A5=AS.MinWidth;} else if(A5>AS.MaxWidth){AS.X=AS.QC-A5+AS.MaxWidth;A5=AS.MaxWidth;} else AS.X=AS.QC; this.MainTag.style.width=A5+"px"; AS.Width=A5;} if(this.ResizingMain&1){ var CS=AS.Height-AS.Y+AS.QD; if(_7R)this.Refresh(); if(CS<AS.MinHeight){AS.Y=AS.QD-CS+AS.MinHeight;CS=AS.MinHeight;} else if(CS>AS.MaxHeight){AS.Y=AS.QD-CS+AS.MaxHeight;CS=AS.MaxHeight;} else AS.Y=AS.QD; this.MainTag.style.height=CS+"px"; AS.Height=CS;} return true;}; _7h.prototype.W1=function(){ var AS=Grids.Bc;if(!AS)return false; for(var i in AS.Wu)this.MainTag.style[i]=AS.Wu[i]; if(AS.Hidden){ if(AS.Wz)this.MainTag.insertBefore(this.HW,AS.Wz); else this.MainTag.appendChild(this.HW); this.MF(this.KC);} this.HW.style.display=""; Grids.W2=null; this.Rendering=0; this.Cw=0; this.Update(); this.Mv(); this.SaveCfg(); if(Grids.OnResizeMain)Grids.OnResizeMain(this); return true;}; _7h.prototype.ActionGridResizeDefault=function(){ this.MainTag.style.width=this.W3; this.MainTag.style.height=this.W4; this.SaveCfg(); if(Grids.OnResizeMain)Grids.OnResizeMain(this);}; _7h.prototype.Rm=function(Cv){ var row=this.Event.Row; if(!row||Grids.Bc)return; if(!this.StandardTitle){ this.HideTip(); this.RJ=Cv; this.RK=0; return;} if(row.Space){row.r1.title=Cv;return;} var C=this.Cols[this.Event.Col]; if(C)row["r"+C.Sec].title=Cv;}; _7h.prototype.HideTip=function(){HideTip();}; _7h.prototype.ActionShowHint=function(){ this.ShowHint(this.ARow,this.ACol);}; _7h.prototype.HideHint=function(Br,Ta,W5,Tc,W6){ if(!this.Rl)return; if(Br){ var AJ=EventXYToElement(Br,this.Rl); if(AJ[0]>=Ta&&AJ[0]<=Tc&&AJ[1]>=W5&&AJ[1]<=W6+3)return;} document.body.removeChild(this.Rl.previousSibling); document.body.removeChild(this.Rl); this.Rl=null;}; _7h.prototype.ShowHint=function(row,F6){ if(!row||!F6)return; var Fa=this.QJ(row,F6);if(!Fa)return; var Bg=this.GetType(row,Fa); if(Bg=="Radio"||Bg=="Gantt"||Bg=="Abs"||this.Gw(row,Fa,"ShowHint")=="0"||Get(row,"ShowHint")=="0")return; var H6=this.GetCell(row,F6); if(!H6)return; var G3=H6.firstChild; if(!G3||G3.nodeType!=1||!this.HG(row,F6))G3=H6; var A5=H6.offsetWidth,CS=H6.offsetHeight,CJ=G3.scrollWidth,N2=G3.scrollHeight,Jm=G3.clientWidth,BC=G3.clientHeight; if((_7N||_7F||_7G)&&CJ==A5){ var AS=this.W7; if(!AS){ var AS=document.createElement("div"),B3=AS.style; B3.position="absolute";B3.left="0px";B3.top="0px";B3.visibility="hidden"; B3.overflow="hidden";B3.border="none";B3.padding="0px"; B2(AS); this.W7=AS;} AS.style.width=A5+"px"; AS.className=H6.className; AS.innerHTML=H6.innerHTML; CJ=AS.scrollWidth; G3=AS;} if(A5+3>=CJ&&CS+2>=N2)return; this.HideHint(); var AJ=[];this.KY(row,AJ,null,null,1,Fa); if(Grids.OnHint)AJ[0]=Grids.OnHint(this,row,Fa,AJ[0]); if(!AJ[0])return; var CA=document.createElement("div"); CA.className=this.Img.Style+"HintMain"; CA.innerHTML="<div class='"+AJ[1]+" "+this.Img.Style+"HintOuter'>"+AJ[0]+"</div>"; AJ=this.IC(row,F6); if(F6==this.MainCol&&!row.Fixed){ var left=0,FX=row.Level;if(this.HideRootTree)FX--; if(FX>=0)left+=this.Img.Tree; if(FX>0)left+=FX*this.Img.Line; AJ.IQ+=left;AJ.Width-=left;} var AN=this.Gw(row,F6,"ButtonPos"),W8=0; if(AN=="0"){ W8=this.Img[this.Gw(row,F6,"Button")+(row.Space?"Space":"")+"Left"]; W8-=1; AJ.IQ+=W8;AJ.Width-=W8;} var NL=GetWindowSize(),W9=NL[0]-AJ.IQ-5,XA=NL[1]-AJ.IR-5; CA.style.left="0px";CA.style.top="0px";CA.style.maxWidth=(NL[0]-5)+"px"; B2(CA); var CE=CA.firstChild,OC=CE.firstChild; if(OC&&OC.nodeType==1){OC.style.overflow="visible";OC.style.maxHeight="";} if(W8){ B3=GetStyle(CE); var Au=parseInt(B3.paddingLeft); if(Au&&Au>W8)Au-=W8; else Au=0; CE.style.paddingLeft=Au+"px"; if(_7Q)CJ-=W8;} if(!_7Q){ var B3=GetStyle(G3); CJ-=_7AH(B3); if(_7K){ var LT=parseInt(B3.paddingRight); if(LT)CJ+=LT;}} else if(H6!=G3)CJ+=_7AH(GetStyle(H6)); CA.style.overflow="hidden"; CE.style.width=CJ+"px"; var Cn=CA.offsetWidth,CZ=CA.offsetHeight; if(Cn<AJ.Width)Cn=AJ.Width; if(Cn>W9)Cn=W9; if(Cn!=CA.offsetWidth){ CE.style.width=Cn+"px"; if(!_7Q&&CE.offsetWidth>Cn)CE.style.width=(Cn*2-CE.offsetWidth)+"px";} if(CZ<AJ.Height)CZ=AJ.Height; if(CZ>XA)CZ=XA; if(CZ!=CA.offsetHeight){ CE.style.height=CZ+"px"; if(!_7Q&&CE.offsetHeight>CZ)CE.style.height=(CZ*2-CE.offsetHeight)+"px";} CA.style.left=AJ.IQ+"px";CA.style.top=AJ.IR+"px";CA.style.visibility="";CA.style.overflow=""; this.MI({C:CA}); this.Rl=CA; var Cp=document.createElement("div"); Cp.className=this.Img.Style+"HintShadow"; Cp.style.left=CA.style.left; Cp.style.top=CA.style.top; Cp.style.height=CA.firstChild.offsetHeight+"px"; Cp.style.width=CA.firstChild.offsetWidth+"px"; CA.parentNode.insertBefore(Cp,CA);}; _7h.prototype.GetRow=function(row,Hj){ return row["r"+Hj];}; _7h.prototype.GetRowChildren=function(row,Hj){ if(!row._7AZ)return null; var AP=row["r"+Hj]; if(!AP)return null; return AP.nextSibling;}; _7h.prototype.GetCell=function(row,F6){ if(!row||!F6)return null; if(F6=="Pager"&&(!row||!row.Space))return this.NE; if(row.Space){ var AP=row.r1; if(!AP)return null; return AP.firstChild.rows[0].cells[row[F6+"Pos"]+(_7P?1:0)];} var C=this.Cols[F6]; if(!C)return null; var AP=row["r"+C.Sec]; if(!AP)return null; if(row.Page)return AP; if(row.G4)return this.XC(row,F6); var AO=C.KK; if(AO<0){ if(!row.Spanned)return null; var HR=Get(row,F6+"Span"); if(!(HR>1))return null; var S=this.ColNames[C.Sec]; for(var i=0;i<S.length&&F6!=S[i];i++); for(i++;i<S.length&&HR>1;i++,HR--){ AO=this.Cols[S[i]].KK; if(AO>=0)break;} if(AO<0)return null;} if(row.Fixed){ var M=this.Cols[this.MainCol]; if(M&&M.Sec==C.Sec&&M.KK>=0&&M.KK<=C.KK)AO--;} for(var i=0,Au=0;Au<AO;Au+=AP.cells[i++].colSpan); return AP.cells[i];}; _7h.prototype.A9=function(Hj){ var AN=this.N[Hj].firstChild; if(_7G&&AN)AN=AN.firstChild; return AN;}; _7h.prototype.NP=function(id){ var AI=GetElem(id); if(AI){ var CA=AI.tagName.toLowerCase(); if(CA=="input"||CA=="textarea")return AI;} var AJ=document.getElementsByName(id); var V2=this.Nh(this.HW); var V3=null; for(var i=0;i<AJ.length;i++){ AI=AJ[i]; var CA=AI.tagName.toLowerCase(); if(CA=="input"||CA=="textarea"){ var CE=this.Nh(CA); if(CE&&(CE==V2||!V2))return AI; V3=AI;}} return V3;}; _7h.prototype.Nh=function(CA){ if(!CA||!CA.tagName)return null; while(CA&&CA.tagName){ if(CA.tagName.toLowerCase()=="form")return CA; CA=CA.parentNode;}}; _7h.prototype.P5=function(object,Br,move,Aj){ if(!this.ShowDrag)return; this.Rc(); var M=new _7g; var H=document.createElement("div"); H.style.position="absolute"; if(object){ var AO=GO(Br,object); M.I=AO[0]-GetWindowScroll()[0]/_7r; M.J=AO[1]-GetWindowScroll()[1]/_7r; H.style.left=Math.floor((Br.clientX/(Br.type?_7r:1)-M.I))+"px"; H.style.top=Math.floor((Br.clientY/(Br.type?_7r:1)-M.J))+"px"; H.className=object.className;} else{ H.style.left=0;H.style.top=0;}; H.innerHTML=Aj?Aj:object.innerHTML; H.className=this.Img.Style+"MouseObject"; H.onmousemove=new Function("ev","CancelEvent(ev?ev:event)"); H.style.width="10px";H.style.height="10px"; B2(H); M.Tag=H; if(move>=0)M.Move=move; Grids.P6=M; M.J=-5-GetWindowScroll()[1]/_7r; this.MoveMouseObject(Br);}; _7h.prototype.MoveMouseObject=function(Br){ var M=Grids.P6,F8=null,Ak=null; if(M&&Br){ if(M.Move&1)F8=Math.floor(Br.clientX/(Br.type?_7r:1)-M.I); if(M.Move&2)Ak=Math.floor(Br.clientY/(Br.type?_7r:1)-M.J); var AJ=GetWindowSize(); if(F8!=null){ var A5=AJ[0]-F8-2; if(A5>=0)M.Tag.style.width=M.Tag.scrollWidth>A5?A5+"px":""; M.Tag.style.left=F8+"px";} if(Ak!=null){ var CS=AJ[1]-Ak-2; if(CS>=0)M.Tag.style.height=M.Tag.scrollHeight>CS?CS+"px":""; M.Tag.style.top=Ak+"px";}}}; _7h.prototype.Rc=function(){ var M=Grids.P6; if(M){ document.body.removeChild(M.Tag); Grids.P6=null;}}; _7h.prototype.S4=function(X,Y,XD,XE){ var AI=this.Img,CS=this.L[1].offsetHeight+AI.XG-this.L[1].offsetTop+this.N[1].offsetHeight+AI.XI+(this.O[1].offsetHeight?this.O[1].offsetHeight+AI.XJ:0); var Cb=this.IF+this.L[1].offsetTop; if(XD){ var XK=this.Qu.parentNode.parentNode.offsetHeight;if(XK)CS+=XK;} for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Visible&&AP.r1){ if(AP.Space>0&&AP.Space<4)CS+=AP.r1.offsetHeight; else if(AP.Space==0)Cb+=AP.r1.offsetHeight;} var Br={clientX:X,clientY:Y}; this.P5(null,Br,1,"<div style='"+(XE?"":"cursor:e-resize;")+"width:1px;height:"+CS+"px;border-left:1px solid;overflow:hidden;'>"+_7D+"</div>"); var M=Grids.P6; M.I=_7Q?document.body.clientLeft:(_7R?document.documentElement.clientLeft:0); M.I-=2+GetWindowScroll()[0]/_7r; M.Tag.style.left=X+"px"; M.Tag.style.top=Cb+"px";}; _7h.prototype.XL=function(row){ var P1=[[],[],[]],HU=this.GetSections(),page=row.Page; if(!page&&this.ChildPages)this.XM(row,P1[0],P1[1],P1[2]); else this.XN(row,P1[0],P1[1],P1[2]); for(var i=HU[0];i<HU[1];i++){ var AP=row["r"+i]; if(page){ AP.innerHTML=P1[i].join(""); AP.style.overflow=""; AP.style.height="";} else{ AP=AP.nextSibling; AP.style.height=""; AP.style.display=""; AP.firstChild.innerHTML=P1[i].join("");}} row.State=4; if(!row.Page)row._7AZ=4; this.Refresh(); this.XO(row);}; _7h.prototype.XP=function(row,EV,XQ){ if(!row.r1||this.Loading||XQ!=null&&this.AF!=XQ)return; if(Grids.OnRenderChildPageStart)Grids.OnRenderChildPageStart(this,row); var BC=this.GetRowChildren(row,1);if(!BC)return; BC=BC.firstChild;if(!BC)return; BC=BC.childNodes[EV];if(!BC)return; if(BC.offsetHeight<5)return; var Md,XR=null,FZ=this.ChildPageLength,HU=this.GetSections(); for(var Au=BC.previousSibling,Em=0;Au&&(!Au.firstChild||Au.firstChild.nodeType!=1);Au=Au.previousSibling)if(Au.offsetHeight>=5)Em++; if(Au){ Md=Au.firstChild.rows; Md=Md[Md.length-1]; Md=Md.row?Md.row:Md.previousSibling.row; Em=Em*FZ+1;} else{ Md=this.GetNextVisible(row); if(Em)Em=Em*FZ;}; for(var i=0;i<Em&&Md;i++){ Md=Md.nextSibling; while(Md&&!Md.Visible)Md=Md.nextSibling;} if(!Md||Md.Level<=row.Level){ for(var i=HU[0];i<HU[1];i++){ var BC=this.GetRowChildren(row,i).firstChild.childNodes[EV]; BC.style.display="none";}} else{ var Au=BC.nextSibling; if(Au){ Au=Au.firstChild; if(Au.nodeType==1){ XR=Au.rows[1].row; FZ=1e6;}} else FZ=1e6; var P1=[[],[],[]]; XR=this.XN(row,P1[0],P1[1],P1[2],Md,XR,FZ); for(var i=HU[0];i<HU[1];i++){ var BC=this.GetRowChildren(row,i).firstChild.childNodes[EV]; BC.style.height=""; BC.innerHTML=P1[i].join("");} this.XO(row,Md,XR,EV);}; this.Update(); if(Grids.OnRenderChildPageFinish)Grids.OnRenderChildPageFinish(this,row); this.ShowPages();}; _7h.prototype.SM=function(row,XQ){ if(!row.r1||row.State==4||this.Loading||XQ!=null&&this.AF!=XQ)return; if(Grids.OnRenderPageStart)Grids.OnRenderPageStart(this,row); this.XL(row); if(this.FRow==row&&row.Page){ this.Focus(this.PagePosToRow(row,this.FPagePos),this.FCol); this.FPagePos=null;} this.Update(); if(Grids.OnRenderPageFinish)Grids.OnRenderPageFinish(this,row); if(this.Paging)this.ShowPages(); if(this.Ph)this.Tq(null,row);}; _7h.prototype.XO=function(row,Md,XR,EV){ var AP=row.firstChild; var HU=this.GetSections(),KF=HU[0],KG=HU[1]; var XT=KF==0,XU=KG==3; if(!row.r1)return; var H4=this.ChildPages,min=this.ChildPageMin,XV=this.FRow&&!this.FRow.r1; if(Md){ AP=Md; if(XT)XW=row.r0.nextSibling.firstChild.childNodes[EV].firstChild.rows[1]; XX=row.r1.nextSibling.firstChild.childNodes[EV].firstChild.rows[1]; if(XU)Ji=row.r2.nextSibling.firstChild.childNodes[EV].firstChild.rows[1];} else if(row.Page){ if(XT)XW=row.r0.firstChild.rows[1]; XX=row.r1.firstChild.rows[1]; if(XU)Ji=row.r2.firstChild.rows[1];} else if(H4){ if(!min)return; if(XT)XW=row.r0.nextSibling.firstChild.firstChild.firstChild.rows[1]; XX=row.r1.nextSibling.firstChild.firstChild.firstChild.rows[1]; if(XU)Ji=row.r2.nextSibling.firstChild.firstChild.firstChild.rows[1];} else{ if(XT)XW=row.r0.nextSibling.firstChild.firstChild.rows[1]; XX=row.r1.nextSibling.firstChild.firstChild.rows[1]; if(XU)Ji=row.r2.nextSibling.firstChild.firstChild.rows[1];}; if(!XX||XX.nodeType!=1){ _7l(row); return;} var CE=new Function(this.K+".ARow=this.row;"+this.K+".ASec=0;"); var KZ=Grids.OnRenderRow!=null; function _7l(row){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ AP.r1=null;if(AP.State>2)AP.State=2; if(AP.firstChild)_7l(AP);}}; while(AP!=XR){ var Dh=AP.Visible; if(Dh){ if(XT){AP.r0=XW;XW.row=AP;XW.onmousemove=CE;} AP.r1=XX;XX.row=AP;XX.onmousemove=CE; if(XU){AP.r2=Ji;Ji.row=AP;Ji.onmousemove=CE;} if(KZ)Grids.OnRenderRow(this,AP);} else{AP.r1=null;if(AP.State>2)AP.State=2;}; if(AP._7AZ){ if(AP._7AZ==4&&(!H4||min)){ if(H4){ if(XT)XW=XW.nextSibling.firstChild.firstChild.firstChild.rows[1]; XX=XX.nextSibling.firstChild.firstChild.firstChild.rows[1]; if(XU)Ji=Ji.nextSibling.firstChild.firstChild.firstChild.rows[1];} else{ if(XT)XW=XW.nextSibling.firstChild.firstChild.rows[1]; XX=XX.nextSibling.firstChild.firstChild.rows[1]; if(XU)Ji=Ji.nextSibling.firstChild.firstChild.rows[1];}; AP=AP.firstChild; continue;} else{ if(XT)XW=XW.nextSibling; XX=XX.nextSibling; if(XU)Ji=Ji.nextSibling; _7l(AP);}} while(AP!=XR){ if(AP.nextSibling){ AP=AP.nextSibling; if(!Dh||AP==XR)break; else if(XX.nextSibling){ if(XT)XW=XW.nextSibling; XX=XX.nextSibling; if(XU)Ji=Ji.nextSibling; break;} else if(H4&&!AP.parentNode.Page){ if(XT)XW=XW.parentNode.parentNode.parentNode; XX=XX.parentNode.parentNode.parentNode; if(XU)Ji=Ji.parentNode.parentNode.parentNode; while(XX.nextSibling&&(!XX.nextSibling.firstChild||XX.nextSibling.firstChild.nodeType!=1)){ var Au=AP.parentNode; for(var i=0;i<this.ChildPageLength;i++){ AP.r1=null;if(AP.State>2)AP.State=2; AP=AP.nextSibling; while(AP&&!AP.Visible){AP.r1=null;if(AP.State>2)AP.State=2;AP=AP.nextSibling;} if(!AP)break;} if(!AP)break; if(XT)XW=XW.nextSibling; XX=XX.nextSibling; if(XU)Ji=Ji.nextSibling;} if(!AP||!XX.nextSibling){ if(!AP)AP=Au.lastChild; if(XT)XW=XW.parentNode.firstChild.firstChild.firstChild.rows[1]; XX=XX.parentNode.firstChild.firstChild.firstChild.rows[1]; if(XU)Ji=Ji.parentNode.firstChild.firstChild.firstChild.rows[1];} else{ if(XT)XW=XW.nextSibling.firstChild.firstChild.rows[1]; XX=XX.nextSibling.firstChild.firstChild.rows[1]; if(XU)Ji=Ji.nextSibling.firstChild.firstChild.rows[1]; break;}}} while(AP!=row&&!AP.nextSibling&&AP!=XR){ AP=AP.parentNode; if(XT)XW=XW.parentNode.parentNode.parentNode.parentNode; XX=XX.parentNode.parentNode.parentNode.parentNode; if(XU)Ji=Ji.parentNode.parentNode.parentNode.parentNode; if(H4){ if(XT)XW=XW.parentNode; XX=XX.parentNode; if(XU)Ji=Ji.parentNode;}} if(AP==row){AP=XR;break;} Dh=AP.Visible;}} if(XV&&this.FRow.r1){ this.Me();}}; _7h.prototype.XY=function(){ var HU=this.GetSections(),KF=HU[0],KG=HU[1]; if(!this.AllPages){ var AP=_7k(this.XB,this.V),AN; for(var i=KF;i<KG;i++){AN=this.A9(i);AP["r"+i]=AN;AN.row=AP;} if(AP.State==4)this.XO(AP);} else{ var Em=0,Rr,Rs,Rt; if(!KF)Rr=this.A9(0); Rs=this.A9(1); if(KG>2)Rt=this.A9(2); for(var AP=this.XB.firstChild;AP;AP=AP.nextSibling){ if(AP.Hv){ if(!Em){Rs.XZ=AP;Rs.Count=1;} else Rs.Count++; Rs.Dn=AP; AP.Height=AP.State<2?AP.Count*this.Hu:this.Ha(AP); if(Rr)AP.r0=Rr; AP.r1=Rs; if(Rt)AP.r2=Rt; if(++Em==this.FastPages){ if(Rr)Rr=Rr.nextSibling; Rs=Rs.nextSibling; if(Rt)Rt=Rt.nextSibling; Em=0;}} else{ if(Rr){AP.r0=Rr;Rr.row=AP;Rr=Rr.nextSibling;} AP.r1=Rs;Rs.row=AP;Rs=Rs.nextSibling; if(Rt){AP.r2=Rt;Rt.row=AP;Rt=Rt.nextSibling;} if(AP.State==4)this.XO(AP);}}}}; _7h.prototype.UpdateBody=function(){ if(this.EditMode&&this.EndEdit(this.FRow,this.FCol,true)==-1)return; this.Clear(0); var P1=[[],[],[]]; this.Ln(this.KB); this.Xa(P1[0],P1[1],P1[2]); for(var Dh=0;Dh<3;Dh++){ if(this.N[Dh])this.N[Dh].innerHTML=P1[Dh].join("");} this.XY(); this.Ne(); if(this.FRow&&!this.FRow.r1)this.Focus(); else this.Mv(); this.Update();}; _7h.prototype.Xb=function(QQ){ var Xc=this.s[QQ]; if(Xc!=null)return Xc; QQ+=""; if(QQ.charAt(0)=='#'){ if(QQ.length==4)Xc=("0x"+QQ.charAt(1)<<20)+("0x"+QQ.charAt(2)<<12)+("0x"+QQ.charAt(3)<<4); else Xc=("0x"+QQ.slice(1))-0;} else{ Xc=QQ.replace(/[^\d\,\-]/g,""); Xc=Xc.split(","); Xc=(Xc[0]<<16)+(Xc[1]<<8)+(Xc[2]-0);}; this.s[QQ]=Xc; return Xc;}; _7h.prototype.ColorCell=function(row,F6){ var H6=this.GetCell(row,F6);if(!H6)return; var AJ=[];this.KY(row,AJ,null,null,2,F6); var Cu=this.Xd; H6.style.backgroundColor=AJ[1]; var K5=H6.nextSibling; var Xe=K5?K5.className.indexOf("NoLeft")>=0:0; if(Xe){ K5.style.backgroundColor=AJ[1];} if(F6==this.MainCol&&!row.Fixed){ var Xf=H6.previousSibling; Xf.style.backgroundColor=AJ[1];}}; _7h.prototype.ColorRow=function(row){ if(!row||!row.r1)return; if(row.Space){ var H6=row.r1.firstChild.rows[0].cells[_7P?1:0]; var AJ=[];this.KY(row,AJ,null,null,2); for(var AO=1;H6;H6=H6.nextSibling,AO+=2)H6.style.backgroundColor=AJ[AO]; return;} var HU=this.GetSections(),P1=[[],[],[]],B3; this.KY(row,P1[0],P1[1],P1[2],2); for(var i=HU[0];i<HU[1];i++){ var AJ=P1[i],H6=row["r"+i].firstChild,AO=1; if(this.KJ)H6=H6.nextSibling; while(H6){ var BQ=H6.className; H6.style.backgroundColor=AJ[AO]; if(BQ.indexOf("NoRight")<0)AO+=2; H6=H6.nextSibling;}}}; _7h.prototype.RefreshCell=function(row,F6){ var H6=this.GetCell(row,F6);if(!H6)return; var AJ=[],Cn;this.KY(row,AJ,null,null,1,F6); if(row.Space&&row.RelWidth&&row[F6+"RelWidth"]&&H6.firstChild)Cn=H6.firstChild.style.width; H6.innerHTML=AJ[0]; H6.className=AJ[1]; H6.style.backgroundColor=AJ[2]; var K5=H6.nextSibling; var Xe=K5?K5.className.indexOf("NoLeft")>=0:0; if(AJ[3]){ if(!Xe){ K5=H6.parentNode.insertCell(H6.cellIndex+1); H6.colSpan=H6.colSpan-1; K5.rowSpan=H6.rowSpan; K5.innerHTML=_7D;} K5.className=AJ[3]; K5.style.backgroundColor=AJ[2];} else if(Xe){ K5.parentNode.removeChild(K5); H6.colSpan=H6.colSpan+1;} if(AJ[4]){ var Xf=H6.previousSibling; Xf.innerHTML=AJ[4]; Xf.className=AJ[5]; Xf.style.backgroundColor=AJ[2];} if(Cn&&H6.firstChild)H6.firstChild.style.width=Cn; if(row==this.ARow&&F6==this.ACol)this.GridMouseOver(); if(Grids.OnRenderRow)Grids.OnRenderRow(this,row,F6);}; _7h.prototype.RefreshRow=function(row){ if(!row||!row.r1)return; var HU=this.GetSections(),P1=[[],[],[]],B3,BM,Cu=null,Xg=null; if(row.Space){ row.r1.innerHTML=this.Xh(row);} else{ this.KY(row,P1[0],P1[1],P1[2]); if(_7P||_7K){ B3=this.P4(row); BM=document.createElement("div");} var CE=new Function(this.K+".ARow=this.row;"+this.K+".ASec=0;"); for(var i=HU[0];i<HU[1];i++){ var AP=row["r"+i]; if(_7P||_7K){ BM.innerHTML=_7A+_7B+B3+P1[i]+"</tr>"+_7C; var Es=BM.firstChild.rows[0]; AP.parentNode.replaceChild(Es,AP); row["r"+i]=Es; Es.onmousemove=CE; Es.row=row; AP.onmousemove=null; AP.row=null;} else AP.innerHTML=(this.KJ?"<td style='width:0px;height:0px'></td>":"")+P1[i];} var CS=row.r1.offsetHeight; if(row.r0&&row.r0.offsetHeight!=CS||row.r2&&row.r2.offsetHeight!=CS)this.UpdateRowHeight(row);}; if(row.Space&&row.RelWidth)this.Il(row); if(row==this.ARow)this.GridMouseOver(); if(Grids.OnRenderRow)Grids.OnRenderRow(this,row);}; _7h.prototype.SC=function(Kl){ if(!this.Xi)return; for(var Au=this.XB.firstChild;Au;Au=Au.nextSibling)if(Au.firstChild)this.Xj(Au,Kl);}; _7h.prototype.Xj=function(Au,Kl){ var a=this.Xi;if(!a)return; var Hw=this.ColorClasses&64; for(var AP=Au.firstChild,BD=a;AP;AP=AP.nextSibling){ if(!AP.Visible)continue; if(!Kl&&AP.ColorPos!=!BD){ AP.ColorPos=BD; if(Hw)this.RefreshRow(AP); else this.ColorRow(AP);} else AP.ColorPos=!BD; if(!--BD)BD=a; if(AP.firstChild)this.Xj(AP,Kl);}}; _7h.prototype.SV=function(row){ if(!row)return; for(var BD in this.Cols){ if(this.GetType(row,BD)=="Panel")this.RefreshCell(row,BD);}}; _7h.prototype.Qa=function(row,F6){ var Hw=this.Gw(row,F6,"Refresh"); if(Hw){ Hw=Hw.split(','); for(var i=0;i<Hw.length;i++)this.RefreshCell(row,Hw[i]);} var Hw=this.Gw(row,F6,"Clear"); if(Hw){ Hw=Hw.split(','); for(var i=0;i<Hw.length;i++)if(row[Hw[i]]!="")this.SetValue(row,Hw[i],"",1);}}; _7h.prototype.Refresh=function(){ if(_7P&&!this.Rendering){ try{this.N[1].scrollTop=this.N[1].scrollTop;}catch(H){}}}; _7h.prototype.J7=function(row){ if(!row)return; row.DetailRow=null; row.DetailGrid=null; for(var AP=row.firstChild;AP;AP=AP.nextSibling)this.J7(AP);}; _7h.prototype.ShowDetail=function(row,detail,Ci){ var AS=Grids[detail]; if(!AS)return false; if(AS==this)row=row.MasterRow; else{ AS.J6=this; if(AS.Loading||AS.Rendering){ var T=this; setTimeout(function(){ T.ShowDetail(row,detail);},100); return true;}}; if(Grids.OnShowDetail&&Grids.OnShowDetail(this,AS,row))return false; var AN=AS.XB.firstChild; var Xk=AN.MasterRow; if(Xk==row&&!Ci)return false; AS.Clear(4); if(Xk){ if(this.ColorClasses&8)this.RefreshRow(Xk); else this.ColorRow(Xk);} _7l(AN); if(row.Deleted&&!AS.ShowDeleted){ this.RefreshDetail(AS,1); return true;} AS.HX(AN); AN.State=4; AN.MasterRow=row; AN.id=row.id; AN.Def=row.Def; row.DetailRow=AN; row.DetailGrid=AS; if(this.ChildPaging==3&&row.State<2&&!row.Expanded){ this.Xl(row); this.Xm(row); this.Xn(row); return true;} var LM=Grids.AH; function Copy(Pd,Xo){ for(var AP=Xo.firstChild;AP;AP=AP.nextSibling){ var EB=_7i.createElement("I"); for(var a in AP)if(!LM[a])EB[a]=AP[a]; EB.id=AP.id; if(EB.Filtered){EB.Filtered=0;EB.Visible=1;} EB.r0=null;EB.r1=null;EB.r2=null; EB.MasterRow=AP; AP.DetailRow=EB; AP.DetailGrid=AS; if(AP.firstChild)Copy(EB,AP); Pd.appendChild(EB);}}; Copy(AN,row); AS.Calculate(1,1,1); AS.Nc(1); AS.UpdateBody(); AS.Ne(); if(this.ColorClasses&8)this.RefreshRow(row); else this.ColorRow(row); if(Grids.OnShowDetailFinish)Grids.OnShowDetailFinish(this,AS,row); return true;}; _7h.prototype.RefreshDetail=function(G,clear){ if(G){ if(G.J6!=this)return; if(clear){ if(G.ReloadBody)G.ReloadBody(null,0,"Detail");} else{ var AN=G.XB.firstChild; if(AN&&AN.MasterRow)this.ShowDetail(AN.MasterRow,Get(AN.MasterRow,"Detail"),1);}} else{ for(var i=0;i<Grids.length;i++){ var G=Grids[i]; if(G&&G.J6==this)this.RefreshDetail(G,clear);}}}; _7h.prototype.Xp=function(CE,Ci,clear){ var row=CE?this.FRow:this.ARow; if(!row||row.Page)return false; var JW=Get(row,"Detail"); if(JW==null)return false; if(clear){ var G=Grids[JW]; if(!G||!G.ReloadBody)return false; G.ReloadBody(null,0,"Detail"); return true;} return this.ShowDetail(row,JW,Ci);}; _7h.prototype.ActionShowDetail=function(CE){return this.Xp(CE,0);}; _7h.prototype.ActionRefreshDetail=function(CE){return this.Xp(CE,1);}; _7h.prototype.ActionClearDetail=function(CE){ var row=CE?this.FRow:this.ARow; if(!row)return false; var G=row.DetailGrid; if(!G||!G.ReloadBody)return false; G.ReloadBody(null,0,"Detail"); return true;}; _7h.prototype.ToolbarClick=function(EV){ if(EV=="MenuCfg")EV="Cfg"; var AJ=["","Save","Reload","Add","Sort","","","Help","ExpandAll","CollapseAll","Cfg","AddChild","Repaint","Calc","Columns","Print","Export"]; if(AJ[EV])EV=AJ[EV]; this.Xq="Key"; this.PW("Click","Button"+EV);}; _7h.prototype.ActionShowCfg=function(){ var DY=this.Lang["MenuCfg"]; var Xr=Grids.OnCanShowCfgItem?Grids.OnCanShowCfgItem:function(D2,EV,HQ){return HQ;}; var Xs=Grids.AG,Xt=[]; for(var i=0;i<Xs.length;i++)Xt[Xt.length]={Name:Xs[i],Text:DY["CheckUpdates"+Xs[i]]}; var M=DV.DW(this.MenuCfg.Menu,1); if(!M)M={}; if(!M.Items){ M.Items=[]; var Au=0,AI=M.Items; if(Xr(this,1,this.Deleting&&!!this.MenuCfg.ShowDeleted)) AI[Au++]={Name:1,Text:DY["ShowDeleted"],Value:this.ShowDeleted,Bool:1}; if(Xr(this,2,this.Sorting&&!!this.MenuCfg.AutoSort&&this.Paging<=2)) AI[Au++]={Name:2,Text:DY["AutoSort"],Value:this.AutoSort,Bool:1}; if(Xr(this,13,!!this.Sorting&&!!this.MenuCfg.ShowIcons)) AI[Au++]={Name:13,Text:DY["SortClick"],Items:[{Name:0,Text:DY["SortClick1"]},{Name:1,Text:DY["SortClick2"]},{Name:2,Text:DY["SortClick3"]},{Name:3,Text:DY["SortClick4"]}],Enum:1,Value:this.SortIcons,Width:130}; if(Xr(this,3,!!this.Source.Upload.Url&&!!this.MenuCfg.AutoUpdate&&!this.Detail)) AI[Au++]={Name:3,Text:DY["AutoUpdate"],Value:this.AutoUpdate,Bool:1}; if(Xr(this,4,!!this.Source.Check.Url&&!!this.MenuCfg.CheckUpdates&&!this.Detail)) AI[Au++]={Name:4,Text:DY["CheckUpdates"],Items:Xt,Value:this.Source.Check.Interval,Enum:1,Width:130}; if(this.MenuCfg.Separator1&&Au)AI[Au++]={Name:"-"}; if(Xr(this,10,!!this.MenuCfg.MouseHover)) AI[Au++]={Name:10,Text:DY["MouseHover"],Items:[{Name:0,Text:DY["Hover1"]},{Name:1,Text:DY["Hover2"]},{Name:2,Text:DY["Hover3"]},{Name:3,Text:DY["Hover4"]}],Value:this.Hover,Enum:1,Width:130}; if(Xr(this,11,(this.Dragging||this.ColMoving)&&!!this.MenuCfg.ShowDrag)) AI[Au++]={Name:11,Text:DY["ShowDrag"],Value:this.ShowDrag,Bool:1}; if(Xr(this,12,!!this.MenuCfg.ShowPanel)) AI[Au++]={Name:12,Text:DY["ShowPanel"],Value:this.Cols.Panel&&this.Cols.Panel.Visible,Bool:1}; if(Xr(this,14,!!this.MenuCfg.ShowPager)) AI[Au++]={Name:14,Text:DY["ShowPager"],Value:this.Pager.Visible,Bool:1}; if(Xr(this,15,this.Paging&&!!this.MenuCfg.ShowAllPages)) AI[Au++]={Name:15,Text:DY["ShowAllPages"],Value:this.AllPages,Bool:1}; M=DV.DW(M);} M.Modal=1; M.ShowCursor=0; M.CloseClickOut=0; M.Head=DY["Caption"]; M.Buttons=["Ok","Cancel"]; M.Texts={Aq:DY["OK"],C9:DY["Cancel"]}; M.EnumTime=0; M.ClassEnum=""; var AM={Tag:GetWindowSize()[1]<this.MainTag.offsetHeight||this.CenterMessage?document.body:this.MainTag,Align:"center middle"}; this.Cw=1; M.Base=this.Img.Style+"Menu"; M.Class=this.Img.Style+"CfgMenu"; var T=this; M.OnSave=function(){T.HideCfg(M);M.QO=1;}; M.OnClose=function(){if(!M.QO)T.Cw=0;}; M=ShowMenu(M,AM); if(Grids.OnShowCfg)Grids.OnShowCfg(this,M);}; _7h.prototype.HideCfg=function(M){ var Xu=false,Xv=false,Xw=false; for(var i=0;i<M.Items.length;i++){ var AI=M.Items[i],Es=AI.Name,Dh=AI.Value; if(Es==1&&Dh!=this.ShowDeleted){ if(this.Xx()){ if(this.Paging)Xu=true; else Xv=true;} if(!this.ShowDeleted)Xw=true;} if(Es==2&&Dh!=this.AutoSort){ if(Dh)this.SortRows(); this.AutoSort=Dh;} if(Es==13&&this.SortIcons!=Dh){this.SortIcons=Dh;this.VW();} if(Es==3)this.AutoUpdate=Dh; if(Es==4)this.Source.Check.Interval=Dh; if(Es==10)this.Hover=Dh; if(Es==11)this.ShowDrag=Dh; if(Es==12&&this.Cols.Panel.Visible!=Dh){ if(Dh)this.ShowCol("Panel"); else this.HideCol("Panel"); Xw=true;} if(Es==14&&this.Pager.Visible!=Dh){ this.Xy(Dh); if(!Xv){ if(this.Pager.Visible&&!_7Q)Xv=true; else Xw=true;}} if(Es==15&&this.AllPages!=Dh){this.SetAllPages(Dh,true);Xw=true;} if(Grids.OnCfgChanged)Grids.OnCfgChanged(this); this.SaveCfg();} this.Cw=0; if(Xv||Xu)this.ShowMessage(this.GetText("UpdateCfg")); var T=this; if(Xv)setTimeout(function(){T.Render();},10); else{ if(Xw){ this.Update(); var AP=this.FRow;this.FRow=null; this.Focus(AP,this.FCol);} if(Xu)setTimeout(function(){T.SN();},10);}}; _7h.prototype.ActionShowColumns=function(){ var count=this.MenuColumns["ColumnsCount"];if(!count)count=1; var DY=this.Lang["MenuCfg"]; var M=DV.DW(this.MenuColumns.Menu,1);if(!M)M={Items:[]}; for(var i=0;i<4;i++){ var AI=[],Au=0; var S=i==3?["Pager"]:this.ColNames[i]; for(var BD=0;BD<S.length;BD++){ var F6=S[BD],C=i==3?this.Pager:this.Cols[F6]; if(!C.CanHide)continue; var Wb=C.MenuName; if(!Wb)Wb=i==3?C.Caption:this.GetCaption(F6); if(!Wb)Wb=F6; AI[Au++]={Name:F6,Text:Wb,Bool:1,Value:C.Visible};} if(Au){ if(M.Items.length)M.Items[M.Items.length]={Name:"-"}; M.Items[M.Items.length]={Columns:count,Items:AI,Sec:i,Group:1}}} M.Modal=1; M.ShowCursor=0; M.CloseClickOut=0; M.Head=this.GetText("ColumnsCaption"); M.Buttons=["Ok","Clear","Cancel"]; M.Texts={Aq:DY["OK"],C9:DY["Cancel"],Clear:DY["Clear"],FG:DY["All"]}; var AM={Tag:GetWindowSize()[1]<this.MainTag.offsetHeight||this.CenterMessage?document.body:this.MainTag,Align:"center middle"}; this.Cw=1; M.Base=this.Img.Style+"Menu"; M.Class=this.Img.Style+"ColumnsMenu"; var T=this; M.OnSave=function(){return T.HideColumns(M);}; M.OnClose=function(){T.Cw=0;}; M=ShowMenu(M,AM); if(Grids.OnShowColumns)Grids.OnShowColumns(this,M);}; _7h.prototype.HideColumns=function(M){ var HU=this.GetSections(),C=this.Cols,PK={},A5=0,Ff=0,Xz=0; var X0=0; for(var i=0;i<M.Items.length;i++){ var AI=M.Items[i]; if(!AI.Columns)continue; if(AI.Sec==3){ if(this.Pager.Visible!=AI.Items[0].Value){ Xz=1; if(this.Pager.Visible)A5-=this.Pager.Width; else A5+=this.Pager.Width;} continue;} for(var j=0;j<AI.Items.length;j++){ var F6=AI.Items[j].Name,BD=C[F6],Dh=AI.Items[j].Value; if(BD.Visible!=Dh){Ff++;PK[F6]=Dh;}} var B3=AI.Sec,S=this.ColNames[B3],Em=0; for(var j=0;j<S.length;j++){ var F6=S[j],BD=C[F6],Dh=PK[F6]!=null?PK[F6]:BD.Visible; if(Dh){Em++;if(B3!=1)A5+=BD.RelWidth?BD.MinWidth:BD.Width;}} if(B3==1&&!Em){ alert(this.GetAlert("ErrHide"));return false;} if(!Em&&B3>=HU[0]&&B3<HU[1]||Em&&(B3<HU[0]||B3>=HU[1]))X0=1;} if(A5>this.MainTag.offsetWidth-_7Z-40){ alert(this.GetAlert("ErrHideExt")); return false;} if(Ff*this.RowCount>this.SynchroCount*2)X0=1; if(Grids.OnColumnsChanged)Grids.OnColumnsChanged(this,PK,Ff); if(Xz){ this.Xy(!this.Pager.Visible); if(!Ff)this.Update();} if(!Ff)return; if(X0){ for(var BD in PK)C[BD].Visible=PK[BD]; this.SaveCfg(); this.SetVPos(); this.Render(this.GetText("ColUpdate"));} else{ this.Rendering=1; for(var BD in PK){ if(PK[BD])this.ShowCol(BD); else this.HideCol(BD);} this.Rendering=0; this.UpdateHeights(); this.Update(); this.SaveCfg(); if(this.FCol&&this.Cols[this.FCol]&&!this.Cols[this.FCol].Visible)this.FCol=null; this.Mv(); if(_7r!=1){ this.VW(); var AP=this.GetFirstVisible();if(AP)this.RefreshRow(AP);} if(_7N){var T=this;setTimeout(function(){T.Scrolled(1);},10);}}}; _7h.prototype.X1=function(F6){ var C=this.Cols[F6];if(!C)return null; var KU=0,Sec=this.ColNames[C.Sec]; for(var i=0;i<Sec.length;i++){ if(F6==Sec[i])break; if(this.Cols[Sec[i]].Visible)KU+=this.Cols[Sec[i]].Width;} if(C.Sec==1)KU-=this.N[1].scrollLeft; else if(C.Sec==2)KU+=this.N[1].offsetWidth; if(C.Sec>=1&&this.N[0])KU+=this.N[0].offsetWidth; return KU;}; _7h.prototype.SY=function(row){ var F6=this.X2;if(!F6)return null; if(row.Space){ var KU=this.X1(F6),A5=0; KU+=this.Cols[F6].Width/2; if(!row.Cells)return null; for(var i=0;i<row.Cells.length;i++){ F6=row.Cells[i]; if(Get(row,F6+"Visible")!=0){ var H6=this.GetCell(row,F6); if(H6)A5+=H6.offsetWidth;} if(A5>KU)break;}} else{ if(this.Cols[F6]&&!this.Cols[F6].Visible)F6=this.GetNextCol(F6); if(row.Spanned&&Get(row,F6+"Span")==0)F6=this.GetPrevCol(F6,row);}; if(!this.CanFocus(row,F6)){ if(row.G4&&row[F6+"RowSpan"]==0)return F6; var KF=F6,KG=F6; while(KF||KG){ if(KF){ if(!this.CanFocus(row,KF))KF=this.GetPrevCol(KF,row); else{F6=KF;break;}} if(KG){ if(!this.CanFocus(row,KG))KG=this.GetNextCol(KG,row); else{F6=KG;break;}}}} return F6;}; _7h.prototype.RV=function(row,F6){ if(!row||!F6)return; if(row.Space==null){this.X2=F6;return;} var H6=this.GetCell(row,F6); if(!H6)return; var A5=H6.offsetLeft+H6.offsetWidth/2; this.X2=this.Hi(A5);}; _7h.prototype.X3=function(F6){ return this.X4;}; _7h.prototype.RW=function(row,F6){ this.X4=row;}; _7h.prototype.ActionTabLeft=function(){return this.X5(1,0);}; _7h.prototype.ActionTabRight=function(){return this.X5(0,0);}; _7h.prototype.ActionTabLeftEdit=function(){return this.X5(1,1);}; _7h.prototype.ActionTabRightEdit=function(){return this.X5(0,1);}; _7h.prototype.ActionGoUp=function(){return this.X6(1,0);}; _7h.prototype.ActionGoDown=function(){return this.X6(0,0);}; _7h.prototype.ActionGoUpEdit=function(){return this.X6(1,1);}; _7h.prototype.ActionGoDownEdit=function(){return this.X6(0,1);}; _7h.prototype.ActionGoLeft=function(){return this.X7(1,0);}; _7h.prototype.ActionGoRight=function(){return this.X7(0,0);}; _7h.prototype.ActionGoLeftEdit=function(){return this.X7(1,1);}; _7h.prototype.ActionGoRightEdit=function(){return this.X7(0,1);}; _7h.prototype.X5=function(shift,Nx){ var X8=shift?-1:1; var F6=this.FCol,row=this.FRow,SW=this.FPagePos,AJ; if(!F6||F6=="Panel")F6=X8>0?this.GetFirstCol(null,row):this.GetLastCol(null,row); else F6=shift?this.GetPrevCol(F6,row):this.GetNextCol(F6,row); if(!row||row.Kind=="Header"){AJ=shift?this.GetPrevShift(null,null,1,F6):this.GetNextShift(null,null,1,F6);row=AJ[0];SW=AJ[1];} while(true){ if(!F6){ AJ=shift?this.GetPrevShift(row,SW,1,F6):this.GetNextShift(row,SW,1,F6);row=AJ[0];SW=AJ[1]; F6=shift?this.GetLastCol(null,row):this.GetFirstCol(null,row); this.RW(row); if(!row)break;} var AP=this.G4?this.Q4(this.X3(),F6):row; if(!Nx&&this.CanFocus(AP,F6)||Nx&&!AP.Page&&this.CanEdit(AP,F6)){ this.Focus(AP,F6); if(_7P)this.HW.focus(); this.RV(AP,F6); return true;} F6=shift?this.GetPrevCol(F6,row):this.GetNextCol(F6,row);} if(!row){ if(Grids.OnTabOutside&&Grids.OnTabOutside(this,shift?-1:1)){ this.Focus(null,null); Grids.Focused=null;}} return false;}; _7h.prototype.X6=function(shift,Nx){ if(this.EditMode&&this.AutoSort)return false; var row=this.FRow,F6=this.FCol; var AJ=shift?this.GetPrevShift(row,this.FPagePos,1,F6):this.GetNextShift(row,this.FPagePos,1,F6); var row=AJ[0],SW=AJ[1]; while(row){ if(row.Page||Nx&&!row.r1){ if(Nx)this.ScrollIntoView(row,F6,SW); else this.Focus(row,F6,SW); return true;} var F6=this.SY(row); if(!Nx&&this.CanFocus(row,F6)||Nx&&this.CanEdit(row,F6)){ this.Focus(row,F6); this.RW(row,F6); return true;} AJ=shift?this.GetPrevShift(row,SW,1,F6):this.GetNextShift(row,SW,1,F6);row=AJ[0];SW=AJ[1];} return false;}; _7h.prototype.X7=function(shift,Nx){ var row=this.FRow,F6=this.FCol; if(!row)return false; if(!F6||F6=="Panel")F6=this.GetFirstCol(); else F6=shift?this.GetPrevCol(F6,row):this.GetNextCol(F6,row); while(F6&&(this.Cols[F6]||row.Space!=null)){ var AP=this.G4?this.Q4(this.X3(),F6):row; if(!Nx&&this.CanFocus(AP,F6)||Nx&&this.CanEdit(AP,F6)){ this.Focus(AP,F6); this.RV(AP,F6); return true;} F6=shift?this.GetPrevCol(F6,row):this.GetNextCol(F6,row);} return false;}; _7h.prototype.ActionGoFirst=function(){ if(this.AllPages&&this.XB.firstChild.State<2){ this.Focus(this.XB.firstChild,this.FCol,0); return true;} var AP=this.GetFirstVisible(this.AllPages?null:_7k(this.XB,this.V),1); if(AP){ var F6=this.SY(AP); this.RW(AP,F6); this.Focus(AP,F6);}}; _7h.prototype.ActionGoLast=function(){ if(this.AllPages&&this.XB.lastChild.State<2){ var AP=this.XB.lastChild; if(AP.Hv&&this.PageLengthDiv>1){ this.X9(AP); this.Update();} this.Focus(AP,this.FCol,AP.Count-1); return true;} var AP=this.GetLastVisible(this.AllPages?null:_7k(this.XB,this.V),1); if(AP){ var F6=this.SY(AP); this.Focus(AP,F6); this.RW(AP,F6);} return true;}; _7h.prototype.ActionPageUp=function(){ var Ex=false; if(!this.AllPages&&this.GoToPrevPage())Ex=true; if(!Ex){ var AP=this.FRow,GQ=this.FPagePos; var Em=Math.floor(this.N[1].offsetHeight/this.Hu); if(AP){var AJ=this.GetPrevShift(AP,GQ,Em);AP=AJ[0];GQ=AJ[1];} if(!AP||AP.Fixed){ AP=this.GetFirstVisible(null,1);} if(AP){ var F6=this.SY(AP); this.Focus(AP,F6,GQ); this.RW(AP,F6);}} return true;}; _7h.prototype.ActionPageDown=function(){ var Ex=false; if(!this.AllPages&&this.GoToNextPage&&this.GoToNextPage())Ex=true; if(!Ex){ var AP=this.FRow,GQ=this.FPagePos; var Em=Math.floor(this.N[1].offsetHeight/this.Hu); if(AP){var AJ=this.GetNextShift(AP,GQ,Em);AP=AJ[0];GQ=AJ[1];} if(!AP||AP.Fixed){ var AP=this.GetLastVisible(null,1);} if(AP){ var F6=this.SY(AP); this.Focus(AP,F6,GQ); this.RW(AP,F6);}} return true;}; _7h.prototype.TabInside=function(event,move){ if(GetKey(event)==9){ if(move>0&&!event.shiftKey){ if(this.FRow)this.Focus(null,null); this.RN(event); return true;} else if(move<0&&event.shiftKey){ if(this.FRow)this.Focus(null,null); this.RN(event); return true;}} return false;}; _7h.prototype.YA=function(){ if(!this.Pager.Visible)return ""; var Aj=new Array(),AO=0,Au=this.XB.firstChild; if(Au==this.XB.lastChild&&Au.State>=2)Aj[AO++]="<div class='"+this.Img.Style+"PagerItem'"+(_7S?" nowrap"+_7E:"")+">"+this.GetText("NoPages")+"</div>"; else for(;Au;Au=Au.nextSibling)Aj[AO++]="<div"+(_7Q?" style='width:100%'":"")+" class='"+this.Img.Style+"PagerItem'"+(Au.Title?" title='"+Au.Title+"'":"")+(_7S?" nowrap"+_7E:"")+">"+Au.Name+"</div>"; this.U=this.XB.childNodes.length; return Aj.join("");}; _7h.prototype.YB=function(){ var BJ=" class='"+this.Img.Style; for(var Au=this.XB.firstChild,JW=1;Au;Au=Au.nextSibling,JW++){ var E="",Kv=""; for(var i=0;i<3;i++){ var Es="Name0"+i; if(!Au[Es])break; if(E){E+=", ";Kv+=", ";} E+="<b"+BJ+"PagerSort"+(i+1)+"'>"+Au[Es]+"</b>";Kv+=Au[Es];} if(Au["Name1"+i]||Au["Name2"+i]){ if(E){E+="<b"+BJ+"PagerSortS'> | </b>";Kv+=_7P?"\n":" | ";} if(!Au["Name1"+i]){E+="<span"+BJ+"PagerSort"+(i+1)+"'>...</span>";Kv+="...";} else for(var j=i;j<3&&Au["Name1"+j];j++){E+=(j==i?"":", ")+"<span"+BJ+"PagerSort"+(j+1)+"'>"+Au["Name1"+j]+"</span>";Kv+=(j==i?"":", ")+Au["Name1"+j];} E+="<span"+BJ+"PagerSortS'> =&gt; </span>";Kv+=_7P?"\n":" => "; if(!Au["Name2"+i]){E+="<span"+BJ+"PagerSort"+(i+1)+"'>...</span>";Kv+="...";} else for(var j=i;j<3&&Au["Name2"+j];j++){E+=(j==i?"":", ")+"<span"+BJ+"PagerSort"+(j+1)+"'>"+Au["Name2"+j]+"</span>";Kv+=(j==i?"":", ")+Au["Name2"+j];}} Au.Name=E?E:(Au.Name?Au.Name:this.GetText("Page")+" "+JW); if(Kv)Au.Title=Kv; if(Grids.OnSetPageName)Grids.OnSetPageName(this,Au);} if(JW==2){ Au=this.XB.firstChild; if(Au.Name==this.GetText("Page")+" "+1)Au.Name=this.GetText("NoPages"); if(Grids.OnSetPageName)Grids.OnSetPageName(this,Au);}}; _7h.prototype.YC=function(){ function GetString(T,row,F6){ var Bb=Get(row,F6+"PageNameValue"); if(Bb==null)Bb=T.GetString(row,F6,2); if(Grids.OnGetPageNameValue)Bb=Grids.OnGetPageNameValue(T,row,F6,Bb); return Bb;}; if(this.PageLength==1){ var F6=this.MainCol?this.MainCol:this.W?this.SortCols[0]:null; if(F6){ for(var Au=this.XB.firstChild,JW=1;Au;Au=Au.nextSibling,JW++){ var AP=this.GetFirstVisible(Au); Au.Name=AP?GetString(this,AP,F6,2):JW; if(AP)Au.Title=GetString(this,AP,F6,2); if(Grids.OnSetPageName)Grids.OnSetPageName(this,Au);} return;}} if(this.XB.childNodes.length==1){ this.XB.firstChild.Name=this.GetText("NoPages"); return;} var Em=this.Sorting?this.W:0,C=this.Cols; var YD=this.Pager["MaxColumns"];if(YD!=null&&YD<Em)Em=YD; function YE(T,AJ,EV){ var a=EV?Au.nextSibling:Au.previousSibling,Ey=EV?Au.lastChild:Au.firstChild; if(!a){ if(EV){ while(Ey&&!Ey.Visible)Ey=Ey.previousSibling;} else{ while(Ey&&!Ey.Visible)Ey=Ey.nextSibling;}; if(Ey)AJ[0]=Get(Ey,T.SortCols[0]+"Visible")==0?"":GetString(T,Ey,T.SortCols[0],2);} else{ a=EV?a.firstChild:a.lastChild; if(EV){ while(a&&!a.Visible)a=a.nextSibling; while(Ey&&!Ey.Visible)Ey=Ey.previousSibling;} else{ while(a&&!a.Visible)a=a.previousSibling; while(Ey&&!Ey.Visible)Ey=Ey.nextSibling;}; if(!a||!Ey)return; for(var i=0;i<Em;i++){ var BD=T.SortCols[i]; if(T.YF(i,a,Ey)==0)AJ[i]=Get(Ey,BD+"Visible")==0?"":GetString(T,Ey,BD,2); else{ if(C[BD].Type!="Text"&&C[BD].Type!="Lines")AJ[i]=Get(Ey,BD+"Visible")==0?"":GetString(T,Ey,BD,2); else{ var B3=Get(Ey,BD+"Visible")==0?"":GetString(T,Ey,BD,2)+"",Db=_7At(GetString(T,a,BD,2),B3,T.SortTypes[i]); if(Db+3<B3.length)AJ[i]=B3.slice(0,Db+1); else AJ[i]=B3;}; break;}}}}; if(Em){ var BJ=" class='"+this.Img.Style; for(var Au=this.XB.firstChild,JW=1;Au;Au=Au.nextSibling,JW++){ var YG=new Array(),YH=new Array(); YE(this,YG,0); YE(this,YH,1); var E="",Kv=""; for(var i=0;i<3;i++){ if(YG[i]==null||YH[i]==null||CompareStrings(YG[i],YH[i],this.SortTypes[i])!=0)break; if(E){E+=", ";Kv+=", ";} if(YG[i]){E+="<b"+BJ+"PagerSort"+(i+1)+"'>"+YG[i]+"</b>";Kv+=YG[i];}} if(YG[i]!=null||YH[i]!=null){ if(E){E+="<b"+BJ+"PagerSortS'> | </b>";Kv+=_7P?"\n":" | ";} if(YG[i]==null||YG[i]==""){E+="<span"+BJ+"PagerSort"+(i+1)+"'>...</span>";Kv+="...";} else for(var j=i;j<YG.length;j++){E+=(j==i?"":", ")+"<span"+BJ+"PagerSort"+(j+1)+"'>"+YG[j]+"</span>";Kv+=(j==i?"":", ")+YG[j];} E+="<span"+BJ+"PagerSortS'> =&gt; </span>";Kv+=_7P?"\n":" => "; if(YH[i]==null||YH[i]=="")E+="<span"+BJ+"PagerSort"+(i+1)+"'>...</span>"; else for(var j=i;j<YH.length;j++){E+=(j==i?"":", ")+"<span"+BJ+"PagerSort"+(j+1)+"'>"+YH[j]+"</span>";Kv+=(j==i?"":", ")+YH[j];}} Au.Name=E?E:this.GetText("Page")+" "+JW; if(Kv)Au.Title=Kv; if(Grids.OnSetPageName)Grids.OnSetPageName(this,Au);}} else for(var Au=this.XB.firstChild,i=1;Au;Au=Au.nextSibling,i++){ Au.Name=this.GetText("Page")+" "+i; if(Grids.OnSetPageName)Grids.OnSetPageName(this,Au);}}; _7h.prototype.Xy=function(HQ){ if(this.Pager.Visible&&HQ||!this.Pager.Visible&&!HQ)return; this.Pager.Visible=HQ?1:0; this.UpdatePager(); this.Qv.parentNode.style.display=HQ?"":"none"; if(_7P){ for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){ if(AP.Space==0||AP.Space>=4)AP.r1.parentNode.colSpan+=HQ?1:-1;}} this.Kc(); if(this.ASec==-6)this.ASec=-5; this.HoverPager(null);}; _7h.prototype.HoverPager=function(Au){ if(this.Rj==1)return; this.Rj=1; if(Au!=this.YI){ if(this.Hover>=1&&this.U<1000){ if(this.YI!=null)this.Q0.childNodes[this.YI].className=this.Img.Style+"PagerItem"; if(Au!=null)this.Q0.childNodes[Au].className=this.Img.Style+"PagerHover";} if(Grids.Bc&&Au!=null)this.GoToPage(_7k(this.XB,Au));} this.YI=Au;}; _7h.prototype.ActionHoverPager=function(){ var E=this.Event;if(!E.Special)return false; var Au=E.Special.slice(9)-0; if(isNaN(Au))return false; this.HoverPager(Au-1); return true;}; _7h.prototype.ActionShowPage=function(){ var E=this.Event;if(!E.Special)return false; var Au=E.Special.slice(9)-0; if(isNaN(Au))return false; if(this.EditMode&&this.EndEdit(this.FRow,this.FCol)==-1)return false; this.GoToPage(_7k(this.XB,Au-1)); return true;}; _7h.prototype.UpdatePager=function(){ if(!this.Paging)return; if(this.Pager.Visible)this.Q0.innerHTML=this.YA(); for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){ if(AP.YJ)this.RefreshCell(AP,AP.YJ); if(AP.YK)this.If(AP,this.IX(),"CalcOrder",1);} this.YL();}; _7h.prototype.Q2=function(){ var CS=this.b;if(CS)return CS; var Qz=this.Q0.firstChild; CS=Qz.offsetHeight; if(_7P&&!_7U){CS+=Qz.offsetTop;this.b=CS;} else if(Qz.nextSibling){CS=Qz.nextSibling.offsetTop-Qz.offsetTop;this.b=CS;} return CS;}; _7h.prototype.Sb=function(){ if(this.Pager.Visible){ var Height=this.Q0.firstChild.offsetHeight,Top,CS=this.Q2(),YM=CS-Height; if(this.AllPages){ var AJ=this.GetShowedPages(),F8=AJ.length-2; if(F8==1){ Top=AJ[0]*CS+AJ[2]*CS-YM; Height=AJ[1]*CS-YM;} else{ Top=AJ[0]*CS+(1-AJ[1])*CS-CS+Height; Height=AJ[F8]*CS+AJ[F8+1]*CS-Top-YM*2;}} else{ Top=this.V*CS-YM;}; var Ht=_7Q?0:this.Img.YN; if(!(Height>Ht))Height=Ht+1; this.YO.style.height=Height-Ht+"px"; if(isFinite(Top)){ this.YO.style.marginTop=(-this.Q0.offsetHeight+Top)+"px"; this.Qy.scrollTop=Top-this.Qy.offsetHeight/2+Height/2; if(_7U)this.YO.innerHTML=this.YO.innerHTML;}} for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){ if(AP.YJ){ var Au=this.GetFPage(1); if(Au)Au=this.GetPageNum(Au); if(AP.YP!=Au){ var a=this.GetCell(AP,AP.YJ).getElementsByTagName("a"); if(AP.YP!=null&&a[AP.YP])a[AP.YP].className=this.Img.Style+"PagesLink"; if(Au!=null){ var H4=a[Au],H6=H4.parentNode; H4.className=this.Img.Style+"PagesLinkActive"; var AO=H4.offsetLeft-H6.scrollLeft; if(AO<0)H6.scrollLeft+=AO; else{ AO+=H4.offsetWidth-H6.offsetWidth; if(AO>0)H6.scrollLeft+=AO;}} AP.YP=Au;}} if(AP.YK)this.If(AP,this.IX(),"CalcOrder",1);}}; _7h.prototype.YL=function(AP){ if(!AP){for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.YJ)this.YL(AP);return;} var H6=this.GetCell(AP,AP.YJ); if(H6){ H6=H6.firstChild; var Ho=H6.clientWidth<H6.lastChild.offsetLeft+H6.lastChild.offsetWidth; H6.style.height=this.Img.YQ+(Ho?_7a:0)+"px"; if((H6.style.overflow!="hidden")!=Ho){var T=this;setTimeout(function(){T.Update();},10);} H6.style.overflow=Ho?"auto":"hidden";}}; _7h.prototype.GetPage=function(EV){ return _7k(this.XB,EV);}; _7h.prototype.GetPageNum=function(row){ for(var AP=this.XB.firstChild,EV=0;AP;AP=AP.nextSibling,EV++)if(AP==row)return EV; return 0;}; _7h.prototype.CreatePages=function(){ var Em=this.PageLength,YR=this.HY(),body=YR,AN=this.XB.firstChild,YS=0; while(AN&&AN!=YR){ var AP=AN.firstChild; while(AP){ if(AP.Pr&&AP.Pr>YS)YS=AP.Pr; if(AP.Visible){ if(!Em){ if(YS>0)Em++; else{ Em=this.PageLength; body=this.HY();}} Em--;} YS--; var Es=AP.nextSibling; body.appendChild(AP); AP=Es;} var AL=AN.nextSibling; this.XB.removeChild(AN); AN=AL;} if(this.FRow)this.V=this.GetPageNum(this.GetRowPage(this.FRow)); else if(this.V>=this.XB.childNodes.length)this.V=0; if(this.YC)this.YC();}; _7h.prototype.SH=function(){ var XB=this.XB,X=XB.firstChild; for(var AN=X.nextSibling;AN;AN=X.nextSibling){ for(var AP=AN.firstChild;AP;AP=AN.firstChild)X.appendChild(AP); XB.removeChild(AN);}}; _7h.prototype.ShowPages=function(){ if(this.Rendering||this.Loading||this.Cw)return; if(this.Paging){ var AJ=this.GetShowedPages(); for(var i=0;i<AJ.length-1;i+=2){ var Au=_7k(this.XB,AJ[i]); if(Au.State==0||Au.State==2){ Au.State++; this.StartPage(Au);}}} if(this.ChildPages){ var AJ=this.YT(); for(var i=0;i<AJ.length;i+=2){ if(AJ[i]["CHP"+AJ[i+1]])continue; AJ[i]["CHP"+AJ[i+1]]=1; var JW=this.v.length; this.v[JW]=AJ[i]; var CE=new Function("p","setTimeout(function(){if("+this.K+")"+this.K+".StartChildPage("+JW+","+AJ[i+1]+","+this.AF+");},10);"); CE(Au);}}}; _7h.prototype.StartChildPage=function(AO,EV,XQ){ var row=this.v[AO];delete this.v[AO];if(!row)return; row["CHP"+EV]=null; if(this.Loading||XQ!=null&&this.AF!=XQ)return; if(!this.YU(row,EV))return; this.XP(row,EV);}; _7h.prototype.StartPage=function(row,Ci,XQ){ if(this.Loading||XQ!=null&&this.AF!=XQ)return; if(!Ci&&!this.YV(row)){ if(row.State==1||row.State==3)row.State--; return;} if(row.State==4)return; if(row.Hv&&this.AllPages)this.X9(row); var YW=this.GetRow(row,1); if(row.State==1){ row=this.NR(row); if(YW.offsetHeight>40&&!this.SuppressMessage)_7Au(this.GetText("Load"),YW,this.Img.Style+"PageMessage",this.N[1].offsetHeight); var T=this;this.DownloadPage(row,function(NU){T.YX(NU,row,XQ);});} else{ if(YW.offsetHeight>40&&!this.SuppressMessage)_7Au(this.GetText("Render"),YW,this.Img.Style+"PageMessage",this.N[1].offsetHeight); var T=this;setTimeout(function(){T.SM(row,XQ);},10);}}; _7h.prototype.YX=function(NU,row,XQ){ if(this.Loading||XQ!=null&&this.AF!=XQ)return; if(NU<0){ row.State=0; this.Debug(1,"Failed downloading ",row.Page?"page "+this.GetPageNum(row):"children "+row.id," from ",this.NN(this.Source.Page)); if(row.tagName=="B")_7Au(this.GetText("PageErr"),this.GetRow(row,1),this.Img.Style+"PageMessage",this.N[1].offsetHeight);} else{ this.LB("PageUpdate"); this.N0(row); if(row.Page)this.LP(row); else if(!this.Sorting||!this.Vv||!this.Vv(row))this.LQ(row); this.SC(false); if(this.MainCol){ var C=this.Cols[this.MainCol],T=this; function LV(row){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ T.LV(AP,false,C); if(AP.firstChild)LV(AP);}}; if(row.Page){row.Level=-1;row.LevelImg="";} LV(row);} row.State=3; row.Count=null; if(!Grids.OnCalculate||!Grids.OnCalculate(this,0,row)){ var AM=this.IX(); for(var AP=row.firstChild;AP;AP=AP.nextSibling)this.If(AP,AM,"CalcOrder",1);} if(row.Page){ if(row.firstChild||this.XB.childNodes.length==1)this.StartPage(row); else if(this.XB.childNodes.length>1){ T.Debug(2,"No rows returned for page ",this.GetPageNum(row)); this.Hb(row); if(this.UpdatePager)this.UpdatePager(); this.Update();}} else if(row.Deleted)for(var AP=this.GetNext(row);AP&&row.Level<AP.Level;AP=this.GetNext(AP))if(!AP.Deleted)AP.Deleted=2; if(this.DebugFlags["page"])this.Debug(4,"Downloaded ",row.Page?"page "+this.GetPageNum(row):"children "+row.id," in ",this.LC("Page"+(row.Page?this.GetPageNum(row):row.id))," ms");}}; _7h.prototype.X9=function(row){ var HU=this.GetSections(),XX=0,Ji=0,Em=0,BJ=this.Img.Style,YY=this.PageLengthDiv; for(var Au=row.r1.XZ;Au!=row;Au=Au.nextSibling){XX+=Au.Height/YY;Em++;} if(row!=row.r1.Dn){ for(var Au=row.nextSibling;;Au=Au.nextSibling){ Ji+=Au.Height/YY; if(Au==row.r1.Dn)break;}} if(this.PageLengthDiv>1){ var CE=this.FRow; if(CE&&!CE.Fixed){ CE=this.GetRowPage(CE); if((row==CE||this.GetPageNum(row)<this.GetPageNum(CE))&&this.YV(CE)){ var Cs=function(){ if(CE.State==3||CE.State==1)setTimeout(Cs,100); else{ T.Update(); T.ScrollIntoView(T.FRow);}}; var T=this;setTimeout(Cs,10);}}} function Ab(){ var BM=document.createElement("div"); BM.style.overflow="hidden"; BM.style.height=CS+"px"; BM.className=BJ+"Page"; return BM;}; var CS=row.Height; row.Hv=null; if(XX==0){ if(Ji==0)return; row.r1.XZ=row.nextSibling; row.r1.Count--; for(var BD=HU[0];BD<HU[1];BD++){ var AP=row["r"+BD],BM=Ab(); AP.style.height=Ji+"px"; AP.parentNode.insertBefore(BM,AP); row["r"+BD]=BM; BM.row=row;}} else if(Ji==0){ row.r1.Dn=row.previousSibling; row.r1.Count--; for(var BD=HU[0];BD<HU[1];BD++){ var AP=row["r"+BD],BM=Ab(); AP.style.height=XX+"px"; if(AP.nextSibling)AP.parentNode.insertBefore(BM,AP.nextSibling); else AP.parentNode.appendChild(BM); row["r"+BD]=BM; BM.row=row;}} else{ var Md=row.r1.XZ; row.r1.XZ=row.nextSibling; row.r1.Count=row.r1.Count-Em-1; for(var BD=HU[0];BD<HU[1];BD++){ var FZ="r"+BD,AP=row[FZ],BM=Ab(); AP.style.height=Ji+"px"; var Ll=Ab(); Ll.style.height=XX+"px"; AP.parentNode.insertBefore(Ll,AP); AP.parentNode.insertBefore(BM,AP); row[FZ]=BM; BM.row=row; if(BD==1){ Ll.XZ=Md; Ll.Dn=row.previousSibling; Ll.Count=Em;} for(var Cq=Md,YZ=row.previousSibling;Cq!=YZ;Cq=Cq.nextSibling)Cq[FZ]=Ll; YZ[FZ]=Ll;}}}; _7h.prototype.GoToPageNum=function(EV){ var row=_7k(this.XB,EV-1); if(row)this.GoToPage(row);}; _7h.prototype.GoToPage=function(row){ if(Grids.OnGoToPage&&Grids.OnGoToPage(this,row,this.GetPageNum(row)))return; var Ya=this.FRow?this.FRow.parentNode:null; var Yb=Ya==this.XH||Ya==this.XF; if(!Yb){ var AO=this.FPagePos; if(AO==null&&this.FRow)AO=this.GetPagePos(this.FRow); if(AO==null)AO=0;} if(this.AllPages){ this.ScrollIntoView(row,this.FCol); if(!Yb)this.Focus(row,this.FCol,AO); this.Sb();} else{ var Es=this.V,AP=_7k(this.XB,Es); if(AP==row)return; AP.State=2; AP.r1=null; if(row.State==null)row.State=this.Paging==1?4:2; this.V=this.GetPageNum(row); this.UpdateBody(); if(!Yb)this.Focus(row,this.FCol,AO); this.Update();}}; _7h.prototype.SN=function(Nx){ this.SL(false); for(var Au=this.XB.firstChild;Au;Au=Au.nextSibling)if(Au.State==4)Au.State=2; if(!this.AllPages){ var Au=_7k(this.XB,this.V); if(Au.State<2){ Au=this.NR(Au); if(this.DownloadPage(Au)<0)return; Au.Count=null;} Au.State=4;} this.UpdateBody(); if(this.UpdatePager)this.UpdatePager(); this.HideMessage(); var Cq=this.FRow; if(Cq&&!Cq.Fixed){ if(!this.AllPages&&this.GoToPage)this.GoToPage(this.GetRowPage(Cq)); else this.FRow=null; this.Focus(Cq,this.FCol,this.FPagePos); if(Nx&&Cq==this.FRow)this.StartEdit(Cq,this.FCol);} this.Update(); this.Ne(); this.SC(); this.ShowPages();}; _7h.prototype.ActionRepaint=function(){this.SN();return true;}; _7h.prototype.SetAllPages=function(Bb,Yc){ if(!this.Paging)return; Bb=!!Bb; if(Bb){} else{ var Au=this.FRow?this.GetRowPage(this.FRow):null; if(!Au){ var AJ=this.GetShowedPages(); if(AJ.length==3)Au=AJ[0]; else if(AJ.length==4)Au=AJ[1]>AJ[3]?AJ[0]:AJ[2]; else Au=AJ[2];} this.V=this.GetPageNum(Au);}; this.AllPages=Bb; for(var Au=this.XB.firstChild;Au;Au=Au.nextSibling){ if(Au.State>=2)Au.State=this.Paging==1&&this.AllPages?4:2; Au.r0=null;Au.r1=null;Au.r2=null;} if(this.Paging==1)_7k(this.XB,this.V).State=4; if(Yc)this.UpdateBody(); this.Ln(this.KB);}; _7h.prototype.GoToNextPage=function(Em){ var AP=this.GetFPage(); if(AP)AP=AP.nextSibling; if(!AP)return false; this.GoToPage(AP); return true;}; _7h.prototype.GoToPrevPage=function(){ var AP=this.GetFPage(); if(AP)AP=AP.previousSibling; if(!AP)return false; this.GoToPage(AP); return true;}; _7h.prototype.GetFPage=function(scroll){ if(!this.Paging||!this.N[1])return null; if(!this.AllPages)return _7k(this.XB,this.V); var AP=this.FRow,Au; if(AP&&!AP.Fixed){ Au=this.GetRowPage(AP);if(!scroll)return Au; if(AP.r1){ var CS=this.GetRowHeight(AP); var Ho=this.GetScrollTop(); var top=this.Hx(AP); if(top+CS/2>=Ho&&top+CS/2<this.N[1].offsetHeight+Ho)return Au;}} var AJ=this.GetShowedPages(); return _7k(this.XB,AJ[3]>AJ[1]?AJ[2]:AJ[0]);}; _7h.prototype.AddPage=function(name,xml,count,Yd){ var AN=_7i.createElement("B"); AN.Level=-1; AN.Page=1; AN.State=0; AN.Count=count==null?this.PageLength:count; this.XB.appendChild(AN); var Au=AN.previousSibling,HZ=this.Ha(AN,true),CS; AN.Pos=Au&&Au.Pos!=null?Au.Pos+1:this.XB.childNodes.length-1; AN.Name=name?name:"Page "+(AN.Pos+1); if(this.AllPages){ for(var i=0;i<3;i++){ if(Au){CS=Au["r"+i];if(CS)CS=CS.parentNode;} else CS=this.A9(i); if(CS){ var BM=document.createElement("div"); CS.appendChild(BM); if(HZ)BM.style.height=HZ+"px"; BM.className=this.Img.Style+"Page"; AN["r"+i]=BM;}}} if(this.Pager.Visible){ var AM=document.createElement("div"); AM.className=this.Img.Style+"PagerItem"; if(AN.Title)AM.title=AN.Title; if(_7S)AM.noWrap=true; AM.innerHTML=AN.Name; this.Q0.appendChild(AM);} if(xml){ this.NM("<Grid><Body><B Pos='"+AN.Pos+"'>"+xml+"</B></Body></Grid>",{},AN); if(AN.firstChild){ this.Ye(AN); AN.State=2; if(this.MainCol)this.Yf(AN,0,1); var Ht=this.Ha(AN,true); if(Ht&&Ht!=HZ)for(var i=0;i<3;i++)if(AN["r"+i])AN["r"+i].style.height=Ht+"px";}} if(!Yd)this.Update(); return AN;}; _7h.prototype.Yg=function(row,Ci){ this._7l(row); var CS=this.Ha(row,row.Expanded||row.Page)+"px"; for(var i=0;i<3;i++){ var AP=row["r"+i]; if(AP){ if(!row.Page)AP=AP.nextSibling; AP.style.overflow=""; AP.style.height=CS; if(!Ci){ if(row.Page)AP.innerHTML=""; else AP.firstChild.innerHTML="";}}}}; _7h.prototype.ReloadPage=function(row,Ci){ if(row.State<2||row.Page&&this.Paging<3||!row.Page&&this.ChildPaging<3)return; row.Count=this.Ha(row,row.Expanded||row.Page)/this.Hu; if(!row.Count)row.Count=1; if(row.State==4)this.Yg(row,0); if(_7P)row.innerHTML=""; else{row.firstChild=null;row.lastChild=null;}; row.State=1; if(!row.Page){ if(!row.Expanded)row.State=0; else this.Xn(row);} else{ this.StartPage(row);}}; _7h.prototype.RefreshPage=function(row,Ci){ if(row.State!=4)return; this.Yg(row,Ci); row.State=3; if(!row.Page&&!row.Expanded){ if(Ci||this.ChildPaging<2){ this.SM(row); this.Xm(row);} else row.State=2;} else if(Ci||!row.Page&&row.Expanded)this.SM(row); else this.StartPage(row);}; _7h.prototype.GetShowedPages=function(){ if(!this.AllPages){ var AJ=new Array();AJ[0]=this.V;AJ[1]=1;AJ[2]=0; return AJ;} var Yh,R7=this.GetScrollTop(),Yi=R7+this.N[1].clientHeight,AJ=new Array(),Au=0,Yj=0; if(!Yi)Yi++; for(var AP=this.XB.firstChild,Es=0;AP;AP=AP.nextSibling,Es++,Yj=Yh){ var YM=AP.r1?AP.r1.offsetHeight:0; if(AP.Hv){ if(Yj+YM<=R7){ Es+=AP.r1.Count-1; AP=AP.r1.Dn; Yh=Yj+YM; continue;} YM=AP.Height/this.PageLengthDiv;} Yh=Yj+YM; if(Yh<=R7){ continue;} if(Yj>=Yi)break; AJ[Au++]=Es; if(Yj>R7){ if(Yh<=Yi)AJ[Au++]=1; else AJ[Au++]=(Yi-Yj)/YM;} else{ if(Yh<=Yi){ AJ[Au++]=(Yh-R7)/YM; if(this.XB.childNodes.length==1)AJ[Au++]=(R7-Yj)/YM;} else{ AJ[Au++]=(Yi-R7)/YM; AJ[Au++]=(R7-Yj)/YM;}}} return AJ;}; _7h.prototype.YV=function(row){ if(!this.AllPages)return row.r1!=null; if(this.Paging==1)return 1; var top=this.GetScrollTop(),CS; var y=row.r1.offsetTop; if(row.Hv){ for(var AP=row.r1.XZ;AP!=row;AP=AP.nextSibling)y+=AP.Height/this.PageLengthDiv; CS=row.Height/this.PageLengthDiv;} else CS=this.Ha(row,false); if(y<top)return y+CS>top?2:0; var Yk=top+this.N[1].clientHeight; if(y>Yk-CS)return y>Yk?0:2; return 1;}; _7h.prototype.YT=function(){ var R7=this.GetScrollTop(),Yi=R7+this.N[1].clientHeight,AJ=new Array(); if(!Yi)Yi++; for(var Ey=this.XB.firstChild;Ey;Ey=Ey.nextSibling)if(Ey.r1&&Ey.State==4&&Ey.r1.offsetTop+Ey.r1.offsetHeight>R7)break; if(!Ey||Ey.r1.offsetTop>Yi)return[]; for(var AP=this.GetFirstVisible(Ey);AP;AP=this.GetNextVisible(AP,1)){ if(!AP.r1)continue; if(AP.firstChild&&AP.Expanded&&AP._7AZ){ var y=this.Hx(AP)+AP.r1.offsetHeight,CS=AP.r1.nextSibling.offsetHeight; if(y+CS<R7)continue; if(y>Yi)break; var H4=AP.r1.nextSibling.firstChild; for(var i=0,Au=H4.firstChild;Au;i++,Au=Au.nextSibling){ var L7=Au.offsetTop+y,CS=Au.offsetHeight; if(L7+CS<R7)continue; if(L7>Yi)break; if(!Au.firstChild||Au.firstChild.nodeType!=1){ AJ[AJ.length]=AP;AJ[AJ.length]=i;}}}} return AJ;}; _7h.prototype.YU=function(row,EV){ if(!row.r1)return 0; var R7=this.GetScrollTop(),Yi=R7+this.N[1].clientHeight; if(!Yi)Yi++; var BC=this.GetRowChildren(row,1);if(!BC)return; BC=BC.firstChild;if(!BC)return; BC=BC.childNodes[EV];if(!BC)return; var y=this.Hx(row)+row.r1.offsetHeight+BC.offsetTop,CS=BC.offsetHeight; if(y<R7)return y+CS>R7?2:0; if(y>Yi-CS)return y>Yi?0:2; return 1;}; _7h.prototype.Yl=function(row,F6){ var Dh=Get(row,F6+"CopyValue"); if(Dh==null)Dh=this.GetString(row,F6); if(Grids.OnGetCopyValue)Dh=Grids.OnGetCopyValue(this,row,F6,Dh); Dh+=""; if(Dh.search(/[\r\n\t]/)<0)return Dh; return '"'+Dh.replace(/\"/g,'""')+'"';}; _7h.prototype.Ym=function(Ai){ var Gq=GetWindowScroll(); var T=this.Yn(); T.value=Ai; T.focus(); T.select(); _7AK(Gq[0],Gq[1]); return true;}; _7h.prototype.ActionCCopyRow=function(){ var row=this.FRow;if(!row)return false; var Cols=this.GetVisibleCols(true); var Ai=""; for(var i=0;i<Cols.length;i++)Ai+=(i?"\t":"")+this.Yl(row,Cols[i]); Ai+="\r\n"; this.Ym(Ai); return true;}; _7h.prototype.ActionCCopyCell=function(){ if(!this.FRow||!this.FCol)return false; this.Ym(this.Yl(this.FRow,this.FCol)); return true;}; _7h.prototype.ActionCCopyCol=function(){ if(!this.FRow||!this.FCol)return false; var AJ=new Array(),Au=0; for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP)){ AJ[Au++]=this.Yl(AP,this.FCol)+"\r\n";} this.Ym(AJ.join("")); return true;}; _7h.prototype.ActionCCopyColLevel=function(){ if(!this.FRow||!this.FCol)return false; var AJ=new Array(),Au=0; var GP=this.FRow.parentNode; if(GP.Page){for(var AP=this.XB.firstChild;AP;AP=this.GetNextSibling(AP))if(AP.Visible)AJ[Au++]=this.Yl(AP,this.FCol)+"\r\n";} else for(var AP=GP.firstChild;AP;AP=AP.nextSibling)if(AP.Visible)AJ[Au++]=this.Yl(AP,this.FCol)+"\r\n"; this.Ym(AJ.join("")); return true;}; _7h.prototype.ActionCCopySelected=function(){ var AJ=new Array(),Au=0,Cols=this.GetVisibleCols(true); if(this.Yo&&this.Paging!=3){ var row=this.Header; for(var i=0;i<Cols.length;i++){ var Dh=row[Cols[i]+"CopyValue"]; if(Dh==null)Dh=row[Cols[i]]; if(Grids.OnGetCopyValue)Dh=Grids.OnGetCopyValue(this,row,Cols[i],Dh); AJ[Au++]=(i?"\t":"")+Dh;} AJ[Au++]="\r\n";} var CE=this.GetSelRows(); if(!CE.length)return false; for(var i=0;i<CE.length;i++){ var row=CE[i],Ai=""; for(var j=0;j<Cols.length;j++){ if(row.Selected==2&&!row[Cols[j]+"Selected"])continue; Ai+=(j?"\t":"")+this.Yl(row,Cols[j]);} AJ[Au++]=Ai+"\r\n";} this.Ym(AJ.join("")); return true;}; _7h.prototype.ActionExcludeRow=function(){ if(!this.ActionCCopyRow())return false; var T=this;setTimeout(function(){T.ActionDeleteRow(1);},10); return true;}; _7h.prototype.ActionExcludeSelected=function(){ if(!this.ActionCCopySelected())return false; var T=this;setTimeout(function(){T.ActionDeleteSelected();},10); return true;}; _7h.prototype.Yp=function(Ai,Au){ if(!Ai)return; Ai=Ai+""; if(this.Pasting!=1)Au=this.Pasting; if(Au==null)Au=3; var AJ=Ai.split(/\r\n|\n|\r/); if(Ai.search(/(^|[\t\r\n])\"/)>=0){ Ai=Ai.replace(/\\/g,"\\x"); while(1){ var M=Ai.match(/(^|[\t\r\n])\"(\"\"|[^\"\r\n\t])*[\r\n\t](\"\"|[^\"])*\"([\t\r\n]|$)/); if(!M)break; var D3=M[0].split('"'); var Cq=D3[0];D3[0]=""; var H=D3[D3.length-1];D3.length--; D3=Cq+D3.join('"').slice(1).replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g," ").replace(/\"\"/g,'"')+H; Ai=Ai.replace(M[0],D3);} AJ=Ai.split(/\r\n|\n|\r/); for(var i=0;i<AJ.length;i++){ if(AJ[i].indexOf("\\")>=0)AJ[i]=AJ[i].replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\x/g,"\\");}} while(AJ.length&&!AJ[AJ.length-1])AJ.length--; if(!AJ.length)return; if(Au&64){ if(!this.FRow)return; CE=new Array(); for(var AP=Au&32?this.GetFirstVisible():this.FRow;AP;AP=this.GetNextVisible(AP))CE[CE.length]=AP;} else if(Au&128){ if(!this.FRow)return; CE=new Array(); var GP=this.FRow.parentNode; if(GP.Page){for(var AP=Au&32?this.GetFirstVisible():this.FRow;AP;AP=this.GetNextSibling(AP))if(AP.Visible)CE[CE.length]=AP;} else for(var AP=Au&32?GP.firstChild:this.FRow;AP;AP=AP.nextSibling)if(AP.Visible)CE[CE.length]=AP;} else CE=Au&1?this.GetSelRows():new Array(); var X=AJ[0].split("\t"),Cols,CE,Ff=false; if(Au&192){ if(!this.FCol)return; if((Au&12)==4){ Cols=new Array(); for(var BD=this.FCol,i=0;BD&&i<X.length;BD=this.GetNextCol(BD),i++)Cols[Cols.length]=BD;} else Cols=[this.FCol];} else Cols=this.GetVisibleCols(true); if(this.Yo&&this.Paging!=3){ for(var i=0;i<Cols.length;i++)if(X[i]!=this.Yl(this.Header,Cols[i]))break; if(i==Cols.length){ AJ.shift();if(!AJ.length)return; X=AJ[0].split("\t");}} var start=0; if(Au&16||X.length<Cols.length&&(!CE.length||CE[0].Selected!=2)&&!(Au&32)){ for(start=0;start<Cols.length&&Cols[start]!=this.FCol;start++); if(start==Cols.length)start=0;} var Yq=0; if(!CE.length&&this.FRow&&Au&2){ Yq=1; if((Au&12)!=12)CE[0]=this.FRow; if((Au&12)==4)for(var i=1,Cq=this.FRow.nextSibling;i<X.length&&Cq;i++,Cq=Cq.nextSibling)CE[i]=Cq;} if(Grids.OnPaste&&Grids.OnPaste(this,CE,Cols,start,Ai))return; var Db=Cols.length-start; if(CE.length&&CE[0].Selected==2){ Db=0; for(var i in Cols)if(CE[0][Cols[i]+"Selected"])Db++;} if(X.length>Db||!Yq&&CE.length!=AJ.length&&!(Au&192)||Yq&&AJ.length>1&&(Au&12)==0){ if(!confirm(this.GetAlert("ErrPasteRange").replace(/\%d/,AJ.length).replace(/\%d/,X.length).replace(/\%d/,CE.length?CE.length:1).replace(/\%d/,Db)))return; if(start&&X.length>Cols.length-start&&!(Au&16))start=0;} this.QE(); if(Yq&&(Au&12)>=8){ if((Au&12)==12){ CE[0]=this.Yr(null,this.FRow,1); if(!CE[0]){this.QF();return;} this.Focus(CE[0],this.FCol);} var GP=this.FRow.parentNode;if(GP.Page)GP=null; for(var i=1;i<AJ.length;i++){ CE[i]=this.Yr(GP,this.FRow.nextSibling,1);} if(AJ.length>1&&CE[1]==null){this.QF();return;}} var Kl=CE.length>=50&&AJ.length>=50; for(var i=0;i<CE.length&&i<AJ.length;i++)this.Ys(CE[i],Cols,AJ[i],start,Kl); this.QF(); this.Update(); this.UploadChanges(); if(Kl){ var T=this; this.ShowMessage(this.GetText("UpdateGrid")); setTimeout(function(){ T.Calculate(); T.UpdateBody(); var CE=T.GetFixedRows(); for(var i=0;i<CE.length;i++)T.RefreshRow(CE[i]); T.HideMessage(); if(Grids.OnPasteFinish)Grids.OnPasteFinish(T,CE.length?CE:[T.FRow],Cols,start?start:0); T.ShowPages();},10);} else if(Grids.OnPasteFinish)Grids.OnPasteFinish(this,CE.length?CE:[this.FRow],Cols,start?start:0);}; _7h.prototype.Ys=function(row,Cols,Ai,start,Kl){ var AJ=Ai.split("\t"),Ff=false; if(!start)start=0; for(var i=0;i<AJ.length;i++){ if(row.Selected==2){ while(Cols[i+start]&&!row[Cols[i+start]+"Selected"])start++;} var F6=Cols[i+start]; if(!F6||!this.CanEdit(row,F6))continue; var Bb=AJ[i]+""; var size=Get(row,F6+"Size");if(size==null)size=this.Cols[F6].Size; if(Bb.length>size)Bb=Bb.slice(0,size); var DI=this.G0(row,F6,1); if(DI&&Bb.search(new RegExp(DI,""))==-1)continue; var DI=this.G0(row,F6,0); try{ if(DI&&Bb.search(new RegExp(DI,""))==-1){ if(!Grids.OnResultMask||Grids.OnResultMask(this,row,F6,Bb)!=3)continue;}} catch(H){}; Bb=this.QG(row,F6,Bb); if(!this.SetValue(row,F6,Bb,0,0,1))continue; Ff=true; this.RefreshCell(row,F6);} if(Ff&&row.Kind!="Filter"&&!Kl){ this.Recalculate(row,null,true); if(this.ColorClasses&1)this.RefreshRow(row); else this.ColorRow(row);} this.UpdateRowHeight(row); return Ff;}; _7h.prototype.Yn=function(){ var T=Grids.Yt; if(T)return T; T=document.createElement("textarea"); Grids.Yt=T; T.style.position="absolute"; T.style.top="-2500px"; T.rows=100; T.cols=150; if(!this.Rtl)T.style.left="-2500px"; else{}; B2(T); return Grids.Yt;}; _7h.prototype.Yu=function(type){ if(!this.Pasting)return false; if((type&3)==2&&!this.FRow)return false; if((type&3)==1){var CE=this.GetSelRows();if(!CE.length)return false;} var Gq=GetWindowScroll(); var T=this.Yn(),G=this; T.onkeyup=function(){ this.blur(); this.onkeyup=null; G.Yp(this.value,type);}; T.focus(); T.select(); _7AK(Gq[0],Gq[1]); setTimeout(function(){_7AK(Gq[0],Gq[1]);},10); return true;}; _7h.prototype.ActionPasteToRow=function(){return this.Yu(2);}; _7h.prototype.ActionPasteToRowFill=function(){return this.Yu(6);}; _7h.prototype.ActionPasteToRowAdd=function(){return this.Yu(10);}; _7h.prototype.ActionPasteToNewRow=function(){return this.Yu(14);}; _7h.prototype.ActionPasteToSelected=function(){return this.Yu(1);}; _7h.prototype.ActionPasteToRowFirst=function(){return this.Yu(2+32);}; _7h.prototype.ActionPasteToRowFillFirst=function(){return this.Yu(6+32);}; _7h.prototype.ActionPasteToRowAddFirst=function(){return this.Yu(10+32);}; _7h.prototype.ActionPasteToNewRowFirst=function(){return this.Yu(14+32);}; _7h.prototype.ActionPasteToSelectedFirst=function(){return this.Yu(1+32);}; _7h.prototype.ActionPasteToCol=function(){return this.Yu(2+64);}; _7h.prototype.ActionPasteToColLevel=function(){return this.Yu(2+128);}; _7h.prototype.ActionPasteToColFill=function(){return this.Yu(6+64);}; _7h.prototype.ActionPasteToColFillLevel=function(){return this.Yu(6+128);}; _7h.prototype.ActionPasteToColFirst=function(){return this.Yu(2+32+64);}; _7h.prototype.ActionPasteToColLevelFirst=function(){return this.Yu(2+32+128);}; _7h.prototype.ActionPasteToColFillFirst=function(){return this.Yu(6+32+64);}; _7h.prototype.ActionPasteToColFillLevelFirst=function(){return this.Yu(6+32+128);}; _7h.prototype.GetPrintable=function(HQ,type,Rx,Cs,AJ,Au,Ey,AO,Em,Yv,Md){ if(HQ==null)HQ=type>>4; if(!HQ)HQ=31; if(this.CancelProgress){ this.HideMessage(); this.CancelProgress=0; return;} var T=this,Bg=type&2?0:1,UV=this.Rtl?" dir='rtl'":"",Yw=type&512; var Yx=this.KJ?"<td></td>":""; function GetRow(row){ var P1=[[],[],[]]; T.KY(row,P1[0],P1[1],P1[2]); AJ[Au++]=T.P4(row)+P1[0].join("")+P1[1].join("")+P1[2].join("")+"</tr>";}; function Yy(row,Bi){ var P1=[[],[],[]]; T.P3(row,P1[0],P1[1],P1[2]); if(Bi)AJ[Au++]="<tr><td colspan='"+(P1[0].Yz+P1[1].Yz+P1[2].Yz)+"'>"; AJ[Au++]=T.P2(row)+P1[0].join("")+P1[1].join("")+P1[2].join("")+"</tr>";}; function Y0(Y1){ var B3=""; for(var AP=T.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Space==Y1&&AP.Visible){ AJ[Au++]="<tr><td><div class='"+T.Img.Style+AP.Kind+"Row"+" style='width:"+(AP.r1.offsetWidth-Yv.A5)+"px'>"+T.Xh(AP)+"</td></tr>";}}; if(!Ey){ this.Y2=1; Yv=[];Yv.A5=0; if(!(HQ&32))for(var BD in this.Cols)if(this.Cols[BD].Type=="Panel"&&this.Cols[BD].Visible){ Yv[Yv.length]=BD; this.Cols[BD].Visible=0; Yv.A5+=this.Cols[BD].Width;} Md=this.FRow;this.FRow=null; AJ=new Array(),Au=0; AJ[Au++]=_7A+" id='GridPrintID' class='"+this.Img.Style+"MainTable'"+_7B; if(HQ&1&&HQ&16)Y0(0);} if(!Ey||Yw){ if(Yw)AJ[Au++]=_7C+_7A+"style='page-break-before:always;' class='"+this.Img.Style+"MainTable'"+_7B; var R=this.GetRows(this.XH); if(R.length>0&&HQ&2||HQ&1){ AJ[Au++]="<tr><td><div class='"+this.Img.Style+"HeadMid'>"; for(var i=0;i<R.length;i++){ if(R[i].Kind=="Header"&&R[i].Visible&&!(HQ&1))R[i].Visible=0; else if(R[i].Kind!="Header"&&R[i].Visible&&(!(HQ&2)||Yw))R[i].Visible=0; else delete R[i];} Yy(this.XH); var AN=this.GetRows(this.XH);for(var i=0;i<AN.length;i++)GetRow(AN[i]); for(var i=0;i<R.length;i++)if(R[i])R[i].Visible=1; AJ[Au++]=_7C+"</div></td></tr>";}} if(!Ey&&HQ&2&&HQ&16)Y0(1); if(HQ&8){ if(!Ey||Yw){ AJ[Au++]="<tr><td><div class='"+this.Img.Style+"BodyMid'>"; Yy(this.XB.firstChild);} if(!Ey){ for(Em=0,Ey=this.GetFirstVisible();Ey;Ey=this.GetNextVisible(Ey,Bg))Em++; Ey=this.GetFirstVisible(); AO=0;} else if(Yw){ for(var AP=Ey.parentNode,X=[];!AP.Page;AP=AP.parentNode)X[X.length]=AP; for(var i=X.length-1;i>=0;i--)Yy(X[i],1);} while(Ey){ var Kg=Ey.Expanded; if(Bg==0)Ey.Expanded=1; GetRow(Ey); Ey.Expanded=Kg; var Es=this.GetNextVisible(Ey,Bg); if(Es&&Es.Level>Ey.Level)Yy(Ey,1); else if(!Es||Es.Level<Ey.Level)for(var i=Es?Es.Level:0;i<Ey.Level;i++)AJ[Au++]=_7C+"</td></tr>"; Ey=Es; if(this.PrintRows&&Ey&&Rx){ AO++; if(!(AO%this.PrintRows)){ if(Yw){ for(var i=0;i<Ey.Level;i++)AJ[Au++]=_7C+"</td></tr>"; AJ[Au++]=_7C+"</div></td></tr>";} this.ShowMessage(this.GetText("ExportProgress").replace('%d',AO).replace('%d',Em).replace('%d',Math.floor(AO/Em*100)).replace('%d',this.K+".CancelProgress=1;")); setTimeout(function(){ T.GetPrintable(HQ,type,Rx,Cs,AJ,Au,Ey,AO,Em,Yv,Md);},10); return;}}} AJ[Au++]=_7C+"</div></td></tr>";} if(HQ&4&&HQ&16)Y0(2); var R=this.GetRows(this.XF); if(HQ&4&&R.length>0){ AJ[Au++]="<tr><td><div class='"+this.Img.Style+"FootMid'>"; Yy(this.XF); for(var i=0;i<R.length;i++)if(R[i].Visible)GetRow(R[i]); AJ[Au++]=_7C+"</div></td></tr>";} if(HQ&4&&HQ&16)Y0(3); AJ[Au++]=_7C; for(var i=0;i<Yv.length;i++)this.Cols[Yv[i]].Visible=1; this.FRow=Md; this.Y2=0; if(Rx&&Cs){ this.HideMessage(); Cs.apply(Rx,[AJ.join("")]);} else return AJ.join("");}; _7h.prototype.ActionPrint=function(){ this.Debug(4,"Printing grid");this.LB("Print"); this.GetPrintable(null,this.PrintType,this,this.Y3); return true;}; _7h.prototype.Y3=function(Bb){ this.Debug(4,"TreeGrid generated print report in ",this.LC("Print")," ms"); var A5=window.open("","TreeGridPrint",this["PrintWindowProp"],false); if(!A5){ alert(this.GetAlert("ErrPrintOpen")); return;} try{ var AJ,P1=""; if(this.PrintCSS)P1='<link href='+this.PrintCSS+' type="text/css" rel="stylesheet"/>'; else{ var S=document.styleSheets; if(!S)S=document.getElementsByTagName("link"); if(S){ for(var i=0;i<S.length;i++)P1+='<link href='+S[i].href+' type="text/css" rel="stylesheet"/>';}}; var Y4=this.PrintPrefix?this.PrintPrefix:""; var GR=(this.PrintPostfix?this.PrintPostfix:""); if(Grids.OnPrint){ AJ=Grids.OnPrint(this,A5); if(AJ==true)return; if(AJ&&AJ.length){Y4=AJ[0];GR=AJ[1];}} if(!_7K||_7I)A5.document.write(this.GetText("Print")); A5.document.close(); this.ShowMessage(this.GetText("Printed")); var T=this; setTimeout(function(){ try{ if(_7O)A5.document.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">'); A5.document.write('<html><head>'+P1+'</head><body'+(this.Rtl?" dir='rtl'":"")+'>'+Y4+Bb+GR+'</body></html>'); Bb=null; A5.document.close(); A5.focus(); if(Grids.OnPrintFinish&&Grids.OnPrintFinish(T,A5))return; if(!A5.closed){A5.print();A5.close();} T.HideMessage();} catch(H){T.HideMessage();}},10);} catch(H){alert(this.GetAlert("ErrPrint"));this.HideMessage();}}; _7h.prototype.Rerender=function(){ if(this.Source.Sync)this.Render(); else{ this.ShowMessage(this.GetText("Render")); var T=this;setTimeout(function(){T.Render();},10);}}; _7h.prototype.Render=function(){ if(this.Rendering)return false; if(Grids.OnRenderStart&&Grids.OnRenderStart(this))return false; this.Debug(4,"Rendering TreeGrid");this.LB("Render"); this.Rendering=true; this.Y5(); this.Y6(); this.LB("RenderPost"); this.Y7(); this.LC("RenderPost");this.LB("RenderUpdate"); this.Rendering=false; this.HideMessage(); this.Ne(); this.Update(); if(this.FRow){ var Cq=this.FRow;this.FRow=null; this.Focus(Cq,this.FCol,this.FPagePos,1);} if(this.N[1].style.display=="none")this.XB.firstChild.State=4; this.ShowPages(); if(Grids.OnRenderFinish)Grids.OnRenderFinish(this); if(this.Paging<2||!this.AllPages||this.XB.childNodes.length==1){ if(Grids.OnRenderPageStart)Grids.OnRenderPageStart(this,this.XB.firstChild); if(Grids.OnRenderPageFinish)Grids.OnRenderPageFinish(this,this.XB.firstChild);} var Ak=this.Nf("Render"),L1=this.PB("UpdateHeights");if(!L1)L1=0; if(Ak&&L1>2000){ for(var AP=this.GetFirstVisible(),i=0,B3="";AP&&i<5;AP=this.GetNextVisible(AP),i++)B3+=this.GetRowHeight(AP)+"px, "; this.Debug(2,"Updating row heights is very slow, because too many rows are higher than their or default row height ("+this.Hu+"px), try to set the rows' heights by Height attribute. Now the first five rows have these heights: ",B3);} if(Ak)this.Debug(4,"TreeGrid rendered in ",Ak," ms (create HTML: ",this.PB("RenderCreate")," ms, set HTML: ",this.PB("RenderSet")," ms, update events: ",this.PB("RenderPost")," ms, update scrollbars: ",this.LC("RenderUpdate")-L1," ms, update row heights: ",L1," ms)"); var Ak=this.Nf("TreeGrid"); if(Ak)this.Debug(4,"TreeGrid completed in full time ",Ak," ms"+(this.Paging>=2?" (without rendering pages)":"")+(Grids.length>1?" (it is an exact time from starting and is affected by processing other grids)":""));}; _7h.prototype.Y5=function(){ this.SetVPos(); if(this.Dialog)this.Dialog.Close(); this.Clear(2); if(this.MainTag.offsetWidth==0){ var Fr=document.createElement("div"),M=this.MainTag,AJ=GetWindowSize(); Fr.style.width=AJ[0]-40+"px"; Fr.style.height=AJ[1]-40+"px"; Fr.style.overflow="hidden"; Fr.className="GridTmpTag"; B2(Fr); this.PX=M; this.MainTag=Fr;}}; _7h.prototype.Y8=function(row,F6){ return this.HW.rows[row].cells[F6];}; if(window.LZD)window.LZD=2; else if(!window.LZD&&typeof(window.LZD)=="object")window.LZD=1; _7h.prototype.Y7=function(){ var M=this.MainTag.firstChild;while(M&&M.tagName.toLowerCase()!="table")M=M.nextSibling; this.HW=M; var S=new Array(); for(var i=0;i<6;i++)S[i]=i; S[5]--; function Y9(B3){return _7P?new Function(B3):new Function("event",B3);}; for(var i=0;i<6;i++){ for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){ var KP=AP.Space; if(KP==i){ AP.r1=this.Y8(S[KP],0).firstChild; AP.r1.onmousemove=Y9(this.K+".SpaceMouseMove(event,"+AP.Pos+");"); for(var k=KP;k<6;k++)S[k]++;}}} for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){ if(AP.Tag){ var Ak=GetElem(AP.Tag); if(Ak){ Ak.innerHTML="<div class='"+this.Img.Style+AP.Kind+"Row'>"+this.Xh(AP)+"</div>"; Ak.onmousemove=Y9(this.K+".SpaceMouseMove(event,"+AP.Pos+");"+this.K+".GridMouseMove(event);"); Ak.onmousedown=Y9(this.K+".GridMouseDown(event);"); Ak.onclick=Y9(this.K+".GridClick(event);"); AP.r1=Ak.firstChild;} else{}}} var HU=this.GetSections(); for(var i=0;i<3;i++){this.L[i]=0;this.N[i]=0;this.O[i]=0;} for(var i=HU[0];i<HU[1];i++){ this.L[i]=this.Y8(S[0],i-HU[0]).firstChild; this.N[i]=this.Y8(S[1],i-HU[0]).firstChild; this.O[i]=this.Y8(S[2],i-HU[0]).firstChild;} if((this["C"+"od"+"e"]+"").search(/[BPGS][GPTR][A-G][SEC]/)<0)Get=Is; this.Qt=this.Y8(S[0],HU[1]-HU[0]).firstChild; this.RG=_7AG(this.Qt,"div")[0]; this.ZA=_7AG(this.RG,"div")[0]; this.Qu=this.Y8(S[3],this.ShortHScroll&&this.GetFirstCol(0)?1:0).firstChild; this.RI=_7AG(this.Qu,"div")[0]; this.ZB=_7AG(this.RI,"div")[0]; this.ZC=this.Y8(S[3],this.ShortHScroll?(this.GetFirstCol(0)?1:0)+(this.GetFirstCol(2)?1:0)+1:1).firstChild; if(_7Q&&this.N[1].offsetWidth)this.N[1].style.width=(this.N[1].offsetWidth-this.Img.Wv)+"px"; this.Qv=this.Y8(S[0],HU[1]-HU[0]+1).firstChild; if(this.Paging){ this.NE=this.Qv.firstChild; this.Qy=this.NE.nextSibling; this.Q0=this.Qy.firstChild.firstChild; this.YO=this.Q0.nextSibling;} if(!_7P&&this.N[1].addEventListener&&!this.NoVScroll){ var Cs=new Function("event","if(!"+this.K+".GridMouseWheel(event,-event.detail*40)) event.preventDefault();"); for(var i=HU[0];i<HU[1];i++)this.N[i].addEventListener('DOMMouseScroll',Cs,false);} var T=this,V2=new Function(this.K+".ARow=this.row;"+this.K+".ASec=0;"); function UpdateRows(CE,CS){ for(k=0;k<CE.length;k++){ if(!CE[k].Visible)continue; for(i=HU[0];i<HU[1];i++){ CE[k]["r"+i]=CS[i]; CS[i].row=CE[k]; CS[i].onmousemove=V2; CS[i]=CS[i].nextSibling;} T.UpdateRowHeight(CE[k]);}}; var CS=new Array(),i,k,CE; if(this.L[1]){ for(i=HU[0];i<HU[1];i++){CS[i]=this.L[i].firstChild.rows[1];if(_7G)CS[i]=CS[i].firstChild;} CE=this.GetRows(this.XH); UpdateRows(CE,CS);} if(this.O[1]){ for(i=HU[0];i<HU[1];i++){CS[i]=this.O[i].firstChild.rows[1];if(_7G)CS[i]=CS[i].firstChild;} CE=this.GetRows(this.XF); UpdateRows(CE,CS);} this.XY(); if(!Grids.ZD){ Grids.ZD=true; AttachEvent(document,"keydown",_7Am); AttachEvent(document,"keypress",_7Ao); AttachEvent(document,"keyup",_7An); if(_7N&&window.top!=window){ try{ var AS=window.top.document; AttachEvent(AS,"keydown",_7Am); AttachEvent(AS,"keypress",_7Ao); AttachEvent(AS,"keyup",_7An);} catch(H){}} AttachEvent(document,"mousewheel",_7y); AttachEvent(document,"click",_7Ap); AttachEvent(window,"unload",_7Ak); AttachEvent(document,"mousemove",DocMouseMove); AttachEvent(document,"mouseup",_7Ar); AttachEvent(document,"mouseout",_7Aq); if(window.LZD!=1)for(var i in this)if(Math.random()>0.95)this[i]=null;} this.YL(); if(this.PX){ while(this.MainTag.firstChild)this.PX.appendChild(this.MainTag.firstChild); document.body.removeChild(this.MainTag); this.MainTag=this.PX; this.PX=null;} this.UpdatePos(); if(!this.MainTag.onresize)this.MainTag.onresize=new Function("if("+this.K+")"+this.K+".Update()");}; _7h.prototype.KY=function(row,ZE,ZF,ZG,ZH,Cell,ZI,ZJ){ var T=this,Cols=this.Cols,KH=this.MainCol,AI=this.Img,DY=this.Lang.Format; var AS=row.Def,AY=" "+AI.Style,ZK=AY+"Color",ZL=" "+AI.ZM; var ZN=Grids.OnGetType!=null,ZO=Grids.OnCanEdit!=null,ZP=Grids.OnGetHtmlValue!=null; var ZQ=Grids.OnGetDefaultColor!=null,ZR=Grids.OnGetColor!=null,ZS=Grids.OnGetClass!=null,ZT=Grids.OnGetFormat!=null; var RF=row.Space!=null,GC=row.Kind=="Header",Yb=row.Fixed,ZU=row.Kind=="Filter",ZV=row==this.ARow&&this.Hover>=1,Yq=row==this.FRow; var ZW=row.Calculated,ZX=row.Spanned,ZY=row.G4; var ZZ=row.Class;if(ZZ==null)ZZ=AS.Class; if(!ZZ)ZZ="";else ZZ=ZL+ZZ; var Fa=this.ColorClasses,Za=Fa&48,Zb=Fa&32,Zc=Fa&8,Zd,Og=0; var Ze="",Zf="",Zg=0; var max=row.MaxHeight;if(max==null)max=AS.MaxHeight; if(max){ Ze="<div style='"+(_7T||_7Q?"height:expression(this.scrollHeight<"+max+"?\"\":\""+max+"px\");":"max-height:"+max+"px;")+"overflow:hidden;'>";Zf="</div>"; Zg=row.MaxHeightAll;if(Zg==null)Zg=AS.MaxHeightAll;if(Zg==null)Zg=Yb?1:0;} var Zh=this.Editing||ZU||RF&&(row.Kind=="Group"||row.Kind=="Search"); var Zi=row.CanFocus;if(Zi==null)Zi=AS.CanFocus; var Zj=row.CanEdit;if(Zj==null)Zj=AS.CanEdit;if(Zj==null)Zj=1; var Zk=row["NoColor"];if(Zk==null)Zk=AS["NoColor"]; var Zl="",Zm=this.f; var Zn=row.Color;if(!Zn)Zn=AS.Color; if(Zn)Zn=this.Xb(Zn); else Zn=Zm[RF?"DefaultSpace":(GC?"DefaultHeader":"Default")]+0xFFFFFF; var Zo=0; if(row.ColorPos==1){ alt=row["AlternateColor"];if(!alt)alt=AS["AlternateColor"]; if(alt)Zo=this.Xb(alt)-0xFFFFFF; else Zo=Zm["Alternate"]; if(Fa&64){ var alt=row["AlternateClass"];if(!alt)alt=AS["AlternateClass"]; if(alt)Zl+=ZL+alt; else Zl+=ZK+"Alternate";}} var Zp=0,UY=this.SearchAction=="Mark";if(UY)UY=this.SearchType&256?2:1; var Zq=row["Detail"];if(Zq==null)Zq=AS["Detail"]; if(Zq){ if(row.DetailRow){Zp+=Zm["DetailSelected"];Zl+=ZK+"DetailSelected";} else{Zp+=Zm["Detail"];Zl+=ZK+"Detail";}} var Zr=0; if(ZV&&this.Hover==2){ if(GC)Zr=Zm["HoveredHeader"]; else Zr=Zm["Hovered"];} if(Yq){Zp+=Zm["Focused"];Zl+=ZK+"Focused";} if(row.LN){Zp+=Zm["ChildPage"];Zl+=ZK+"ChildPage";} if(row.Selected-0){ Zd=Fa&2; if(row.Selected==1){ Zp+=Zm["Selected"]; if(Zd)Zl+=ZK+"Selected";} else Og=1;} var Zs=0,Zt=row.NoColorState,Ff=row.Changed-0,Zu=Fa&1; if(!Zt){ if(row.Deleted-0){Zs=Zm["Deleted"];if(Zu)Zl+=ZK+"Deleted";} else if(row.Added-0){Zs=Zm["Added"];Zl+=ZK+"Added";} else if(Ff){Zs=Zm["Changed"];if(Zu)Zl+=ZK+"Changed";} else if(row.Moved){Zs=Zm["Moved"+row.Moved];if(Zu)Zl+=ZK+"Moved"+row.Moved;}} var P1=[ZE,ZF,ZG]; for(var j=0;j<3;j++){ var Jf,AJ=P1[j];if(!AJ&&ZH!=3)continue; if(Cell){ if(j)continue; Jf=[Cell];} else if(RF){ Jf=row.Cells; if(!Jf){AJ[AJ.length]="<td></td>";continue;} var Zv=0;} else Jf=this.ColNames[j]; var Db=Jf.length,Eu=""; var G5=_7AQ[j]; if(row[G5]!=null||AS[G5]!=null){ if(Cell)return ""; var HR=0; for(var i=0;i<Db;i++){ var BD=Jf[i],C=Cols[BD]; if(C.Visible==0&&!C.Hidden)continue; if(C.WidthPad)HR++; if(BD==KH&&!row.Fixed)HR++; HR++;} AJ[AJ.length]="<td class='"+AY+"CellUser"+AY+"User' colspan='"+HR+"'>"+Get(row,G5)+"</td>"; continue;} for(var i=0;i<Db;i++){ var F6=Jf[i],C=Cols[F6]; if(!C)C=this.Def["C"]; if(C.Visible==0&&!C.Hidden&&ZH!=3&&!RF){ if(!ZX)continue; var HR=row[F6+"Span"];if(HR==null)HR=AS[F6+"Span"]; if(!(HR>1))continue; var J0=this.ColNames[j]; for(var k=0;k<J0.length&&F6!=J0[i];k++); for(k++;k<J0.length&&HR>1;k++,HR--)if(Cols[J0[k]].Visible||Cols[J0[k]].Hidden)break; if(HR<=1||k==J0.length)continue;} var Zw=""; if(ZY){ var HR=row[F6+"RowSpan"]; if(HR=="0"&&row.previousSibling)continue; if(HR>1&&C.Spanned)Zw=" rowspan='"+HR+"'";} var Zx=row[F6+"Class"];if(Zx==null)Zx=AS[F6+"Class"];if(Zx==null)Zx=C.Class; if(!Zx)Zx=ZZ; else Zx=ZL+Zx+ZZ; if(ZS){ var OV=Grids.OnGetClass(this,row,F6,Zx); if(OV!=null)Zx=OV;} var Q7=F6+"Type",type=row[Q7]; if(type==null){ type=AS[Q7]; if(type==null){ type=C.Type; if(ZU&&!_7AP[type]&&type!="Panel"&&F6!="_ConstWidth")type="Text";}} if(ZN)type=Grids.OnGetType(this,row,F6,type); var Yv=type=="Panel",Zy=type=="Button"; var BN,G3=row[F6+"CanFocus"]; if(G3==null){ G3=AS[F6+"CanFocus"]; if(G3==null){ if(!Zi)G3=0; else G3=C.CanFocus==null?!Yv&&!Zy:C.CanFocus;}} if(!G3&&type!="Bool"&&type!="Radio"&&type!="Enum")BN=0; else if(Zh){ BN=row[F6+"CanEdit"]; if(BN==null){ BN=AS[F6+"CanEdit"]; if(BN==null){ if(ZU)BN=type!="Pass"&&C.CanFilter>0; else if(Zj!=1)BN=Zj?2:0; else if(ZW){ BN=row[F6+"Formula"]; if(BN==null)BN=AS[F6+"Formula"]; BN=BN?0:(C.CanEdit!=null?C.CanEdit:_7AP[type]);} else if(C.CanEdit!=null)BN=C.CanEdit; else BN=C.Formula?0:_7AP[type];}} if(Zh==2&&BN==1&&!ZU)BN=2; if(ZO)BN=Grids.OnCanEdit(this,row,F6,BN);} else BN=0; var QQ="",Zz=row[F6+"NoColor"],OV="";if(Zz==null){Zz=AS[F6+"NoColor"];if(Zz==null){Zz=Zk;if(Zz==null)Zz=C.NoColor;}} if(!Zz){ var Xc=row[F6+"Color"];if(Xc==null)Xc=AS[F6+"Color"]; if(Xc)Xc=this.Xb(Xc); else Xc=Zn; Xc+=Zo; if(Yv)Xc=Zm["DefaultPanel"]+0xFFFFFF; if(Zy)Xc=Zm["DefaultButton"]+0xFFFFFF; if(ZQ){var BD=Grids.OnGetDefaultColor(this,row,F6,Xc);if(BD!=null)Xc=BD;} var Z0=Zl; if(ZV&&F6==this.ACol){ if(GC){Xc+=Zm["HoveredCellHeader"];if(Za)Z0+=ZK+"HoveredCellHeader";} else if(Yv){ if(this.FastPanel){Xc+=Zm["HoveredCellFastPanel"];if(Za)Z0+=ZK+"HoveredCellFastPanel";} else{Xc+=Zm["HoveredCellPanel"];if(Za)Z0+=ZK+"HoveredCellPanel";}} else if(Zy){Xc+=Zm["HoveredCellButton"];if(Za)Z0+=ZK+"HoveredCellButton";} else if(!G3){Xc+=Zm["HoveredCellNoFocus"];if(Zb)Z0+=ZK+"HoveredCellNoFocus";} else if(!BN){Xc+=Zm["HoveredCellReadOnly"];if(Zb)Z0+=ZK+"HoveredCellReadOnly";} else{Xc+=Zm["HoveredCell"];if(Zb)Z0+=ZK+"HoveredCell";}} else Xc+=Zr; if(GC||Yv|Zy); else if(!G3){ if(RF){Xc+=Zm["NoFocusSpace"];Z0+=ZK+"NoFocusSpace";} else{Xc+=Zm["NoFocus"];Z0+=ZK+"NoFocus";}} else if(!BN){ if(RF){Xc+=Zm["ReadOnlySpace"];Z0+=ZK+"ReadOnlySpace";} else{Xc+=Zm["ReadOnly"];Z0+=ZK+"ReadOnly";}} else if(BN==2){Xc+=Zm["Preview"];Z0+=ZK+"Preview";} Xc+=Zp; if(Og){ var Cp=row[F6+"Selected"];if(Cp==null)Cp=AS[F6+"Selected"]; if(Cp){ Xc+=Zm["Selected"]; if(Zd)Z0+=ZK+"Selected";}} if(!Zt){ var NH=row[F6+"Error"];if(NH==null)NH=AS[F6+"Error"]; if(NH){Xc+=Zm["Error"];Z0+=ZK+"Error";} else{ if(Ff&&row[F6+"Changed"]-0){Xc+=Zm["ChangedCell"];Z0+=ZK+"ChangedCell";} Xc+=Zs;}} if(UY){ if(UY==2){ if(row.OG)Xc=row.OG; if(row[F6+"MarkColor"])Xc=row[F6+"MarkColor"];} else{ if(row.OG)Xc+=row.OG; if(row[F6+"MarkColor"])Xc+=row[F6+"MarkColor"];}; if(Zc){ var Z1=row.OH;if(Z1)Z0+=ZK+Z1; Z1=row[F6+"MarkClass"];if(Z1)Z0+=ZK+Z1;}} if(Yq&&F6==this.FCol){Xc=Zm["FocusedCell"]+0xFFFFFF;Z0+=ZK+"FocusedCell";} if(ZR)OV=Grids.OnGetColor(this,row,F6,(Xc>>16)&255,(Xc>>8)&255,Xc&255,0); if(OV){ Xc=OV; QQ=" style='background-color:"+Xc+"'";} else if(Xc>=0&&Xc<16777215){ if(Xc<1048576){ Xc=Number(Xc).toString(16); while(Xc.length<6)Xc='0'+Xc; QQ=" style='background-color:#"+Xc+"'";} else{ Xc=Number(Xc).toString(16); QQ=" style='background-color:#"+Xc+"'";}; Xc="#"+Xc;} else Xc="";} else{Xc="";Z0="";}; if(ZH==2){ AJ[AJ.length]=Z0; AJ[AJ.length]=Xc; if(ZX){ var HR=row[F6+"Span"];if(HR==null)HR=AS[F6+"Span"]; if(HR>1)i+=HR-1;} continue;} var RB=F6+"Button",Bo=row[RB],Z2=0;if(Bo==null){Bo=AS[RB];if(Bo==null)Bo=C.Button;} var RC=F6+"RightButton",RD=row[RC];if(RD==null){RD=AS[RC];if(RD==null)RD=C.RightButton;} function Z3(Bo){ if(Bo=="Defaults"){return RF?"DefaultsSpace":"Defaults";} else if(Bo=="Filter"){ if(!BN)return ""; var RB=F6+"Filter",UN=row[RB];if(UN==null)UN=AS[RB];if(UN==null)UN=0; return Bo+UN;} else if(Bo=="Sort"){ if(T.SortIcons==0)return ""; var Wo=0,Z4=T["ReversedSortIcons"],Vm=T.W; for(var k=0,Af=0;k<Vm;k++){ if(T.SortCols[k]==F6){Wo=(T.SortTypes[k]&1?(Z4?1:4)+Af:(Z4?4:1)+Af);break;} var HU=Cols[T.SortCols[k]]; if(Af<2&&HU&&(HU.Visible||HU.CanHide))Af++;} return Bo+Wo;} return Bo;}; if(Bo){ if(Bo=="None")Bo=""; else Bo=Z3(Bo);} if(RD){ if(RD=="None")RD=""; else RD=Z3(RD);} if(Bo==null&&BN){ if(type=="Date"&&RD!="Date"&&!this.AutoCalendar){Bo="DateRight";GM=1;} else if(type=="Enum"&&RD!="Enum"){ Bo="EnumLeft";GM=0;}} else if(Bo){ var RB=F6+"ButtonPos",GM=row[RB];if(GM==null){GM=AS[RB];if(GM==null)GM=GC?1:C.ButtonPos;} if(GM==0)Bo+="Left"; else if(GM!=3)Bo+="Right";} var PK=row[F6+"Visible"];if(PK==null)PK=AS[F6+"Visible"]; if(PK<=0){ type="Hidden"; if(PK<0||RF){Bo="";RD="";if(PK==-2)Zx+=AY+"CellHidden";}} var Bb=row[F6];if(Bb==null)Bb=AS[F6]; if(ZI)Bb=ZI; if(ZP){ var Dh=Grids.OnGetHtmlValue(this,row,F6,Bb); if(Dh!=null){Bb=Dh;type="Html";}} var Cq=row[F6+"Format"];if(Cq==null){Cq=AS[F6+"Format"];if(Cq==null)Cq=C.Format;} if(ZT)Cq=Grids.OnGetFormat(this,row,F6); var Z5=type; switch(type){ case "Text": if(Cq)Bb=DY.Ez(Bb,Cq,this.NoFormatEscape?1:2); else if(typeof(Bb)=="string"){ if(Bb.search(DY.EL)>=0)Bb=Bb.replace(DY.EQ,"&amp;").replace(DY.ER,"&lt;"); if(Bb.indexOf(" ")>=0)Bb=Bb.replace(DY.EO,_7D);} else if(Bb==null)Bb=""; else Bb+=""; if(!Bb){Bb=row[F6+"EmptyValue"];if(Bb==null){Bb=AS[F6+"EmptyValue"];if(Bb==null)Bb=C.Z6;}} if(!Bb)Bb=_7D; if(Zg)Bb=Ze+Bb+Zf; break; case "Int": case "Float": if(Bb===""&&DY.EmptyNumber!=null)Bb=DY.EmptyNumber; else{ var EX=row[F6+"Range"];if(EX==null){EX=AS[F6+"Range"];if(EX==null)EX=C.Range;} Bb=DY.NumberToString(Bb,Cq,EX?2:0);}; if(Bb==""||Bb==" ")Bb=_7D; else if(!this.NoFormatEscape&&Cq)Bb=DY.Escape(Bb); if(Zg)Bb=Ze+Bb+Zf; break; case "Date": if(Bb===""&&DY.EmptyDate!=null)Bb=DY.EmptyDate; else{ var EX=row[F6+"Range"];if(EX==null){EX=AS[F6+"Range"];if(EX==null)EX=C.Range;} Bb=DY.DateToString(Bb,Cq,EX?2:0);}; if(!Bb||Bb==" ")Bb=_7D; else if(!this.NoFormatEscape&&Cq)Bb=DY.Escape(Bb); if(Zg)Bb=Ze+Bb+Zf; break; case "Bool": if(this.Y2||Cq==1)Bb="<input type=checkbox "+(this.Y2||!BN?"disabled"+_7E:"")+" "+(Bb-0?" checked"+_7E:"")+" class='"+AY+"BoolInput'>"; else if(_7T||Cq==2||Bo)Bb=this.Z7("Bool"+(Bb?1:0)+(RF?"Space":"")+(BN?"":"RO")); else{Z5="Bool"+(Bb?1:0)+(RF?"Space":"")+(BN?"":"RO");Bb=_7D;}; if(Zg)Bb=Ze+Bb+Zf; break; case "Enum": Bb=this.HB(row,F6,1); if(!Bb||Bb==" ")Bb=_7D; if(Zg)Bb=Ze+Bb+Zf; break; case "Lines": Bb=DY.Ez(Bb,Cq,this.NoFormatEscape?1:2); if((!Bb||Bb==0)&&Bb!="0")Bb=_7D; Bb=Ze+Bb+Zf; break; case "Html": if(Bb==""||Bb==null)Bb=_7D; Bb=Ze+Bb+Zf; break; case "Img": if(!Bb||typeof(Bb)!="string")Bb=_7D; else{ Bb=Bb.split(Bb.charAt(0)); if(Bb[1]=="")Bb=_7D; else{ var LT="",GR=""; if(Cq){ var EW=this.s[Cq]; if(!EW){EW=Cq.split(Cq.charAt(0));this.s[Cq]=EW;} if(EW[3])LT=EW[3]; if(EW[4])GR=EW[4]; Bb[1]=(EW[7]&1&&this.BaseUrl?this.BaseUrl:"")+(EW[1]?EW[1]:"")+Bb[1]+(EW[2]?EW[2]:""); if(Bb[6])Bb[6]=(EW[7]&2&&this.BaseUrl?this.BaseUrl:"")+(EW[5]?EW[5]:"")+Bb[6]+(EW[6]?EW[6]:"");} var Cu=Bb[6]&&BN!=1; if(Cu){ LT+="<a href='"+DY.Escape(Bb[6])+"' onclick='CancelEvent(event,2);'>"; GR="</a>"+GR; Bb[6]="";} if(!Bb[4]||!Bb[5]){ if(Bb[3]&&_7N){ LT="<div style='overflow:hidden;height:"+Bb[3]+"px;'>";GR="</div>";} Bb=LT+"<img border='0'"+(Bb[2]?" width='"+Bb[2]+"'":"")+(Bb[3]?" height='"+Bb[3]+"'":"")+" src='"+this.Ae(DY.Escape(Bb[1]))+"'"+(Cu?" style='"+_7b+"' title='"+DY.Escape(Bb[6])+"'":"")+"/>"+GR;} else Bb=LT+(_7T?"<span><b":"<div")+" style='"+(Cu?_7b:"")+"width:"+Bb[2]+"px;height:"+Bb[3]+"px;overflow:hidden;background:url("+this.Ae(DY.Escape(Bb[1]))+") -"+Bb[4]+"px -"+Bb[5]+"px;'"+(Cu?" title='"+DY.Escape(Bb[6])+"'":"")+">"+(_7T?"</span></b>":"</div>")+GR;}}; Bb=Ze+Bb+Zf; break; case "Link": if(!Bb||typeof(Bb)!="string")Bb=_7D; else{ Bb=Bb.split(Bb.charAt(0)); var LT="",GR="",Cu=BN!=1; if(Cq){ var EW=this.s[Cq]; if(!EW){EW=Cq.split(Cq.charAt(0));this.s[Cq]=EW;} if(EW[3])LT=EW[3]; if(EW[4])GR=EW[4]; Bb[1]=(EW[5]&1&&this.BaseUrl?this.BaseUrl:"")+(EW[1]?EW[1]:"")+Bb[1]+(EW[2]?EW[2]:"");} Bb=LT+"<a href='"+DY.Escape(Bb[1])+"'"+(Bb[3]?" target='"+Bb[3]+"'":"")+" onclick='CancelEvent(event,2);'"+(Cu?"":" style='cursor:default;'")+">"+(Bb[2]?Bb[2]:Bb[1])+"</a>"+GR;}; if(Zg)Bb=Ze+Bb+Zf; break; case "Panel": Bo=""; if(!Bb&&(!this.FastPanel||GC)&&!RF&&!ZU)Bb="Move,Select,Delete,Copy"; if(Bb){ Bb=(Bb+"").split(','); var DU=""; for(var k=0;k<Bb.length;k++){ var Dh=Bb[k]; if(Dh=="Move"){if(this.Dragging&&C.Move!=0)DU+=this.Z7("PanelMove"+(Is(row,"CanDrag")?"":"Off"));} else if(Dh=="Select"){if(this.Selecting&&C.Select!=0)DU+=this.Z7("PanelSelect"+(Is(row,"CanSelect")?(row.Selected?"On":""):"Off"));} else if(Dh=="Delete"){if(this.Deleting&&C.Delete!=0)DU+=this.Z7("PanelDelete"+(Is(row,"CanDelete")?"":"Off"));} else if(Dh=="Copy"){if(this.Copying&&C.Copy!=0)DU+=this.Z7("PanelCopy"+(Is(row,"CanCopy")?"":"Off"));} else{ var Ik=row[F6+Dh];if(Ik==null)Ik=AS[F6+Dh];if(Ik==null)Ik=C[Dh]; if(Ik){ Ik=" style='background-image:url("+Ik+");padding-left:"+this.Img.Panel+"' class='"+AY+"PanelImage"+AY+"Image'>"; if(_7S)DU+="<i><u"+Ik+"&nbsp;</i></u>"; else if(_7T)DU+="<i><u"+Ik+"&#65279;</i></u>"; else if(_7N)DU+="<u"+Ik+"</u>"; else DU+="<u"+Ik+"&#65279;</u>";} else{ var BW=Dh+"Html"; var Ik=row[F6+BW];if(Ik==null)Ik=AS[F6+BW];if(Ik==null)Ik=C[BW]; if(Ik)DU+=Ik; else DU+=this.Z7("Panel"+Dh);}}} Z5="";Bb=DU;if(!DU){Bb=_7D;Z5="Space";} if(Zg)Bb=Ze+Bb+Zf; break;} if(ZU){ if(!this.Filtering||PK<=0){Z5="Empty";Bb=_7D;} else{Z5="";Bb=this.Z7("Filter"+(this.Filtered?1:0));}; if(Zg)Bb=Ze+Bb+Zf; break;} if(RF){ var AM=this.Cols.Panel; if(!AM.Visible){ if(row.Panel!=2){type="Hidden";Z5=type;break;}} if(row.Kind=="Group")Bb=AY+"Group"+(this.Grouped?1:0); else if(row.Kind=="Search")Bb=AY+"Search"+(this.Searched?1:0); else Bb=""; if(_7T){Z5="";Bb=this.Z7("PSpace"+(AM.Z8?AM.Z8:2)+Bb);} else{Z5="Empty"+Bb+AY+"PSpace"+(AM.Z8?AM.Z8:2);Bb=_7D;}; if(Zg)Bb=Ze+Bb+Zf; break;} Z5="P"+(!this.Dragging||!C.Move?'x':(Is(row,"CanDrag")?'1':'0'))+(!this.Selecting||!C.Select?'x':(Is(row,"CanSelect")?(row.Selected?'2':'1'):'0'))+(!this.Deleting||!C.Delete?'x':(Is(row,"CanDelete")?'1':'0'))+(!this.Copying||!C.Copy?'x':(Is(row,"CanCopy")?'1':'0')); if(_7T){Bb=this.Z7(Z5+AY+"Panel");Z5="";} else Bb=_7D; if(Zg)Bb=Ze+Bb+Zf; break; case "Abs": case "Gantt": if(!Bb){Bb=_7D;break;} if(!row.Gb)row.Gb={}; row.Gb[F6]=1; Bb+=""; var Dh=Bb.split(Bb.charAt(0)),Z9=Dh.length,B3="",UV=this.Rtl?"margin-right:":"margin-left:"; if(type=="Gantt"){ var UR=row[F6+"Gdep"]; if(UR!=null)Dh[UR*8+5]=this.VC(row,F6);} for(var k=1;k<Z9;k+=8){ var x=Dh[k]-0,y=Dh[k+1]-0,A5=Dh[k+2]; var CS=Dh[k+3];CS=CS===""?500:CS-0; var Ik=Dh[k+4],BQ=Dh[k+5];BQ=BQ?" class='"+BQ+"'":""; B3+="<div"+BQ+" style='"+(x?UV+x+"px;":"")+(A5?"width:"+A5+"px;":"")+"margin-top:"+(k==1?y:y-500)+"px;height:"+CS+"px;margin-bottom:"+(500-y-CS)+"px;overflow:hidden;'>"+Ik+"</div>";} var CS=row.Height;if(!CS)CS=row.Def.Height;if(!CS)CS=this.Hu; if(row.r1){ var H6=this.GetCell(row,F6); if(H6&&H6.firstChild)CS=H6.firstChild.offsetHeight;} Bb="<div style='overflow:hidden;height:"+CS+"px'>"+B3+"</div>"; break; case "Radio": if(!Cq)Bb=_7D; else{ var EW=this.s[Cq]; if(!EW){EW=Cq.split(Cq.charAt(0));this.s[Cq]=EW;} var UN=EW.length; if(UN<=7)Bb=_7D; else{ var Ik="",QZ=EW[1]-0,Bg=QZ&3; if(EW[2])Ik+=EW[2]; if(Bg!=1)Ik+=_7A+_7B; if(Bg==0)Ik+="<tr>"; var Y4,GR; if(Bg==2){Y4="<tr><td";GR="</td></tr>";} else if(Bg==1){ if(_7P||_7F){Y4="<nobr>&#65279;<span";GR="</span></nobr> ";} else{Y4="<nobr";GR="</nobr> ";}} else{Y4="<td";GR="</td>";}; for(var k=7;k<UN;k++){ var Fw=QZ&16?Bb&(1<<(k-7))?1:0:k-7===Bb?1:0; if(this.Y2||QZ&64){ var Dh="<span class='"+AY+"RadioText'>"+EW[k]+"</span>"; Ik+=Y4+(EW[k]?"":" class='"+AY+"None'")+">"+(QZ&4?Dh:"")+"<input class='"+AY+"RadioInput' type='"+(QZ&32?"checkbox":"radio")+"'"+(this.Y2?" disabled"+_7E:"")+(Fw?" checked"+_7E:"")+">"+(Bg==0?"</td><td>":"")+(QZ&4?"":Dh)+GR;} else Ik+=Y4+(EW[k]?"":" class='"+AY+"None'")+" class='"+AY+"Radio"+(Fw+(QZ&32?2:0))+(QZ&4?"Right":"Left")+"'>"+EW[k]+GR;} if(Bg==0)Ik+="</tr>"; if(Bg!=1)Ik+=_7C; if(EW[3])Ik+=EW[3]; Bb=Ik;}; Bb=Ze+Bb+Zf;}; break; case "List": if(!Bb)Bb="|"+_7D; else Bb+=""; Bb=Bb.split(Bb.charAt(0)); if(!Cq)Bb=Bb.join(""); else{ var Ik="",EW=this.s[Cq]; if(!EW){EW=Cq.split(Cq.charAt(0));this.s[Cq]=EW;} var aA=EW.length,k=5,GN=EW[1]-0,VE=Bb.length; if(EW[2])Ik+=EW[2]; for(var F8=1;F8<VE;F8++){ if(EW[k]&&(F8!=1||!(GN&1)))Ik+=EW[k]; if(EW[k+2])Bb[F8]=Bb[F8].replace(new RegExp(EW[k+2],EW[k+3]),EW[k+4]); if(Bb[F8])Ik+=GN&2?DY.Escape(Bb[F8]):Bb[F8]; if(EW[k+1]&&(F8!=VE-1||!(GN&1)))Ik+=EW[k+1]; k+=6;if(k>=aA)k=5;} if(EW[3])Ik+=EW[3]; Bb=Ik;}; if(!Bb)Bb=_7D; Bb=Ze+Bb+Zf; break; case "Pass": Bb=this.GetText("Password"); if(Zg)Bb=Ze+Bb+Zf; break; case "Button": if(!Bb)Bb=""; else if(Bb==1)Bb=1; var aB=null; if(Bb)aB=Get(row,F6+"IconChecked"); if(aB==null)aB=Get(row,F6+"Icon"+Bb); if(aB==null&&Bb)aB=Get(row,F6+"Icon"); var Wb=Get(row,F6+"Caption"); if(Wb){ var aC=Get(row,F6+"Width"); Z5="ToolButton"; Bb="<button"+(aC>=0?" style='width:"+(aC-6)+"px'":"")+" class='"+AY+"ToolButtonButton"+Bb+"'>"+Wb+"</button>";} else if(aB!=null&&aB-0+""==aB){ aB=["Save","Reload","Repaint","Add","AddChild","Sort1","Sort0","Calc1","Calc0","ExpandAll","CollapseAll","Cfg","Help","Columns","Resize","Print","Export"][aB]; Z5="Tool"+aB+AY+"Empty";Bb=_7D;} else if(aB){Z5="ToolIcon"+Bb;Bb=aB;} else{Z5="Tool"+F6+Bb+AY+"Empty";Bb=_7D;}; BN=0; if(Zg)Bb=Ze+Bb+Zf; break; case "DropCols": Bb=Bb?(Bb+"").split(','):new Array(); var B3=_7A+_7B+"<tr>"; for(var k=0;k<Bb.length;k++){ if(!Bb[k]||!this.Cols[Bb[k]])continue; B3+="<td class='"+this.Img.Style+"HeaderGroup'><div style='overflow:hidden;width:"+this.Cols[Bb[k]].Width+"px'>"; B3+=this.GetCaption(Bb[k]); B3+="</div></td>";} var Ai=Get(row,F6+"Text");if(Ai==null)Ai=this.GetText("GroupCustom"); if(!this.Y2)B3+="<td nowrap"+_7E+" class='"+this.Img.Style+"HeaderGroupCustom'>"+Ai+"</td>"; B3+="</tr>"+_7C; Bb=B3; if(Zg)Bb=Ze+Bb+Zf; break; case "Pages": var Em=this.XB.childNodes.length; Bb=""; var Au=this.GetFPage(); if(Au)Au=this.GetPageNum(Au); for(var k=0;k<Em;k++)Bb+="<a class='"+this.Img.Style+"PagesLink"+(k==Au?"Active":"")+"' href='javascript: "+this.K+".GoToPageNum("+(k+1)+")'>"+(k+1)+"</a>"; if(Zg)Bb=Ze+Bb+Zf; break; case "Hidden": Bb=_7D; if(Zg)Bb=Ze+Bb+Zf; break; default: if(Bb==""||Bb==null)Bb=_7D; if(Zg)Bb=Ze+Bb+Zf; break;}; if(ZH==3)return Bb; var aD=row[F6+"HtmlPrefix"];if(aD==null)aD=AS[F6+"HtmlPrefix"];if(aD==null)aD=C.HtmlPrefix;if(aD!=null)Bb=aD+Bb; var aD=row[F6+"HtmlPostfix"];if(aD==null)aD=AS[F6+"HtmlPostfix"];if(aD==null)aD=C.HtmlPostfix;if(aD!=null)Bb+=aD; if(RF){ var A5=row[F6+"Width"];if(A5==null)A5=AS[F6+"Width"]; if(this.Y2&&row[F6+"RelWidth"])A5=this.GetCell(row,F6).offsetWidth; if(type=="Hidden")Bb=""; else if(type=="Pages")Bb="<div style='overflow:auto;overflow-y:hidden;height:"+AI.YQ+"px;width:"+A5+"px;'>"+Bb+"</div>"; else if(A5>=0){ if(Ze&&(Zg||type=="Lines"||type=="Html"||type=="Radio"||type=="Img"||type=="List"))Bb=Bb.replace("style='","style='width:"+A5+"px;"); else Bb="<div style='overflow:hidden;width:"+A5+"px;'>"+Bb+"</div>";} var BQ=Z0+Zx+(Bo?AY+Bo:"")+AY+"CellSpace"+(Yv?"Panel":(type=="Bool"?"Bool":(BN?"Edit":((Bo+RD+"").indexOf("Defaults")>=0?"Select":""))))+(Z5?AY+Z5:""); if(!ZH)Eu+="<td"+(this.Y2?"":" onmousemove='"+this.K+".TmpSpaceCol=\""+F6+"\";'")+QQ+" class='"+BQ+"'>"+Bb+"</td>"; else{AJ[AJ.length]=Bb;AJ[AJ.length]=BQ;AJ[AJ.length]=Xc;AJ[AJ.length]="";}; if(!Cell&&!this.Y2)row[F6+"Pos"]=i+Zv; continue;} var aE="",aF; if(F6==KH){ aE=this.aG(row); if(aE.length){ if(aE.length<5){ if(_7T){aF=Z0+Zx+AY+"Cell"+AY+"NoRight"+AY+(this.NoTreeLines?"NoTreeLines"+this.NoTreeLines:"Tree");aE=this.Z7(aE);} else{aF=Z0+Zx+AY+"Cell"+AY+"NoRight"+AY+"Empty"+AY+aE;aE=_7D;}} else aF=Z0+Zx+AY+"Cell"+AY+"NoRight"+AY+(this.NoTreeLines?"NoTreeLines"+this.NoTreeLines:"Tree");}} var span=1,aH; if(C.WidthPad){ if(RD)RD+="Right"; else if(Bo&&GM==1){RD=Bo;Bo=null;} if(RD){ if(RD=="ButtonRight"){ aH="<button class='"+AY+"RightButton'>"+this.Gw(row,F6,"ButtonText")+"</Button>"; RD=Z0+Zx+AY+"Cell"+(GC?"Header":"")+AY+"NoLeft";} else if(RD=="HtmlRight"){ aH=this.Gw(row,F6,"ButtonText"); RD=Z0+Zx+AY+"Cell"+(GC?"Header":"")+AY+"NoLeft"+AY+"RightHtml";} else if(RD=="ImgRight"){ aH="<img class='"+AY+"RightImg' src='"+this.Gw(row,F6,"ButtonText")+"'/>"; RD=Z0+Zx+AY+"Cell"+(GC?"Header":"")+AY+"NoLeft";} else if(_7T||GC){aH=this.Z7(RD);RD=Z0+Zx+AY+"Cell"+(GC?"Header":"")+AY+"NoLeft";} else{RD=AY+RD+Z0+Zx+AY+"Empty"+AY+"Cell"+(GC?"Header":"")+AY+"NoLeft";aH=_7D;}} else{span++;RD="";}} else RD=""; if(ZX){ var HR=row[F6+"Span"];if(HR==null)HR=AS[F6+"Span"]; if(HR>1){ i++; if(!C.Visible&&!C.Hidden)span=0; while(--HR){ if(!Jf[i])break; var HU=Cols[Jf[i]]; if(HU.Visible||HU.Hidden){ if(Jf[i]==KH&&!Yb)span++; if(HU.WidthPad)span++; span++;} i++;} i--;} var H7=row[F6+"Merge"];if(H7==null)H7=AS[F6+"Merge"]; if(H7&&!(PK<=0)){ H7=(H7+"").split(","); if(H7.length==1){ var aI=row[H7[0]+"Visible"]==-3; if(aI)row[H7[0]+"Visible"]=null; Bb=this.KY(row,0,0,0,3,H7[0]); if(aI)row[H7[0]+"Visible"]=-3;} else{ var GJ=Get(row,F6+"MergeType")-0;if(!GJ)GJ=0; Bb=_7A+_7B; if(!(GJ&1))Bb+="<tr>"; for(var D3=0;D3<H7.length;D3++){ if(GJ&2||this.Cols[H7[D3]].Visible){ Bb+=(GJ&1?"<tr>":"")+"<td class='"+AY+this.GetType(row,H7[D3])+" "+AY+"MergedCell"+(GJ&1?"V":"H")+"'>"+this.KY(row,0,0,0,3,H7[D3])+"</td>"+(GJ&1?"</tr>":"");}} if(!(GJ&1))Bb+="</tr>"; Bb+=_7C;}}} if(aE&&this.SpannedTree){ var BQ=Z0+Zx+AY+"Cell"; if(RD)BQ+=AY+"NoRight"; if(_7Y){ BQ+=AY+"CellBorderFF3"; if(RD)RD+=AY+"CellBorderFF3";} var aJ=""; if(Bo)aJ+=AY+Bo; if(Z5)aJ+=AY+Z5; aE=this.aG(row); if(aE.length){ if(aE.length<5)aE=this.Z7(aE); aF=AY+"SpannedTree"; if(this.NoTreeLines){ aF+=AY+"NoTreeLines"+this.NoTreeLines; if(this.HideRootTree&&!row.Level)aE=""; else aF+="' style='width:"+((row.Level+(this.HideRootTree?-1:0))*AI.Line+AI.Tree)+"px";}} Bb=_7A+_7B+"<tr><td class='"+aF+"'>"+aE+"</td><td class='"+aJ+"'>"+Bb+"</td></tr>"+_7C; if(!ZH){ Eu+="<td>"+_7D+"</td>"; Eu+="<td"+QQ+" class='"+BQ+"'"+Zw+(span>1?" colspan='"+span+"'":"")+"'>"+Bb+"</td>"; if(RD){ if(ZJ)Eu+="<td"+QQ+Zw+"><div style='width:"+C.WidthPad+"px'</td>"; else Eu+="<td"+QQ+Zw+" class='"+RD+"'>"+aH+"</td>";}} else{ AJ[AJ.length]=Bb;AJ[AJ.length]=BQ; AJ[AJ.length]=Xc;AJ[AJ.length]=RD;}; continue;} var BQ=Z0+Zx; if(GC){ if(Yv)BQ+=(Z5?AY+Z5:"")+AY+"CellHeaderPanel"; else if(F6=="_ConstWidth")BQ+=AY+"HeaderText"+AY+"CellHeaderEmpty"; else BQ+=AY+"HeaderText"+AY+"CellHeader";} else if(ZU){ if(Yv)BQ+=(Z5?AY+Z5:"")+AY+"CellFilterPanel"; else if(F6=="_ConstWidth")BQ+=(Z5?AY+Z5:"")+AY+"CellEmpty"; else BQ+=(Z5?AY+Z5:"")+AY+"CellFilter";} else if(Yv)BQ+=(Z5?AY+Z5:"")+AY+"CellPanel"; else if(F6=="_ConstWidth")BQ+=(Z5?AY+Z5:"")+AY+"CellEmpty"; else BQ+=(Z5?AY+Z5:"")+AY+"Cell"; if(Bo)BQ+=AY+Bo; if(RD)BQ+=AY+"NoRight"; if(aE)BQ+=AY+"NoLeft"; if(Bb==_7D)BQ+=AY+"Empty"; if(_7Y){ BQ+=AY+"CellBorderFF3"; if(RD)RD+=AY+"CellBorderFF3"; if(aE)aF=AY+"CellBorderFF3"+aF;} if(!ZH){ if(aE)Eu+="<td"+QQ+Zw+" class='"+aF+"'>"+aE+"</td>"; Eu+="<td"+QQ+" class='"+BQ+"'"+Zw+(span>1?" colspan='"+span+"'":"")+">"+Bb+"</td>"; if(RD){ if(ZJ)Eu+="<td"+QQ+Zw+"><div style='width:"+C.WidthPad+"px'</td>"; else Eu+="<td"+QQ+Zw+" class='"+RD+"'>"+aH+"</td>";}} else{ AJ[AJ.length]=Bb;AJ[AJ.length]=BQ; AJ[AJ.length]=Xc;AJ[AJ.length]=RD; if(aE){AJ[AJ.length]=aE;AJ[AJ.length]=aF;}}} AJ[AJ.length]=Eu;}}; if(_7S)_7h.prototype.Z7=function(name){"<i><u class='"+this.Img.Style+name+" "+this.Img.Style+"Image'>&nbsp;</i></u>";}; else if(_7T)_7h.prototype.Z7=function(name){return "<i><u class='"+this.Img.Style+name+" "+this.Img.Style+"Image'>&#65279;</i></u>";}; else if(_7N)_7h.prototype.Z7=function(name){return "<u class='"+this.Img.Style+name+" "+this.Img.Style+"Image'></u>";}; else _7h.prototype.Z7=function(name){return "<u class='"+this.Img.Style+name+" "+this.Img.Style+"Image'>&#65279;</u>";}; _7h.prototype.aG=function(row,aK){ if(row.Fixed)return ""; if(this.NoTreeLines){ if(aK!=null)return this.Z7('ND'+aK); if(this.HasChildren(row)&&Is(row,"CanExpand")){ if(this.NoTreeLines==2)return this.Z7('N'+(row.Expanded?'C':'E')); return 'N'+(row.Expanded?'C':'E');} return _7D;} var FX=row.Level,aL,AY=this.Img.Style; if(this.HideRootTree){ FX--;if(FX<0)return _7D;} if(aK==null){ if(this.HasChildren(row)&&Is(row,"CanExpand"))aL=row.Expanded?'C':'E'; else aL='T'; if(!row.LevelImg)aL+='L'; if(!FX--)return aL; row=row.parentNode; if(aL=='T'){ aL=row.LevelImg+aL;if(!FX--)return aL; row=row.parentNode; aL=row.LevelImg+aL;if(!FX--)return aL; row=row.parentNode;} aL=row.LevelImg+aL;if(!FX--)return aL; row=row.parentNode;} else{ aL='D'+aK+(row.LevelImg?'':'L');if(!FX--)return aL; row=row.parentNode;}; var B3="",i=2; while(1){ if(i++==2){ B3=this.Z7(aL)+B3; aL=""; i=0;} aL=row.LevelImg+aL;if(!FX--)return this.Z7(aL)+B3; row=row.parentNode;}}; _7h.prototype.P4=function(row){ var CS=row.Height;if(CS==null)CS=row.Def.Height;if(!CS)CS=this.Hu; var B3="<tr class='"+this.Img.Style+row.Kind+"Row' style='"+(_7P?"overflow:auto;"+(_7R?"":"min-height:"+CS+"px;"):"height:"+CS+"px;")+(row.Visible?"":"display:none;")+"'>"; if(this.KJ)B3+="<td style='width:0px;height:"+CS+"px'></td>"; return B3;}; _7h.prototype.P2=function(row){ var B3=_7A+"class='"+this.Img.Style+"Section"+(_7Y?"FF3":"")+"'"+_7B+"<tr"+(_7P&&!F?" style='display:none;'":"")+">"; if(this.KJ)B3+="<th style='width:0px;'></th>"; return B3;}; _7h.prototype.P3=function(row,ZE,ZF,ZG){ var AI=this.Img,FX=row.Level,KH=FX==null?null:this.MainCol; if(this.HideRootTree)FX--; var P1=[ZE,ZF,ZG]; for(var j=0;j<3;j++){ var AJ=P1[j];if(!AJ)continue; var Jf=this.ColNames[j],Db=Jf.length,Em=Db; var B3=""; for(var i=0;i<Db;i++){ var BD=Jf[i],C=this.Cols[BD]; if(!C.Visible&&!C.Hidden){Em--;continue;} var A5=C.Width;if(!A5)A5=100; var KU=C.WidthPad; if(KU){ A5-=KU; if(A5<AI.Kj){KU+=A5-AI.Ki;A5=AI.Ki;}} if(BD==KH){ Em++; var Ss=(FX+1)*AI.Line+AI.Tree+AI.Kj; if(FX==-2)Ss=AI.Kj; if(this.SpannedTree)Ss=0; A5-=Ss; if(A5<AI.Ki){Ss+=A5-AI.Ki;A5=AI.Ki;} if(!C.Visible)Ss=0; B3+="<th style='height:0px;width:"+Ss+"px;'></th>";} if(!C.Visible){A5=0;KU=0;} B3+="<th style='height:0px;width:"+A5+"px;'></th>"; if(C.WidthPad){ Em++;B3+="<th style='height:0px;width:"+KU+"px;'></th>";}} if(this.KJ)Em++; AJ[AJ.length]=B3; AJ.Yz=Em;}}; _7h.prototype.XN=function(row,ZE,ZF,ZG,Md,XR,max){ var P1=[ZE,ZF,ZG],aM=this.ChildPages; if(!max)max=1e6; var B3=this.P2(row); for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]=B3; this.P3(row,ZE,ZF,ZG); for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]="</tr>"; var YS=0,AP=Md?Md:row.firstChild; while(AP!=XR){ if(AP.Pr){ if(YS>0){if(AP.Pr>YS)YS=AP.Pr;} else YS=AP.Pr;} if(!AP.Visible){AP=AP.nextSibling;continue;} if(--max<0&&YS<=0)break; var B3=this.P4(AP); for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]=B3; this.KY(AP,ZE,ZF,ZG); this.RowCount++; for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]="</tr>"; if(this.HasChildren(AP)){ if(this.ChildPaging&&!AP.Expanded){AP._7AZ=0;AP.State=AP.State>2||AP.firstChild||AP.Count==0||this.ChildPaging==2?2:0;} else{ AP.State=4;AP._7AZ=4; var B3="<tr"+(AP.Expanded?"":" style='display:none'")+">"; for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]=B3+"<td style='height:10px overflow:hidden;' colspan='"+P1[j].Yz+"'>"; if(aM)this.XM(AP,ZE,ZF,ZG); else this.XN(AP,ZE,ZF,ZG); for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]="</td></tr>";}} else{AP._7AZ=0;AP.State=AP.firstChild?2:4;}; AP=AP.nextSibling; if(--YS>0&&AP==XR){ if(!AP)break; XR=XR.nextSibling;}} for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]=_7C; return AP;}; _7h.prototype.XM=function(row,ZE,ZF,ZG){ var P1=[ZE,ZF,ZG],V9=row.firstChild,min=this.ChildPageMin,Db=this.ChildPageLength; if(min){ for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]="<div class='"+this.Img.Style+"ChildPage'>"; V9=this.XN(row,ZE,ZF,ZG,V9,null,min); for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]="</div>";} while(V9){ for(var Em=Db,CS=0;Em&&V9;V9=V9.nextSibling){ if(!V9.Visible&&this.ChildPages==1)continue; if(V9.firstChild&&V9.Expanded)CS+=this.Hs(V9); var Ht=V9.Height;if(!Ht){Ht=V9.Def.Height;if(!Ht)Ht=this.Hu;} if(Ht)CS+=Ht; Em--;} for(var j=0;j<3;j++)if(P1[j])P1[j][P1[j].length]="<div class='"+this.Img.Style+"ChildPage' style='height:"+CS+"px;'>"+_7D+"</div>";}}; _7h.prototype.Xa=function(ZE,ZF,ZG){ var aN=this.FastPages,aD=0,Em=0,aO=this.Hu/this.PageLengthDiv,CS,AY=this.Img.Style; var HU=this.GetSections(),aP=HU[0],XT=HU[1],P1=[ZE,ZF,ZG]; var Dy="<div style='height:0px;overflow:hidden;'></div>"; if(!this.Paging||!this.AllPages||this.XB.childNodes.length==1){ var Au=this.Paging?_7k(this.XB,this.V):this.XB.firstChild; var CS=Au.State<2?" style='height:"+this.Ha(Au)+"px;'":""; for(var Dh=aP;Dh<XT;Dh++)P1[Dh][P1[Dh].length]="<div class='"+AY+"PageOne'"+CS+">"; if(!CS){this.XN(Au,P1[0],P1[1],P1[2]);Au.State=4;} for(var Dh=aP;Dh<XT;Dh++)P1[Dh][P1[Dh].length]="</div>"+Dy; return;} for(var aQ=this.XB.firstChild,Au=aQ;Au;Au=Au.nextSibling){ if(this.Paging==1)Au.State=4; var YZ=Au.State-0; if(aN){ if(YZ<4){ aD+=YZ<2?Au.Count*aO:this.Ha(Au)/this.PageLengthDiv; if(++Em==aN)Em=0; if(_7V&&aD>9000&&Em){ aN=Em; this.FastPages=aN; Em=0;} Au.Hv=1;}} if(!Em){ if(YZ<4){ CS=aD?Math.floor(aD):this.Ha(Au,true);if(!CS)CS=1; CS=" style='"+(_7K&&!_7I?"":"overflow:hidden;")+"height:"+CS+"px'";} else CS=""; var B3="<div class='"+AY+"Page"+(Au==aQ?"First":"")+"'"+CS+">"; for(var Dh=aP;Dh<XT;Dh++)P1[Dh][P1[Dh].length]=B3; if(!_7P)P1[1][P1[1].length-1]=B3.indexOf("style")>0?B3.replace("style='","style='width:1000%;"):B3.replace("class","style='width:1000%;' class"); if(YZ==4)this.XN(Au,ZE,ZF,ZG); for(var Dh=aP;Dh<XT;Dh++)P1[Dh][P1[Dh].length]="</div>"; aD=0;}} if(aN&&!aD&&this.XB.childNodes.length==1)aD++; if(aD)for(var Dh=aP;Dh<XT;Dh++)P1[Dh][P1[Dh].length]="<div class='"+this.Img.Style+"Page' style='overflow:hidden;height:"+aD+"px'>"+_7D+"</div>"; for(var Dh=aP;Dh<XT;Dh++)P1[Dh][P1[Dh].length]=Dy;}; _7h.prototype.Xh=function(row){ var min=row.Height;if(min==null)min=row.Def.Height;if(min==null)min=this.aR; var AJ=[];this.KY(row,null,AJ,null); return _7A+_7B+"<tr"+(_7P?"><td style='height:"+min+"px'></td>":" style='height:"+min+"px;'>")+AJ.join("")+"</tr>"+_7C;}; _7h.prototype.aS=function(Y1,HU){ var B3=""; for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Space==Y1){ var span=HU[1]-HU[0]; if(Y1==0||Y1>=4)span+=(this.Pager.Visible?1:0)+1; B3+=(AP.Visible?"<tr>":"<tr style='display:none;'>")+"<td colspan='"+span+"'>"; B3+="<div class='"+this.Img.Style+AP.Kind+"Row'>"; B3+=this.Xh(AP)+"</div></td></tr>";} return B3;}; _7h.prototype.aT=function(BQ){ var B3="<div class='"+this.Img.Style+BQ+"' style='visibility:hidden;'>"; for(var i=0;i<10;i++)if(this.Img[BQ][i]!=null)B3+="<div class='"+this.Img.Style+BQ+i+"'>"+_7D+"</div>"; return B3+"</div>";}; _7h.prototype.Y6=function(){ this.LB("RenderCreate"); var HU=this.GetSections(),aP=HU[0],XT=HU[1],AJ=new Array(),Au=0,B3,AY=this.Img.Style,UV=this.Rtl; if(this.Img.Top)AJ[Au++]=this.aT("Top"); AJ[Au++]=_7A+" class='"+AY+"MainTable' id='"+this.id+"'"; if(UV)AJ[Au++]=" style='text-align:right;'"; AJ[Au++]=" onclick='return "+this.K+".GridClick(event)' "; AJ[Au++]=" onmousemove='return "+this.K+".GridMouseMove(event)' "; AJ[Au++]=" onmouseover='return "+this.K+".GridMouseOver(event)' "; AJ[Au++]=" onmousedown='return "+this.K+".GridMouseDown(event)' "; AJ[Au++]=" onmouseup='return "+this.K+".GridMouseUp(event)' "; AJ[Au++]=" ondblclick='return "+this.K+".GridDblClick(event)' "; AJ[Au++]=" oncontextmenu='return "+this.K+".GridRightClick(event)'"; if(_7P)AJ[Au++]=" onselectstart='return "+this.K+".GridSelectStart(event)'"; AJ[Au++]=_7B; var aU=["Left","Mid","Right"]; AJ[Au++]=this.aS(0,HU); AJ[Au++]="<tr>"; var P1=[]; for(var Dh=aP;Dh<XT;Dh++)P1[Dh]=["<td style='overflow:hidden;'><div class='"+AY+"Head"+aU[Dh]+"'"+(_7G?"":" style='overflow:hidden;'")+">"]; this.XN(this.XH,P1[0],P1[1],P1[2]); for(var Dh=aP;Dh<XT;Dh++)AJ[Au++]=P1[Dh].join("")+"</div></td>"; B3="<td rowspan='"+(this.XS.Space[3]-this.XS.Space[0]-(this.XF.firstChild?0:1))+"' valign='top'>"; B3+="<div class='"+AY+"VScroll' style='width:"+_7Z+"px;'>"; if(_7K&&!_7I)B3+="<div style='width:"+(_7Z-1)+"px;overflow:auto;border-right:1px solid white;'"; else if(F)B3+="<div style='margin-left:-"+_7Z+"px;width:"+(_7Z*2)+"px;overflow:auto;'"; else B3+="<div style='width:"+_7Z+"px;overflow:auto;'"; B3+=" onscroll='"+this.K+".Scrolled();'"; B3+=" onmousemove='"+this.K+".ARow=null;"+this.K+".ASec=-1;'"; B3+=">"; B3+="<div style='width:1px;overflow:hidden;'>"+_7D+"</div>"; B3+="</div>"; B3+="</div></td>"; AJ[Au++]=B3; if(this.Paging){ B3="<td rowspan='"+(this.XS.Space[3]-this.XS.Space[0]+1)+"' valign='top' style='"+(this.Pager.Visible?"":"display:none;")+"'>"; B3+="<div class='"+AY+"PagerMain' style='width:"+(this.Pager.Width+(_7Q?this.Img.aV-this.Img.aW:0))+"px;height:20px;overflow:hidden;white-space:nowrap;'"; B3+=" onmousemove='"+this.K+".ARow=null;"+this.K+".ASec=-6;'"; B3+=">"; B3+="<div class='"+AY+"PagerHeader'>"; if(this.Pager.Caption)B3+="<div class='"+AY+"PagerCaption'>"+this.Pager.Caption+"</div>"; B3+="</div>"; B3+="<div class='"+AY+"PagerBody' style='overflow:auto;'>"; if(_7Q)B3+="<div style='width:100%;overflow:hidden;'>"; else B3+="<div>"; B3+="<div>"; B3+=this.YA(); B3+="</div>"; B3+="<div class='"+AY+"PagerCursor' style='"+(_7G||_7K&&!_7J?"width:3px;":"")+"height:20px;overflow:hidden;'>"+_7D+"</div>"; B3+="</div></div></div></td>"; AJ[Au++]=B3;} else AJ[Au++]="<td rowspan='"+(this.XS.Space[3]-this.XS.Space[0])+"' style='display:none'><div>"+_7D+"</div></td>"; AJ[Au++]="</tr>"; AJ[Au++]=this.aS(1,HU); AJ[Au++]="<tr>"; var P1=[]; for(var Dh=aP;Dh<XT;Dh++)P1[Dh]=["<td style='overflow:hidden;'><div class='"+AY+"Body"+aU[Dh]+"'"+(_7G?"":" style='overflow:hidden;'")+">"]; this.Xa(P1[0],P1[1],P1[2]); for(var Dh=aP;Dh<XT;Dh++)AJ[Au++]=P1[Dh].join("")+"</div></td>"; AJ[Au++]="</tr>"; AJ[Au++]=this.aS(2,HU); AJ[Au++]="<tr"+(this.XF.firstChild?"":" style='display:none;'")+">"; var P1=[]; for(var Dh=aP;Dh<XT;Dh++)P1[Dh]=["<td style='overflow:hidden;'><div class='"+AY+"Foot"+aU[Dh]+(this.XF.firstChild?"":" "+AY+"None")+"'"+(_7G?"":" style='overflow:hidden;'")+">"]; this.XN(this.XF,P1[0],P1[1],P1[2]); for(var Dh=aP;Dh<XT;Dh++)AJ[Au++]=P1[Dh].join("")+"</div></td>"; AJ[Au++]="</tr>"; AJ[Au++]=this.aS(3,HU); B3="<tr>"; if(this.ShortHScroll&&!HU[0])B3+="<td onmousemove='"+this.K+".ARow=null;"+this.K+".ASec=-2;' ><div class='"+AY+"XScroll' style='height:"+_7a+"px;overflow:hidden;'>"+_7D+"</div></td>"; B3+="<td colspan='"+(this.ShortHScroll?1:HU[1]-HU[0])+"'><div class='"+AY+"HScroll' style='"+(_7Q?"":"height:"+_7a+"px;")+"overflow:hidden;'>"; if(_7G)B3+="<div style='position:relative;top:"+(_7a-38)+"px;height:38px;overflow:auto;'"; else if(_7K&&!_7I)B3+="<div style='height:"+(_7a-1)+"px;overflow:auto;border-bottom:1px solid white;'"; else if(_7P)B3+="<div style='height:"+(_7a+1)+"px;margin-top:-1px;overflow-x:scroll;overflow-y:hidden;'"; else B3+="<div style='height:"+_7a+"px;overflow:auto;'"; B3+=" onscroll='"+this.K+".Scrolled();'"; B3+=" onmousemove='"+this.K+".ARow=null;"+this.K+".ASec=-3;'"; B3+=">"; B3+="<div"+(_7G?"":" style='height:1px;overflow:hidden;'")+">"+_7D+"</div>"; B3+="</div>"; B3+="</div></td>"; if(this.ShortHScroll&&HU[1]==3)B3+="<td onmousemove='"+this.K+".ARow=null;"+this.K+".ASec=-4;'><div class='"+AY+"XScroll' style='height:"+_7a+"px;overflow:hidden;'>"+_7D+"</div></td>"; B3+="<td onmousemove='"+this.K+".ARow=null;"+this.K+".ASec=-5;'><div class='"+AY+"XScroll' style='height:"+_7a+"px;width:"+_7Z+"px;overflow:hidden;'>"+_7D+"</div></td>"; AJ[Au++]=B3+"</tr>"; AJ[Au++]=this.aS(4,HU); AJ[Au++]=this.aS(5,HU); AJ[Au++]=_7C; if(this.Img.Bottom)AJ[Au++]=this.aT("Bottom"); this.LC("RenderCreate");this.LB("RenderSet"); this.MainTag.innerHTML=AJ.join(""); this.LC("RenderSet");}; _7h.prototype.AddRow=function(GP,next,HQ,Pk,Def,Op,aX,test,children){ if(next)GP=next.parentNode; if(!GP){ if(!this.AllPages)GP=_7k(this.XB,this.V); else GP=this.XB.lastChild;} if(!Def&&GP.Def&&Is(GP,"AddParent"))return this.AddRow(GP.parentNode,Get(GP,"AddParent")==2?null:GP,HQ,Pk,Def,Op,aX,test,children); if(!Def){Def=this.GetCDef(GP);if(!Def)return null;} var AS=this.Def[Def];if(!AS)return null; if(next&&GP.Page&&this.Root.AddParent==2)next=null; if(!GP.Page&&Get(GP,"DefParent")&&!this.HM(GP))this.ChangeDef(GP,Get(GP,"DefParent"),HQ); if(!this.HasChildren(GP))GP.State=4; if(GP.State<2)return null; if(test)return true; var AP=_7i.createElement("I"); if(next)GP.insertBefore(AP,next); else GP.appendChild(AP); AP.Def=AS; AP.Expanded=AS.Expanded?1:0; AP.Kind=AS.Kind; AP.Calculated=AS.Calculated?1:0; AP.Visible=AS.Visible?1:0; AP.Spanned=AS.Spanned?1:0; AP.Level=GP.Level+1; AP.Added=1; AP.Visible=0; AP.State=4; for(var BD in this.Cols)if(BD!="Panel"&&!Get(AP,BD))AP[BD]=this.GetValue(AP,BD); if(AS.EditCols){ var Vx=(AS.EditCols+"").split(','); for(var i=0;i<Vx.length;i++){ var BD=Vx[i]; if(BD=="Main"||BD=="MainCol"){ if(this.Z){ var AO=AS.GroupCol; if(AO&&(AO+"").indexOf(",")<0){ if(AO-0+""==AO)AO=this.GroupCols[AO<0?this.Z-AO:AO];} else{ for(var LT=AP.parentNode,R1=0;LT&&!LT.Page;LT=LT.parentNode)if(LT.Def&&LT.Def.Group)R1++; AO=this.GroupCols[R1];}; if(AO){ AP[this.MainCol+"CopyTo"]="Children,"+AO; AP[this.MainCol+"CanEdit"]=1; AP[this.MainCol]=Get(AP,AO);}}} else{ AP[BD+"CopyTo"]="Children,"+BD; AP[BD+"CanEdit"]=1;}} AP._7A1=1;} if(AS.Group||GP._7A1||GP.Def&&GP.Def._7A1)this.aY(AP,GP); if(!Pk)this.Nz(AP); var aZ=children?children:AS.Children; if(aZ&&!aX){ for(var i=0;i<aZ.length;i++){ var BM=aZ[i]; if(BM.Def==AP.Def&&!children)continue; var BC=this.AddRow(AP,null,false,false,BM.Def.Name,0,0,0,BM.Children); for(var j in BM)if(j!="id"&&!this.Om[j])BC[j]=BM[j];} this.Yf(AP); AP.State=2;} if(!Op){ if(GP.MasterRow){ var EB=this.J6.AddRow(GP.MasterRow,next?next.MasterRow:null,HQ,Pk,Def,1); AP.MasterRow=EB; EB.DetailRow=AP; EB.DetailGrid=this;} if(GP.DetailRow){ var EB=GP.DetailGrid.AddRow(GP.DetailRow,next?next.DetailRow:null,HQ,Pk,Def,1); AP.DetailRow=EB; AP.DetailGrid=GP.DetailGrid; EB.MasterRow=AP;}} if(this.G4)this.aa([AP]); if(GP.LN)this.Lk(GP.parentNode,HQ); if(HQ){ this.ShowRow(AP);} this.ab({Type:"Add",Row:AP,Parent:GP,Next:next,ac:Pk,Def:AS.Name,ad:Op}); return AP;}; _7h.prototype.Yr=function(GP,next,ae){ if(!this.Adding||this.Detail&&!this.XB.firstChild.MasterRow)return null; if(Grids.OnCanRowAdd&&!Grids.OnCanRowAdd(this,GP,next))return null; var AP=this.AddRow(GP,next,false); if(!AP){ var NH=this.GetAlert("ErrAdd");if(NH)alert(NH); return null;} if(Grids.OnRowAdd)Grids.OnRowAdd(this,AP); function Update(T,AP,GP){ T.ShowRow(AP); T.N3(AP); if(GP&&!GP.Expanded&&!GP.Page)T.Expand(GP,null,null,1); if(!ae){ T.Recalculate(AP,null,true); if(!T.J6)T.UploadChanges(AP); if(T.SaveValues)T.SaveCfg();}}; if(AP.MasterRow){ Update(this.J6,AP.MasterRow,AP.MasterRow.parentNode);} if(AP.DetailRow){ Update(AP.DetailGrid,AP.DetailRow,AP.DetailRow.parentNode);} Update(this,AP,GP); this.Focus(AP,this.FCol); return AP;}; _7h.prototype.af=function(){ if(!this.Paging)return this.XB.firstChild; if(this.AllPages){ if(this.FRow&&!this.FRow.Fixed)return this.GetRowPage(this.FRow); var AJ=this.GetShowedPages(); return _7k(this.XB,AJ[0]);} else return this.V!=null?this.XB.childNodes[this.V]:null;}; _7h.prototype.ActionAddRow=function(CE){ var row=CE?this.FRow:this.ARow; if(row==null||row.Fixed||row.Page)return false; var AP=this.Yr(row.parentNode,row); if(!AP)return false; if(row==this.ARow)this.ARow=AP; return true;}; _7h.prototype.ActionAddRowBelow=function(CE){ var row=CE?this.FRow:this.ARow; if(row==null||row.Fixed||row.Page)return false; var AP=this.Yr(row.parentNode,row.nextSibling); if(!AP)return false; return true;}; _7h.prototype.ActionAddRowEndPage=function(){ return!!this.Yr(this.af(),null);}; _7h.prototype.ActionAddRowEndGrid=function(Yd){ var Ey=this.XB.lastChild; if(!this.AllPages&&Ey!=this.V)this.GoToPage(Ey); if(Ey.State!=4){ if(this.AllPages&&!Yd)this.ScrollIntoView(Ey); var T=this; setTimeout(function(){T.ActionAddRowEndGrid(1);},100); return true;} return!!this.Yr(Ey,null);}; _7h.prototype.ActionAddRowEnd=function(){ return this.AllPages?this.ActionAddRowEndGrid():this.ActionAddRowEndPage();}; _7h.prototype.AddChild=function(CE,type){ var row=CE?this.FRow:this.ARow; if(row==null||row.Fixed||row.Page||!this.MainCol||!Is(row,"AcceptChild"))return false; var next=type?null:row.firstChild; if(this.AddChildType&1)type=1; var LS=row.firstChild; if(LS&&LS.LN||!LS&&row.Count){ if(!row.Expanded&&!row.Page)this.Expand(row); if(row.State<4){ var T=this; setTimeout(function(){T.AddChild(CE,type);},100); return true;} if(LS){ if(type)row=row.lastChild; else{row=LS;next=LS.firstChild;}}} return!!this.Yr(row,next);}; _7h.prototype.ActionAddChild=function(CE){return this.AddChild(CE,0);}; _7h.prototype.ActionAddChildEnd=function(CE){return this.AddChild(CE,1);}; _7h.prototype.aY=function(row,GP,refresh){ var Oe=GP.parentNode; if(Oe.Def&&Oe.Def.Group)this.aY(row,Oe,refresh); for(var Fa in this.Cols)if(GP[Fa+"CopyTo"]){ var H4=GP[Fa+"CopyTo"].split(','); for(var i=0;i<H4.length;i+=2){ if(H4[i]=="Children"){ if(refresh)this.SetValue(row,H4[i+1],Get(GP,Fa),1); else row[H4[i+1]]=Get(GP,Fa);}}}}; _7h.prototype.DelRow=function(row){ if(this.HideRow(row,2)==-1)return; if(row.parentNode.Count)row.parentNode.Count--; this.Lc(row); if(row.DetailRow){ if(row.DetailRow.Page&&this.RefreshDetail)this.RefreshDetail(row.DetailGrid,1); else row.DetailGrid.DelRow(row.DetailRow);} if(row.MasterRow){ row.MasterRow.DetailRow=null; row.MasterRow.DetailGrid=null;} row.parentNode.removeChild(row); row.Removed=1;}; _7h.prototype.MoveRow=function(row,GP,next,HQ,Op,Pe,ag,ah){ var Pf=row.parentNode,ai=row.nextSibling,aj,ak=this.GetRowPage(row),al=null; if(next)GP=next.parentNode; if(!GP){ if(!this.AllPages)GP=_7k(this.XB,this.V); else GP=this.XB.lastChild;} if(!ai){ for(al=row.previousSibling;al&&!al.Visible;al=al.previousSibling);} if(!next&&!ai&&GP==row.parentNode||next&&next==ai||row==next)return 0; if(GP.State<2)return 0; for(var AP=GP;AP;AP=AP.parentNode)if(AP==row)return 0; if(Pf!=GP)aj=2; else aj=1; if(row.Visible&&this.MainCol){ row.Visible=0; this.N3(row,HQ); row.Visible=1;} if(!GP.Page&&Get(GP,"DefParent")&&!this.HM(GP)&&!row.Deleted)this.ChangeDef(GP,Get(GP,"DefParent"),HQ); if(next)GP.insertBefore(row,next); else GP.appendChild(row); if(!Pf.Page&&Get(Pf,"DefEmpty")&&!this.HM(Pf)&&!row.Deleted)this.ChangeDef(Pf,Get(Pf,"DefEmpty"),HQ); if(GP.Def&&GP.Def.Group||GP._7A1||GP.Def&&GP.Def._7A1)this.aY(row,GP,1); if(this.FullId)this.am(row); if(Grids.OnRowMove)Grids.OnRowMove(this,row,Pf,ai); if(!ah)this.ab({Type:"Move",Row:row,Par:GP,Next:next,an:Pf,ao:ai,Moved:row.Moved}); if(!row.Moved||row.Moved<aj)row.Moved=aj; if(HQ){ if(ak.State!=4){ row.Visible=0; row.r1=null; this.ShowRow(row);} else{ if(!Pe&&!GP.Expanded&&!GP.Page){ var Em=this.HO(GP); if(Em==1){ GP.Expanded=1; this.Li(GP);} else this.Expand(GP,0,null,1);} if(!GP.r1||GP.State<3||!GP.Expanded&&!GP.Page&&!Is(GP,"CanExpand"))this.Lc(row,Pf); else{ var ap=!row.r1; this.aq(row,Pf); if(ap&&row.Expanded&&this.HasChildren(row))this.Expand(row,true);}; this.Update(); if(!this.HasChildren(Pf)){ if(Pf.Page){ this.Hb(Pf); if(this.Paging!=3&&this.YC)this.YC(); if(this.UpdatePager)this.UpdatePager();} else{ this.Li(Pf); Pf._7AZ=null;}} if(this.ColorClasses&1)this.RefreshRow(row); else this.ColorRow(row);}} if(this.MainCol){ this.LV(row,HQ); this.Yf(row,HQ); this.N3(row,HQ); if(Pf.Level!=GP.Level&&row._7AZ)this.SetWidth(this.MainCol,0,0,1,row); if(GP.LN)this.Lk(GP.parentNode); if(Pf.LN){ if(!GP.LN||Pf.parentNode!=GP.parentNode)this.Lk(Pf.parentNode);}} if(!Op){ if(row.MasterRow){ var G=this.J6; if(!GP.MasterRow.Expanded)G.Expand(GP.MasterRow); G.N4(row.MasterRow,GP.MasterRow,next?next.MasterRow:null,1,1,ag); G.Update();} if(row.DetailRow){ var G=row.DetailGrid; if(GP.DetailRow){ if(!GP.DetailRow.Expanded&&!GP.DetailRow.Page)G.Expand(GP.DetailRow); G.N4(row.DetailRow,GP.DetailRow,next?next.DetailRow:null,1,1,ag);} else{ G.DelRow(row.DetailRow); for(var AP=row.firstChild;AP&&AP.Level>row.Level;AP=this.GetNext(AP)){AP.DetailGrid=null;AP.DetailRow=null;} row.DetailGrid=null;row.DetailRow=null;}; G.Update();} else if(GP.DetailRow){ if(this.RefreshDetail)this.RefreshDetail(GP.DetailGrid);}} return aj;}; _7h.prototype.ShowRow=function(row,Kl,Op,ar){ if(row.Fixed){ if(row.Visible)return 1; row.Visible=true; if(Kl)return 1; this.at(row); this.ColorRow(row); if(!ar)this.Update(); return 1;} var GP=row.parentNode; if(!row.Visible&&!ar)this.LV(row); if(!GP.Page){ if(!GP.Visible)this.ShowRow(GP,null,Op,ar); if(!GP.Expanded){ if(this.ChildPaging&&!(GP.State>2)||!Is(GP,"CanExpand")){ var CS=this.HasChildren(GP); row.Visible=true; if(!CS)this.Li(GP); return 0;} if(!ar)this.Expand(GP,null,null,Op);} else{ this.au(GP);}} if(row.Visible)return 1; row.Visible=true; if(Kl)return 1; this.Ne(); this.at(row); if(row.Expanded&&this.HasChildren(row))this.Expand(row,true); this.ColorRow(row); if(!ar){ this.N3(row,true); this.Update();} return 1;}; _7h.prototype.SK=function(){ if(!this.FRow||this.FRow.Fixed)return; for(var AP=this.FRow,row=null;AP&&!AP.Page;AP=AP.parentNode)if(!AP.Visible)row=AP; if(row){ var AP=this.GetNextSibling(row); if(AP&&!AP.Visible)AP=this.GetNextVisible(AP); if(!AP)AP=this.GetPrevVisible(row,1); if(!AP)AP=this.GetFirstVisible(null,4); if(AP)this.Focus(AP,this.FCol); else this.Focus(null,null);}}; _7h.prototype.HideRow=function(row,av,Kl,ar){ if(!row.Visible)return; if(row.Fixed){ if(row==this.FRow)this.Focus(null,null); if(row==this.J5)this.J5=null; if(row==this.ARow)this.ARow=null; this.aw(row); row.Visible=false; row.Selected=false; if(!Kl)this.Update(); return;} if(row==this.J5)this.J5=null; if(row==this.ARow)this.ARow=null; if(!Kl&&this.Paging&&this.GetRowPage(row).State<4)Kl=true; if(!Kl){ if(av){ if(row._7AZ)this.Lh(row); this.Lc(row);} else{ if(row._7AZ)this.Xm(row); this.aw(row);}} if(this.ax)this.ax(row,0); row.Visible=false; this.SK(); var GP=row.parentNode; if(GP.Page&&!this.HasChildren(GP)){ var T=this; function ay(){ row.Visible=true;if(Es.State==0){Es.State=1;T.StartPage(Es,1);} setTimeout(function(){T.HideRow(row,av,Kl);if(av==2)T.DelRow(row);},200);}; var Es=GP.nextSibling; if(Es){ if(!this.AllPages)this.GoToPage(Es); if(Es.State<2){ay();return-1;} var Cq=Es.firstChild; for(var AP=GP.firstChild;AP;AP=GP.firstChild)Es.insertBefore(AP,Cq);} else{ Es=GP.previousSibling; if(Es){ if(!this.AllPages)this.GoToPage(Es); if(Es.State<2){ay();return-1;} for(var AP=GP.firstChild;AP;AP=GP.firstChild)Es.appendChild(AP);} else{}}; if(Es){ if(!this.AllPages&&Es==GP.nextSibling)this.V--; this.Hb(GP); if(this.Paging!=3&&this.YC)this.YC(); if(this.UpdatePager)this.UpdatePager();}} else if(GP.Expanded&&!this.HasChildren(GP)&&!GP._7AZ){ if(this.Xm)this.Xm(GP);} if(!ar)this.N3(row,!Kl); if(!Kl){ this.Update(); this.Ne();}}; _7h.prototype.CopyRow=function(row,GP,next,G,az,empty){ if(!G)G=this; var AP=G.AddRow(GP,next,false,true,row.Def.Name,null,az); if(!AP)return; function Copy(row,AP,G){ G.a0({Type:"Copy",Row:AP,Source:row,Par:GP,Next:next,Grid:G,a1:az,Ea:empty}); if(!empty||row.LN)for(var i in row)if(!Grids.AH[i]&&i!="DetailRow"&&i!="DetailGrid"&&i!="MasterRow"&&i!="Def"&&row[i]!=null)AP[i]=row[i]; G.Nz(AP); AP.Selected=0;AP.Visible=0; G.LV(AP); AP.r0=null;AP.r1=null;AP.r2=null;AP.Count=null;AP._7AZ=null; if(Grids.OnRowAdd)Grids.OnRowAdd(G,AP); if(Grids.OnRowCopy)Grids.OnRowCopy(G,AP,row,empty); if(az&&row.Count){ AP.State=0; AP.Count=row.Count; AP.Copy=row.Copy?row.Copy:row.id;}}; Copy(row,AP,G); if(row.MasterRow&&AP.MasterRow)Copy(row.MasterRow,AP.MasterRow,G.J6); if(row.DetailRow&&AP.DetailRow)Copy(row.DetailRow,AP.DetailRow,row.DetailGrid); if(az&&(row.State==null||row.State>=2)){ G.ShowRow(AP,null,1); for(var Es=row.firstChild;Es;Es=Es.nextSibling){ if(Es.Visible){ var x=G.CopyRow(Es,AP,null,G,true,empty); G.ShowRow(x,null,1); if(!Es.Expanded){x.Expanded=1;G.Collapse(x);x.Expanded=0;} if(Es.MasterRow&&x.MasterRow){ G.J6.ShowRow(x.MasterRow,null,1); if(!Es.MasterRow.Expanded){x.MasterRow.Expanded=1;G.J6.Collapse(x.MasterRow);x.MasterRow.Expanded=0;}} if(Es.DetailRow&&x.DetailRow){ Es.DetailGrid.ShowRow(x.DetailRow,null,1); if(!Es.DetailRow.Expanded){x.DetailRow.Expanded=1;Es.DetailGrid.Collapse(x.DetailRow);x.DetailRow.Expanded=0;}}}}} G.Recalculate(AP,null,true); if(row.MasterRow&&AP.MasterRow)G.J6.Recalculate(AP.MasterRow,null,true); if(row.DetailRow&&AP.DetailRow)row.DetailGrid.Recalculate(AP.DetailRow,null,true); return AP;}; _7h.prototype.a2=function(row,GP,next){ if(!GP&&next)GP=next.parentNode; if(!this.Copying||!this.Adding||GP&&(GP.Deleted||GP.Fixed)||!Is(row,"CanCopy"))return false; var Def=Get(row,"Def").Name; if(!this.Pl(GP,Def))return false; if(Grids.OnCanRowAdd&&!Grids.OnCanRowAdd(this,GP,next))return false; if(!this.AddRow(GP,next,null,null,row.Def.Name,null,null,1))return false; return true;}; _7h.prototype.CopyRows=function(rows,GP,next,G,az,empty){ if(!G)G=this; if(!G.Adding||!rows||!rows.length)return false; var Au=GP?GP:(next?next.parentNode:null); if(Au&&!Au.Page){ if(!Au.Expanded)G.Expand(Au); if(Au.State<4){ setTimeout(function(){G.CopyRows(rows,GP,next,G,az,empty);},100); return true;}} if(Grids.OnCanRowAdd)if(!Grids.OnCanRowAdd(G,GP,next))return false; var AN=new Array(),Ey=rows.length; this.QE(); for(var i=0;i<Ey;i++)AN[i]=G.CopyRow(rows[i],GP,next,G,az,empty); this.QF(); for(var i=0;i<Ey;i++){ if(AN[i]){ var row=AN[i],Ug=null,a3; if(row.MasterRow){ Ug=row.MasterRow; a3=G.J6; a3.ShowRow(Ug);} if(row.DetailRow){ Ug=row.DetailRow; a3=row.DetailGrid; if(!Ug.Page)a3.ShowRow(Ug);} G.ShowRow(AN[i]); if(!rows[i].Expanded&&AN[i]._7AZ){ AN[i].Expanded=1; G.Collapse(AN[i]); AN[i].Expanded=0; if(Ug){ Ug.Expanded=1; a3.Collapse(Ug); Ug.Expanded=0;}}}} G.UploadChanges(); return true;}; _7h.prototype.a4=function(CE,az,empty,below){ if(!this.Copying)return false; var row=CE?this.FRow:this.ARow; if(row==null||row.Fixed||row.Page)return false; var DG=this.CopyRows([row],row.parentNode,below?row.nextSibling:row,this,az,empty); if(!DG)return false; if(row==this.ARow)this.ARow=row.previousSibling; this.Focus(this.ARow,this.FCol); return true;}; _7h.prototype.ActionCopyRow=function(CE){return this.a4(CE,0,0,0);}; _7h.prototype.ActionCopyTree=function(CE){return this.a4(CE,1,0,0);}; _7h.prototype.ActionCopyEmpty=function(CE){return this.a4(CE,1,1,0);}; _7h.prototype.ActionCopyRowBelow=function(CE){return this.a4(CE,0,0,1);}; _7h.prototype.ActionCopyTreeBelow=function(CE){return this.a4(CE,1,0,1);}; _7h.prototype.ActionCopyEmptyBelow=function(CE){return this.a4(CE,1,1,1);}; _7h.prototype.a5=function(CE,az,empty,below,test){ if(!this.Copying)return false; var next=CE?this.FRow:this.ARow; if(next==null||next.Fixed||next.Page)return false; if(below)next=next.nextSibling; var prev=next.previousSibling,GP=next.parentNode; var AJ=new Array(),Au=0; for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP))if(AP.Selected){ if(!this.a2(AP,null,next))continue; AJ[Au++]=AP; if(test&&(AP.firstChild||AP.Count))test++;} if(!Au)return false; if(test)return test; var DG=this.CopyRows(AJ,GP,next,this,az,empty); if(!DG)return false; if(next==this.ARow)this.ARow=prev?prev.previousSibling:GP.firstChild; this.Focus(this.ARow,this.FCol); return true;}; _7h.prototype.a6=function(CE,az,empty,Dy,test){ if(!this.Copying)return false; var GP=CE?this.FRow:this.ARow; if(GP==null||GP.Fixed||GP.Page)return false; var next=Dy?null:GP.firstChild; var prev=Dy?GP.lastChild:null; var AJ=new Array(),Au=0; for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP))if(AP.Selected){ if(!this.a2(AP,GP,next))continue; AJ[Au++]=AP; if(test&&AP.firstChild)test++;} if(!Au)return false; if(test)return test; var DG=this.CopyRows(AJ,GP,next,this,az,empty); if(!DG)return false; if(GP==this.ARow)this.ARow=prev?prev.nextSibling:GP.firstChild; this.Focus(this.ARow,this.FCol); return true;}; _7h.prototype.a7=function(az,empty,page,test,Yd){ if(!this.Copying)return false; var GP; if(page)GP=this.af(); else{ GP=this.XB.lastChild; if(!test){ if(!this.AllPages&&GP!=this.V)this.GoToPage(GP); if(GP.State!=4){ if(this.AllPages&&!Yd)this.ScrollIntoView(GP); var T=this; setTimeout(function(){T.a7(az,empty,0,0,1);},100); return true;}}}; if(!GP)return false; var prev=GP.lastChild; var AJ=new Array(),Au=0; for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP))if(AP.Selected){ if(!this.a2(AP,GP,null))continue; AJ[Au++]=AP; if(test&&AP.firstChild)test++;} if(!Au)return false; if(test)return test; var DG=this.CopyRows(AJ,GP,null,this,az,empty); if(!DG)return false; this.Focus(prev.nextSibling,this.FCol); return true;}; _7h.prototype.ActionCopySelected=function(CE){return this.a5(CE,0,0,0);}; _7h.prototype.ActionCopySelectedTree=function(CE){return this.a5(CE,1,0,0);}; _7h.prototype.ActionCopySelectedEmpty=function(CE){return this.a5(CE,1,1,0);}; _7h.prototype.ActionCopySelectedBelow=function(CE){return this.a5(CE,0,0,1);}; _7h.prototype.ActionCopySelectedTreeBelow=function(CE){return this.a5(CE,1,0,1);}; _7h.prototype.ActionCopySelectedEmptyBelow=function(CE){return this.a5(CE,1,1,1);}; _7h.prototype.ActionCopySelectedChild=function(CE){return this.a6(CE,0,0,0);}; _7h.prototype.ActionCopySelectedTreeChild=function(CE){return this.a6(CE,1,0,0);}; _7h.prototype.ActionCopySelectedEmptyChild=function(CE){return this.a6(CE,1,1,0);}; _7h.prototype.ActionCopySelectedChildEnd=function(CE){return this.a6(CE,0,0,1);}; _7h.prototype.ActionCopySelectedTreeChildEnd=function(CE){return this.a6(CE,1,0,1);}; _7h.prototype.ActionCopySelectedEmptyChildEnd=function(CE){return this.a6(CE,1,1,1);}; _7h.prototype.ActionCopySelectedEnd=function(){return this.a7(0,0,!this.AllPages);}; _7h.prototype.ActionCopySelectedTreeEnd=function(){return this.a7(1,0,!this.AllPages);}; _7h.prototype.ActionCopySelectedEmptyEnd=function(){return this.a7(1,1,!this.AllPages);}; _7h.prototype.ActionCopySelectedEndGrid=function(){return this.a7(0,0,0);}; _7h.prototype.ActionCopySelectedTreeEndGrid=function(){return this.a7(1,0,0);}; _7h.prototype.ActionCopySelectedEmptyEndGrid=function(){return this.a7(1,1,0);}; _7h.prototype.ActionCopySelectedEndGrid=function(){return this.a7(0,0,1);}; _7h.prototype.ActionCopySelectedTreeEndGrid=function(){return this.a7(1,0,1);}; _7h.prototype.ActionCopySelectedEmptyEndGrid=function(){return this.a7(1,1,1);}; _7h.prototype.CopyMenu=function(CE){ var row=CE?this.FRow:this.ARow,T=this; if(this.Dialog&&this.Dialog.Row==this.ARow&&this.Dialog.Col==this.ACol){ this.Dialog.Close(); return true;} if(this.Dialog)this.Dialog.Close(); var M; if(CE&&this.ARow&&this.ARow.Space)M=this.ARow[this.ACol+"CopyMenu"]; else if(this.Cols[this.ACol]&&this.Cols[this.ACol].Type=="Panel")M=this.Cols[this.ACol].CopyMenu; else M=this.Cols.Panel.CopyMenu; if(!M)return false; M=DV.DW(M); if(!M)return false; M.FW=false; var AJ=[],Au=0,AI=M.Items; var a8=row&&!row.Fixed&&!row.Page&&this.a2(row,null,row)?1:0; var a9=this.a5(CE,null,null,null,1),bA=this.a6(CE,null,null,null,1); var bB=CE?this.a7(null,null,null,1):0; var bC=this.Adding&&row&&!row.Fixed&&this.AddRow(null,row,null,null,null,null,null,1)?1:0; var bD=this.Adding&&CE&&this.AddRow(this.af(),null,null,null,null,null,null,1)?1:0; var bE=this.Adding&&this.MainCol&&row&&!row.Fixed&&this.AddRow(row,null,null,null,null,null,null,1)?1:0; var bF=row&&(row.firstChild||row.Count)?1:0; var S={ "CopyRow":a8,"CopyTree":a8&&bF,"CopyEmpty":a8&&bF, "CopyRowBelow":a8,"CopyTreeBelow":a8&&bF,"CopyEmptyBelow":a8&&bF, "CopySelected":a9,"CopySelectedTree":a9>1,"CopySelectedEmpty":a9>1, "CopySelectedBelow":a9,"CopySelectedTreeBelow":a9>1,"CopySelectedEmptyBelow":a9>1, "CopySelectedChild":bA,"CopySelectedTreeChild":bA>1,"CopySelectedEmptyChild":bA>1, "CopySelectedChildEnd":bA&&bF,"CopySelectedTreeChildEnd":bA>1&&bF,"CopySelectedEmptyChildEnd":bA>1&&bF, "CopySelectedEnd":bB,"CopySelectedTreeEnd":bB>1,"CopySelectedEmptyEnd":bB>1, "CopySelectedEndPage":bB,"CopySelectedTreeEndPage":bB>1,"CopySelectedEmptyEndPage":bB>1, "CopySelectedEndGrid":bB,"CopySelectedTreeEndGrid":bB>1,"CopySelectedEmptyEndGrid":bB>1, "AddRow":bC,"AddRowBelow":bC, "AddRowEnd":bD,"AddRowEndPage":bD,"AddRowEndGrid":bD, "AddChild":bE,"AddChildEnd":bE&&bF}; for(var i=0;i<AI.length;i++){ var Es=AI[i].Name,a=S[Es]; if(a!=null){ if(!a)continue; AI[i].AT=this["Action"+Es]; AI[i].Text=this.GetText(Es); if(!AI[i].AT||!AI[i].Text)continue;} AJ[Au++]=AI[i];} M.Items=AJ; M=DV.DW(M); if(!Au)return false; if(Au==1)return M.Items[0].AT?M.Items[0].AT.apply(this,[CE]):false; if(row!=this.ARow)this.ScrollIntoView(row); var Qm=this.ARow,Wc=this.ACol; if(!Qm)return false; var AM=this.IC(Qm,Wc);AM.X=AM.IQ;AM.Y=AM.IR; M.OnSave=function(AI){ var bG=T.ARow,bH=T.ACol; T.ARow=Qm;T.ACol=Wc; M.Close(); if(AI.AT)AI.AT.apply(T,[CE]); T.ARow=bG;T.ACol=bH;}; M.OnClose=function(){ T.Dialog=null;}; HideTip(); M.Base=this.Img.Style+"Menu"; M.Class=this.Img.Style+"CopyMenu"; M=ShowMenu(M,AM); this.Dialog=M;M.Row=Qm;M.Col=Wc;M.Type="Copy"; return true;}; _7h.prototype.ActionCopyMenu=function(CE){return this.CopyMenu(CE);}; _7h.prototype.bI=function(row,av,Kl,Pj){ if(!Pj)this.QE(); for(var AP=row.firstChild;AP;AP=AP.nextSibling)this.bI(AP,av,Kl,1); if(Pj&&(av&&row.Deleted||!av&&row.Deleted!=2))return; if(Pj&&av)av=2; this.ab({Type:"Delete",Row:row,bJ:av,Deleted:row.Deleted,Selected:row.Selected,Expanded:row.Expanded}); var GP=row.parentNode; if(!av&&!GP.Page&&Get(GP,"DefParent")&&!this.HM(GP))this.ChangeDef(GP,Get(GP,"DefParent"),!Kl); row.Deleted=av; if(av&&!GP.Page&&Get(GP,"DefEmpty")&&!this.HM(GP))this.ChangeDef(GP,Get(GP,"DefEmpty"),!Kl); if(av&&Grids.OnRowDelete)Grids.OnRowDelete(this,row,av); if(!av&&Grids.OnRowUndelete)Grids.OnRowUndelete(this,row); if(!Kl){ if(this.ColorClasses&1)this.RefreshRow(row); else this.ColorRow(row);} if(!Pj)this.QF();}; _7h.prototype.DeleteRow=function(row,type,bK){ if(!row||!this.Deleting||!Is(row,"CanDelete"))return false; var av=row.Deleted-0; if(!type){ if(this.ShowDeleted&&!this.AutoUpdate){ if(av)type=3; else type=2;} else type=1;} if(type==3){ if(row.parentNode.Deleted-0)return false;} if(Grids.OnCanRowDelete)type=Grids.OnCanRowDelete(this,row,type); if(type==1)type=confirm(this.GetAlert("ConfirmDel")+" "+this.GetAlert("Row2")+" '"+this.HK(row)+"' ?")?2:0; if(type<=1)return false; if(type==2&&av||type==3&&!av)return false; this.DeleteRowT(row,type,null,bK); if(this.Ph&&!this.ShowDeleted)this.RefreshGanttDependencies(); return true;}; _7h.prototype.DeleteRowT=function(row,type,Kl,bK,ae,Op){ if(this.ShowDeleted){ this.bI(row,type==2);} else{ if(type==2){ this.bI(row,1,Kl); if(this.HasChildren(row)){ this.Collapse(row); if(this.ChildPaging&&row.State>2)row.State=2;} row.Selected=0; if(row.parentNode.Count)row.parentNode.Count--; if(row.Page&&Op){ for(var AP=row.firstChild;AP;AP=AP.nextSibling)this.HideRow(AP,true,Kl);} else this.HideRow(row,true,Kl); if(row.Def.Group){ function bL(row){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(AP.Def.Group)bL(AP); else AP.Visible=0;}}; bL(row);}} else if(type==3){ this.bI(row,0,Kl); row.Deleted=0; if(row.Page&&Op&&this.ShowDetail){; this.J6.ShowDetail(row.MasterRow,this.id);} else this.ShowRow(row,Kl);}}; if(!Op){ if(row.MasterRow){ this.J6.DeleteRowT(row.MasterRow,type,Kl,bK,1,1);} if(row.DetailRow){ row.DetailGrid.DeleteRowT(row.DetailRow,type,Kl,bK,1,1);}} if(!Kl)this.Recalculate(row,null,!Kl); if(bK){ this.DelRow(row); if(!Kl){ this.HideMessage(); if(!this.GetFirstVisible()&&this.Paging!=3)this.UpdatePager(); this.Update();}} else if(!Kl){ if(!ae){ this.UploadChanges(row); if(this.SaveValues)this.SaveCfg();} this.HideMessage(); if(!this.ShowDeleted){ if(!this.GetFirstVisible()&&this.Paging!=3)this.UpdatePager(); this.Update();}} status="";}; _7h.prototype.Xx=function(){ var Em=0,Kl=false; this.ShowDeleted=!this.ShowDeleted; this.Rendering=true; for(var AP=this.GetFirst();AP;AP=this.GetNext(AP)){ if(AP.Deleted){ Em++; if(Em>30){Kl=true;break;}}} if(this.ShowDeleted){ for(var AP=this.GetFirst(null,1);AP;AP=this.GetNext(AP,1))if(AP.Deleted&&!AP.Filtered)this.ShowRow(AP,Kl); for(var AP=this.GetFirst();AP;AP=this.GetNext(AP))if(AP.Deleted&&!AP.Filtered&&!AP.Visible){ if(!Kl){ var Au=AP.parentNode; if(Au.r1&&!(Au.State<4)&&this.HasChildren(Au)){ var Es=this.GetNextVisible(Au); if(Es&&Es.parentNode==Au&&Es.r1){ AP.Visible=true; this.at(AP); this.N3(AP,true);}} if(Au.r1){AP.Visible=true;this.Li(Au);}} AP.Visible=true;} var CE=this.GetFixedRows();for(var AP=0;AP<AP.length;AP++)if(AP.Deleted)this.ShowRow(AP); if(Kl&&this.Paging>0&&this.Paging<3)this.CreatePages(); if(Kl&&this.MainCol)this.SL(0,1);} else{ for(var AP=this.GetFirst();AP;AP=this.GetNext(AP))if(AP.Deleted&&!AP.Filtered)this.HideRow(AP,true,Kl); var CE=this.GetFixedRows();for(var AP=0;AP<AP.length;AP++)if(AP.Deleted&&!AP.Filtered)this.HideRow(AP,true);}; this.Rendering=false; if(this.Ph)this.RefreshGanttDependencies(); if(!Kl)this.Update(); return Kl;}; _7h.prototype.ActionDeleteRow=function(CE){return this.DeleteRow(CE?this.FRow:this.ARow,this.ShowDeleted&&!this.AutoUpdate?2:1);}; _7h.prototype.ActionUndeleteRow=function(CE){return this.DeleteRow(CE?this.FRow:this.ARow,3);}; _7h.prototype.ActionRemoveRow=function(CE){return this.DeleteRow(CE?this.FRow:this.ARow,1,1);}; _7h.prototype.bM=function(av,bK){ if(!this.Deleting)return false; var AJ=this.bN(); if(AJ.length==0)return false; var Em=0; for(var i=0;i<AJ.length;i++)if(AJ[i].Deleted)Em++; if(av==null)av=!Em; else if(!Em&&!av||Em==AJ.length&&av)return false; if((!this.ShowDeleted||this.AutoUpdate)&&av){ var bO=this.GetAlert("ConfirmDel"),bP=this.GetAlert("SelRows"); if(bO&&bP&&!confirm(bO+" "+bP+" ("+AJ.length+") ?"))return false;} var type=av?2:3; status=this.GetText("DelSelected"); if(this.RowCount<this.SynchroCount)this.bQ(AJ,type,bK); else{ this.ShowMessage(this.GetText("DelSelected")); var T=this;setTimeout(function(){T.bQ(AJ,type,bK);},10);}; return true;}; _7h.prototype.bQ=function(AJ,type,bK){ var Db=AJ.length; for(var i=0;i<AJ.length;i++){ var Ak=type; if(Grids.OnCanRowDelete)Ak=Grids.OnCanRowDelete(this,AJ[i],type); if(Ak==2&&AJ[i].Deleted||Ak==3&&!AJ[i].Deleted){Db--;AJ[i]=null;}} var Kl=Db>30; var ae=Db>1&&this.AutoUpdate; this.QE(); for(var i=0;i<AJ.length;i++){ if(AJ[i]){ var av=AJ[i].Deleted; if(!av||type==3)this.DeleteRowT(AJ[i],av?3:2,AJ[i].Fixed?false:Kl,bK,ae);}} this.QF(); if(Kl||ae)this.UploadChanges(); if(this.Ph&&!this.ShowDeleted)this.RefreshGanttDependencies(); if(Kl){ this.Calculate(2,true); if(this.Paging)this.SN(); else{this.Ne();this.UpdateBody();this.HideMessage();this.Update();}} else this.HideMessage(); if(this.SaveValues)this.SaveCfg(); status="";}; _7h.prototype.ActionDeleteSelected=function(){ if(Grids.OnDeleteAll&&Grids.OnDeleteAll(this,1))return false; return this.bM(true);}; _7h.prototype.ActionUndeleteSelected=function(){ if(Grids.OnDeleteAll&&Grids.OnDeleteAll(this,0))return false; return this.bM(false);}; _7h.prototype.ActionRemoveSelected=function(){ if(Grids.OnDeleteAll&&Grids.OnDeleteAll(this,2))return false; return this.bM(true,true);}; _7h.prototype.GenerateId=function(row,bR){ var id=this.LastId;if(id!=null)id+=""; var AL=this.IdNames,Nr=this.Nr,C=this.IdChars,bS=this.bT; var Bb,bU,AP,Ey,bV=AL.length-1,bW=this.AppendId,OE=0,bX=this.IdCompare&4?1:0; var bY=id.length,bZ=this.IdPrefix,ba=this.Ek; if(bW){ Bb=bR?bR:Get(row,this.Nr); bU=Bb==null?"":(Bb+"").replace(/\$/g,"_").replace(this.bb,"\\$&");} var R=new RegExp("^"+(bU?bU:"")+this.bc,bX?"i":""); if(bV){ var bd=new Array(); for(var i=0;i<bV;i++){ var x=AL[i]=="Def"?row.Def.Name:Get(row,AL[i]); x=x==null?"":(x+"").replace(/\$/g,"_"); if(bX)x=x.toLowerCase(); bd[i]=x;}} function be(AP,test,bf){ if(AP==row)return; if(bf){ var bg=AP.id; if(bg==null)return; bg=(bg+"").split('$'); if(bV)for(var i=0;i<bV;i++)if(bd[i]!=(bX?bg[i].toLowerCase():bg[i]))return; bg=bg[bg.length-1];} else{ be(AP,test,1); if(bV)for(var i=0;i<bV;i++){ var x=AL[i]=="Def"?AP.Def.Name:Get(AP,AL[i]); x=x==null?"":(x+"").replace(/\$/g,"_"); if(bX)x=x.toLowerCase(); if(bd[i]!=x)return;} var bg=Get(AP,Nr); if(bg==null)return; bg=(bg+"").replace(/\$/g,"_");}; var M=bg.match(R); if(!M)return; bg=M[1]; if(bR){ if(bW){if(!bg)OE=1;} else if(bg==bR)OE=1;} if(test)return bg==id; var Db=bg.length; if(Db==bY){ for(var i=0;i<Db;i++){ var bh=bS[id.charAt(i)]; var bi=bS[bg.charAt(i)]; if(bi!=bh){ if(bi>bh)id=bg; break;}}} else if(Db>bY){id=bg;bY=Db;}}; if(this.FullId){ if(row.parentNode.Page){ for(Ey=this.XB.firstChild;Ey;Ey=Ey.nextSibling){ for(AP=Ey.firstChild;AP;AP=AP.nextSibling)be(AP);}} else for(AP=row.parentNode.firstChild;AP;AP=AP.nextSibling)be(AP);} else{ for(AP=this.GetFirst();AP;AP=this.GetNext(AP))be(AP);}; var CE=this.GetFixedRows(); if(bR&&!OE){ if(!this.FullId||row.parentNode.Page)for(AP=0;AP<CE.length;AP++)be(CE[AP],1); if(!OE)return bR;} while(1){ for(var i=bY-1;i>=0;i--){ var BD=id.charAt(i); var JW=bS[BD]; if(JW==null||JW==C.length-1){id=id.slice(0,i)+C.charAt(0)+id.slice(i+1);continue;} id=id.slice(0,i)+C.charAt(JW+1)+id.slice(i+1); break;} if(i<0){ id=C.charAt(this.NumberId?this.NumberId:0); for(i=0;i<bY;i++)id+=C.charAt(0);} var Ex=1; if(!this.FullId||row.parentNode.Page)for(AP=0;AP<CE.length;AP++)if(be(CE[AP],1)){Ex=0;break;} if(Ex)break;} id=this.IdPrefix+id+this.IdPostfix; if(bW)id=Bb+id; if(Grids.OnGenerateId)id=Grids.OnGenerateId(this,row,id); return id;}; _7h.prototype.bj=function(row){ if(this.Ol){ var id="",x,i,Es; for(i=0;i<this.Ol;i++){ Es=this.IdNames[i]; if(Es=="Def")x=row.Def.Name; else x=Get(row,Es); if(x==null)x=""; if(Es=="id")id+="$"+(x+"").replace(/.\$/,""); else id+="$"+(x+"").replace(/\$/g,"_");} id=id.slice(1); if(this.FullId){ var U0=row.parentNode.id; if(U0)id=U0+"$"+id;} return id;} return row.id;}; _7h.prototype.am=function(row){ if(row.Kind!="Data")return; var BD=this.Nr; var Dh=Get(row,BD); var Es=this.GenerateId(row,Dh); if(Es!=Dh){ row[BD]=Es; row[BD+"Changed"]=1; row.Changed=1; if(this.Cols[BD])this.RefreshCell(row,BD); if(Grids.OnChangeId)Grids.OnChangeId(this,row,BD,Dh);}}; _7h.prototype.Nz=function(row){ if(row.Kind!="Data")return; var BD=this.Nr,id=this.GenerateId(row,this.AppendId?Get(row,BD):null); row[BD]=id; if(this.Cols[BD]){ row[BD+"Changed"]=1; row.Changed=1;} id=this.bj(row); if(Grids.OnSetRowId)id=Grids.OnSetRowId(this,row,id); row.id=id;}; _7h.prototype.GetRows=function(Sec){ var AP,AJ=new Array(),Au=0; for(AP=Sec.firstChild;AP;AP=AP.nextSibling)AJ[Au++]=AP; return AJ;}; _7h.prototype.GetFixedRows=function(){ var AJ=new Array(),Au=0,AP; for(AP=this.XH.firstChild;AP;AP=AP.nextSibling)AJ[Au++]=AP; for(AP=this.XF.firstChild;AP;AP=AP.nextSibling)AJ[Au++]=AP; return AJ;}; _7h.prototype.JU=function(){ var AJ=new Array(),Au=0,AP; for(AP=this.XH.firstChild;AP;AP=AP.nextSibling)if(AP.Kind=="Filter")AJ[Au++]=AP; for(AP=this.XF.firstChild;AP;AP=AP.nextSibling)if(AP.Kind=="Filter")AJ[Au++]=AP; return AJ;}; _7h.prototype.GetSelRows=function(){ var AJ=new Array(),Au=0,CE; CE=this.GetRows(this.XH); for(var i=0;i<CE.length;i++)if(CE[i].Selected)AJ[Au++]=CE[i]; for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP))if(AP.Selected)AJ[Au++]=AP; CE=this.GetRows(this.XF); for(var i=0;i<CE.length;i++)if(CE[i].Selected)AJ[Au++]=CE[i]; return AJ;}; _7h.prototype.GetRowById=function(id){ var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++)if(CE[i].id==id)return CE[i]; if(this.XS)for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.id==id)return AP; for(var AP=this.GetFirst();AP;AP=this.GetNext(AP))if(AP.id==id)return AP; return null;}; _7h.prototype.GetFirst=function(AN,type){ if(type&4&&this.XH.firstChild)return this.XH.firstChild; if(!AN){ AN=this.XB.firstChild; while(AN&&!AN.firstChild)AN=AN.nextSibling;} if(!AN)return null; var row=AN.firstChild; if(!row&&type&4)return this.XF.firstChild; return row;}; _7h.prototype.GetLast=function(AN,type){ if(type&4&&this.XF.lastChild)return this.XF.lastChild; if(!AN){ AN=this.XB.lastChild; while(AN&&!AN.firstChild)AN=AN.previousSibling;} if(!AN)return null; var row=AN.lastChild; if(!row&&type&4)return this.XH.lastChild; while(row.lastChild&&(!(type&1)||row.Expanded))row=row.lastChild; return row;}; _7h.prototype.GetNext=function(row,type){ var AP=row.firstChild; if(AP&&(!(type&1)||row.Expanded))return AP; AP=row.nextSibling; if(AP)return AP; while(!row.nextSibling&&row.parentNode)row=row.parentNode; if(row.Page){ if(type&2||!row.nextSibling)return null; row=row.nextSibling; while(row&&!row.firstChild)row=row.nextSibling; return row?row.firstChild:null;} return row.nextSibling;}; _7h.prototype.GetPrev=function(row,type){ var AP=row.previousSibling; if(AP)while(AP.lastChild&&(!(type&1)||AP.Expanded))AP=AP.lastChild; else{ AP=row.parentNode; if(AP.Page){ if(type&2)return null; AP=AP.previousSibling; while(AP&&!AP.firstChild)AP=AP.previousSibling; if(AP){ AP=AP.lastChild; while(AP.lastChild&&(!(type&1)||AP.Expanded))AP=AP.lastChild;}}}; return AP;}; _7h.prototype.GetFirstVisible=function(AN,type){ var row=this.GetFirst(AN,type); if(row&&!row.Visible)return this.GetNextVisible(row,AN?type|2:type); return row;}; _7h.prototype.GetLastVisible=function(AN,type){ if(!AN){ AN=this.XB.lastChild; while(AN&&!AN.firstChild)AN=AN.previousSibling;} if(!AN)return null; var row=AN.lastChild;if(!row)return null; if(row&&!row.Visible)return this.GetPrevVisible(row,AN?type|2:type); while(row.lastChild&&row.Visible&&(!(type&1)||row.Expanded))row=row.lastChild; if(row&&!row.Visible)return this.GetPrevVisible(row,AN?type|2:type); return row;}; _7h.prototype.GetNextVisible=function(row,type){ while(1){ var AP=row.Visible?row.firstChild:null; if(!AP||type&1&&!row.Expanded){ AP=row.nextSibling; if(!AP){ var AP=row; while(!AP.nextSibling&&!AP.Page)AP=AP.parentNode; if(AP.Page){ if(type&2||!AP.nextSibling)break; AP=AP.nextSibling; while(AP&&!AP.firstChild)AP=AP.nextSibling; if(AP)AP=AP.firstChild;} else AP=AP.nextSibling;}} if(!AP)break; if(AP.Visible)return AP; row=AP;} return null;}; _7h.prototype.GetPrevVisible=function(row,type){ var AP=row.previousSibling; while(AP&&!AP.Visible)AP=AP.previousSibling; if(AP)while(AP.lastChild&&AP.lastChild.Visible&&(!(type&1)||AP.Expanded))AP=AP.lastChild; else{ AP=row.parentNode; if(AP.Page){ if(type&2)return null; AP=AP.previousSibling; while(AP&&!AP.firstChild)AP=AP.previousSibling; if(AP){ AP=AP.lastChild; while(AP.lastChild&&AP.lastChild.Visible&&(!(type&1)||AP.Expanded))AP=AP.lastChild;}}}; return AP;}; _7h.prototype.GetPrevShift=function(row,SW,Em,F6){ var LZ=Em; if(row&&row.Space>=10){ for(var AP=row.previousSibling;AP&&Em>0;AP=AP.previousSibling){ if(AP.Space==row.Space&&AP.Cells&&AP.Visible){row=AP;Em--;}} return[Em>0?null:row,0];} if(!row||Em!=LZ||row.Space>=3&&row.Space<=9){ for(var AP=row?row.previousSibling:this.XS.lastChild;AP&&Em>0;AP=AP.previousSibling){ if(AP.Space>=3&&AP.Space<=9&&AP.Cells&&AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if(!row||Em!=LZ||row.Fixed=="Foot"){ for(var AP=row?row.previousSibling:this.XF.lastChild;AP&&Em>0;AP=AP.previousSibling){ if(AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if(!row||Em!=LZ||row.Space==2){ for(var AP=row?row.previousSibling:this.XS.lastChild;AP&&Em>0;AP=AP.previousSibling){ if(AP.Space==2&&AP.Cells&&AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if((!row||Em!=LZ||row.Fixed=="Foot"||!row.Fixed||row.Space>=2)&&Em>0){ if(!row||row.Fixed){ row=this.AllPages?this.XB.lastChild:_7k(this.XB,this.V); if(row.State==4){row=this.GetLastVisible(row,1);SW=null;} else SW=this.Ha(row)/this.Hu-1; if(row&&row.Visible)Em--;} if(row&&Em>0){ while(Em&&row){ if(row.Page&&!this.AllPages){row=null;SW=null;break;} if(row.Page&&row.State<4){ if(SW==null)SW=row.State<2?row.Count:row.childNodes.length; if(Em<=SW){SW-=Em;Em=0;} else{ Em-=SW; row=row.previousSibling; if(row)SW=this.Ha(row)/this.Hu-1;}} else{ var AP=row.previousSibling; if(AP&&AP.Page){ if(AP.State<4){ row=AP; SW=row.State<2?row.Count:row.childNodes.length; continue;} AP=AP.lastChild;} if(AP&&this.G4&&F6){ var bk=this.Q4(AP,F6); if(AP==bk)while(AP.lastChild&&AP.Expanded&&AP.Visible)AP=AP.lastChild; else AP=bk;} else if(AP)while(AP.lastChild&&AP.Expanded&&AP.Visible)AP=AP.lastChild; else AP=row.parentNode; if(AP&&!AP.Page&&AP.Visible)Em--; row=AP;}}} if(Em>0)row=null;} if(!row||Em!=LZ||row.Space==1){ for(var AP=row?row.previousSibling:this.XS.lastChild;AP&&Em>0;AP=AP.previousSibling){ if(AP.Space==1&&AP.Cells&&AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if(!row||Em!=LZ||row.Fixed=="Head"){ for(var AP=row?row.previousSibling:this.XH.lastChild;AP&&Em>0;AP=AP.previousSibling){ if(AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if(!row||Em!=LZ||row.Space==0){ for(var AP=row?row.previousSibling:this.XS.lastChild;AP&&Em>0;AP=AP.previousSibling){ if(AP.Space==0&&AP.Cells&&AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if(Em>0)return[null,0]; return[row,SW];}; _7h.prototype.GetNextShift=function(row,SW,Em,F6){ var LZ=Em; if(row&&row.Space>=10){ for(var AP=row.nextSibling;AP&&Em>0;AP=AP.nextSibling){ if(AP.Space==row.Space&&AP.Cells&&AP.Visible){row=AP;Em--;}} return[Em>0?null:row,0];} if(!row||Em!=LZ||row.Space==0){ for(var AP=row?row.nextSibling:this.XS.firstChild;AP&&Em>0;AP=AP.nextSibling){ if(AP.Space==0&&AP.Cells&&AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if(!row||Em!=LZ||row.Fixed=="Head"){ for(var AP=row?row.nextSibling:this.XH.firstChild;AP&&Em>0;AP=AP.nextSibling){ if(AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if(!row||Em!=LZ||row.Space==1){ for(var AP=row?row.nextSibling:this.XS.firstChild;AP&&Em>0;AP=AP.nextSibling){ if(AP.Space==1&&AP.Cells&&AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if((!row||Em!=LZ||row.Fixed=="Head"||!row.Fixed||row.Space<=1)&&Em>0){ if(!row||row.Fixed){ row=this.AllPages?this.XB.firstChild:_7k(this.XB,this.V); if(row.State==4){row=this.GetFirstVisible(row,1);SW=null;} else SW=this.Ha(row)/this.Hu-1; if(row&&row.Visible)Em--;} if(row&&Em>0){ while(Em&&row){ if(row.Page&&row.State<4){ if(!this.AllPages){row=null;SW=null;break;} if(SW==null)SW=-1; var EV=this.Ha(row)/this.Hu; if(Em<EV-SW){SW+=Em;Em=0;} else{Em-=EV-SW;row=row.nextSibling;SW=0;}} else{ var AP; if(row.G4&&row[F6+"RowSpan"]&&F6&&this.Cols[F6].Spanned){ for(AP=row.nextSibling;AP&&AP[F6+"RowSpan"]==0;AP=AP.nextSibling);} else AP=row.firstChild; if(!AP||!row.Page&&(!row.Expanded||!row.Visible)){ AP=row.nextSibling; if(!AP){ AP=row.parentNode; while(AP&&!AP.nextSibling)AP=AP.parentNode; if(AP)AP=AP.nextSibling;}} if(AP&&!AP.Page&&AP.Visible)Em--; row=AP;}}} if(Em>0)row=null;} if(!row||Em!=LZ||row.Space==2){ for(var AP=row?row.nextSibling:this.XS.firstChild;AP&&Em>0;AP=AP.nextSibling){ if(AP.Space==2&&AP.Cells&&AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if(!row||Em!=LZ||row.Fixed=="Foot"){ for(var AP=row?row.nextSibling:this.XF.firstChild;AP&&Em>0;AP=AP.nextSibling){ if(AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if(!row||Em!=LZ||row.Space>=3&&row.Space<=9){ for(var AP=row?row.nextSibling:this.XS.firstChild;AP&&Em>0;AP=AP.nextSibling){ if(AP.Space>=3&&AP.Space<=9&&AP.Cells&&AP.Visible){row=AP;Em--;}} if(Em>0)row=null;} if(Em>0)return[null,0]; return[row,SW];}; _7h.prototype.GetNextSibling=function(row){ var Es=row.nextSibling; if(Es)return Es; Es=row.parentNode.nextSibling; while(Es){ if(Es.firstChild)return Es.firstChild; Es=Es.nextSibling;} return null;}; _7h.prototype.GetNextSiblingVisible=function(row){ do{ row=this.GetNextSibling(row);}while(row&&!row.Visible); return row;}; _7h.prototype.ax=function(row,select){ for(var x=row.firstChild;x;x=x.nextSibling)if(x.Visible)this.ax(x,select); if((row.Selected?row.Selected:0)!=select){ if(Grids.OnSelect)Grids.OnSelect(this,row,!select); row.Selected=!row.Selected; if(this.ColorClasses&2)this.RefreshRow(row);else this.ColorRow(row); this.SV(row);}}; _7h.prototype.bl=function(row,AJ){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(AP.Selected&&AP.Visible&&Is(AP,"CanDelete"))AJ[AJ.length]=AP; this.bl(AP,AJ);}}; _7h.prototype.bN=function(){ var AJ=new Array(); for(var Au=this.XB.firstChild;Au;Au=Au.nextSibling)if(!(Au.State<2))this.bl(Au,AJ); return AJ;}; _7h.prototype.SelectRow=function(row,Og,bm){ if(!row||row.Page||!Is(row,"CanSelect")||!this.Selecting)return false; this.Yo=null; if(row.Selected==2){ for(var BD in this.Cols){ var BJ=BD+"Selected"; if(row[BJ])row[BJ]=null;}} if(Og!=null)if(!row.Selected==!Og)return false; if(Grids.OnSelect)Grids.OnSelect(this,row,row.Selected?1:0); row.Selected=Og==null?!(row.Selected-0):Og; if(this.ColorClasses&2)this.RefreshRow(row);else this.ColorRow(row); this.SV(row); if(!bm&&this.SaveSelected)this.SaveCfg(); return true;}; _7h.prototype.SelectAllRows=function(select){ if(!this.Selecting)return false; var page=this.Paging==3||this.Paging&&!this.AllPages?this.GetFPage():null,type=page?2:0; if(this.Paging==3&&(!this.FRow||this.FRow.Fixed)){ var Ai=this.GetAlert("NoActivePage"); if(Ai){ if(Grids.OnSelectAll&&Grids.OnSelectAll(this,select))return true; alert(Ai); return true;} if(!page||page.State<2)return false;} var Og=0,bn=0; for(var AP=this.GetFirstVisible(page,type|1);AP;AP=this.GetNextVisible(AP,type|1)){ if(!Is(AP,"CanSelect"))continue; if(AP.Selected){Og=1;if(bn)break;} else{bn=1;if(Og)break;}} if(select==null)select=!Og; if(select==-1){ if(!Og)select=1; else if(!bn)select=0;} if(select==0&&Og==0||select==1&&bn==0)return false; if(Grids.OnSelectAll&&Grids.OnSelectAll(this,select))return true; if(select==1)type|=1; if(this.RowCount<this.SynchroCount)this.bo(select,type,page); else{ this.ShowMessage(this.GetText("SelectAll")); var T=this;setTimeout(function(){T.bo(select,type,page);},10);}; return true;}; _7h.prototype.bo=function(select,type,page){ for(var AP=this.GetFirstVisible(page,type);AP;AP=this.GetNextVisible(AP,type)){ if(Is(AP,"CanSelect")&&!AP.Selected==select||select==-1)this.SelectRow(AP);} this.Yo=select==-1?null:select; if(this.SaveSelected)this.SaveCfg(); this.HideMessage();}; _7h.prototype.SelectRange=function(r1,KF,r2,KG,Og,PK,Ta,Tc,AJ){ if(!this.Selecting||KF&&!this.SelectingCells)return; var next=PK&1?this.GetNextVisible:this.GetNext; var type=PK&2?1:0; var Au,AP,dir=0; var Color=this.ColorClasses&2?"RefreshRow":"ColorRow"; var ColorCell=this.ColorClasses&2?"RefreshCell":"ColorCell"; if(Og==2){ if(!r1||r1.Fixed)Og=1; else if(!KF)Og=r1.Selected?0:1; else Og=r1.Selected==1||r1.Selected==2&&Is(r1,KF+"Selected")?0:1;} if(!r1||r1.Fixed=="Foot"||r1.Space>=2){ if(PK&4)return; r1=dir&1?this.GetLastVisible(null,type):this.GetLast(null,type); if(KF&&Ta!=null)KF=this.Hi(r1,Ta); dir=-1;} else if(r1.Fixed=="Head"||r1.Space<=1){ if(PK&4)return; r1=dir&1?this.GetFirstVisible():this.GetFirst(); if(KF&&Ta!=null)KF=this.Hi(r1,Ta); dir=1;} if(!r2||r2.Fixed=="Foot"||r2.Space>=2){ if(PK&4||dir==-1)return; r2=dir&1?this.GetLastVisible(null,type):this.GetLast(null,type); if(KF&&Tc!=null)KG=this.Hi(r2,Tc); dir=1;} else if(r2.Fixed=="Head"||r2.Space<=1){ if(PK&4||dir==1)return; r2=dir&1?this.GetFirstVisible():this.GetFirst(); if(KF&&Tc!=null)KG=this.Hi(r2,Tc); dir=-1;} if(!r1||!r2)return; if(!dir&&this.Paging){ var bp=this.GetRowPage(r1),bq=this.GetRowPage(r2); if(bp!=bq){ for(Au=bp;Au&&Au!=bq;Au=Au.nextSibling); dir=Au==bq?1:-1;}} if(!dir){ var TY=r1,TZ=r2; while(1){ if(!TY||TZ==r1){dir=-1;break;} if(!TZ||TY==r2){dir=1;break;} TY=next(TY); TZ=next(TZ);}} if(dir<0){AP=r1;r1=r2;r2=AP;} if(AJ){ var br=AJ[0],bs=AJ[2]; var bt=[],bu=[],OT=[],R=[]; for(var AP=r1;AP;AP=next(AP,type)){ if(AP==br){OT=R;R=[];br=null;} R[R.length]=AP; if(AP==bs){bt=R;R=[];bs=null;} if(AP==r2){ if(!bs){OT=OT.length?OT.concat(R):R;} else if(br){ for(var AP=br;AP;AP=next(AP,type)){ if(AP==r1)break; if(AP==bs){ OT=R; for(var AP=br;AP;AP=next(AP,type)){bu[bu.length]=AP;if(AP==bs)break;} br=null;bs=null; break;}}} if(bs){ bt=R; for(AP=next(r2,type);AP;AP=next(AP,type)){bu[bu.length]=AP;if(AP==bs)break;}} if(br)for(AP=br;AP&&AP!=r1;AP=next(AP,type))bu[bu.length]=AP; break;}}} if(!KF){ if(!AJ){ for(var AP=r1;AP;AP=next(AP,type)){ if(!AP.Selected==Og&&Is(AP,"CanSelect")){ if(AP.Selected==2)for(var BD in this.Cols){var BJ=BD+"Selected";if(row[BJ])row[BJ]=null;} if(Grids.OnSelect)Grids.OnSelect(this,AP,!Og); AP.Selected=Og; if(!(PK&8))this[Color](AP); this.SV(AP);} if(AP==r2)break;}} else{ var bv=this.ARow;this.ARow=null; for(var i=0,Au=bu.length;i<Au;i++)if(Is(bu[i],"CanSelect"))this[Color](bu[i]); for(var i=0,Au=OT.length;i<Au;i++){var AP=OT[i],bw=AP.Selected;AP.Selected=Og;this[Color](AP);AP.Selected=bw;} this.ARow=bv;}} else{ var S=[]; for(var BD=KF;BD;BD=this.GetNextCol(BD)){S[S.length]=BD;if(BD==KG)break;} if(!BD){ S=[]; BD=KF;KF=KG;KG=BD; for(var BD=KF;BD;BD=this.GetNextCol(BD)){S[S.length]=BD;if(BD==KG)break;}} if(!AJ){ var Au=S.length,Dh=!(PK&8); var AJ=new Object(); for(var i=0;i<Au;i++)AJ[S[i]]=1; var X=new Array(),x=0; for(var BD in this.Cols)if(!AJ[BD]&&BD!="Panel")X[x++]=BD; for(var AP=r1;AP;AP=next(AP,type)){ if(!Is(AP,"CanSelect")){if(AP==r2)break;continue;} var B3=AP.Selected; if(!B3){ if(Og){ if(Grids.OnSelect)Grids.OnSelect(this,AP,0); if(!x){AP.Selected=1;this[Color](AP);} else{ AP.Selected=2; for(var i=0;i<Au;i++){AP[S[i]+"Selected"]=1;if(Dh)this[ColorCell](AP,S[i]);}}; this.SV(AP);}} else if(B3==1){ if(!Og){ if(Grids.OnSelect)Grids.OnSelect(this,AP,1); if(!x){AP.Selected=0;this[Color]();} else{ AP.Selected=2; for(var i=0;i<x;i++)AP[X[i]+"Selected"]=1; for(var i=0;i<Au;i++)if(this.Cols[S[i]].Visible)if(Dh)this[ColorCell](AP,S[i]);}; this.SV(AP);}} else{ var Em=0; for(var i=0;i<x;i++)if(!AP[X[i]+"Selected"]!=Og)Em++; if(Grids.OnSelect)Grids.OnSelect(this,AP,Em==x?(Og?0:1):2); for(var i=0;i<Au;i++){ var bx=S[i]+"Selected"; if(!AP[bx]==Og){AP[bx]=Og;if(Dh)this[ColorCell](AP,S[i]);}} if(Em==x){ for(var i=0;i<Au;i++)AP[S[i]+"Selected"]=null; for(var i=0;i<x;i++)AP[X[i]+"Selected"]=null; AP.Selected=Og;} if(!Og)this.SV(AP);}; if(AP==r2)break;}} else{ var bv=this.ARow;this.ARow=null; var X=[],by=[],bz=[],NL={}; for(var BD=AJ[1];BD;BD=this.GetNextCol(BD)){ X[X.length]=BD; NL[BD]=1; if(BD==AJ[3])break;} for(var i=0;i<S.length;i++){ if(!NL[S[i]])bz[bz.length]=S[i]; else NL[S[i]]=null;} for(var BD in NL)if(NL[BD])by[by.length]=BD; var b0=by.length,b1=bz.length,b2=X.length,bx=S.length; for(var i=0;i<bu.length;i++){ var AP=bu[i];if(!Is(AP,"CanSelect"))continue; for(var j=0;j<b2;j++)this[ColorCell](AP,X[j]);} for(var i=0;i<OT.length;i++){ var AP=OT[i];if(!Is(AP,"CanSelect"))continue; var bw=AP.Selected;AP.Selected=Og; for(var j=0;j<bx;j++)this[ColorCell](AP,S[j]); AP.Selected=bw;} for(var i=0;i<bt.length;i++){ var AP=bt[i];if(!Is(AP,"CanSelect"))continue; var bw=AP.Selected;AP.Selected=Og; for(var j=0;j<b1;j++)this[ColorCell](AP,bz[j]); AP.Selected=bw; for(var j=0;j<b0;j++)this[ColorCell](AP,by[j]);} this.ARow=bv;}}; this.Refresh(); if(this.SaveSelected)this.SaveCfg(); this.Yo=null; return[r1,KF,r2,KG];}; _7h.prototype.Bj=function(row){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(AP.Selected&&(AP.CanSelect==null?AP.Def.CanSelect:AP.CanSelect))this.SelectRow(AP); if(AP.firstChild)this.Bj(AP);}}; _7h.prototype.ActionClearSelection=function(){ for(var AP=this.XB.firstChild;AP;AP=AP.nextSibling)this.Bj(AP); this.Yo=0; return true;}; _7h.prototype.ActionSelectRow=function(CE){return this.SelectRow(CE?this.FRow:this.ARow,true);}; _7h.prototype.ActionDeselectRow=function(CE){return this.SelectRow(CE?this.FRow:this.ARow,false);}; _7h.prototype.ActionSelectCell=function(CE){ if(!this.Selecting||!this.SelectingCells)return false; var row=CE?this.FRow:this.ARow,F6=CE?this.FCol:this.ACol; if(!Is(row,"CanSelect")||row.Selected==1||row.Selected==2&&Is(row,F6+"Selected"))return false; this.SelectRange(row,F6,row,F6,1); return true;}; _7h.prototype.ActionDeselectCell=function(CE){ if(!this.Selecting||!this.SelectingCells)return false; var row=CE?this.FRow:this.ARow,F6=CE?this.FCol:this.ACol; if(!Is(row,"CanSelect")||row.Selected==0||row.Selected==2&&!Is(row,F6+"Selected"))return false; this.SelectRange(row,F6,row,F6,0); return true;}; _7h.prototype.ActionSelectRowRange=function(){return this.SelectRange(this.FRow,null,this.ARow,null,1,7)?1:0;}; _7h.prototype.ActionDeselectRowRange=function(){return this.SelectRange(this.FRow,null,this.ARow,null,0,7)?1:0;}; _7h.prototype.ActionInvertRowRangeFirst=function(){return this.SelectRange(this.FRow,null,this.ARow,null,2,7)?1:0;}; _7h.prototype.ActionSelectCellRange=function(){return this.SelectingCells&&this.SelectRange(this.FRow,this.FCol,this.ARow,this.ACol,1,7)?1:0;}; _7h.prototype.ActionDeselectCellRange=function(){return this.SelectingCells&&this.SelectRange(this.FRow,this.FCol,this.ARow,this.ACol,0,7)?1:0;}; _7h.prototype.ActionInvertCellRangeFirst=function(){return this.SelectingCells&&this.SelectRange(this.FRow,this.FCol,this.ARow,this.ACol,2,7)?1:0;}; _7h.prototype.ActionSelectAll=function(){return this.SelectAllRows(1);}; _7h.prototype.ActionDeselectAll=function(){return this.SelectAllRows(0);}; _7h.prototype.ActionInvertAll=function(){return this.SelectAllRows(-1);}; _7h.prototype.ActionSelectRows=function(){return this.b3(0,1);}; _7h.prototype.ActionDeselectRows=function(){return this.b3(0,0);}; _7h.prototype.ActionInvertRowsFirst=function(){return this.b3(0,2);}; _7h.prototype.ActionSelectCells=function(){return this.b3(1,1);}; _7h.prototype.ActionDeselectCells=function(){return this.b3(1,0);}; _7h.prototype.ActionInvertCellsFirst=function(){return this.b3(1,2);}; _7h.prototype.b3=function(cells,Og){ if(!this.Selecting||cells&&!this.SelectingCells)return false; var AS=Grids.Bc;if(!AS)return false; if(AS.Row.Fixed)return false; AS.Action="Select"; AS.Move=this.b4; AS.Pz=this.b5; AS.Type=7; AS.Do=Og; AS.Cells=cells; AS.b6=[]; return true;}; _7h.prototype.b4=function(){ var AS=Grids.Bc;if(!AS)return false; var AJ=this.SelectRange(AS.Row,AS.Cells?AS.Col:null,this.ARow,this.ACol,AS.Do,AS.Type,null,this.Event.X,AS.b6); if(AJ)AS.b6=AJ; this.P9(this.ARow); return true;}; _7h.prototype.b5=function(){ var AS=Grids.Bc;if(!AS)return false; this.SelectRange(AS.Row,AS.Cells?AS.Col:null,AS.Row==AS.b6[0]?AS.b6[2]:AS.b6[0],AS.Col==AS.b6[1]?AS.b6[3]:AS.b6[1],AS.Do,AS.Type|8,null,0); return true;}; _7h.prototype.ActionSelectOddRows=function(){return this.b7(1);}; _7h.prototype.ActionDeselectOddRows=function(){return this.b7(0);}; _7h.prototype.ActionInvertOddRows=function(){return this.b7(2);}; _7h.prototype.b7=function(Og){ if(!this.Selecting)return false; var AS=Grids.Bc;if(!AS)return false; AS.Action="SelectPanel"; AS.Move=this.b8; AS.Do=Og; if(Og==2||!Og!=!AS.Row.Selected)this.SelectRow(AS.Row); AS.Pz=function(){return true;}; return true;}; _7h.prototype.b8=function(){ var AS=Grids.Bc;if(!AS)return false; var r1=AS.Row,r2=this.ARow; if(!r2||r2.Fixed||r1==r2)return true; var TY=r1,TZ=r2,Og=AS.Do; while(1){ if(!TY||TZ==r1){ for(var AP=r2;AP&&AP!=r1;AP=this.GetNextVisible(AP,1)){ if(Og==2||!Og!=!AP.Selected)this.SelectRow(AP);} break;} if(!TZ||TY==r2){ for(var AP=this.GetNextVisible(r1,1);AP;AP=this.GetNextVisible(AP,1)){ if(Og==2||!Og!=!AP.Selected)this.SelectRow(AP); if(AP==r2)break;} break;} TY=this.GetNextVisible(TY,1); TZ=this.GetNextVisible(TZ,1);} AS.Row=this.ARow; return true;}; _7h.prototype.ActionSelectCol=function(CE){ var F6=CE?this.FCol:this.ACol; if(!F6||!this.Selecting||!this.SelectingCells)return false; var Em=0; for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP)){ if(!Is(AP,"CanSelect")||AP.Selected==1)continue; if(!AP.Selected)AP.Selected=2; else if(AP[F6+"Selected"])continue; AP[F6+"Selected"]=1; Em++; if(this.ColorClasses&2)this.RefreshCell(AP,F6);else this.ColorCell(AP,F6);} return Em?true:false;}; _7h.prototype.ActionDeselectCol=function(CE){ var F6=CE?this.FCol:this.ACol; if(!F6||!this.Selecting||!this.SelectingCells)return false; var Em=0; for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP)){ if(!Is(AP,"CanSelect")||!AP.Selected)continue; if(AP.Selected==1){ AP.Selected=2; for(var BD in this.Cols)AP[BD+"Selected"]=1;} else{ if(!AP[F6+"Selected"])continue; var b9=0; for(var BD in this.Cols)if(BD!=F6&&AP[BD+"Selected"]){b9++;break;} if(!b9)AP.Selected=0;}; AP[F6+"Selected"]=0; Em++; if(this.ColorClasses&2)this.RefreshCell(AP,F6);else this.ColorCell(AP,F6);} return Em?true:false;}; _7h.prototype.cA=function(dir){ var AS=Grids.Bc;if(!AS)return false; if(AS.Row.Fixed)return false; AS.Action="Fill"; AS.Move=this.cB; AS.Pz=this.cC; AS.Type=7; AS.Sp=dir; AS.b6=[]; return true;}; _7h.prototype.cB=function(){ var AS=Grids.Bc;if(!AS)return false; var AJ=this.SelectRange(AS.Row,AS.Col,AS.Sp&1?this.ARow:AS.Row,AS.Sp&2?this.ACol:AS.Col,1,AS.Type,null,this.Event.X,AS.b6); if(AJ)AS.b6=AJ; this.P9(this.ARow); return true;}; _7h.prototype.cC=function(){ var AS=Grids.Bc;if(!AS)return false; this.SelectRange(AS.Row,AS.Col,AS.Row,AS.Col,1,AS.Type,null,null,AS.b6); if(this.ColorClasses&2)this.RefreshCell(AS.Row,AS.Col);else this.ColorCell(AS.Row,AS.Col); var cD,r2,cE,KG; if(AS.Row==AS.b6[0]){r2=AS.b6[2];cD=0} else{r2=AS.b6[0];cD=1;}; if(AS.Col==AS.b6[1]){cE=0,KG=AS.b6[3];} else{cE=1,KG=AS.b6[1];}; if(Grids.OnAutoFill&&Grids.OnAutoFill(this,AS.Row,AS.Col,r2,KG,cD,cE))return true; var cF=0; if(this.Calculating&&this.Calculated){cF=1;this.Calculated=0;} var Bb=this.GetValue(AS.Row,AS.Col),Dh=null; for(var AP=AS.Row,cG=0;AP;AP=cD?this.GetPrevVisible(AP):this.GetNextVisible(AP),cG++){ for(var BD=AS.Col,Vg=0;BD;BD=cE?this.GetPrevCol(BD):this.GetNextCol(BD),Vg++){ if(this.CanEdit(AP,BD)){ Dh=Grids.OnAutoFillValue?Grids.OnAutoFillValue(this,AP,BD,AS.Row,AS.Col,Bb,Dh,cD?-cG:cG,cE?-Vg:Vg):Bb; this.SetValue(AP,BD,Dh,1);} if(BD==KG)break;} if(AP==r2)break;} if(cF){ this.Calculated=1; this.Calculate(1);} return true;}; _7h.prototype.ActionFillCells=function(){return this.cA(3);}; _7h.prototype.ActionFillRow=function(){return this.cA(2);}; _7h.prototype.ActionFillCol=function(){return this.cA(1);}; _7h.prototype.cH=function(){ this.cI={}; for(F6 in this.Cols)if(this.Cols[F6].Spanned)this.cI[F6]=this.Cols[F6]; for(F6 in this.cI){ this.cJ(this.XH,F6); this.cJ(this.XF,F6); for(var AN=this.XB.firstChild;AN;AN=AN.nextSibling)this.cJ(AN,F6);}}; _7h.prototype.cJ=function(row,F6){ var cK=F6+"RowSpan",Ex=0; for(var AP=row.firstChild;AP;AP=AP.nextSibling){ var HR=AP[cK];if(HR==null)HR=AP.Def[cK]; if(HR>1){ var LF=0,KP=0; AP.G4=1;Ex=1; if(this.HasChildren(AP)&&(!this.ChildPaging||AP.Expanded)&&AP.Visible)LF++; if(AP.Spanned){ KP=AP[F6+"Span"];if(KP==null)AP.Def[F6+"Span"]; if(KP=="0")continue; var Jf=this.ColNames[this.Cols[F6].Sec],AO=this.Cols[F6].Pos; if(!Jf)continue; for(var i=0;i<KP;i++)this.Cols[Jf[i+AO]].Spanned=1; for(var Es=AP.nextSibling,i=1;Es&&i<HR;i++,Es=Es.nextSibling){ Es.G4=1;for(var j=0;j<KP;j++)Es[Jf[j+AO]+"RowSpan"]=0; Es.Spanned=1;Es[F6+"Span"]=KP;this.HS(Es); if(Es.firstChild){ this.LH(Es,F6,KP); if(this.HasChildren(Es)&&(!this.ChildPaging||Es.Expanded)&&Es.Visible)LF++;} if(!Es.Visible)LF--;}} else for(var Es=AP.nextSibling,i=1;Es&&i<HR;i++,Es=Es.nextSibling){ Es.G4=1;Es[cK]=0; if(Es.Spanned&&Get(Es,F6+"Span")>1){ Es[F6+"Span"]=1; this.HS(Es);} if(Es.firstChild){ this.LH(Es,F6); if(this.HasChildren(Es)&&(!this.ChildPaging||Es.Expanded)&&Es.Visible)LF++;} if(!Es.Visible)LF--;} AP[cK]=HR+LF; if(!AP.Pr||AP.Pr<HR)AP.Pr=HR; if(AP.firstChild)this.LH(AP,F6,KP); AP=Es; if(!AP)break;} else if(AP.firstChild)this.cJ(AP,F6);} if(Ex){ this.KJ=1; this.G4=Ex;}}; _7h.prototype.LH=function(row,F6,span){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(AP[F6+"Visible"]!=-2)AP[F6+"ZalVisible"]=AP[F6+"Visible"]; AP[F6+"Visible"]=-2; if(span){ AP.Spanned=1; if(AP[F6+"ZalSpan"]==null)AP[F6+"ZalSpan"]=AP[F6+"Span"]; AP[F6+"Span"]=span; this.HS(AP);} this.LH(AP,F6,span);}}; _7h.prototype.cL=function(row,F6){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ AP[F6+"Visible"]=AP[F6+"ZalVisible"]; if(AP[F6+"Span"]!=AP[F6+"ZalSpan"]){ AP[F6+"Span"]=AP[F6+"ZalSpan"]; this.HS(AP);} this.LH(AP,F6);}}; _7h.prototype.cM=function(rows,Au,F6){ var G9=this.Q4(Au,F6),HR=G9[F6+"Span"],C3=0; for(var i=0;i<rows.length;i++){ var row=rows[i]; row[F6+"RowSpan"]=0; if(HR>1){ row.Spanned=1;row[F6+"Span"]=HR;this.HS(row); if(row.firstChild)this.LH(row,F6,HR); for(var j=0,C=this.Cols[F6];j<HR;j++)row[this.ColNames[C.Sec][j+C.Pos]+"RowSpan"]=0;} else{ if(row.Spanned&&Get(row,F6+"Span")>1){ var cK=row[F6+"Span"]; row[F6+"Span"]=1;this.HS(row); for(var j=1,C=this.Cols[F6];j<cK;j++)row[this.ColNames[C.Sec][j+C.Pos]+"RowSpan"]=null;} if(row.firstChild)this.LH(row,F6,HR>1?HR:0);}; row.G4=1; C3+=row.Visible?(row._7AZ?2:1):0;} this.cN(rows[0],F6,C3);}; _7h.prototype.cO=function(rows,Au,F6){ var HR=Au[F6+"Span"]; for(var i=0;i<rows.length;i++){ var row=rows[i]; row[F6+"Visible"]=-2; if(HR>1){ row.Spanned=1;row[F6+"Span"]=HR;this.HS(row); if(row.firstChild)this.LH(row,F6,HR);} else if(row.firstChild)this.LH(row,F6,0);}}; _7h.prototype.aa=function(rows,cP){ var Ff=0,Es=rows[rows.length-1].nextSibling,Au=rows[0].previousSibling; if(Es&&!cP){ if(Es.G4)for(var F6 in this.cI)if(Es[F6+"RowSpan"]==0){this.cM(rows,Au,F6);Ff=1;} Au=Es;} else if(Au){ if(Au.G4)for(var F6 in this.cI)if(Au[F6+"RowSpan"]!=null){this.cM(rows,Au,F6);Ff=1;}} else{ Au=rows[0].parentNode; if(Au.G4)for(var F6 in this.cI)if(Au[F6+"RowSpan"]!=null){this.cO(rows,Au,F6);Ff=1;}}; for(var F6 in this.cI)if(Au[F6+"Visible"]==-2){this.cO(rows,Au,F6);Ff=1;} return Ff;}; _7h.prototype.cN=function(row,F6,C3,BC){ var HR=row[F6+"RowSpan"]; if(HR&&!BC){ for(var Es=row.nextSibling;Es;Es=Es.nextSibling){ if(C3<0){ Es[F6+"RowSpan"]=HR-(row.cQ?1:0)-1; Es[F6]=row[F6]; Es[F6+"CopyTo"]="Prev,"+F6; if(row[F6+"Span"]>1)Es.Spanned=1; AJ=["Span","Type","Format","HtmlPrefix","HtmlPostfix","Button","Defaults","Enum"]; for(var i=0;i<AJ.length;i++){ var Dh=Get(row,F6+AJ[i]); if(Dh!=null)Es[F6+AJ[i]]=Dh;}} else if(Es[F6+"RowSpan"]>HR)Es[F6+"RowSpan"]=0; else break; if(Es.Visible){this.RefreshRow(Es);break;}}} else if(HR!=null){ for(var AP=row;AP;AP=AP.previousSibling){ if(AP[F6+"RowSpan"]){ var HR=AP[F6+"RowSpan"]+C3; AP[F6+"RowSpan"]=HR; var H6=this.GetCell(AP,F6); if(H6){ H6.rowSpan=HR; var K5=H6.nextSibling; if(K5&&K5.className.indexOf("NoLeft")>=0)K5.rowSpan=HR; if(F6==this.MainCol&&!row.Fixed)H6.previousSibling.rowSpan=HR;} break;}}}}; _7h.prototype.cR=function(row,C3,BC){ if(!row.G4||!this.G4)return; for(var F6 in this.cI)if(row[F6+"RowSpan"]!=null)this.cN(row,F6,C3,BC);}; _7h.prototype.N4=function(row,GP,next,HQ,Op,Pe,ag){ if(!this.G4&&!row.Pr)return this.MoveRow(row,GP,next,HQ,Op,Pe); var AJ=[];this.Ps(row,AJ),Ff=0,Pf=row.parentNode,cS=!GP||GP.Page||GP.firstChild; if(row.G4){ for(var F6 in this.cI){ if(row[F6+"RowSpan"]==0){ for(var C3=0,i=1;i<AJ.length&&AJ[i][F6+"RowSpan"]==0;i++){ var AP=AJ[i]; C3+=AP.Visible?(AP._7AZ?2:1):0; AP[F6+"RowSpan"]=null; if(AP.firstChild)this.cL(AP,F6);} C3+=row.Visible?(row._7AZ?2:1):0; if(row.firstChild)this.cL(row,F6); this.cN(row,F6,-C3); row[F6+"RowSpan"]=null; Ff=1;}}} for(var F6 in this.cI){ if(row[F6+"Visible"]==-2){ for(var i=0;i<AJ.length;i++){ var AP=AJ[i]; AP[F6+"Visible"]=AP[F6+"ZalVisible"]; if(AP[F6+"ZalSpan"]!=AP[F6+"Span"]){ AP[F6+"Span"]=AP[F6+"ZalSpan"]; this.HS(AP);} if(AP.firstChild)this.cL(AP,F6);} Ff=1;}} this.G4=0;this.Rendering=1; var Pf=AJ[0].parentNode,ai=AJ[AJ.length-1].nextSibling; for(var i=0;i<AJ.length;i++)this.MoveRow(AJ[i],GP,next,HQ,Op,Pe,ag,1); this.ab({Type:"Move",Row:AJ[0],Par:GP,Next:next,an:Pf,ao:ai,Moved:AJ[0].Moved}); this.G4=1;this.Rendering=0; if(!Pf.firstChild&&Pf.G4)this.cR(Pf,-1,1); if(!cS&&GP.G4)this.cR(GP,1,1); if(this.aa(AJ,ag)||Ff){ for(var i=0;i<AJ.length;i++){ this.RefreshRow(AJ[i]); if(AJ[i]._7AZ==4)this.RefreshPage(AJ[i]);}} if(HQ)this.Update();}; _7h.prototype.Ps=function(row,AJ){ for(var YS=1;YS>0&&row;YS--){ if(row.Pr>YS)YS=row.Pr; AJ[AJ.length]=row; row=row.nextSibling;}}; _7h.prototype.Kb=function(F6){ if(!this.G4)return[]; var KX=[],C=this.Cols[F6];if(!C)return[]; var Jf=this.ColNames[C.Sec]; for(var i=0;i<C.Pos;i++){ var BD=this.Cols[Jf[i]]; if(BD.Spanned&&(BD.Visible||BD.Hidden))KX[KX.length]=Jf[i];} return KX;}; _7h.prototype.Q4=function(row,F6){ while(row&&row[F6+"Visible"]==-2)row=row.parentNode; while(row&&row[F6+"RowSpan"]==0)row=row.previousSibling; return row;}; _7h.prototype.XC=function(row,F6){ var C=this.Cols[F6],Jf=this.ColNames[C.Sec],AP=row["r"+C.Sec]; for(var i=0,Au=this.KJ;i<Jf.length;i++){ var BD=Jf[i],C=this.Cols[BD]; if(!C.Visible&&!C.Hidden){ if(BD==F6)return null; continue;} if(BD==this.MainCol&&row[BD+"RowSpan"]!=0)Au++; if(row.Spanned){ var KP=row[BD+"Span"]; if(KP>1){ if(row[F6+"Span"]==0&&this.KO(row,F6)==BD||BD==F6)return row[BD+"RowSpan"]==0?this.GetCell(this.Q4(row,F6),F6):AP.cells[Au]; i+=KP-1;}} if(row[BD+"RowSpan"]==0){ if(BD==F6)return this.GetCell(this.Q4(row,F6),F6);} else{ if(BD==F6)return AP.cells[Au]; var K5=AP.cells[Au+1]; Au+=K5&&K5.className.indexOf("NoLeft")>=0?2:1;}} return null;}; _7h.prototype.cT=function(row,CS){ var HU={},CZ={},KD={}; for(var F6 in this.cI)if(row[F6+"RowSpan"]){ var H6=this.GetCell(row,F6); if(H6){ CZ[F6]=H6.offsetHeight; HU[F6]=this.cI[F6]; KD[F6]=H6; H6.style.display="none";}} for(var F6 in HU){ var HR=F6+"RowSpan",PK=F6+"Visible",Ht=0; for(var AP=this.GetNextVisible(row,1);AP&&(AP[HR]==0||AP[PK]==-2);AP=this.GetNextVisible(AP,1))if(AP.r1){ var cU=AP.r1.offsetHeight; if(AP.r0&&AP.r0.offsetHeight>cU)cU=AP.r0.offsetHeight; if(AP.r2&&AP.r2.offsetHeight>cU)cU=AP.r2.offsetHeight; Ht+=cU;} Ht=CZ[F6]-Ht; if(CS<Ht)CS=Ht;} for(var F6 in HU)KD[F6].style.display=""; return CS;}; _7h.prototype.Expand=function(row,Ci,bm,Op,cV){ var AS=Get(row,"Detail"); if(AS){ var Kg=row.Expanded;row.Expanded=1; if(!Op&&this.DetailExpand!=1)this.ShowDetail(row,AS); row.Expanded=Kg; if(!this.DetailExpand)return;} if((!this.HasChildren(row)||row.Expanded)&&!Ci||Get(row,"CanExpand")==0)return; var NZ=0,T=this; row.Expanded=0; if(!row._7AZ)this.Xl(row); row.Expanded=1; if(this.SaveExpanded&&!bm)this.SaveCfg(); if(!row.firstChild&&row.State==null&&this.ChildPaging==3)row.State=0; function Update(){ if(Ci){ for(var AP=row.firstChild;AP;AP=AP.nextSibling)if(AP.Visible){ T.LV(AP); T.Li(AP);}}}; if(!this.ChildPaging||row.State==4){ this.au(row); Update(); this.cW(row);} else{ var cX=!this.ChildPages&&this.HP(row,4); if(!(row.State<2)&&!cX){ this.SM(row); Update(); this.cW(row);} else{ this.cW(row); if(this.ChildPaging==3&&row.State<2){ if(cX&&!this.SuppressMessage)_7Au(this.GetText("Load"),this.GetRowChildren(row,1).firstChild,this.Img.Style+"PageMessage",this.N[1].offsetHeight); this.Xn(row,cX);} else if(cV){ this.SM(row); this.Update(); row.State=4;} else this.cY(row);}}}; _7h.prototype.ExpandParents=function(row){ if(!row||row.Fixed||!row.Visible||row.Page)return; var GP=row.parentNode; while(GP&&!GP.Page){ if(!GP.Expanded)this.Expand(GP); GP=GP.parentNode;}}; _7h.prototype.Xn=function(row,cX){ var T=this,XQ=this.AF; row=this.NR(row); this.DownloadPage(row,function(NU){ if(XQ!=T.AF)return; T.YX(NU,row); if(row.firstChild==null){ T.Debug(2,"No children returned for ",row.id); row.Count=0; row.State=4; if(row.Copy)row.Copy=null; T.Lh(row); T.RefreshRow(row); return;} if(NU>=0){ function cZ(row){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ AP.Added=1; var id=AP.id; T.Nz(AP); if(AP.firstChild)cZ(AP); else if(AP.Count)AP.Copy=id; if(Grids.OnRowAdd)Grids.OnRowAdd(T,AP);}}; if(row.Copy)cZ(row); if(row.Expanded){ if(cX)T.cY(row); else{ T.SM(row); T.Update();}} else row.State=2; if(row.DetailRow){ T.ShowDetail(row,Get(row,"Detail"),1);}}});}; _7h.prototype.cY=function(row){ var T=this,XQ=this.AF; if(!this.SuppressMessage)_7Au(T.GetText("Render"),T.GetRowChildren(row,1).firstChild,this.Img.Style+"PageMessage",T.N[1].offsetHeight); row.State=3; setTimeout(function(){ if(XQ!=T.AF)return; if(row.State<4){ T.SM(row); T.Update(); row.State=4;}},10);}; _7h.prototype.cW=function(row){ this.Li(row); if(!this.NoScrollAfterExpand){ this.ScrollIntoView(row,null,null,1);} this.ShowPages();}; _7h.prototype.Collapse=function(row,bm){ if(!this.HasChildren(row)||!row.Expanded)return; row.Expanded=0; if(this.SaveExpanded&&!bm)this.SaveCfg(); if(row.State==null)row.State=4; this.Xm(row); this.Li(row); if(this.RemoveCollapsed>=3){ this._7l(row,1); var Em=0; while(row.firstChild){row.removeChild(row.firstChild);Em++;} row.Count=Em; row.State=0; if(Grids.OnRemoveCollapsed)Grids.OnRemoveCollapsed(this,row);}}; _7h.prototype.ExpandAll=function(ca,cb,cc){ if(!ca)ca=5*1000; if(!cc)cc=500; this.Rendering=true; var type=0,body=null; if(!this.AllPages){type=2;body=_7k(this.XB,this.V);} var Cr=(new Date).getTime()+ca; var T=this; function cd(AP){ if(T.HasChildren(AP)&&!AP.Expanded&&(!(cb&1)||T.ChildPaging!=3||!(AP.State<2))){ if(T.ChildPaging==2&&AP.State!=4){ if(!T.Paging||T.Paging==1||T.GetRowPage(AP).State==4){ cc-=AP.childNodes.length; if(cc<0)return 1;}} if(!Grids.OnExpand||!Grids.OnExpand(T,AP)){ var Kg=T.NoScrollAfterExpand;T.NoScrollAfterExpand=1; T.Expand(AP,null,true,null,1); T.NoScrollAfterExpand=Kg;}}}; if(this.FRow&&!this.FRow.Fixed)for(var AP=this.FRow;AP;AP=this.GetNextVisible(AP,type)){ if(cd(AP))break; if((new Date).getTime()>Cr)break;} for(var AP=this.GetFirstVisible(body);AP&&AP!=this.FRow;AP=this.GetNextVisible(AP,type)){ if((new Date).getTime()>Cr)break; if(cd(AP))break;} if(this.SaveExpanded)this.SaveCfg(); this.Rendering=false; this.ce=1; this.Update(); this.HideMessage(); this.ShowPages();this.Scrolled(1);}; _7h.prototype.CollapseAll=function(){ this.Rendering=true; for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP)){ if(AP.firstChild&&AP.Expanded){ if(!Grids.OnExpand||!Grids.OnExpand(this,AP))this.Collapse(AP,true);}} var Md=this.FRow; if(Md&&!Md.Page&&!Md.Fixed){ for(var AP=Md.parentNode;AP&&!AP.Page;AP=AP.parentNode)if(!AP.Expanded)Md=AP;} this.Rendering=false; this.Update(); this.HideMessage(); if(Md!=this.FRow)this.Focus(Md,this.FCol); if(this.SaveExpanded)this.SaveCfg(); this.ShowPages();this.Scrolled(1);}; _7h.prototype.cf=function(type){ if(!this.Paging&&this.RowCount<=this.SynchroCount){this.ExpandAll(null,type);return true;} this.ShowMessage(this.GetText("ExpandAll")); var T=this;setTimeout(function(){T.ExpandAll(null,type);},10); return true;}; _7h.prototype.ActionExpandAll=function(){this.cf(this.ExpandAllType);return true;}; _7h.prototype.ActionExpandAllLoaded=function(){this.cf(this.ExpandAllType);return true;}; _7h.prototype.ActionCollapseAll=function(){ if(!this.Paging&&this.RowCount<=this.SynchroCount){this.CollapseAll();return true;} this.ShowMessage(this.GetText("CollapseAll")); var T=this;setTimeout(function(){T.CollapseAll();},10); return true;}; _7h.prototype.ActionExpand=function(CE){ var row=CE?this.FRow:this.ARow; if(!row||!this.HasChildren(row)&&!row.Detail||!Is(row,"CanExpand")||row.Expanded||Grids.OnExpand&&Grids.OnExpand(this,row))return false; this.Expand(row); return true;}; _7h.prototype.ActionCollapse=function(CE){ var row=CE?this.FRow:this.ARow; if(!row||!this.HasChildren(row)&&!row.Detail||!Is(row,"CanExpand")||!row.Expanded||Grids.OnExpand&&Grids.OnExpand(this,row))return false; this.Collapse(row); return true;}; _7h.prototype.ActionIndent=function(CE){ var row=CE?this.FRow:this.ARow; if(!row||row.Fixed||row.Space!=null||row.Page)return false; var Au=this.GetPrevVisible(row); if(!Au||Au.Level<row.Level)return false; while(Au.Level>row.Level)Au=this.GetPrevVisible(Au); if(!this.Pl(row,row.Def.Name))return false; this.N4(row,Au,null,1); return true;}; _7h.prototype.ActionOutdent=function(CE){ var row=CE?this.FRow:this.ARow; if(!row||row.Fixed||row.Space!=null||row.Level<=0)return false; var Au=row.parentNode,GP=Au.parentNode; if(!this.Pl(row,row.Def.Name))return false; for(Au=this.GetNextVisible(Au);Au&&Au.Level>=row.Level;Au=this.GetNextVisible(Au)); this.N4(row,GP,Au,1); return true;}; _7h.prototype.Update=function(cg){ if(this.N[1]==null||this.Rendering||this.Qu.parentNode==null)return true; var AI=this.Img,C=this.Cols,AM=this.Pager,M=this.MainTag,GK=this.HW; var Rs=this.N[1],ch=this.L[1],N6=this.O[1]; this.Rendering=true; if(!this.c&&M.offsetWidth){ this.ci(); this.UpdatePos(); this.UpdateHeights();} this.c=M.offsetWidth;this.d=M.offsetHeight; if(!this.c){this.Rendering=false;this.MC(this.KC);return true;} if(AM.Visible)this.Qv.style.height="10px"; var cj=this.ck(0),cl=this.ck(2),cm=this.cn(); var co=this.RelWidth?this.cp():this.cq(); var GW=this.c-AI.Ly-AI.cr; var CJ=AI.Ww+_7Z; var cs=co[0]-AI.IP; var ct=this.RelHeight&&!this.NoVScroll&&!this.MaxVScroll; var N2=_7a+AI.Wy; var GU=this.d-AI.Wt-AI.cu; AI.L0=0;AI.L2=0; if(AI.Top&&GK.previousSibling)AI.L0=GK.previousSibling.offsetHeight; if(AI.Bottom&&GK.nextSibling)AI.L2=GK.nextSibling.offsetHeight; var cv=AI.L0+AI.L2;GU-=cv; var Ht=ch.offsetHeight;if(Ht)Ht+=AI.XG; var cw=N6.offsetHeight;if(cw)cw+=AI.XJ; var cx=Ht+cw; var cy=0; var cz=0,c0=0; if(ct){ var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++){ if(!CE[i].RelHeight)continue; c0+=CE[i].RelHeight; cz-=CE[i].r1.offsetHeight-(CE[i].MinHeight>this.Hu?CE[i].MinHeight:this.Hu);}} for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){ if(!AP.r1)continue; var Ht=AP.r1.parentNode.offsetHeight;if(!Ht)Ht=0; if(AP.Tag)continue; if(AP.Space>0&&AP.Space<=3)cx+=Ht; else cy+=Ht; if(ct&&AP.RelHeight){ c0+=AP.RelHeight; cz-=Ht; if(AP.MinHeight)cz+=AP.MinHeight+(AP.r1.parentNode.offsetHeight-AP.r1.offsetHeight);}} cz+=cx+cy; if(_7S)Rs.scrollHeight; else if(_7P)Rs.scrollTop=Rs.scrollTop; var c1=this.c2?(_7P?1:0)-AI.Wx:Rs.lastChild.offsetTop-(_7P?AI.Hz:AI.H0+AI.Hy); var c3,c4; var c5=cj[1]+cl[1]+cm[1],c6=cz+c1+AI.Wx>GU-N2?CJ:0; if(c5>GW-c6-AI.IP&&!this.NoHScroll&&!this.NoScroll&&!(this.ResizingMain&2)){ var c7=cj[3]+cl[3]+cm[3],c8=cj[4]+cl[4]+cm[4],min=GW-c6-AI.IP; if(c7+25>=min&&c8<min){ for(var F6 in C){ var BD=C[F6]; if(BD.Sec==1||!BD.CanHide||!BD.Visible)continue; this.HideCol(F6); if(BD.Sec)cl[0]-=BD.Width;else cj[0]-=BD.Width;c5-=BD.Width; if(BD.CanResize)c7+=C.Width-BD.MinWidth; min+=BD.MinWidth; if(c5+25<=min)break;} Rs=this.N[1];ch=this.L[1];N6=this.O[1];GK=this.HW; if(AM.CanHide&&AM.Visible&&c5+25>min){ this.Xy(); cm[0]-=AM.Width;c5-=AM.Width; if(AM.CanResize)c7+=AM.Width-AM.MinWidth; min+=AM.MinWidth;}} if(c7+25<min&&c5+25>min){ var c9=(c5-min+25)/(c5-c7); for(var F6 in C){ var BD=C[F6]; if(BD.Sec==1||!BD.CanResize||!BD.Visible)continue; var Ca=Math.ceil((BD.Width-BD.MinWidth)*c9); this.SetWidth(F6,-Ca,0,1); if(BD.Sec)cl[0]-=Ca;else cj[0]-=Ca;c5-=Ca;} if(AM.CanResize&&AM.Visible){ var Ca=Math.ceil((AM.Width-AM.MinWidth)*c9); AM.Width-=Ca; this.Qv.style.width=AM.Width+"px"; cm[0]-=Ca; c5-=Ca;}}} c5+=co[1]; if(c5<=GW-CJ||this.NoHScroll||this.NoScroll)c4=0; else if(c5<=GW)c4=(cz+c1+AI.Wx>GU||this.ShowVScroll)&&!this.NoHScroll&&!this.NoScroll?1:0; else c4=1; c3=(cz+c1+AI.Wx>GU-(c4?N2:0)||this.ShowVScroll)&&!this.NoVScroll&&!this.NoScroll?1:0; var dA=GW-(c3?CJ:0)-AI.IP-c5+co[1],Ag=0; if(dA<=0&&this.ResizingMain&2){ M.style.width=parseInt(M.style.width)-dA+25+"px"; GW+=25-dA; dA=25; Ag=1;} var dB=GU-(c4?N2:0)-(this.c2?(_7P?1:0):AI.Wx)-cz; if(dB<=0&&this.ResizingMain&1){ M.style.height=parseInt(M.style.height)-dB+this.Hu+"px"; GU+=this.Hu-dB; dB=this.Hu; Ag=1;} if(Ag){ if(c5<=GW-CJ||this.NoHScroll||this.NoScroll)c4=0; else if(c5<=GW)c4=cz+c1+AI.Wx>GU&&!this.NoHScroll&&!this.NoScroll; else c4=1; c3=cz+c1+AI.Wx>GU-(c4?N2:0)&&!this.NoVScroll&&!this.NoScroll;} if((dA<=0&&!this.NoHScroll||dB<=0&&!this.NoVScroll)&&!this.NoScroll){ this.ShowMessage(this.GetText("ExtentErr"),1); GK.style.visibility="hidden"; this.Rendering=false; return false;} if(GK.style.visibility=="hidden"){ GK.style.visibility=""; this.HideMessage();} if(this.RelWidth){ var Cn=GW-(c3?CJ:0)-cm[1]-cj[1]-cl[1]-co[1]; if(Cn<0)Cn=0; var LE=cj[2]+cl[2]+co[2],Lp=0,dC=Cn; for(var F6 in C){ if(!C[F6].RelWidth||!C[F6].Visible&&!C[F6].dD)continue; var BD=C[F6]; var dE=Cn*BD.RelWidth/LE+Lp,A5=Math.floor(dE);Lp=dE-A5; dC-=A5;if(dC>0&&dC<2){A5+=dC;dC=0;Lp=0;} A5+=BD.MinWidth; var Ss=A5-(BD.dD?0:BD.Width); if(Ss!=0){ if(BD.dD)this.SetWidth(F6,null,0,1); this.SetWidth(F6,A5<=0?null:Ss,0,1); BD.dD=A5<=0; if(BD.Sec==0)cj[0]+=Ss; else if(BD.Sec==2)cl[0]+=Ss; else{co[0]+=Ss;cs+=Ss;}}}} var dF=c4?GW-cj[0]-cl[0]-cm[0]-(c3?CJ:0):cs+AI.IP; this.Hl=cj[0];this.Hq=cl[0]; this.Hn=dF; var dG=dF-(_7Q?AI.dH:AI.IP)+"px"; ch.style.width=dG; Rs.style.width=dG; N6.style.width=dG; this.Qu.parentNode.parentNode.style.display=c4?"":"none"; if(c4){ var dI=this.ShortHScroll?dF:GW-cm[0]-(c3?CJ:0); this.RI.style.width=(dI-AI.dJ)+"px"; this.Qu.style.width=(dI-(_7Q?AI.dK:AI.dJ))+"px"; this.Q=(dI-AI.dJ)/(dF-AI.IP); this.ZB.style.width=Math.floor(cs*this.Q)+"px";} else this.RI.scrollLeft=0; var dL=dF+cj[0]+cl[0],dM=dL+cm[0]+(c3?CJ:0); for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){ if(!AP.r1)continue; var CF=AP.Space>0&&AP.Space<=3?dL:dM; var dN=AP.dO; if(dN==null){ var B3=GetStyle(AP.r1); dN=_7AH(B3); if(_7Q)AP.dP=dN; if(B3){ var dQ=parseInt(B3.marginLeft),dR=parseInt(B3.marginRight); if(!_7K||!this.Rtl)dN+=(dQ?dQ:0)+(_7K?(dQ?dQ:0):(dR?dR:0));} if(!dN)dN=0; AP.dO=dN;} CF-=dN; if(AP.Tag)CF+=AI.cr; AP.r1.style.width=_7Q?(CF+AP.dP)+"px":CF+"px"; if(AP.RelWidth&&(!_7K||!cg))this.Il(AP,CF);} if(ct){ if(AM.Visible)this.Qv.style.height="10px"; if(this.ShowVScroll){ if(_7N||_7U)this.Qt.style.display="none"; else this.Qt.parentNode.style.display="none";} var CZ=GU-(c4?N2:0)-cz-c1-AI.Wx; if(_7Y)CZ-=AI.dS; if(CZ<0)CZ=0; var HU=this.GetSections(),CE=this.GetFixedRows(),YW=0,dT=CZ; for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)CE[CE.length]=AP; for(var i=0;i<CE.length;i++){ var row=CE[i];if(!row.RelHeight)continue; var dU=CZ*row.RelHeight/c0+YW,CS=Math.floor(dU);YW=dU-CS; dT-=CS;if(dT>0&&dT<2){CS+=dT;dT=0;YW=0;} if(CS<0)CS=0; if(row.Space){ var AP=row.r1; var G9=_7P&&!_7U?AP.parentNode.parentNode:AP.parentNode; if(row.MinHeight)CS+=row.MinHeight+(G9.offsetHeight-AP.offsetHeight); if(CS==G9.offsetHeight)continue; var Ht=CS-G9.offsetHeight; if(row.Space>0&&row.Space<=3)cx+=Ht; else cy+=Ht; if(CS){ G9.style.display=""; AP.style.overflow="hidden"; AP.style.height=CS+"px"; var YM=G9.offsetHeight-CS; if(YM){ YM=CS-YM; if(YM<=0)G9.style.display="none"; else AP.style.height=YM+"px";}} else G9.style.display="none";} else{ CS+=row.MinHeight>this.Hu?row.MinHeight:this.Hu; if(CS==row.r1.offsetHeight)continue; cx+=CS-row.r1.offsetHeight; for(var k=HU[0];k<HU[1];k++){ var AP=row["r"+k]; if(CS){ AP.style.overflow="hidden"; if(_7K)AP.firstChild.style.height=CS+"px"; else AP.style.height=CS+"px"; AP.style.display="";} else AP.style.display="none";}}}} var dV=c3?GU-cx-cy-(c4?N2:0):c1+AI.Wx; var dW=dV-(_7Q?AI.XI:AI.Wx); if(dW>=0)for(var i=0;i<3;i++)if(this.N[i])this.N[i].style.height=dW+"px"; if(_7P)this.RG.style.overflow="hidden"; if(_7N||_7U)this.Qt.style.display=c3?"":"none"; else this.Qt.parentNode.style.display=c3?"":"none"; this.ZC.parentNode.style.display=c3?"":"none"; if(c3){ var dX=dV+cx; this.RG.style.height=(dX-AI.dY)+"px"; this.Qt.style.height=(dX-(_7Q?AI.dZ:AI.dY))+"px"; this.P=(dX-AI.dY)/(dV-AI.Wx); var da=Math.floor(c1*this.P); if(_7V){ var AJ=new Array(),Au=0; while(da>9999){ AJ[Au++]="<div style='height:9999px'>"+_7D+"</div>"; da-=9999;} AJ[Au++]="<div style='height:"+da+"px'>"+_7D+"</div>"; this.RG.innerHTML=AJ.join("");} else this.ZA.style.height=da+"px";} else this.RG.scrollTop=0; if(this.Paging&&AM.Visible){ var db=this.Qv,dc=this.Qy; db.parentNode.rowSpan=c4+this.XS.Space[3]-this.XS.Space[0]; var aD=dV+cx-AI.dd+(c4?N2:0); db.style.height=(aD+(_7Q?AI.de:0))+"px"; aD-=db.firstChild.offsetHeight+AI.df; if(_7Q)aD+=AI.dg; dc.style.height=(aD<0?0:aD)+"px"; if(_7Q){ var dh=AM.Width-dc.offsetWidth+dc.clientWidth-AI.di; if(dh<15)dh=15; dc.firstChild.style.width=dh+"px";}} this.IL=ch.parentNode.parentNode.offsetTop; this.IH=Rs.parentNode.parentNode.offsetTop; this.II=N6.parentNode.parentNode.offsetTop; if(this.NoVScroll){ if(_7P)M.scrollTop=M.scrollTop; var QV=GK.offsetHeight+cv,N2=M.scrollHeight; if(QV>0){ M.style.height=((QV<N2?QV:N2)+(_7Q?AI.Wt:0))+"px";}} if(this.NoHScroll){ if(_7P)M.scrollLeft=M.scrollLeft; var dj=GK.offsetWidth,CJ=M.scrollWidth; if(dj>0){ M.style.width=((dj<CJ?dj:CJ)+(_7Q?AI.Ly:0))+"px";}} function dk(M,dl,dm){ if(!M)return; M.style.visibility=""; var Cn=dl.offsetWidth; for(var i=0,AP=M.firstChild;i<10;i++){ if(dm[i]!=null){AP.style.width=(Cn-dm[i])+"px";AP=AP.nextSibling;}}}; if(AI.Top)dk(GK.previousSibling,GK,AI.Top); if(AI.Bottom)dk(GK.nextSibling,GK,AI.Bottom); if(this.KC)this.MF(this.KC); this.Qn=GK.offsetWidth; this.Qo=GK.offsetHeight; this.Rendering=false; if(this.MaxVScroll){ if(this.NoVScroll){ if(this.MaxVScroll&&this.d>this.MaxVScroll){ M.style.height=this.MaxVScroll-(_7Q?0:AI.Wt)+"px"; this.NoVScroll=0; return this.Update();}} else if(this.d<this.MaxVScroll&&c3){ M.style.height=this.MaxVScroll-(_7Q?0:AI.Wt)+"px"; return this.Update();} else{ var CS=GK.offsetHeight+AI.L0+AI.L2; if(CS<this.d-AI.Wt){ this.NoVScroll=1; return this.Update();}}} if(this.MaxHScroll){ if(this.NoHScroll){ if(this.MaxHScroll&&this.c>this.MaxHScroll){ M.style.width=this.MaxHScroll-(_7Q?0:AI.Ly)+"px"; this.NoHScroll=0; return this.Update();}} else if(this.c<this.MaxHScroll&&c4){ M.style.width=this.MaxHScroll-(_7Q?0:AI.Ly)+"px"; return this.Update();} else if(GK.offsetWidth<this.c-AI.Ly){ this.NoHScroll=1; return this.Update();}} if(_7P)this.RG.style.overflowY=this.ShowVScroll?"scroll":"auto"; Gi(); this.UpdatePos(); this.Scrolled(1); this.MZ(); this.Mv(); return true;}; _7h.prototype.SetScrollBars=_7h.prototype.Update; _7h.prototype.Scrolled=function(Ci){ if(this.Rendering||this.Loading||this.Cw)return; this.UpdateHeights(); var dn=Math.ceil(this.RI.scrollLeft/this.Q); if(dn<=1&&(!this.Rtl||dn>=-2)||isNaN(dn))dn=0; var KK=Math.ceil(this.RG.scrollTop/this.P);if(KK<=1||isNaN(KK))KK=0; if(Grids.OnScroll||Grids.OnScrollRow||Grids.OnScrollCol){ var QV=this.GetScrollLeft(),dp=this.GetScrollTop(); if(Grids.OnScrollRow){var dq=this.dr();} if(Grids.OnScrollCol){var ds=this.dt();}} if(_7G){ this.L[1].style.marginLeft=-dn+"px"; this.N[1].style.marginLeft=-dn+"px"; this.O[1].style.marginLeft=-dn+"px"; if(!Ci&&parseInt(this.N[1].firstChild.style.marginTop)==-KK)return; for(var i=0;i<3;i++)if(this.N[i])this.N[i].firstChild.style.marginTop=-KK+"px";} else{ if(!Ci){ var KI=parseInt(this.N[1].scrollTop),du=parseInt(this.N[1].scrollLeft); if(!du)du=parseInt(this.L[1].scrollLeft); if(KI==KK&&du==dn)return;} this.L[1].scrollLeft=dn; this.N[1].scrollLeft=dn; if(_7r!=1){var CZ=this.Header;if(!CZ.r1)CZ=this.GetFirstVisible();if(CZ)setTimeout(function(){_7AO(CZ.r1);},10);} this.O[1].scrollLeft=dn; for(var i=0;i<3;i++)if(this.N[i])this.N[i].scrollTop=KK;}; this.Sb(); if(Grids.OnScroll||Grids.OnScrollRow||Grids.OnScrollCol){ var dv=this.GetScrollLeft(),dw=this.GetScrollTop(); if(QV!=dv||dp!=dw){ if(Grids.OnScroll)Grids.OnScroll(this,dv,dw,QV,dp); if(Grids.OnScrollRow){ var dx=this.dr(); if(dw<dp){ var R=dq[0]; for(var i=0;i<dx.length&&dx[i]!=R;i++)Grids.OnScrollRow(this,dx[i]);} else if(dw>dp){ var R=dq[dq.length-1]; for(var i=dx.length-1;i>=0&&dx[i]!=R;i--)Grids.OnScrollRow(this,dx[i]);}} if(Grids.OnScrollCol){ var dy=this.dt(); if(dv<QV){ var C=ds[0]; for(var i=0;i<dy.length&&dy[i]!=C;i++)Grids.OnScrollCol(this,dy[i]);} else if(dv>QV){ var C=ds[ds.length-1]; for(var i=dy.length-1;i>=0&&dy[i]!=C;i--)Grids.OnScrollCol(this,dy[i]);}}}} var Cb=KK-KI; if(Cb&&this.ARow&&!this.ARow.Fixed){ var row=this.ARow,E=this.Event; Cb+=E.Y; if(Cb>0){ while(row&&row.r1){ var CS=row.r1.offsetHeight; if(Cb<CS)break; Cb-=CS; row=this.GetNextVisible(row,1);}} else{ while(row&&row.r1){ var CS=row.r1.offsetHeight; if(Cb>0)break; Cb+=CS; row=this.GetPrevVisible(row,1);}}; if(row&&row.r1){ this.ARow=row; this.GridMouseOver();} else{ this.ARow=null; this.Ln(this.KB);}} this.MZ(); this.Mv(); if(!Ci){ if(this.Dialog)this.Dialog.Close(); this.HideHint(); this.HideTip();} if(KK!=KI)this.RL=new Date();}; _7h.prototype.ck=function(Hj){ var S=this.ColNames[Hj],Db=S.length,C=this.Cols,AI=this.Img; var A5=0,dE=0,dz=0,c0=0,d0=0,d1=0; for(var i=0;i<Db;i++){ var BD=C[S[i]]; if(BD.Visible){ A5+=BD.Width; if(BD.RelWidth){ dz+=BD.Width-BD.MinWidth; c0+=BD.RelWidth; if(BD.CanHide)d1+=BD.Width;} else if(BD.CanResize){ d0+=BD.Width-BD.MinWidth; if(BD.CanHide)d1+=BD.Width;} else if(BD.CanHide)d1+=BD.Width;} else if(BD.Hidden){ dE=1; if(BD.dD)c0+=BD.RelWidth;}} var W8=A5+[AI.d2,AI.IP,AI.Lu][Hj]; if(A5)return[W8,W8-dz,c0,W8-dz-d0,W8-dz-d0-d1]; if(dE)return[W8+1,W8+1,c0,W8+1,W8+1]; return[0,0,0,0,0];}; _7h.prototype.cp=function(){ var S=this.ColNames[1],Db=S.length,C=this.Cols; var A5=0,dz=0,c0=0; for(var i=0;i<Db;i++){ var BD=C[S[i]]; if(BD.Visible){ A5+=BD.Width; if(BD.RelWidth){ dz+=BD.Width-BD.MinWidth; c0+=BD.RelWidth;}} else if(BD.dD)c0+=BD.RelWidth;} A5+=this.Img.IP; return[A5,A5-dz,c0,0,0];}; _7h.prototype.cq=function(){ var S=this.ColNames[1],Db=S.length,C=this.Cols,A5=0; for(var i=0;i<Db;i++)if(C[S[i]].Visible)A5+=C[S[i]].Width; A5+=this.Img.IP; return[A5,A5,0,0,0];}; _7h.prototype.cn=function(){ var AM=this.Pager,dN=this.Img.aV; if(this.Paging&&AM.Visible)return[ AM.Width+dN, AM.RelWidth?AM.MinWidth+dN:AM.Width+dN, AM.RelWidth, AM.CanResize?AM.MinWidth+dN:AM.Width+dN, AM.CanHide?AM.Width+dN:0]; return[0,0,0,0,0];}; _7h.prototype.ScrollIntoView=function(row,F6,d3,children,d4){ if(!row||row.Space)return; if(row.Page||children||!row.r1){ if(row.Page){ var y=row.r1?row.r1.offsetTop:0,CS=this.Hu; if(d3==null)CS=row.r1.offsetHeight; else if(!row.firstChild)y+=d3*this.Hu; else{ for(var AP=row.firstChild,i=0;i<d3&&AP;i++,AP=AP.nextSibling)y+=this.GetRowHeight(AP); if(AP)CS=this.GetRowHeight(AP);}} else{ var y=this.Hx(row); var CS=this.GetRowHeight(row); if(children)CS+=this.Hs(row); if(y>2)y-=2;else y=0; d3=0;}; var Gq=this.GetScrollTop(),Gn=this.N[1].offsetHeight-this.Img.d5; if(y<=Gq){this.RG.scrollTop=Math.ceil(this.P*(y-1));Ho=1;} else if(y+CS>Gq+Gn){this.RG.scrollTop=Math.ceil(this.P*(d3==null?y:(y>y-Gn+CS+1||!children?y-Gn+CS+1:y)));Ho=1;}} else{ var E=this.IC(row,F6?F6:this.GetFirstCol()),Ho=0; if(!E)return; if(F6&&(E.w||E.z)&&(!E.w||!E.z||d4)){ var A5=this.KL(row,F6),dN=this.N[1].clientWidth; if(E.w){ if(A5<dN||d4){this.RI.scrollLeft-=Math.ceil(this.Q*(E.w+0));Ho=1;}} else if(A5>=dN){ if(this.CanEdit(row,F6)){ var Lq=Math.ceil(this.Q*(this.GetCell(row,F6).offsetLeft)); if(Lq!=this.RI.scrollLeft){this.RI.scrollLeft=Lq;Ho=1;}}} else{this.RI.scrollLeft+=Math.ceil(this.Q*(E.z+0));Ho=1;}} if(E.AA){this.RG.scrollTop-=Math.ceil(this.P*(E.AA+0));Ho=1;} else if(E.AB){this.RG.scrollTop+=Math.ceil(this.P*(E.AB+0));Ho=1;}}; if(Ho){ this.Scrolled(1);}}; _7h.prototype.dr=function(){ var top=this.GetScrollTop()+2; for(var Ey=this.XB.firstChild;Ey;Ey=Ey.nextSibling){ var YM=Ey.r1?Ey.r1.offsetHeight:0; if(Ey.Hv){ if(top-YM>=0){ Ey=Ey.r1.Dn; top-=YM; continue;} YM=Ey.Height/this.PageLengthDiv;} if(top-YM<0)break; top-=YM;} for(var AP=this.GetFirstVisible(Ey);AP;AP=this.GetNextVisible(AP)){ var YM=this.GetRowHeight(AP); if(top-YM<0)break; top-=YM;} var AJ=[],Au=0;top+=this.N[1].clientHeight-4; for(;AP;AP=this.GetNextVisible(AP)){ if(AP.r1)AJ[Au++]=AP; var YM=this.GetRowHeight(AP); if(top-YM<0)break; top-=YM;} return AJ;}; _7h.prototype.dt=function(){ var left=this.GetScrollLeft()+2; var C=this.ColNames[1],AJ=[],Au=0; for(var i=0;i<C.length;i++){ var BD=this.Cols[C[i]]; if(!BD.Visible)continue; if(left<BD.Width)break; left-=BD.Width;} left+=this.N[1].clientWidth-4; for(;i<C.length;i++){ var BD=this.Cols[C[i]]; if(!BD.Visible)continue; AJ[Au++]=C[i]; if(left<BD.Width)break; left-=BD.Width;} return AJ;}; _7h.prototype.Kc=function(){ for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.r1)AP.r1.style.width="10px"; if(!_7N){ var Au=this.Qu.parentNode; if(Au)Au.parentNode.style.display="none";}}; _7h.prototype.P9=function(row){ if(row&&(row.Fixed=="Head"||row.Space<=1))this.P8=1; else if(row&&(row.Fixed=="Foot"||row.Space>=2)||this.ASec==-3||this.ASec==-4)this.P8=2; else this.P8=null;}; _7h.prototype.S5=function(F6,left){ this.RH=null; var H6=this.GetCell(this.Header,F6),dE=this.L[1].offsetWidth; if(!H6)this.GetCell(this.GetFirstVisible(),F6); if(H6){ var x=H6.offsetLeft+left; if(_7P&&!_7U)x-=this.GetScrollLeft(); if(x>=0&&x<=10)this.RH=-1; else if(x>=dE-10&&x<=dE)this.RH=1;}}; _7h.prototype.GetScrollLeft=function(){ return _7G?-this.L[1].firstChild.firstChild.offsetLeft:this.L[1].scrollLeft;}; _7h.prototype.GetScrollTop=function(){ return _7G?-this.N[1].firstChild.firstChild.offsetTop:this.N[1].scrollTop;}; _7h.prototype.UpdatePos=function(d6){ if(!this.HW||!this.HW.parentNode||Grids.Bc&&Grids.Bc.Hidden)return; var AJ=_7s(this.HW); if(_7N&&!_7Y)AJ[0]+=this.Img.d7; if(_7J)AJ[1]+=this.Img.d8; var Ff=this.IE!=AJ[0]||this.IF!=AJ[1]; if(Ff||!d6){ this.IE=AJ[0];this.IF=AJ[1]; if(_7R)_7w(); var AJ=_7t();_7AR=AJ[0],_7AS=AJ[1]; var x=0,y=0,Ak=0,F8=0,A5=1e8,CS=1e8,M=this.MainTag; for(var Au=M,a=Au.offsetParent;a&&a!=document.body;Au=a,a=a.offsetParent){ var C3=0; x+=a.scrollLeft-Au.offsetLeft; y+=a.scrollTop-Au.offsetTop; if(a.offsetWidth<a.scrollWidth){ var CF=a.clientWidth+x;if(CF<A5)A5=CF; if(x>F8)F8=x; C3=1;} if(a.offsetHeight<a.scrollHeight){ var Ht=a.clientHeight+y;if(Ht<CS)CS=Ht; if(y>Ak)Ak=y; C3=1;} if(C3&&!a["Grid"+this.Index]){ AttachEvent(a,"scroll",new Function("if("+this.K+")"+this.K+".UpdatePos();")); a["Grid"+this.Index]=1;}} A5=M.offsetWidth-A5;if(A5<0)A5=0; CS=M.offsetHeight-CS;if(CS<0)CS=0; if(!Ff)Ff=this.w!=F8||this.z!=A5||this.AA!=Ak||this.AB!=CS; if(Ff){ this.w=F8;this.z=A5;this.AA=Ak;this.AB=CS;this.Lv=1; this.MC(this.KB); this.Mv();}} return Ff;}; function GetS(row,Gv){return Get(row,Gv)+"";}; function GetLowerS(row,Gv){return GetLower(row,Gv)+"";}; _7h.prototype.SearchRows=function(action,Kl){ if(this.Paging==3&&!(this.OnePage&4)&&!this.Iz())return; if(action=="Find"){ this.DoSearch(action,Kl);} else if(this.RowCount<this.SynchroCount)this.DoSearch(action,Kl); else{ this.ShowMessage(this.GetText("Search")); var T=this;setTimeout(function(){ T.DoSearch(action,Kl); T.HideMessage();},10);}}; _7h.prototype.SearchInRow=function(AP,AJ,R,Fr,Cols){ for(var i=0;i<AJ.length;i++){ for(var j=0;j<Cols.length;j++){ var BD=Cols[j],Ak=this.GetType(AP,BD); if(Ak=="Int"||Ak=="Float"){ Fr[i]=AJ[i]-0==this.GetValue(AP,BD);} else{ var S=Get(AP,BD+"FilterValue"); if(S==null)S=this.GetString(AP,BD,2); if(Grids.OnGetFilterValue)S=Grids.OnGetFilterValue(this,AP,BD,S); if(!S)Fr[i]=AJ[i]=="#"; else Fr[i]=AJ[i]?(R?S.search(R[i])>=0:S.indexOf(AJ[i])>=0):0;}; if(Fr[i])break;}}}; _7h.prototype.SearchInCell=function(AP,AJ,R,Fr,BD){ for(var i=0;i<AJ.length;i++){ var Ak=this.GetType(AP,BD); if(Ak=="Int"||Ak=="Float"){ Fr[i]=AJ[i]-0==this.GetValue(AP,BD);} else{ var S=Get(AP,BD+"FilterValue"); if(S==null)S=this.GetString(AP,BD,2); if(Grids.OnGetFilterValue)S=Grids.OnGetFilterValue(this,AP,BD,S); if(!S)Fr[i]=AJ[i]=="#"; else Fr[i]=AJ[i]?(R?S.search(R[i])>=0:S.indexOf(AJ[i])>=0):0;}}}; _7h.prototype.OD=function(Fj,Af){ var Method=this.SearchMethod; if(!Method){ if(Fj.search(/[\(\)\=\!\<\>]/)>=0)Method=2;} var O7=""; var d9=this.SearchDefs; if(d9){ d9=d9.split(','); for(var i=0;i<d9.length;i++)if(this.Def[d9[i]])O7+=(O7?":1,":"")+d9[i]; if(O7)O7="if(!{"+O7+":1}[Row.Def.Name]) return -1;";} if(!Method||Method==2){ function eA(BD){ return BD>=48&&BD<=57||BD>=65&&BD<=90||BD>=97&&BD<=122||BD==46||BD==44||BD==95||BD==34||BD==39||BD==35||BD==36||BD==64||BD>=128}; var AJ=new Array(),AN=new Array(),C=new Array(); for(var Au=0,i=0,Ak=-1;Fj;i++){ var BD=Fj.charCodeAt(i); if(!BD){ if(Fj&&Fj.charCodeAt(0)>32)AJ[Au++]=Fj; break;} if(BD<=32&&!i){Fj=Fj.slice(1);i=-1;continue;} var x=eA(BD); if(!i){ if(BD==34||BD==39){ for(i++;;i++){ var BM=Fj.charCodeAt(i); if(!BM)break; if(BM==BD){ if(Fj.charCodeAt(i+1)==BD)Fj=Fj.slice(0,i)+Fj.slice(i+1); else break;}}} Ak=x;} else if(Ak&&!x||!Ak&&x||BD<=32){ AJ[Au++]=Fj.slice(0,i); Fj=Fj.slice(i); i=-1;}} function eB(AL,eC,eD,eE){ AL=AL.split(","); for(var i=0;i<AL.length;i++){ var eF=AL[i].toLowerCase(); for(var j=0;j<AJ.length;j++){ var B3=AJ[j].toLowerCase(); if(eF==B3&&AN[j]==null&&(!AJ[j+1]||AJ[j+1].charAt(0)!='(')){ AN[j]=eC; C[j]=eD;} if(eF.indexOf(B3)==0){ for(var x=j+1;B3.length<eF.length&&AJ[x];x++)B3+=' '+AJ[x].toLowerCase(); if(eF==B3&&AN[j]!=""&&(AN[j]==null||x-j>1)){ AN[j]=eC; if(eD)AJ[j]=eD; while(x>j+1){ AN[--x]=""; if(!eE)C[x]="";}}}}}}; var Cs=Af&4?"Get":"GetLower"; for(var BD in this.Cols){ var AL=this.Cols[BD].SearchNames; if(!AL)AL=this.GetCaption(BD); eB(AL,Cs+"(Row,'"+BD+"')",null,1);} eB(this.GetText("Starts"),"|*"); eB(this.GetText("Ends"),"*|"); eB(this.GetText("Contains"),"*|*"); if(!Method){ for(var i=0,a=0;i<AN.length;i++)if(AN[i])a++; if(a>=2)Method=2; else Method=1;} if(Method==2){ eB(this.GetText("And"),"&&"); eB(this.GetText("Or"),"||"); eB(this.GetText("Not"),"!"); eB("<>","!="); for(var i=0;i<AJ.length;i++){ var B3=AJ[i],BD=B3.charCodeAt(0); if(BD==34||BD==39){ if(!(Af&4)){ function Dx(JW){ var a=AN[JW]?AN[JW]:AJ[JW]; return a=="=="||a=="!="||a==">"||a==">="||a=="<"||a=="<="||a=="|*"||a=="*|"||a=="*|*";}; if(Dx(i-1)||Dx(i+1))AJ[i]=AJ[i].toLowerCase();} continue;} if(AN[i]!=null)continue; var JW=B3.indexOf('='); if(JW>=0){ var KF=JW?B3.charAt(JW-1):null; if(KF=='='||KF=='>'||KF=='<'||B3.charAt(JW+1)=='=')continue; AN[i]=B3.slice(0,JW)+"="+B3.slice(JW);} else if(BD>=48&&BD<=57){ if(B3.indexOf(',')>=0)AN[i]=B3.replace(',','.');} else if(eA(BD)){ var j=i; for(i++;i<AJ.length;i++){ if(!eA(AJ[i].charCodeAt(0))||AN[i]!=null)break; B3+=' '+AJ[i];} if(AJ[i]&&AJ[i].charCodeAt(0)==40)continue; if(B3&&!(Af&4))B3=B3.toLowerCase(); if(B3.indexOf('"')<0)B3='"'+B3+'"'; else if(B3.indexOf("'")<0)B3="'"+B3+"'"; else B3='"'+B3.replace('"','""')+'"'; AN[j]=B3; C[j]=B3; for(j++;j<i;j++){AN[j]="";C[j]="";} i--;}} for(var i=0;i<AJ.length;i++){ if(AJ[i].search(/^\'?\"?\d{1,2}[\/\-\:\.]\d{1,2}([\/\-\:\.]\d{1,4})?(..?\d{1,2}[\:\-]\d{1,2}([\-\:]\d{1,2})?)?\'?\"?$/)>=0&&AJ[i].search(/^\d*.\d*$/)<0){ var B3=AJ[i]; if(B3.charAt(0)=='"'||B3.charAt(0)=="'")B3=B3.slice(1,B3.length-1); AN[i]=this.Lang.Format.StringToDate(B3,this.SearchDateFormat); var BD=B3.charAt(0); if(BD!='"'&&BD!="'")B3='"'+B3+'"'; C[i]=B3;} if(AJ[i]=='/'||AJ[i]=='-'||AJ[i]==':'){ if(!i||AN[i-1]!=null||AN[i+1]!=null||isNaN(AJ[i-1]-0)||isNaN(AJ[i+1]-0))continue; var j=AJ[i+2]==AJ[i]&&!isNaN(AJ[i+3])&&AN[i+3]==null?i+4:i+2,eG=null; if(AJ[j+1]==':'&&AN[j]==null&&AN[j+2]==null&&!isNaN(AJ[j]-0)&&!isNaN(AJ[j+2]-0)){ eG=j; j=AJ[j+3]==':'&&!isNaN(AJ[j+4])&&AN[j+4]==null?j+5:j+3;} for(var k=i,P1="";k<j;k++){ if(k==eG)P1+=' '; P1+=AJ[k];AN[k]="";C[k]=""} AN[i-1]=this.Lang.Format.StringToDate(AJ[i-1]+P1,this.SearchDateFormat); C[i-1]='"'+AJ[i-1]+P1+'"'; if(AJ[i]==':'){ if(i>1&&AN[i-2]-0){ var BD=AJ[i-2].charAt(0); if(BD!='"'&&BD!="'"){ AN[i-2]=this.Lang.Format.StringToDate(AJ[i-2]+" "+AJ[i-1]+P1,this.SearchDateFormat); AN[i-1]=""; C[i-2]='"'+AJ[i-2]+" "+AJ[i-1]+P1+'"'; C[i-1]="";}}}}} for(var i=0;i<AJ.length;i++){ var H4=null; switch(AN[i]){ case '|*': AN[i]='.indexOf('; H4="==0"; if(i&&AN[i-1]&&AN[i-1]=='!'){AN[i-1]="";H4="!=0";} if(AN[i+1])AN[i+1]+=")"+H4; else AN[i+1]=AJ[i+1]+")"+H4; break; case '*|': AN[i]='.lastIndexOf('; H4="=="; if(i&&AN[i-1]&&AN[i-1]=='!'){AN[i-1]="";H4="!=";} var eH=AN[i-1]?AN[i-1]:AJ[i-1],eI=AN[i+1]?AN[i+1]:AJ[i+1]; AN[i+1]=eI+")"+H4+"("+eH+".length-("+eI+"+'').length)"; break; case '*|*': AN[i]='.indexOf('; H4=">=0"; if(i&&AN[i-1]&&AN[i-1]=='!'){AN[i-1]="";H4="<0";} if(AN[i+1])AN[i+1]+=")"+H4; else AN[i+1]=AJ[i+1]+")"+H4; break;}; if(H4&&AN[i-1]){ AN[i-1]=(AN[i-1]+"").replace("Get(","GetS(").replace("GetLower(","GetLowerS(");}} var S="",eJ=""; for(var i=0;i<AJ.length;i++){ S+=(i?" ":"")+(AN[i]!=null?AN[i]:AJ[i]); eJ+=(i&&C[i]!=""?" ":"")+(C[i]!=null?C[i]:AJ[i]);} this.SearchExpression=eJ; if(Grids.OnRowSearch)S=O7+"var found=("+S+"); return Grids.OnRowSearch("+this.K+",Row,null,found,arguments.callee,UserVal);"; else S=O7+"return "+S+";";}} if(Method==1){ Fj=this.SearchExpression; var S='([^\\"\\s]*)?\\s*(\"([^\\"]*)\")?\\s*'; for(var i=0;i<4;i++)S+=S; S="^\\s*"+S+"$"; var X="",AM=new Array(),AJ=new Array(),Au=0; if(Fj){ Fj=Fj.match(S); for(var i=1;i<Fj.length;i++)if(Fj[i]&&Fj[i].charAt(0)!='"')AM[Au++]=Fj[i]; for(var i=0,x=0;i<Au;i++){ if(AM[i]=="OR")continue; if(i)X+=AM[i-1]=="OR"?"||":"&&"; if(AM[i+1]=="OR"&&(!i||AM[i-1]!="OR"))X+="("; if(AM[i].charAt(0)=='-'){X+="!";AM[i]=AM[i].slice(1);} X+="Z["+x+"]"; AJ[x++]=AM[i]; if(i&&AM[i+1]!="OR"&&AM[i-1]=="OR")X+=")";}} var Cols=this.SearchCols; if(Cols){ Cols=Cols.split(","); var eK=new Object(); for(var i=0;i<Cols.length;i++)eK[Cols[i]]=1;} var eL=new Object();Cols=new Array(); for(var BD=this.GetFirstCol();BD;BD=this.GetNextCol(BD)){ if(this.Cols[BD].CanSearch&&(!eK||eK[BD])){eL[BD]=1;Cols[Cols.length]='\"'+BD+'\"';}} if(Af&2){ for(var BD in this.Cols){ if(this.Cols[BD].CanSearch&&!eL[BD]){Cols[Cols.length]='\"'+BD+'\"';}}} var S=O7; S+="var Z=new Array();"; S+="var A=["; for(var i=0;i<AJ.length;i++)S+=(i?",":"")+"\""+AJ[i].replace("\"","\\\"")+"\""; S+="];"; if(Af&4)S+="var R=null;"; else{ S+="var R=["; for(var i=0;i<AJ.length;i++)S+=(i?",":"")+"/"+AJ[i].replace(/[\\\^\$\*\+\?\.\{\}\[\]\(\)\|\-\{\}\/]/g,"\\$&")+"/i"; S+="];";}; if(Af&1){ S+="var Cols=["+Cols.join(",")+"],i=0;"; S+="if(Col){"; S+="for(i=0;i<Cols.length;i++) if(Cols[i]==Col) { i++; break; }"; S+="}"; S+="for(;i<Cols.length;i++){"; S+=this.K+".SearchInCell(Row,A,R,Z,Cols[i]);"; if(Grids.OnRowSearch)S+="var found = Grids.OnRowSearch("+this.K+",Row,Cols[i],"+X+",arguments.callee,UserVal);"; else S+="var found= "+X+";"; S+="if(found==-1) return -1;"; S+="if(found==1) return Cols[i];"; S+="if(found) return found;"; S+="} return 0;";} else{ S+=this.K+".SearchInRow(Row,A,R,Z,["+Cols.join(",")+"]);"; if(Grids.OnRowSearch)S+="return Grids.OnRowSearch("+this.K+",Row,null,"+X+",arguments.callee,UserVal);"; else S+="return "+X+";";}} try{ var CE=new Function("Row","Col","UserVal",S); return[CE,Method];} catch(H){ return null;}}; _7h.prototype.DoSearch=function(action,Kl){ if(!this.Searching)return; if(action=="Last")action=this.eM; if(Grids.OnSearch&&Grids.OnSearch(this,action,!Kl))return; if(action=="Help"){ alert(this.GetAlert("SearchHelp")); return;} if(action=="Refresh"){ var QU=this.SearchAction; if(QU){ this.DoSearch("Clear",QU=="Filter"?Kl:1); this.DoSearch(QU,Kl);} else this.SaveCfg(); return;} var Fj=this.SearchExpression; if(this.eN&&Fj!=this.eO){this.OF++;this.eN=0;} this.eO=Fj; var eP=this.SearchAction; if(!Fj)action="Clear"; if(this.SearchAction!=action){ this.eQ(action,Kl); this.SearchAction=action;} if(action=="Clear"){ this.SearchAction=""; this.Calculate(!Kl,1,1); this.SaveCfg(); return;} this.eM=this.SearchAction; if(this.Paging==3&&(!(this.OnePage&4)||this.AllPages)){ this.Calculate(!Kl,1,1); this.SaveCfg(); this.ReloadBody(null,0,"Search"); if(Grids.OnSearchFinish)Grids.OnSearchFinish(this,action,!Kl); return 1;} var Af=this.SearchType;if(Af==null)Af=176; this.Debug(4,"Searching in grid, action "+action);this.LB("Search"); var CE=this.OD(Fj,Af); if(!CE){ alert(this.GetAlert("SearchError")); this.SearchAction=""; return;} var Method=CE[1];CE=CE[0]; var DG=0; if(this.Searched)switch(action){ case "Filter": this.N9=CE; var Kg=this.Filtered;this.Filtered=true; if(this.SB){ if(!Kl&&this.G4){DG=this.SB(1);this.Render();} else DG=this.SB(Kl);} else _7Ae("Filter"); this.Filtered=Kg; this.ShowPages(); break; case "Select": for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP)){ if(!Is(AP,"CanSelect"))continue; var OE=CE(AP); OE=typeof(OE)=="string"||OE>0; if(AP.Selected&&!OE)this.SelectRow(AP); else if(!AP.Selected&&OE){ this.SelectRow(AP); if(Af&8)this.ExpandParents(AP);}} break; case "Mark": this.eN=1; if(!this.OF)this.OF=1; var Color=this.f["Found"+this.OF]; if(!Color){Color=this.f["Found1"];this.OF=1;} if(Af&1&&Method==1)for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP)){ var OE=CE(AP); while(OE&&typeof(OE)=="string"){ AP[OE+"MarkColor"]=Color; if(this.ColorClasses&4){ AP[OE+"MarkClass"]="Found"+this.OF; this.RefreshCell(AP,OE);} else this.ColorCell(AP,OE); if(Af&8)this.ExpandParents(AP); OE=CE(AP,OE);}} else for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP)){ var OE=CE(AP)>0; if(OE){ AP.OG=Color; if(this.ColorClasses&4){ AP.OH="Found"+this.OF; this.RefreshRow(AP);} else this.ColorRow(AP); if(Af&8)this.ExpandParents(AP);}} break; case "Find": var start=this.FRow&&!this.FRow.Fixed&&(!(Af&64)||eP=="Find")?this.FRow:null; if(this.FRow&&this.FRow.Space!=null)this.Focus(); if(Af&1&&Method==1&&start&&this.FCol){ var OE=CE(start,this.FCol); if(typeof(OE)=="string"){ this.Focus(start,OE,null,1); break;}} var AP=start?this.GetNextVisible(start):this.GetFirstVisible(); if(AP)while(AP!=start){ var OE=CE(AP); if(OE){ if(typeof(OE)=="string"){ this.Focus(AP,OE,null,1); break;} else if(OE>0){ this.Focus(AP,this.FCol,null,1); break;} else OE=0;} AP=this.GetNextVisible(AP); if(!AP){ if(start&&Af&16){ if(Af&32){ if(!confirm(this.GetAlert("SearchStart"))){ OE=1; break;}} AP=this.GetFirstVisible();} else break;}} if(!OE&&Af&128)alert(this.GetAlert("NotFound")); break;}; this.Calculate(!Kl,1,1); this.SaveCfg(); if(Grids.OnSearchFinish)Grids.OnSearchFinish(this,action,!Kl); this.LC("Search"); if(!Kl)this.Debug(4,"Search completed in ",this.PB("Search")," ms"); return DG;}; _7h.prototype.eQ=function(action,Kl){ if(this.Searched&&this.SearchAction&&!Kl){ this.Debug(4,"Clearing search action "+this.SearchAction); this.LB("Search");} if(this.Searched)switch(this.SearchAction){ case "Filter": this.N9=null; var Kg=this.Filtered;this.Filtered=true; if(this.SB){ if(!Kl&&this.G4){this.SB(1);this.Render();} else this.SB(Kl);} this.Filtered=Kg; this.ShowPages(); break; case "Select": for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP)){ if(AP.Selected&&Is(AP,"CanSelect"))this.SelectRow(AP);} break; case "Find": if(action=="Clear")this.Focus(); break; case "Mark": for(var AP=this.GetFirstVisible();AP;AP=this.GetNextVisible(AP)){ if(AP.OG){ AP.OG=null; if(this.ColorClasses&4){ AP.OH=null; this.RefreshRow(AP);} else this.ColorRow(AP);} for(var BD in this.Cols){ if(AP[BD+"MarkColor"]){ AP[BD+"MarkColor"]=null; if(this.ColorClasses&4){ AP[BD+"MarkClass"]=null; this.RefreshCell(AP,BD);} else this.ColorCell(AP,BD);}}} this.OF=0;this.eN=1; break;}; if(this.Searched&&this.SearchAction&&!Kl){ this.LC("Search"); this.Debug(4,"Clearing search completed in ",this.PB("Search")," ms");}}; _7h.prototype.ActionSearchOff=function(){ if(!this.Searching||!this.Searched)return false; this.eQ(); this.Searched=false; for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Kind=="Search")this.SV(AP); this.SaveCfg(); return true;}; _7h.prototype.ActionSearchOn=function(){ if(!this.Searching||this.Searched)return false; this.Searched=true; if(this.SearchAction)this.DoSearch(this.SearchAction); for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling)if(AP.Kind=="Search")this.SV(AP); this.SaveCfg(); return true;}; _7h.prototype.UseCharCodes=function(Ep,F6){ var Es="",Fa=this.Cols[F6].CharCodes;Ep+=""; if(!Fa)return Ep; for(var i=0;i<Ep.length;i++){ var x=Fa[Ep.charAt(i)]; Es+=x?x:Ep.charAt(i);} return Es;}; _7h.prototype.YF=function(eR,r1,r2){ var J1=this.SortTypes,F6=this.SortCols[eR],eS=J1[eR]&1; var MW=this.GetValue(r1,F6),MY=this.GetValue(r2,F6); if((J1[eR]&30||this.Cols[F6].CharCodes)&&(this.Cols[F6].Type=="Text"||this.Cols[F6].Type=="Lines")){ if(MW==null)return MY==null?0:-1; if(MY==null)return 1; var DG=this.Cols[F6].CharCodes&&this.UseCharCodes?CompareStrings(this.UseCharCodes(MW,F6),this.UseCharCodes(MY,F6),J1[eR]):CompareStrings(MW,MY,J1[eR]); return eS?-DG:DG;} else{ if(MW<MY)return eS?1:-1; if(MW>MY)return eS?-1:1;}; return 0;}; _7h.prototype.eT=function(r1,r2){ for(var i=0;i<this.W;i++){ var x=this.YF(i,r1,r2); if(x)return x;} return 0;}; _7h.prototype.SortRow=function(row,F6,HQ){ if(!this.Sorted||!this.AutoSort||!this.Sorting||row.Fixed)return; if(F6&&F6!="Panel"){ var Ex=false; for(var i=0;i<this.W;i++)if(this.SortCols[i]==F6){Ex=true;break;} if(!Ex)return;} var GP=row.parentNode,AP; if(GP.Page){ if(!this.Root.CanSort)return; for(AP=this.GetFirst();AP;AP=this.GetNextSibling(AP))if(this.eT(row,AP)<0)break;} else{ if(!Get(GP,"CanSort"))return; for(AP=GP.firstChild;AP;AP=AP.nextSibling)if(this.eT(row,AP)<0)break;}; if(this.N4)this.N4(row,GP,AP,HQ); if(HQ)this.ScrollIntoView(row,F6);}; function _7A2(EV){ if(EV>0){ var U1=Math.log(EV)/100; return U1>=0?U1+"":"/"+(10+U1);} if(EV<0){ var U1=Math.log(-EV)/100; return U1>0?"-/"+(10-U1):"-"+(-U1);} if(EV=="0")return "."; return EV+"";}; function _7A3(Ep){ if(Ep==="")return _7A3.Ea; var B3="",Db=Ep.length;if(Db>20)Db=20; for(var i=0;i<Db;i++){ B3+=String.fromCharCode(65535-Ep.charCodeAt(i));} return B3;}; _7A3.Ea=String.fromCharCode(65530); _7h.prototype.eU=function(AP,Bg,eV,Af){ var B3=""; var Vy=AP.SortPos;if(Vy==null)Vy=AP.Def.SortPos; if(Vy)B3=Af?String.fromCharCode(65535-Vy):String.fromCharCode(Vy); for(var i=0;i<this.W;i++){ var Dh,R8,Fa=AP.Spanned&&Is(AP,"SortSpan")?this.KO(AP,this.SortCols[i]):this.SortCols[i],K9=Bg[i]; if(K9&1){ R8=Fa+"SortDescValue";Dh=AP[R8];if(Dh==null)Dh=AP.Def[R8]; if(Dh==null){R8=Fa+"SortValue";Dh=AP[R8];if(Dh==null)Dh=AP.Def[R8];}} else{R8=Fa+"SortValue";Dh=AP[R8];if(Dh==null)Dh=AP.Def[R8];}; if(Dh==null){ if(eV[i]){ Dh=AP[Fa];if(Dh==null)Dh=AP.Def[Fa]; if(Dh&&typeof(Dh)=="string"){ var eW=AP[Fa+"Range"];if(eW==null){eW=AP.Def[Fa+"Range"];if(eW==null)eW=this.Cols[Fa]["Range"];} if(eW){ Dh=Dh.split(this.Lang.Format.ValueSeparator); Dh=K9&1?Dh[Dh.length-1]:Dh[0]; var R4=Dh.indexOf(this.Lang.Format.RangeSeparator); if(R4>=0)Dh=K9&1?Dh.slice(R4+1)-0:Dh.slice(0,R4)-0; else Dh-=0;}}} else Dh=this.GetString(AP,Fa,2);} if(Grids.OnGetSortValue)Dh=Grids.OnGetSortValue(this,AP,Fa,this.Vz&&eV[i]?this.GetString(AP,Fa,2):Dh,K9&1,this.Vz); Dh=Dh==null?"":Dh+""; if(this.Cols[Fa].CharCodes)Dh=this.UseCharCodes(Dh,Fa); if(K9&6)Dh=K9&2?Dh.toLocaleLowerCase():Dh.toLowerCase(); if(K9&8)Dh=Dh.replace(this.Cols[Fa].WhiteChars,""); if(Af==(K9&1)){ B3+=(eV[i]?_7A2(Dh):Dh)+"  ";} else{ B3+=(eV[i]&&(Dh-0||Dh=="0")?_7A2(-Dh):_7A3(Dh))+"  ";}} return B3;}; _7h.prototype.eX=function(eY,SortType,GP){ var Em=this.W; for(var i=0;i<Em;i++){ var C=this.Cols[this.SortCols[i]]; if(!C)return; var Es=Get(GP,this.SortCols[i]+"NumberSort"); eY[i]=Es==null?C.Type=="Int"||C.Type=="Float"||C.Type=="Date":Es; SortType[i]=(C.SortType?C.SortType:0)|(this.SortTypes[i]?this.SortTypes[i]:0);} var dir=0; for(var i=0;i<Em;i++){ if(!eY[i])dir+=SortType[i]&1?-1:1;} if(dir)dir=dir<0?1:0; else dir=SortType[0]&1; return dir;}; _7h.prototype.Vv=function(GP,HQ,aX){ var eZ=false,Em=this.W; if(!Em)return false; var eY=new Array(),SortType=new Array(); var dir=this.eX(eY,SortType,this.Root); this.PA("SortPrepare"); var AJ=new Array(),AN=new Array(),Au=0,AP=GP.firstChild,YS=0,ea=""; if(AP&&AP.LN){ for(;AP;AP=AP.nextSibling){ for(var FZ=AP.firstChild;FZ;FZ=FZ.nextSibling){ if(!aX&&FZ.firstChild&&this.Vv(FZ,HQ))eZ=true; if(FZ.Pr){ if(YS>0){if(FZ.Pr>YS){YS=FZ.Pr;ea+=dir?"0":"9";}} else{YS=FZ.Pr;ea=this.eU(FZ,SortType,eY,dir);}} AJ[Au]=(YS-->0?ea+(dir?10000+YS:9999-YS):this.eU(FZ,SortType,eY,dir))+"      "+Au; AN[Au++]=FZ;}}} else{ for(;AP;AP=AP.nextSibling){ if(!aX&&AP.firstChild&&this.Vv(AP,HQ))eZ=true; if(AP.Pr){ if(YS>0){if(AP.Pr>YS){YS=AP.Pr;ea+=dir?"0":"9";}} else{YS=AP.Pr;ea=this.eU(AP,SortType,eY,dir);}} AJ[Au]=(YS-->0?ea+(dir?10000+YS:9999-YS):this.eU(AP,SortType,eY,dir))+"      "+Au; AN[Au++]=AP;}}; this.LC("SortPrepare"); if(Au<=1||GP.Page&&!this.Root.CanSort||!GP.Page&&!Is(GP,"CanSort"))return eZ; this.PA("SortSort"); AJ.sort(); this.LC("SortSort"); var C=new Array(),eb=AJ.length,ec=AN.length-1; for(var i=0;i<eb;i++){ C[i]=dir?AN[AJ[ec-i].slice(AJ[ec-i].length-6)-0]:AN[AJ[i].slice(AJ[i].length-6)-0];} this.PA("SortUpdate"); this.LQ(GP,HQ,C); this.LC("SortUpdate"); eZ=true; return eZ;}; _7h.prototype.DoSort=function(HQ,aX){ for(var i=0;i<this.W;i++){ if(!this.Cols[this.SortCols[i]])this.W=0;} if(!this.W)return false; this.Debug(4,"Sorting rows");this.LB("Sort"); this.PC("SortPrepare");this.PC("SortSort");this.PC("SortUpdate");this.PC("SortShow"); var eZ=false; var eY=new Array(),SortType=new Array(); var dir=this.eX(eY,SortType,this.Root); this.PA("SortPrepare"); var AJ=new Array(),AN=new Array(),Au=0,D3=!!this.MainCol&&!aX,YS=0,ea=""; for(var Ey=this.XB.firstChild;Ey;Ey=Ey.nextSibling){ for(var AP=Ey.firstChild;AP;AP=AP.nextSibling){ if(D3&&AP.firstChild&&(AP.firstChild.nextSibling||AP.firstChild.firstChild)&&this.Vv(AP,HQ))eZ=true; if(AP.Pr){ if(YS>0){if(AP.Pr>YS){YS=AP.Pr;ea+=dir?"0":"9";}} else{YS=AP.Pr;ea=this.eU(AP,SortType,eY,dir);}} AJ[Au]=(YS-->0?ea+(dir?10000+YS:9999-YS):this.eU(AP,SortType,eY,dir))+"      "+Au; AN[Au++]=AP;}} this.LC("SortPrepare"); if(Au<=1||!this.Root.CanSort){ if(Au>1)this.CreatePages(); if(this.Paging&&this.YC)this.YC(); this.LC("Sort"); if(HQ)this.Debug(4,"TreeGrid sorted in ",this.PB("Sort")," ms (prepare: ",this.PC("SortPrepare")," ms, sort: ",this.PC("SortSort")," ms, update: ",this.PC("SortUpdate")," ms)"); return eZ;} this.PA("SortSort"); AJ.sort(); this.LC("SortSort"); this.PA("SortUpdate"); var body=this.XB.firstChild,ec=AN.length-1,eb=AJ.length; var Em=this.Paging?this.PageLength:0xffffffff,YS=0; this.HX(body); for(var i=0;i<eb;i++){ var AP=dir?AN[AJ[ec-i].slice(AJ[ec-i].length-6)-0]:AN[AJ[i].slice(AJ[i].length-6)-0]; if(_7V)AP.parentNode.removeChild(AP); if(AP.Pr&&AP.Pr>YS)YS=AP.Pr; if(AP.Visible){ if(!Em){ if(YS>0)Em++; else{ Em=this.PageLength; body=body.nextSibling; if(!body)body=this.HY(HQ); else this.HX(body);}} Em--;} YS--; body.appendChild(AP);} this.LC("SortUpdate"); if(this.Paging&&this.YC)this.YC(); this.PA("SortShow"); if(HQ){ var HU=this.GetSections(),KF=HU[0],KG=HU[1]; for(var j=KF;j<KG;j++){ var Es="r"+j,KZ=j==1&&Grids.OnDisplaceRow!=null; for(var i=0;i<eb;i++){ var AP=dir?AN[AJ[ec-i].slice(AJ[ec-i].length-6)-0]:AN[AJ[i].slice(AJ[i].length-6)-0]; if(AP[Es]){ var Au=AP[Es].parentNode; var BC=AP._7AZ?AP[Es].nextSibling:null; Au.appendChild(AP[Es]); if(BC){ Au.appendChild(BC); if(KZ){ for(var BD=AP.firstChild;BD&&BD.Level>AP.Level;BD=this.GetNext(BD))if(BD.r1)Grids.OnDisplaceRow(this,BD);}} if(KZ)Grids.OnDisplaceRow(this,AP);}}}} this.LC("SortShow"); body=body.nextSibling; while(body){ var Es=body.nextSibling; this.Hb(body); body=Es;} eZ=true; this.LC("Sort"); if(HQ)this.Debug(4,"TreeGrid sorted in ",this.PB("Sort")," ms (prepare: ",this.PC("SortPrepare")," ms, sort: ",this.PC("SortSort")," ms, update: ",this.PC("SortUpdate")," ms, show: ",this.PC("SortShow")," ms)"); return eZ;}; _7h.prototype.SortRows=function(){ if(!this.AllPages&&this.OnePage&1&&this.Paging){ var SG=this.GetFPage(); if(this.ChildPages){ this.Vv(SG,false); this.Yg(SG); SG.State=2; this.SM(SG);} else{ this.Vv(SG,true); if(this.MainCol)for(var AP=SG.firstChild;AP;AP=AP.nextSibling)this.Yf(AP,true);}} else if(this.Paging==3){ this.ShowMessage(this.GetText("Sort")); this.ReloadBody(null,0,"Sort");} else if(this.Paging==2||this.Paging==1&&!this.AllPages||this.ChildPages){ this.ShowMessage(this.GetText("Sort")); var T=this;setTimeout(function(){ var Nx=T.EditMode; if(Nx&&T.EndEdit(T.FRow,T.FCol,true)==-1){ T.HideMessage(); return;} if(T.DoSort()){ T.Debug(4,"TreeGrid sorted in ",T.PB("Sort")," ms (prepare: ",T.PC("SortPrepare")," ms, sort: ",T.PC("SortSort")," ms, update: ",T.PC("SortUpdate")," ms, show: ",T.PC("SortShow")," ms)"); if(T.Ph)T.Tp(); T.SN(Nx);} else T.HideMessage(); if(Grids.OnSortFinish)Grids.OnSortFinish(T);},10);} else{ var T=this; function sort(){ if(T.DoSort(true)){T.SL(true);T.SC();} T.HideMessage(); if(T.Paging==1&&T.UpdatePager)T.UpdatePager(); if(T.FRow&&!T.FRow.Fixed){ T.ScrollIntoView(T.FRow,T.FCol); T.Mv();} if(T.FRow)T.ExpandParents(T.FRow); if(T.Ph){T.RefreshGanttDependencies();} if(Grids.OnSortFinish)Grids.OnSortFinish(T);}; if(this.RowCount<this.SynchroCount)sort(); else{this.ShowMessage(this.GetText("Sort"));setTimeout(sort,10);}}}; _7h.prototype.ChangeSort=function(cols,ed,Vy){ cols=FD(cols); ed=FD(ed); if(!ed)ed=new Array(); this.SortCols=cols; for(var i=0;i<cols.length;i++)ed[i]=ed[i]?ed[i]-0:0; this.SortTypes=ed; this.W=cols.length; this.VW(); if(!Vy)this.SortRows();}; _7h.prototype.JT=function(HQ){ var ee=this.DefaultSortCol,ef=this.MaxSortColumns; if(ee){ var C=this.Cols[ee]; if(!C)return; for(var i=0;i<this.W;i++)if(ee==this.SortCols[i])break; if(i==this.W||i==ef&&C.Visible){ if(i>ef-1&&C.Visible)i=ef-1; else if(i>ef)i=ef; else this.W++; this.SortCols[i]=ee; this.SortTypes[i]=0; if(HQ)this.VW();}}}; _7h.prototype.SortClick=function(F6,type,dir,bK,bf){ if(this.Cw||!this.Sorting)return false; var C=this.Cols; if(this.EditMode&&this.EndEdit(this.FRow,this.FCol,true)==-1)return false; var eg=0; if(this.Sorted){ if(Grids.OnSort){ eg=Grids.OnSort(this,F6); if(eg==-1)return true; eg=!eg;} else eg=1;} if(!bf&&dir!=null&&this.W&&this.SortCols[0]==F6&&(this.SortTypes[0]&1)==dir)return false; if(eg&&this.Paging==3&&!(this.OnePage&1)&&!this.Iz())return false; for(var Af=0;Af<this.W;Af++){ var HU=C[this.SortCols[Af]]; if(!HU||HU.Visible||HU.CanHide||this.SortCols[Af]==this.DefaultSortCol)break;} for(var i=Af;i<this.W;i++)if(this.SortCols[i]==F6)break; if(bf){ this.SortCols=CopyObject(this.eh); this.SortTypes=CopyObject(this.ei); this.W=this.SortCols.length;} else if(bK){ if(i==this.W)return false; for(i++;i<this.W;i++){ this.SortCols[i-1]=this.SortCols[i]; this.SortTypes[i-1]=this.SortTypes[i];} this.W--;} else{ var ef=this.MaxSortColumns; if(i==this.W&&this.W<ef){ if(i==Af)this.SortTypes[Af]=C[F6].CanSort&0xFE|1; this.W++;} if(i!=Af){ var Ak=this.SortTypes[i]; if(i==ef)i--; for(var j=i-1;j>=Af;j--){ this.SortTypes[j+1]=this.SortTypes[j]; this.SortCols[j+1]=this.SortCols[j];} this.SortTypes[Af]=C[F6].CanSort&0xFE|1;} if(this.SortTypes[Af]==null)this.SortTypes[Af]=C[F6].CanSort&0xFE|1; this.SortCols[Af]=F6; if(type!=null)this.SortTypes[Af]=type; else if(dir!=null)this.SortTypes[Af]=this.SortTypes[Af]&0xFE|dir&1; else this.SortTypes[Af]=(~this.SortTypes[Af])&1|this.SortTypes[Af]&0xFE; if(this.W>ef){ this.SortCols.length=ef; this.W=ef;} this.JT();}; this.VW(); this.SaveCfg(); if(eg)this.SortRows(); return true;}; _7h.prototype.ActionSortAsc=function(CE){return this.SortClick(CE?this.FCol:this.ACol,null,0);}; _7h.prototype.ActionSortDesc=function(CE){return this.SortClick(CE?this.FCol:this.ACol,null,1);}; _7h.prototype.ActionNoSort=function(CE){return this.SortClick(CE?this.FCol:this.ACol,null,null,1);}; _7h.prototype.ActionDefaultSort=function(){return this.SortClick(null,null,null,null,1);}; _7h.prototype.ActionSortOff=function(){ if(!this.Sorting||!this.Sorted)return false; this.Sorted=false; this.SaveCfg(); this.Calculate(1,1,1); return true;}; _7h.prototype.ActionSortOn=function(){ if(!this.Sorting||this.Sorted)return false; var sort=true; if(Grids.OnSort)sort=!Grids.OnSort(this); if(sort&&this.Paging==3&&!this.Iz())return; this.Sorted=true; if(sort){ if(this.Paging==3){ var T=this; setTimeout(function(){ T.J2=true; T.ReloadBody(function(){T.J2=false;},0,"ReSort");},10);} else this.SortRows();} this.SaveCfg(); this.Calculate(1,1,1); return true;}; _7h.prototype.ej=function(F6,ek){ var Ak=(new Date()).getTime(),el=this.DefaultSortCol; if(Ak-this.RR<2000){ var dy=[],NW=[],Em=this.W,C3=1; for(var i=0;i<Em;i++){ dy[i]=this.SortCols[i]; NW[i]=this.SortTypes[i]; if(this.SortCols[i]==F6){ C3=0; if(NW[i]&1){ if(ek)return false; NW[i]&=0xFFFE;} else{ if(ek==false)return false; NW[i]|=1;}}} if(C3&&Em<this.MaxSortColumns){ if(el&&F6!=el&&this.SortCols[Em-1]==el&&!this.em){ dy[Em]=el; NW[Em]=this.Cols[F6].SortType; Em--;} dy[Em]=F6; NW[Em]=this.Cols[F6].SortType; if(ek)NW[Em]|=1;} else if(C3)return false; this.ChangeSort(dy,NW);} else{ this.ChangeSort([F6],[this.Cols[F6].SortType]); this.JT(1);}; this.em=F6==el; this.RR=Ak; this.SaveCfg(); return true;}; _7h.prototype.ActionSortAscAdd=function(CE){return this.ej(CE?this.FCol:this.ACol,0);}; _7h.prototype.ActionSortDescAdd=function(CE){return this.ej(CE?this.FCol:this.ACol,1);}; _7h.prototype.en=function(row){ var eo=new Object(),cells=row.Cells; if(cells)for(var i=0;i<cells.length;i++)eo[cells[i]]=1; return eo;}; _7h.prototype.ep=function(AP,eo){ if(eo["List"]){ if(!AP["ListDefaults"])AP["ListDefaults"]=AP["List"]; if(!AP["ListType"])AP["ListType"]="Select"; if(!AP["ListAction"])AP["ListAction"]="Group"; var Cols=AP["Cols"],VP=AP["Types"]; if(Cols){ Cols=Cols.split(Cols.charAt(0)); var B3="",Ak=""; for(var i=1;i<Cols.length;i++)B3+="','"+Cols[i]; B3="['"+B3.slice(3)+"']"; AP["ListFormula"]="choose(Grid.GroupCols.join(','),"+B3+")"; if(VP){ VP=VP.split(VP.charAt(0)); for(var i=1;i<VP.length;i++)Ak+="','"+VP[i]; Ak="['"+Ak.slice(3)+"']";} AP["ListAction"]="Grid.GroupRows(choose(null,null,"+B3+")"+(Ak?",choose(null,null,"+Ak+")":"")+");"}} if(eo["Custom"]||AP["Custom"]||AP["Custom"]!=0&&AP.Cells.length==0){ if(!eo["Custom"])AP.Cells[AP.Cells.length]="Custom"; AP["CustomType"]="DropCols"; if(AP["CustomText"]==null)AP["CustomText"]=this.GetText("GroupCustom"); AP["CustomCanFocus"]=0; AP["CustomAction"]="Grid.GroupRows(Row[Col]);"; AP["CustomFormula"]="Grid.GroupCols.join(',')"; AP["CustomRelWidth"]=1;} AP.NoColor=1; AP.NoUpload=1; if(Get(AP,"Panel")==null)AP.Panel=1; return;}; _7h.prototype.eq=function(AP,eo){ if(eo["Expression"]){ if(!AP["ExpressionType"])AP["ExpressionType"]="Text"; if(AP["ExpressionRelWidth"]==null)AP["ExpressionRelWidth"]=1; if(!AP["ExpressionFormula"])AP["ExpressionFormula"]="Grid.SearchExpression==null?'':Grid.SearchExpression"; if(AP["ExpressionCanEdit"]==null)AP["ExpressionCanEdit"]=1; if(AP["ExpressionToolTip"]==null)AP["ExpressionToolTip"]=1; var I1=AP["ExpressionAction"],B3="Grid.SearchExpression=Value;"; if(!I1)I1=eo["Actions"]?B3+"Grid.SearchRows(Actions);":B3; else if(I1=="Filter"||I1=="Select"||I1=="Mark"||I1=="Find"||I1=="Last")I1=B3+"Grid.SearchRows('"+I1+"');"; else if(I1=="Actions")I1=B3+"Grid.SearchRows(Actions);"; AP["ExpressionAction"]=I1; if(AP.Cells.length==1)AP.Height=this.aR;} var AN=["Filter","Select","Mark","Find","Clear","Help"]; for(var i=0;i<AN.length;i++){ var Ey=AN[i]; if(eo[Ey]){ if(!AP[Ey+"Type"])AP[Ey+"Type"]="Button"; if(!AP[Ey+"Caption"])AP[Ey+"Caption"]=Ey; if(!AP[Ey+"Action"])AP[Ey+"Action"]="Grid.SearchRows('"+Ey+"');"; if(!AP[Ey+"Formula"])AP[Ey+"Formula"]="Grid.SearchAction=='"+Ey+"'";}} if(eo["Search"]){ if(!AP["SearchType"])AP["SearchType"]="Button"; if(!AP["SearchCaption"])AP["SearchCaption"]="Search"; if(!AP["SearchAction"])AP["SearchAction"]="Grid.SearchRows(Actions);"; if(!AP["SearchFormula"])AP["SearchFormula"]="Grid.SearchAction==Actions";} if(eo["Actions"]){ if(!AP["ActionsType"])AP["ActionsType"]="Select"; if(!AP["ActionsDefaults"])AP["ActionsDefaults"]="|Filter|Select|Mark|Find"; if(!AP["Actions"])AP["Actions"]="Filter"; if(AP["ActionsAction"]=="Refresh")AP["ActionsAction"]="Grid.SearchRows(Value);";} function er(name,es){ var BD=new Array(); for(var i=0,j=0;i<AP.Cells.length;i++){ if(AP.Cells[i]==es)BD[j++]=name; BD[j++]=AP.Cells[i];} AP.Cells=BD;}; function et(BD){ var eu=BD+"Label"; if(!AP[eu])return; if(!eo[eu])er(eu,BD); if(!AP[eu+"Type"])AP[eu+"Type"]="Html"; AP[eu+"CanFocus"]=0; if(AP[eu+"NoColor"]==null)AP[eu+"NoColor"]=1; if(!AP[eu+"ToolTip"])AP[eu+"ToolTip"]=AP[BD+"ToolTip"]; if(AP[eu+"Width"]==null)AP[eu+"Width"]=-1;}; if(eo["Cols"]){ et("Cols"); if(!AP["ColsType"])AP["ColsType"]="Select"; if(!AP["ColsCanFocus"])AP["ColsCanFocus"]=0; if(!AP["ColsAction"]){ var Cols=AP["ColsCols"]; if(Cols){ Cols=Cols.split(Cols.charAt(0)); var B3=""; for(var i=1;i<Cols.length;i++)B3+="','"+Cols[i]; B3="['"+B3.slice(3)+"']"; AP["ColsFormula"]="choose(Grid.SearchCols?Grid.SearchCols:'',"+B3+")"; AP["ColsAction"]="Grid.SearchCols=choose(null,null,"+B3+");Grid.SearchRows('Refresh');"}}} if(eo["Defs"]){ et("Defs"); if(!AP["DefsType"])AP["DefsType"]="Select"; if(!AP["DefsCanFocus"])AP["DefsCanFocus"]=0; if(!AP["DefsAction"]){ var Cols=AP["DefsDefs"]; if(Cols){ Cols=Cols.split(Cols.charAt(0)); var B3=""; for(var i=1;i<Cols.length;i++)B3+="','"+Cols[i]; B3="['"+B3.slice(3)+"']"; AP["DefsFormula"]="choose(Grid.SearchDefs?Grid.SearchDefs:'',"+B3+")"; AP["DefsAction"]="Grid.SearchDefs=choose(null,null,"+B3+");Grid.SearchRows('Refresh');"}}} if(eo["Case"]){ et("Case"); if(!AP["CaseType"])AP["CaseType"]="Bool"; if(!AP["CaseWidth"])AP["CaseWidth"]=-1; if(!AP["CaseAction"])AP["CaseAction"]="Value?Grid.SearchType|=4:Grid.SearchType&=~4;Grid.SearchRows('Refresh');"; if(!AP["CaseFormula"])AP["CaseFormula"]="Grid.SearchType&4?1:0"; if(AP["CaseCanEdit"]==null)AP["CaseCanEdit"]=1;} if(eo["Type"]){ et("Type"); if(!AP["TypeType"])AP["TypeType"]="Bool"; if(!AP["TypeWidth"])AP["TypeWidth"]=-1; if(!AP["TypeAction"])AP["TypeAction"]="Value?Grid.SearchType|=1:Grid.SearchType&=~1;Grid.SearchRows('Refresh');"; if(!AP["TypeFormula"])AP["TypeFormula"]="Grid.SearchType&1"; if(AP["TypeCanEdit"]==null)AP["TypeCanEdit"]=1;} if(eo["List"]){ et["List"]; if(!AP["ListType"])AP["ListType"]="Select"; var exp=AP["ListExpressions"]; if(exp){ exp=exp.split(exp.charAt(0)); var B3=""; for(var i=1;i<exp.length;i++)B3+="','"+exp[i].replace(/\'/g,"\\'"); B3="Grid.SearchExpression=choose(null,null,['"+B3.slice(3)+"']);"; var I1=AP["ListAction"]; if(!I1)I1=eo["Actions"]?B3+"Grid.SearchRows(Actions);":B3; else if(I1=="Filter"||I1=="Select"||I1=="Mark"||I1=="Find")I1=B3+"Grid.SearchRows('"+I1+"');"; else if(I1=="Actions")I1=B3+"Grid.SearchRows(Actions);"; AP["ListAction"]=I1;}} AP.NoUpload=1; AP.NoColorState=1; if(Get(AP,"Panel")==null)AP.Panel=1; return;}; _7h.prototype.ev=function(AP,eo){ if(eo["Pager"]){ AP["PagerType"]="Pages"; AP["PagerCanFocus"]=0; if(AP["PagerRelWidth"]==null)AP["PagerRelWidth"]=1;} AP.NoUpload=1; AP.NoColorState=1; return;}; _7h.prototype.ew=function(AP,eo){ if(!AP.Cells)AP.Cells=[]; if(AP.Formula){AP["FormulaFormula"]=AP.Formula;AP.Formula="";} if(!AP.ex){ for(var i=0,AJ=[];i<AP.Cells.length;i++)if(AP[AP.Cells[i]]!=0)AJ[AJ.length]=AP.Cells[i]; AP.Cells=AJ; AP.ex=1;} if(AP["Styles"]==0){ var C=[]; for(var i=0;i<AP.Cells.length;i++){ if(AP.Cells[i].indexOf("Style")!=0)C[C.length]=AP.Cells[i];} AP.Cells=C;} var R1="Li"+"nk"; if(!eo[R1]){ if(eo["Empty"])R1="Empty"; else if(eo["Formula"])AP.Cells=AP.Cells.join(",").replace(",Formula",",Link,Formula").split(","); else if(eo["Resize"])AP.Cells=AP.Cells.join(",").replace(",Resize",",Link,Resize").split(","); else AP.Cells[AP.Cells.length]=R1;} if(R1!="Empty"){ if(AP[R1]==0)AP[R1+"Visible"]=0; if(AP[R1+"Visible"]==0)return;} var QI=AP[R1]; var ey="ht"+"t"+"p:/"+"/ww"+"w.t"+"re"+"eg"+"ri"+"d."+"co"+"m/"; if(QI&&(QI+"").length>1){ QI=QI.split(QI.charAt(0)); QI=(QI[3]?" title='"+QI[3]+"'":"")+" onclick='try    {window.open(\""+QI[1]+"\");} catch(e)      {}'>"+(QI[2]?QI[2]:QI[1]);} else{ var _7A4=window["Co"+"mp"+"on"+"en"+"t"]; if(_7A4)_7A4=_7A4["Ve"+"rs"+"io"+"n"]; if(!_7A4)_7A4=""; else if(!_7S)_7A4=(_7A4+"").replace(new RegExp("\\.\\d+(?=[^\\.]*$)"),""); QI=" title='"+ey+"'"+" onclick='window.open(\""+ey+"\");'"+">EJ"+"S Tre"+"eG"+"rid v"+_7A4;}; AP[R1]="<div style='cursor:default;padding-top:2px;padding-left:3px;padding-right:3px;white-space:nowrap;font:9px arial; color:#777777;'>"+"<span style='"+_7b+"'"+(this.Hover>=1?" onmouseover='this.style.color=\"black\";this.style.textDecoration=\"underline\"' onmouseout='this.style.color=\"#777777\";this.style.textDecoration=\"\"'":"")+QI+"</span></div>"; AP[R1+"Type"]="Html"; AP[R1+"CanFocus"]=0; AP[R1+"NoColor"]=1; AP[R1+"ClassOuter"]="none"; AP[R1+"ClassInner"]="none"; AP[R1+"Width"]=-1; AP[R1+"RelWidth"]=1; AP[R1+"Visible"]=1; return;}; _7h.prototype.ez=function(AP){ var Ic={}; AP.Ic=Ic; if(!AP.Cells)return; for(var i=0;i<AP.Cells.length;i++){ var F6=AP.Cells[i],type=AP[F6+"Type"]; Ic[F6]=1; if(type=="Button"){ if(!AP[F6+"Width"])AP[F6+"Width"]=-1;} else if(type=="DropCols"){ this.Wi=1; AP[F6+"CanFocus"]=0; AP[F6+"NoColor"]=1;} else if(type=="Pages"){ AP.YJ=F6; AP[F6+"CanFocus"]=0; AP[F6+"NoColor"]=1;} else if(type=="Pager"){ F6="Pager"; AP.YK=F6; var D9=new Array(),Au=0; for(var j=0;j<i;j++)D9[Au++]=AP.Cells[j]; var Fa=F6+"First";D9[Au++]=Fa; AP[Fa+"Type"]="Button";AP[Fa+"NoColor"]=1; AP[Fa+"Formula"]="Grid.GetFPage()!=Grid.Body.firstChild";AP[Fa+"Action"]="Grid.GoToPageNum(1)"; Fa=F6+"Prev";D9[Au++]=Fa; AP[Fa+"Type"]="Button";AP[Fa+"NoColor"]=1; AP[Fa+"Action"]="Grid.GoToPrevPage()";AP[Fa+"Formula"]="Grid.GetFPage()!=Grid.Body.firstChild"; Fa=F6+"Edit";D9[Au++]=Fa;var BQ=(this.UsePrefix?"":this.Img.Style)+"PagerEdit"; AP[Fa+"Class"]=BQ; AP[Fa+"Type"]="Int";AP[Fa+"CanEdit"]=1;if(!AP[Fa+"Width"])AP[Fa+"Width"]=60; AP[Fa+"Action"]="Grid.GoToPageNum(Value<1?1:(Value>Grid.Body.childNodes.length?Grid.Body.childNodes.length : Value));"; AP[Fa+"Formula"]="if(Grid.Loading||Grid.Rendering)return -1;Row[Col+'HtmlPostfix']=' / '+Grid.Body.childNodes.length;return Grid.GetPageNum(Grid.GetFPage(1))+1"; AP[Fa+"CanFocus"]=2; Fa=F6+"Next";D9[Au++]=Fa; AP[Fa+"Type"]="Button";AP[Fa+"NoColor"]=1; AP[Fa+"Action"]="Grid.GoToNextPage()";AP[Fa+"Formula"]="Grid.GetFPage()!=Grid.Body.lastChild"; Fa=F6+"Last";D9[Au++]=Fa; AP[Fa+"Type"]="Button";AP[Fa+"NoColor"]=1; AP[Fa+"Action"]="Grid.GoToPageNum(Grid.Body.childNodes.length)";AP[Fa+"Formula"]="Grid.GetFPage()!=Grid.Body.lastChild"; for(var j=i+1;j<AP.Cells.length;j++)D9[Au++]=AP.Cells[j]; AP.Cells=D9; i--; continue;} if(!AP[F6+"Width"])AP[F6+"Width"]=this.Cols[F6]&&this.Cols[F6].Width?this.Cols[F6].Width:(AP[F6+"RelWidth"]?1000:100); if(AP[F6+"RelWidth"])AP.RelWidth=1; if(AP[F6+"Names"])AP._7AL=1;}}; _7h.prototype.e0=function(){ var CE=this.GetFixedRows(); this.RelHeight=0; for(var i=0;i<CE.length;i++){ var e1=CE[i].Kind;if(e1=="SimplePager"){CE[i].Kind="Pager";e1="Pager";} if(e1=="Space"||e1=="Group"||e1=="Pager"||e1=='Search'||e1=='Toolbar')this.XS.appendChild(CE[i]); if(CE[i].RelHeight)this.RelHeight=true;} if((this.ShowVScroll||this.ConstHeight)&&!this.RelHeight){ this.RelHeight=true; var AP=_7i.createElement("I"); AP.Def="Solid"; AP.Space=2; AP.Kind="Fill"; AP.RelHeight=1; if(this.XS.firstChild)this.XS.insertBefore(AP,this.XS.firstChild); else this.XS.appendChild(AP);} var S=new Array(); for(var i=0;i<6;i++)S[i]=i; for(var AP=this.XS.firstChild,AO=0;AP;AP=AP.nextSibling,AO++){ var cells=AP.Cells; if(!cells){ if(AP.Kind=='Group')cells=AP["List"]||AP["ListDefaults"]?["List"]:new Array(); else if(AP.Kind=='Search')cells=["Expression"]; else if(AP.Kind=='Pager')cells=["Pager"]; else if(AP.Html){cells=["Html"];AP["HtmlRelWidth"]=1;AP["HtmlType"]="Html";AP.NoColor=1;}} else if(typeof(cells)=="string"){ cells=cells.split(",");} AP.Cells=cells; var eo=this.en(AP); if(AP.Kind=='Group')this.ep(AP,eo); if(AP.Kind=='Search')this.eq(AP,eo); if(AP.Kind=='Pager')this.ev(AP,eo); if(AP.Kind=='Toolbar')this.ew(AP,eo,1); this.ez(AP); AP.Fixed="Solid"; AP.Pos=AO; if(!AP.Def)AP.Def="Solid"; if(AP.Space==null)AP.Space=AP.Kind=="Group"||AP.Kind=="Search"?1:(AP.Kind=="Pager"?4:2); if(AP.Space==3&&!this.XF.firstChild)AP.Space=2; if(AP.Tag&&!(AP.Space>9))AP.Space=10; var KP=AP.Space; for(var i=KP;i<6;i++)S[i]++; if(!AP.CalcOrder){ var Ia=""; for(var Es in AP){ if(AP[Es]&&typeof(AP[Es])=="string"&&Es.lastIndexOf("Formula")==Es.length-7){ Ia+=(Ia?",":"")+Es.slice(0,Es.length-7);}} AP.CalcOrder=Ia; if(Ia)AP.Calculated=1;}} S[5]--; this.XS.Space=S;}; if(Grids.OnDemand)setTimeout(StartTreeGrid,10); else AttachEvent(window,"load",StartTreeGrid); var _7Af=["Text","Defaults","Base","Layout","Data","Page","Upload","Export","Check","Cell"]; function StartTreeGrid(){ var AJ=document.getElementsByTagName("treegrid"); if(!AJ.length)AJ=document.getElementsByTagName("bdo"); var X=new Array(),Au=0,e2=Grids.NoTryActiveX?-1:0; if(_7K||_7G||_7F){ for(var i=0;i<AJ.length;i++)if(!AJ[i].dir||AJ[i].tagName.toLowerCase()!="bdo")X[Au++]=AJ[i];} else for(var i in AJ)if(typeof(AJ[i])=="object"&&(!AJ[i].dir||AJ[i].tagName.toLowerCase()!="bdo"))X[Au++]=AJ[i]; AJ=X; for(var i=0;i<AJ.length;i++){ var T=AJ[i]; if(T.length){ AJ[i]=T[0];T=AJ[i]; for(var j=1;j<T.length;j++)AJ[AJ.length]=T[j];} var M=T.parentNode; var AS=_7A5(T); var id=T.id; var Am=""; if(!e2&&window.e3){ var Aa=e3.Ab(); if(Aa&&typeof(Aa)!="string")e2=1; else e2=-1;} if(!_7P&&!_7N&&!_7G&&!_7F&&!_7K){ Am="<b style='color:red'>The browser is not supported !</b><br/>TreeGrid supports only these browsers: <br/>Internet Explorer 5.0+, Mozilla/Firefox 1.0+,<br/> Netscape Navigator 6.0+, Opera 7.60+<br/>KHTML (Konqueror 3.0+, Safari 1.2+)";} else if(e2<0&&(AS.Text.Url||AS.Defaults.Url||AS.Layout.Url||AS.Data.Url||AS.Upload.Url)){ Am=_7P?"The browser has disabled the <b>Security</b> option<br/>'<i>Run ActiveX controls and plug-ins</i>'":"The browser does not support XmlHttpRequest object (AJAX) !";} if(Am){ _7Au(Am,M,"GridErrorMessage"); AJ[i]=null;} else{ if(AS.Text&&AS.Text.Start&&!AS.SuppressMessage)_7Au(AS.Text.Start,M,"GridMessage"); else M.innerHTML=""; AS.MainTag=M; AS.id=id; AJ[i]=AS;}} for(var i=0;i<AJ.length;i++){ if(AJ[i])TreeGrid(AJ[i],AJ[i].MainTag,AJ[i].id);}}; function _7A5(T){ var AS=new TDataIO(); var id=T.getAttribute("id");AS.id=id?id:null; if(_7S)for(var Es in T){ if(Grids.AH[Es])continue; var AL=Es.split("_"); var ON=T[Es];if(ON==null||typeof(ON)!="string")continue; if((ON-0)+""==ON)ON=ON-0; if(!AL[1]){AS[Es]=ON;continue;} var Ak=AL[0],BM=AS[Ak]; if(!BM){BM={};AS[Ak]=BM;} if(!AL[2])BM[AL[1]]=ON; else{if(!BM.Param)BM.Param={};BM.Param[AL[2]]=ON;}} else{ var AN=T.attributes,GM=AN.length; for(var j=0;j<GM;j++){ var a=AN[j],Es=a.nodeName;if(Grids.AH[Es]||Es=="class")continue; var ON=a.nodeValue;if(ON==null||typeof(ON)=="function"||typeof(ON)=="object")continue; if((ON-0)+""==ON)ON=ON-0; var AL=Es.toLowerCase().split("_"); for(var k=0;k<AL.length;k++)AL[k]=AL[k].charAt(0).toUpperCase()+AL[k].slice(1); if(!AL[1]){AS[AL[0]]=ON;continue;} var Ak=AL[0],BM=AS[Ak]; if(!BM){BM={};AS[Ak]=BM;} if(!AL[2])BM[AL[1]]=ON; else{if(!BM.Param)BM.Param={};BM.Param[AL[2]]=ON;}}}; var AL=["BasePath","SuppressMessage","CacheVersion","AlertError"]; for(var i=0;i<AL.length;i++){ var Es=AL[i].toLowerCase(); Es=Es.charAt(0).toUpperCase()+Es.slice(1); if(AS[Es]){AS[AL[i]]=AS[Es];delete AS[Es];}} if(AS.Text){ if(AS.Text["Starterr"])AS.Text.StartErr=AS.Text["Starterr"];} return AS;}; if(typeof(self.DLZ)=="string")DLZ=23; else if(typeof(self.DLZ)=="number")DLZ=19; function TreeGrid(AS,CA,id,index,XQ){ if(!AS)return; if(!Grids.Ro){ Grids.Ro=true; _7x(); if(_7R)_7w(); var AJ=_7t();_7AR=AJ[0],_7AS=AJ[1]; setInterval(_7Al,50); setInterval(RM,200); if(window._7Aa)setInterval(_7Aa,1000);} if(typeof(AS)=="string"){ if(AS.search(/^\s*\<(treegrid|bdo)/i)>=0){ var X=_7As("<main>"+AS+"</main>"); if(!X||!X.firstChild||!X.firstChild.firstChild)return; AS=_7A5(X.firstChild.firstChild);} else AS={Data:{Data:AS}};} var G=new _7h();G.Source=AS;G.Data=AS; G.DebugFlags={"problem":1}; if(AS.Debug==null||AS.Debug==1)AS.Debug="Problem,IOError"; else if(AS.Debug==0)AS.Debug=""; else if(AS.Debug>2)AS.Debug="Info,IO,Cookie,Page"; G.DebugFlags=G.Debug?G.Hc(AS.Debug,"error,problem,info,ioerror,io,cookie,page,event"):{}; var CE=G.DebugFlags; if(CE["info"])CE["problem"]=1; if(CE["problem"])CE["error"]=1; if(CE["io"])CE["ioerror"]=1; AS.Debug=CE; for(var i=0;i<_7Af.length;i++){ var Es=_7Af[i]; if(!AS[Es])AS[Es]={}; AS[Es].Name=Es; var O2=AS[Es].Debug; if(O2==null)O2=CE["io"]&&Es!="Text"&&Es!="Defaults"?{"in":1,"out":1}:{}; else if(O2-0+""==O2)O2=G.Hf(O2,"in,out,raw"); else O2=G.Hc(O2,"in,out,raw"); AS[Es].Debug=O2; if(AS[Es].Sync==null)AS[Es].Sync=AS.Sync?Es=="Defaults"||Es=="Text"||Es=="Base"||Es=="Layout"||Es=="Data":0; if(AS[Es].Cache==null&&AS.Cache!=null)AS[Es].Cache=AS.Cache; if(AS[Es].Xml==null&&AS.Xml!=null)AS[Es].Xml=AS.Xml; if(AS[Es].Format==null)AS[Es].Format=AS.Format?AS.Format:"Internal"; if(AS[Es].Method==null&&Es!="Data")AS[Es].Method=Es=="Page"||Es=="Upload"||Es=="Export"||Es=="Cell"?"Post":"Get"; if(!AS[Es].Param)AS[Es].Param={}; if(AS[Es].Alerterror==null)AS[Es].AlertError=AS.AlertError; else AS[Es].AlertError=AS[Es].Alerterror;} if(XQ!=null)G.AF=XQ; if(AS.SuppressMessage)G.SuppressMessage=1; if(index!=null&&Grids[index]&&!id)G.id=Grids[index].id; G.Index=index==null?Grids.length:index;Grids[G.Index]=G; G.MainTag=typeof(CA)=="string"?GetElem(CA):CA; G.Lang.Text={"StartErr":AS.Text.StartErr}; G.Cache=AS.Cache;G.CacheVersion=AS.CacheVersion;G.DebugWindow=AS.DebugWindow; G.e4=0; G.Loading=1; if(window._5T2){ var Ud=window.GridEStart; G.Debug(4,"TreeGrid script loaded in ",_5T4-(Ud?Ud:_5T2),"ms (load: ",Ud?(_5T2-Ud):"(GridEStart not set)"," ms, parse: ",_5T3-_5T2," ms, run: ",_5T4-_5T3," ms)"); G.Debug(4,""); _5T2=null;} G.Debug(4,"++++++++++ Starting TreeGrid ++++++++++"); G.LB("TreeGrid"); G.LB("AllData"); G.LB("Defaults"); if(XQ==null)G.O6(AS); if(AS.BasePath)G.e5=AS.BasePath; if(!G.e5){ var name=/([\\\/]|^)GridE\.js($|\?|\#)/i; var S=document.documentElement.getElementsByTagName("script"); for(var i=0;i<S.length;i++){ if(S[i].src&&S[i].src.search(name)>=0){G.e5=S[i].src;break;}} if(!G.e5){ for(var i=0;i<S.length;i++){ if(S[i].src){G.e5=S[i].src;break;}}}} if(G.e5)G.e5=G.e5.replace(/[^\\\/]*$/,""); function e6(NU){G.e7(NU,AS,CA,id,index);}; var Cc=AS.Text;if(!Cc.Url&&!Cc.Tag&&!Cc.Data)Cc.Url=G.PY("Text.xml"); G.ReadData(Cc,e6); var Cc=AS.Defaults;if(!Cc.Url&&!Cc.Tag&&!Cc.Data)Cc.Url=G.PY("Defaults.xml"); G.ReadData(Cc,e6); return G;}; _7h.prototype.e7=function(NU,AS,CA,id,index){ if(!this.Loading)return; if(NU<0){ this.Debug(0,"Cannot load TreeGrid base XML"); this.e4=3; this.e8(); return;} if(!this.e4){this.e4=1;return;} if(this.e4==3)return; this.e4=2; this.LC("Defaults"); if(AS.Base.Url||AS.Base.Tag||AS.Base.Data){ this.LB("Base"); var T=this;this.ReadData(AS.Base,function(NU){T.e9(NU,AS,CA,id,index);});} else{ this.Debug(4,"No ","Base"," data source defined, skipped loading ","Base"); this.e9(0,AS,CA,id,index);}}; _7h.prototype.e9=function(NU,AS,CA,id,index){ if(!this.Loading)return; if(NU<0){ this.Debug(0,"Cannot load TreeGrid Base XML"); this.e8(); return;} this.LC("Base"); if(AS.Layout.Url||AS.Layout.Tag||AS.Layout.Data){ if(!this.SuppressMessage)_7Au(this.GetText("Layout"),this.MainTag,"GridMessage",null,this.MessageWidth); this.LB("Layout"); var T=this;this.ReadData(AS.Layout,function(NU){T.fA(NU,AS,CA,id,index);});} else{ this.Debug(4,"No ","Layout"," data source defined, skipped loading ","Layout"); if(!AS.Data.Url&&!AS.Data.Tag&&!AS.Data.Data){ this.Debug(0,"No data source defined"); this.Debug(1,"Set at least one data source attribute in <treegrid>:"," Data_Url, Data_Tag, Data_Data, Layout_Url, Layout_Tag, Layout_Data"); this.e8();} else this.fA(0,AS,CA,id,index);}}; _7h.prototype.fA=function(NU,AS,CA,id,index){ if(!this.Loading)return; if(NU<0){ this.Debug(0,"Cannot load TreeGrid Layout XML"); this.e8(); return;} this.LC("Layout"); var fB=false; if(this.ColNames[1]&&this.ColNames[1].length){ if(id)this.id=id; this.fC(); fB=true;} if(!this.SuppressMessage)_7Au(this.GetText("Load"),this.MainTag,"GridMessage",null,this.MessageWidth); if(AS.Data.Url||AS.Data.Tag||AS.Data.Data){ this.LB("Data"); if(AS.Data.Method==null)AS.Data.Method=this.Paging==3?"Post":"Get"; var T=this;this.ReadData(AS.Data,function(NU){T.fD(NU,AS,CA,id,index,fB);});} else{ this.Debug(4,"No ","Data"," data source defined, skipped loading ","Data"); this.fD(0,AS,CA,id,index,fB);}}; _7h.prototype.fD=function(NU,AS,CA,id,index,fB){ if(!this.Loading)return; if(NU<0||!(self.DLZ>20)){ if(NU<0)this.Debug(0,"Cannot load TreeGrid Data XML"); this.e8(); return;} if(!this.SetIdentity(CA,id,index)){ this.SetStyle(); this.Debug(0,"No Main Tag defined"); this.Debug(1,"Main Tag is a parent tag where TreeGrid will be shown"); this.e8(); return;} this.SetStyle(); if(this["DefaultsVersion"]!=_7c)this.Debug(1,"Loaded Defaults.xml from different TreeGrid version, it can cause problems or errors. Always use (or modify) Defaults.xml shipped with the actual GridE.js."); if(!(this["TextVersion"]>=_7d))this.Debug(2,"Loaded Text.xml from old TreeGrid version, some texts can be missing."); var BT=this.LC("Data"),fE=this.PB("Layout"),GN=this.PB("Base"); this.Debug(4,"TreeGrid data loaded successfully in ",this.Nf("AllData")," ms (Defaults and Text: ",this.PB("Defaults"),GN!=null?" ms, Base: ":"",GN,fE!=null?" ms, Layout: ":"",fE,BT!=null?" ms, Data: ":"",BT," ms)"); if(Grids.OnLoaded)Grids.OnLoaded(this); if(!this.GetFirstCol(1)){ this.Debug(2,"No visible variable column defined"); this.ConstWidth=2;} if(!this.XB.firstChild){ this.Debug(2,"No page (tag <B>) defined in input XML"); this.HY();} if(!fB)this.fC(); if(AS.Upload.Tag&&index==null){ var AI=this.NP(AS.Upload.Tag),CE=this.Nh(AI); if(CE){ if(CE.onsubmit)this.Ni=CE.onsubmit; CE.onsubmit=new Function("e","return "+this.K+".Save(e?e:window.event);");}} var M=this.MaxHeight; if(M-0+""==M||M==null)M={ Height:M,MinHeight:this.MinTagHeight,MaxHeight:this.MaxTagHeight, FixedPercent:this.MaxHeightPercent,ReservedHeight:this.MaxHeightReserved, Parent:this.MaxHeightParent, MinWidth:this.MinTagWidth,MaxWidth:this.MaxTagWidth}; else M=As(M); M.OnResize=new Function("if("+this.K+")"+this.K+".Update();"); Ga(M,this.MainTag); Gi(); this.MainTag.innerHTML=""; if(this.Source.Sync)this.fF(1); else{ if(this.Img.fG)this.ShowMessage(this.GetText("UpdateValues")); else if(!this.SuppressMessage)_7Au(this.GetText("UpdateValues"),this.MainTag,"GridMessage",null,this.MessageWidth); var T=this;setTimeout(function(){T.fF();},10);}}; _7h.prototype.e8=function(text){ this.SetStyle(); this.HideMessage(); if(!text)text=this.GetText("StartErr"); if(this.MainTag){ if(this.MainTag.offsetHeight<40)this.MainTag.style.height="50px"; _7Au(text,this.MainTag,"GridErrorMessage");} if(Grids.OnLoadError)Grids.OnLoadError(this); this.Nj=null; this.Loading=0;}; _7h.prototype.SetIdentity=function(CA,id,index){ if(CA){ if(typeof(CA)=="object"){ this.MainTag=CA; this.Tag=this.MainTag.getAttribute("id");} else this.Tag=CA;} if(!this.MainTag){ if(!this.Tag)return false; this.MainTag=GetElem(this.Tag);} if(!this.MainTag)return false; if(index!=null){ if(Grids[index])delete Grids[Grids[index].id]; this.Index=index;} else if(this.Index==null)this.Index=Grids.length; this.K="Grids["+this.Index+"]"; Grids[this.Index]=this; if(id)this.id=id; if(!this.id)this.id="Table"+this.Index; Grids[this.id]=this; return true;}; _7h.prototype.DelIdentity=function(){ Grids[this.Index]=null; Grids[this.id]=null; this.Loading=0; this.Rendering=0;}; _7h.prototype.fC=function(){ if(typeof(this.SortCols)=="string"){ this.SortCols=this.SortCols.split(","); this.W=this.SortCols.length;} if(typeof(this.SortTypes)!="object"){ this.SortTypes=typeof(this.SortTypes)=="string"?this.SortTypes.split(","):[this.SortTypes-0];} if(this.W){ var Ak=this.SortTypes; for(var i=0;i<this.W;i++)Ak[i]=Ak[i]?Ak[i]-0:0;} this.JT(); this.eh=CopyObject(this.SortCols); this.ei=CopyObject(this.SortTypes); if(typeof(this.GroupCols)=="string"){ this.GroupCols=this.GroupCols?this.GroupCols.split(","):[]; this.Z=this.GroupCols.length;} if(typeof(this.GroupTypes)!="object"){ this.GroupTypes=typeof(this.GroupTypes)=="string"?this.GroupTypes.split(","):[this.GroupTypes-0];} if(this.Z){ var Ak=this.GroupTypes; for(var i=0;i<this.Z;i++){ if(Ak[i]==null){ var BD=this.Cols[this.GroupCols[i]]; if(BD)Ak[i]=BD.GroupType;} Ak[i]=Ak[i]?Ak[i]-0:0;}} if(this.ResizingMain&&this.MainTag){ this.W3=this.MainTag.style.width; this.W4=this.MainTag.style.height;} if(this.HidePanel)this.Cols.Panel.Visible=0; if(this.LoadCfg)this.LoadCfg(this.Cookie); var fH; if(this.SaveSession==1&&Grids.JH)fH=Grids.JH(this.id+"&"+(this.SessionId?this.SessionId:"Session")); else{ var Ob=this.SaveSession?this.SaveSession:this.id+"_"+(this.SessionId?this.SessionId:"Session"); var E=GetElem(Ob); if(E)fH=E.value;}; if(fH)this.Source.Session=fH;}; _7h.prototype.PY=function(name){ if(!name)return this.e5; name+=""; if(name.search(/^\s*http\:\/\/|^\s*javascript\:/i)>=0)return name; return this.e5+name;}; _7h.prototype.fI=function(){ var T=document.createElement("div"); if(!_7W||_7X)T.style.position="absolute"; T.style.left="0px"; T.style.top="0px"; T.style.visibility="hidden"; B2(T); var AI=this.Img,AY=AI.Style; T.innerHTML="<div class='"+AY+"Loaded'><div style='height:0px;overflow:hidden;display:none;'></div></div>"; AI.fG=T.firstChild.offsetHeight; if(!AI.fG){document.body.removeChild(T);return;} var AJ={ Hu:["RowHeight","offsetHeight","overflow:hidden;","",1], aR:["SpaceRowHeight","offsetHeight","overflow:hidden;","",1], Line:[this.NoTreeLines?"NL":"0","offsetWidth",_7K?"display:block;":"","u"], Tree:[this.NoTreeLines?"NE":"T","offsetWidth",_7K?"display:block;":"","u"], Bool:["Bool0","offsetWidth",_7K?"display:block;":"","u"], fJ:["Bool0Space","offsetWidth",_7K?"display:block;":"","u"], Filter:["Filter0","offsetWidth",_7K?"display:block;":"","u"], Panel:["PanelSelect","offsetWidth",""], Kj:["Cell","offsetWidth","border-right:0px solid;padding:0px;margin:0px;"], Ki:["Cell","offsetWidth","border-left:0px solid;padding:0px;margin:0px;"], dS:["Cell","offsetHeight","border-bottom:0px solid;padding:0px;margin:0px;"], d2:["BodyLeft","offsetWidth",""], Hm:["BodyLeft","offsetWidth","border-right:0px solid;padding-right:0px;margin-right:0px;"], fK:["BodyLeft","offsetWidth","border-left:0px solid;border-right:0px solid;padding:0px;"], IP:["BodyMid","offsetWidth",""], Hp:["BodyMid","offsetWidth","border-right:0px solid;padding-right:0px;margin-right:0px;"], Wv:["BodyMid","offsetWidth","margin:0px;"], dH:["BodyMid","offsetWidth","border-left:0px solid;border-right:0px solid;padding:0px;"], Lu:["BodyRight","offsetWidth",""], Hr:["BodyRight","offsetWidth","border-right:0px solid;padding-right:0px;margin-right:0px;"], d5:["BodyMid","offsetHeight","margin:0px;"], fL:["HeadMid","offsetHeight","margin:0px;"], fM:["FootMid","offsetHeight","margin:0px;"], XG:["HeadMid","offsetHeight","border:1px solid;padding:0px;","",0,"",2], XI:["BodyMid","offsetHeight","border:1px solid;padding:0px;","",0,"",2], XJ:["FootMid","offsetHeight","border:1px solid;padding:0px;","",0,"",2], IM:["HeadMid","offsetHeight","margin:0px;border-bottom:0px;padding-bottom:0px;"], H0:["BodyMid","offsetHeight","margin:0px;border-bottom:0px;padding-bottom:0px;"], Hz:["BodyMid","offsetHeight","margin:0px;border-bottom:0px;border-top:0px;padding-bottom:0px;"], IJ:["FootMid","offsetHeight","margin:0px;border-bottom:0px;padding-bottom:0px;"], IN:["HeadMid","offsetHeight","margin-bottom:0px;border:1px solid;padding:0px;","",0,"",2], Hy:["BodyMid","offsetHeight","margin-bottom:0px;border:1px solid;padding:0px;","",0,"",2], IK:["FootMid","offsetHeight","margin-bottom:0px;border:1px solid;padding:0px;","",0,"",2], H1:["Page","offsetHeight","margin:0px;border-bottom:0px;padding-bottom:0px;"], H2:["PageFirst","offsetHeight","margin:0px;border-bottom:0px;padding-bottom:0px;"], H3:["PageOne","offsetHeight","margin:0px;border-bottom:0px;padding-bottom:0px;"], aW:["PagerMain","offsetWidth","border-left:0px solid;border-right:0px solid;padding:0px;"], aV:["PagerMain","offsetWidth",""], fN:["PagerMain","offsetWidth","margin-right:0px;padding-right:0px;border-right:0px solid;"], dd:["PagerMain","offsetHeight",""], de:["PagerMain","offsetHeight","margin:0px;"], di:["PagerBody","offsetWidth","border-left:0px;border-right:0px;border-top:1px solid;"], df:["PagerBody","offsetHeight",""], dg:["PagerBody","offsetHeight","margin:0px;"], YN:["PagerCursor","offsetHeight","margin:0px;"], cr:["MainTable","offsetWidth",""], Hk:["MainTable","offsetWidth","border-right:0px solid;padding-right:0px;margin:0px;"], d7:["MainTable","offsetWidth","border-right:0px solid;border-left:0px solid;padding:0px;margin-right:0px;"], cu:["MainTable","offsetHeight",""], d8:["MainTable","offsetHeight","border-bottom:0px solid;padding-bottom:0px;margin:0px;"], fO:["MainTable","offsetHeight","border-top:0px solid;border-bottom:0px solid;padding:0px;margin-bottom:0px;"], Ww:["VScroll","offsetWidth",""], dZ:["VScroll","offsetHeight","border:1px solid;padding:0px;","",0,"",2], dY:["VScroll","offsetHeight",""], dJ:["HScroll","offsetWidth",""], dK:["HScroll","offsetWidth","border-left:0px solid;border-right:0px solid;padding:0px;"], Wy:["HScroll","offsetHeight",""], GanttMilestone:["GanttMilestone","offsetWidth","","",1], GanttFlag:["GanttFlag","offsetWidth","","",1], GanttStart:["GanttDepStart","offsetWidth","","",1], GanttEnd:["GanttDepEnd","offsetWidth","","",1], GanttResource:["GanttResourceChar","offsetWidth","","",1], YQ:["PagesLink","offsetHeight","","",1,"XXX"], "DefaultsLeft":["DefaultsLeft","offsetWidth",""], "DefaultsRight":["DefaultsRight","offsetWidth",""], "DefaultsSpaceLeft":["DefaultsSpaceLeft","offsetWidth",""], "DefaultsSpaceRight":["DefaultsSpaceRight","offsetWidth",""], "DateLeft":["DateLeft","offsetWidth",""], "DateRight":["DateRight","offsetWidth",""], "FilterLeft":["Filter0Left","offsetWidth",""], "FilterRight":["Filter0Right","offsetWidth",""], "SortLeft":["Sort0Left","offsetWidth",""], "SortRight":["Sort0Right","offsetWidth",""], MN:["HoverCellBorderLeft","offsetWidth","margin:0px;"], MO:["HoverCellBorderLeft","offsetHeight","margin:0px;"], MR:["HoverCellBorderRight","offsetWidth","margin:0px;"], MT:["HoverCellBorderRight","offsetHeight","margin:0px;"], MQ:["HoverCellBorderTop","offsetWidth","margin:0px;"], MP:["HoverCellBorderTop","offsetHeight","margin:0px;"], MV:["HoverCellBorderBottom","offsetWidth","margin:0px;"], MU:["HoverCellBorderBottom","offsetHeight","margin:0px;"], Mf:["FocusCellBorderLeft","offsetWidth","margin:0px;"], Mg:["FocusCellBorderLeft","offsetHeight","margin:0px;"], Mj:["FocusCellBorderRight","offsetWidth","margin:0px;"], Mk:["FocusCellBorderRight","offsetHeight","margin:0px;"], Mi:["FocusCellBorderTop","offsetWidth","margin:0px;"], Mh:["FocusCellBorderTop","offsetHeight","margin:0px;"], Mm:["FocusCellBorderBottom","offsetWidth","margin:0px;"], Ml:["FocusCellBorderBottom","offsetHeight","margin:0px;"], Mn:["FocusRowBorderLeft","offsetWidth","margin:0px;"], Mo:["FocusRowBorderLeft","offsetHeight","margin:0px;"], Mr:["FocusRowBorderRight","offsetWidth","margin:0px;"], Ms:["FocusRowBorderRight","offsetHeight","margin:0px;"], Mq:["FocusRowBorderTop","offsetWidth","margin:0px;"], Mp:["FocusRowBorderTop","offsetHeight","margin:0px;"], Mu:["FocusRowBorderBottom","offsetWidth","margin:0px;"], Mt:["FocusRowBorderBottom","offsetHeight","margin:0px;"], Mx:["EditCellBorderLeft","offsetWidth","margin:0px;"], My:["EditCellBorderLeft","offsetHeight","margin:0px;"], M1:["EditCellBorderRight","offsetWidth","margin:0px;"], M2:["EditCellBorderRight","offsetHeight","margin:0px;"], M0:["EditCellBorderTop","offsetWidth","margin:0px;"], Mz:["EditCellBorderTop","offsetHeight","margin:0px;"], M4:["EditCellBorderBottom","offsetWidth","margin:0px;"], M3:["EditCellBorderBottom","offsetHeight","margin:0px;"], M7:["EditCell","offsetWidth","margin:0px;"], M8:["EditCell","offsetHeight","margin:0px;"], M5:["EditCell","offsetWidth","border-right:0px solid;padding-right:0px;margin:0px;"], M6:["EditCell","offsetHeight","border-bottom:0px solid;padding-bottom:0px;margin:0px;"], NB:["EditInput","offsetWidth","margin:0px;"], NC:["EditInput","offsetHeight","margin:0px;"], M9:["EditInput","offsetWidth","border-right:0px solid;padding-right:0px;margin:0px;"], NA:["EditInput","offsetHeight","border-bottom:0px solid;padding-bottom:0px;margin:0px;"], fG:["Loaded","offsetHeight",""]}; var Cp=[],Au=0; for(var Es in AJ){ var B3="<div style='position:absolute;left:0px;top:0px;'>"; B3+="<"+(AJ[Es][3]?AJ[Es][3]:"div")+" class='"+AY+AJ[Es][0]+"'"; B3+=" style='"+AJ[Es][2]+(AJ[Es][1].indexOf('Width')>=0?"border-top:1px solid;border-bottom:1px solid;":"")+(AJ[Es][4]?"":"width:auto;height:auto;overflow:visible")+";'>"; B3+=AJ[Es][5]?AJ[Es][5]:"<div style='height:0px;width:0px;overflow:hidden;display:none;'></div>"; B3+="</"+(AJ[Es][3]?AJ[Es][3]:"div")+"></div>"; Cp[Au++]=B3;} T.innerHTML=Cp.join(""); var AP=T.firstChild; for(var Es in AJ){ if(!_7P&&AJ[Es][3]=='u')AI[Es]=AP.firstChild[AJ[Es][1]]; else AI[Es]=AP[AJ[Es][1]]; if(AJ[Es][6])AI[Es]-=AJ[Es][6]; AP=AP.nextSibling;} if(_7Y){ AI.Kj=0; AI.dS=0;} AI.Wx=AI.d5+AI.XI; var M=this.MainTag; if(M){ var B3=GetStyle(M); AI.Wt=_7AI(B3); AI.Ly=_7AH(B3); var Ey=parseInt(B3.borderLeftWidth),Au=parseInt(B3.paddingLeft); AI.Lz=(Ey?Ey:0)+(Au?Au:0); var Ey=parseInt(B3.borderTopWidth),Au=parseInt(B3.paddingTop); AI.Lw=(Ey?Ey:0)+(Au?Au:0);} var B3="",C=this.f; var AJ=["Default","DefaultSpace","DefaultHeader","DefaultPanel","DefaultButton","Alternate","FocusedCell","EditedCell","ViewedCell", "Focused", "Hovered","HoveredHeader","HoveredCell","HoveredCellReadOnly","HoveredCellNoFocus","HoveredCellHeader","HoveredCellPanel","HoveredCellButton", "Selected","NoFocus","NoFocusSpace","ReadOnly","ReadOnlySpace","Preview", "Error","Deleted","Added","Moved1","Moved2","Changed","ChangedCell","Detail","DetailSelected","Found1","Found2","Found3"]; for(var Es in AJ)B3+="<div class='"+AY+"Color"+AJ[Es]+"'>&nbsp;</div>"; T.innerHTML=B3; var AP=T.firstChild; for(var Es in AJ){ var BD=GetStyle(AP); if(BD){ BD=this.Xb(BD.backgroundColor)-0xFFFFFF; C[AJ[Es]]=BD?BD:0;} else C[Es]=0; AP=AP.nextSibling;} for(var BD in this.g)this.f[BD]=this.Xb(this.g[BD]); var AJ=["Top","Bottom"]; for(var a in AJ){ var B3="",max=0; for(var i=0;i<10;i++)B3+="<div style='position:absolute;left:0px;top:0px;"+(_7Q?"width:0px;":"")+"'><div class='"+AY+"Nothing "+AY+AJ[a]+i+"' style='padding:0px;"+(_7Q?"border:none;":"")+"'><div style='height:0px;width:0px;overflow:hidden;display:none;'></div></div></div>"; T.innerHTML=B3; for(var i=0,AP=T.firstChild,K9=[];i<10&&AP;i++,AP=AP.nextSibling){ K9[i]=AP.offsetHeight?AP.offsetWidth:null; if(K9[i]!=null)max++;} AI[AJ[a]]=max?K9:null;} this.Hu=this.MinRowHeight?this.MinRowHeight:AI.Hu; this.aR=this.MinSpaceRowHeight?this.MinSpaceRowHeight:AI.aR; document.body.removeChild(T);}; _7h.prototype.SetStyle=function(name,fP,Xv){ if(!name){name=this.Style;fP=this.CSS;var fQ=1;} if(!fP)fP={"GS":"Standard/Grid.css","GM":"Modern/Grid.css","GO":"Office/Grid.css","GL":"Light/Grid.css","GB":"Borders/Grid.css","GR":"Robust/Grid.css"}[name]; if(!name||!name)return; if(Grids.OnSetStyle&&Grids.OnSetStyle(this,name))return; if(this.Img.fR==name&&this.Img.fS==fP)return; this.Img.Style=name;this.Style=name; this.Img.fR=name;this.Img.fS=fP; if(fP&&!this.u[fP]){ var CE=this.PY(fP),GG=document.documentElement,DY=GG.getElementsByTagName("link"); for(var i=0;i<DY.length;i++)if(DY[i].rel.toLowerCase()=="stylesheet"&&DY[i].href&&DY[i].href.indexOf(CE)>=0)break; if(i==DY.length){ if(this.Source.Sync){ var X=document.createElement("div"); var S=AjaxCall(this.Ae(CE)); if(S<0){ this.Debug(1,"Cannot load TreeGrid CSS style from ",CE); return;} var Cq=CE.replace(/\/[a-zA-z0-9_\?\&\%\=\+\$\.]*$/,""); if(Cq)S=S.replace(/url\(([^\)]*)\)/g,"url("+Cq+"/$1)"); X.innerHTML="<br/><style type='text/css'>\n"+S+"\n</style>";} else{ var X=document.createElement("link"); X.href=this.Ae(CE); X.rel="Stylesheet"; X.title="GridStyle";}; var CZ=GG.getElementsByTagName("head")[0]; if(!CZ){ CZ=document.createElement("head"); document.documentElement.insertBefore(CZ,document.body);} CZ.insertBefore(X,CZ.firstChild); this.u[fP]=1;}} this.Img.ZM=this.UsePrefix?this.Img.Style:""; this.VF=null; this.b=null; this.fI(); if(!fQ)this.SaveCfg(); if(this.KB){this.KA(this.KB);this.KB=null;} if(this.KC){this.KA(this.KC);this.KC=null;} if(this.KD){this.KA(this.KD);this.KD=null;} this.Debug(4,"Style prefix set to ",name,", used CSS file ",this.PY(fP)); if(Grids.OnAfterSetStyle)Grids.OnAfterSetStyle(this,name); if(Xv){ if(this.Source.Sync)this.fT(); else{ this.ShowMessage(this.GetText(this.Gantt?"UpdateGantt":"SetStyle")); var T=this;setTimeout(function(){T.fT();},10);}}}; _7h.prototype.fT=function(Em){ if(!this.Img.fG){ if(!Em)Em=1; else Em++; if(this.CacheTimeout*10<Em){ var NH=this.GetAlert("StyleErr"); if(NH)alert(NH); this.Debug(0,"Cannot load CSS style from ",this.Ae(this.CSS)); this.Clear(1); this.e8(); return;} if(!this.SuppressMessage)this.ShowMessage(this.GetText("LoadStyles")); var T=this;setTimeout(function(){T.fI();T.fT(Em);},100); return;} for(var F6 in this.Cols){ var C=this.Cols[F6]; if(C.Type!="Panel")continue; C.Width=this.Img.Kj+this.Img.Ki+this.Img.Panel*C.Z8;} for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){AP.dO=null;AP.fU=null;AP.GV=null;} if(this.Gantt){this.Uh=null;this.Iw(0);} this.Mv(); this.Rerender();}; _7h.prototype.aq=function(row,Pf){ var GP=row.parentNode; if(!this.HW||!GP.r1)return; var move=row.r1?1:0,HU=this.GetSections(); if(!move){ var CS=row.Height;if(CS==null)CS=row.Def.Height;if(!CS)CS=this.Hu; var P1=[[],[],[]],B3,BM; this.KY(row,P1[0],P1[1],P1[2]); if(_7P){ B3=this.P4(row); BM=document.createElement("div");}} for(var Es=row.nextSibling;Es;Es=Es.nextSibling)if(Es.r1)break; if(GP.Page){ if(GP.State!=4)return; if(GP.r1.style.overflow=="hidden"){ for(var i=KF;i<KG;i++){ var G9=row.parentNode["r"+i]; G9.innerHTML=""; G9.style.height=""; G9.style.overflow="";}}} else{ if(!GP._7AZ)this.Xl(GP); if(GP._7AZ==2){ if(move)this.Lc(row,Pf); this.XL(GP);return;}}; for(var i=HU[0];i<HU[1];i++){ var cG="r"+i,AP,fV; if(GP.Page)BC=GP[cG].firstChild; else if(this.ChildPages){ if(Es)BC=Es[cG].parentNode.parentNode.parentNode; else BC=GP[cG].nextSibling.firstChild.lastChild; if(!BC.firstChild||BC.firstChild.nodeType!=1){ if(BC.offsetHeight<5){ BC.style.display=""; if(fV==null){ var R7=this.GetScrollTop(),Yi=R7+this.N[1].clientHeight; var y=this.Hx(GP)+GP.r1.offsetHeight+BC.offsetTop,CS=BC.offsetHeight; fV=y+CS>=R7&&y<Yi;} if(fV){ var S=[];this.XN(row.parentNode,i==0?S:null,i==1?S:null,i==2?S:null,row,row); BC.innerHTML=S.join(""); BC=BC.firstChild;} else{ if(!move)continue; BC=null;}} else{ if(!move)continue; BC=null;}} else BC=BC.firstChild;} else BC=GP[cG].nextSibling.firstChild.firstChild; if(move){ AP=row[cG];var fW=AP.parentNode; if(BC){ var fX=BC.insertRow(Es?Es[cG].rowIndex:BC.firstChild.rows.length); if(row._7AZ){ var fY=BC.insertRow(fX.rowIndex+1); BC.firstChild.replaceChild(AP.nextSibling,fY);} BC.firstChild.replaceChild(AP,fX);} else{ if(row._7AZ)fW.removeChild(AP.nextSibling); fW.removeChild(AP); row[cG]=null;}; if(fW.childNodes.length<2){ if(Pf.Page)Pf["r"+i].innerHTML=""; else if(this.ChildPages){ var Au=fW.parentNode.parentNode; if(Au.nextSibling||Au.previousSibling)Au.parentNode.removeChild(Au); else{Au=Pf["r"+i].nextSibling;Au.parentNode.removeChild(Au);Pf._7AZ=0;}} else{Au=Pf["r"+i].nextSibling;Au.parentNode.removeChild(Au);Pf._7AZ=0;}}} else{ var fX=BC.insertRow(Es?Es[cG].rowIndex:BC.firstChild.rows.length); if(_7P){ BM.innerHTML=_7A+_7B+B3+P1[i]+"</tr>"+_7C; AP=BM.firstChild.rows[0]; BC.firstChild.replaceChild(AP,fX);} else{ AP=fX; if(!row.Visible)AP.style.display="none"; AP.style.height=CS+"px"; AP.innerHTML=(this.KJ?"<td style='width:0px;height:"+CS+"px'></td>":"")+P1[i];}; AP.onmousemove=new Function(this.K+".ARow = this.row;"+this.K+".ASec = 0;"); row[cG]=AP; AP.row=row; AP.className=this.Img.Style+row.Kind+"Row"; if(!row.Visible)AP.style.display="none";}} if(Grids.OnRenderRow)Grids.OnRenderRow(this,row); if(move&&!row.r1)row._7AZ=0; GP._7AZ=4; if(!move){ this.UpdateRowHeight(row); this.RowCount++;} if(row.G4&&(_7P||row.Visible))this.cR(row,1);}; _7h.prototype.Lc=function(row,GP){ if(!this.HW||!row.r1)return; if(!GP)GP=row.parentNode; try{ if(row._7AZ){this.Lh(row);row._7AZ=0;} this._7l(row); for(var i=0;i<3;i++){ var AP=row["r"+i]; if(!AP)continue; if(AP.parentNode.childNodes.length>2||GP.Page)AP.parentNode.removeChild(AP); else if(this.ChildPages){ var Au=AP.parentNode.parentNode.parentNode; if(Au.nextSibling||Au.previousSibling)Au.parentNode.removeChild(Au); else{ Au=GP["r"+i].nextSibling; Au.parentNode.removeChild(Au); if(GP._7AZ){GP._7AZ=0;if(_7P)this.cR(GP,-1,1);}}} else{ Au=GP["r"+i].nextSibling; Au.parentNode.removeChild(Au); if(GP._7AZ){GP._7AZ=0;if(_7P)this.cR(GP,-1,1);}}; row["r"+i]=null;}} catch(H){}; this.RowCount--; if(row.G4)this.cR(row,-1);}; _7h.prototype.at=function(row){ if(!this.HW)return; var AP=row.r1; if(AP){ if(row.Space!=null)AP.parentNode.parentNode.style.display=""; else{ var eW=AP.offsetHeight; AP.style.display=""; AP=row.r0;if(AP)AP.style.display=""; AP=row.r2;if(AP)AP.style.display=""; if(!eW)this.UpdateRowHeight(row); if(Grids.OnDisplayRow)Grids.OnDisplayRow(this,row); if(!_7P&&row.G4)this.cR(row,1);}} else this.aq(row); this.SV(row);}; _7h.prototype.aw=function(row){ if(!this.HW||!row.r1)return; if(row.Space!=null){row.r1.parentNode.parentNode.style.display="none";return;} try{ for(var i=0;i<3;i++){ var AP=row["r"+i]; if(AP)AP.style.display="none";}} catch(H){}; if(!_7P&&row.G4)this.cR(row,-1);}; _7h.prototype.au=function(row){ if(!this.HW||!row.r1)return; if(!row._7AZ)this.Xl(row); var AP=this.GetRowChildren(row,1);if(AP&&AP.style.display=="")return; for(var i=0;i<3;i++){ var AP=this.GetRowChildren(row,i); if(AP){ AP.style.display=""; if(_7P){AP.offsetWidth;AP.offsetHeight;}}} if(row.G4){ if(!_7P)this.cR(row,1,1); for(var F6 in this.cI)if(row[F6+"RowSpan"]!=null)this.UpdateRowHeight(this.Q4(row,F6));} if(Grids.OnDisplayRow){ var FX=row.Level; for(var AP=this.GetNextVisible(row,1);AP&&AP.Level>FX;AP=this.GetNextVisible(AP,1))Grids.OnDisplayRow(this,AP);} this.Update();}; _7h.prototype.Xm=function(row){ if(!this.HW||!row.r1)return; if(this.RemoveCollapsed){ this._7l(row);row.State=2; row._7AZ=2; for(var i=0;i<3;i++){ var AP=this.GetRowChildren(row,i); if(AP){ AP.firstChild.firstChild.innerHTML=""; AP.style.display="none"; if(_7P){AP.offsetWidth;AP.offsetHeight;}}}} else for(var i=0;i<3;i++){ var AP=this.GetRowChildren(row,i); if(AP){ AP.style.display="none"; if(_7P){AP.offsetWidth;AP.offsetHeight;}}} if(!_7P&&row.G4)this.cR(row,-1,1); this.Update();}; _7h.prototype.Xl=function(row){ if(!row||!row.r1)return; var HU=this.GetSections(); for(var i=HU[0];i<HU[1];i++){ var AP=row["r"+i]; var BC=AP.parentNode.insertRow(AP.rowIndex+1); if(!row.Visible||!row.Expanded)BC.style.display="none"; BC=BC.insertCell(0); BC.colSpan=AP.parentNode.rows[0].cells.length;} row._7AZ=2; if(row.G4&&(_7P||row.Visible||row.Expanded))this.cR(row,1,1);}; _7h.prototype.Lh=function(row){ if(row.G4&&(_7P||!this.GetRowChildren(row,1).style.display))this.cR(row,-1,1); var HU=this.GetSections(); for(var i=HU[0];i<HU[1];i++){ var AP=this.GetRowChildren(row,i);if(AP)AP.parentNode.removeChild(AP);} row._7AZ=0; this.Update();}; _7h.prototype.QE=function(){if(this.fZ){this.fZ[this.fa++]={Type:"Start"};this.fZ.length=this.fa;}}; _7h.prototype.QF=function(){if(this.fZ){this.fZ[this.fa++]={Type:"End"};}}; _7h.prototype.ab=function(D5){if(this.fZ){this.fZ[this.fa++]=D5;this.fZ.length=this.fa;}}; _7h.prototype.a0=function(D5){if(this.fZ){this.fZ[this.fa-1]=D5;}}; _7h.prototype.ClearUndo=function(){if(this.Undo){this.fZ=[];this.fa=0;}}; _7h.prototype.fb=function(Em){ if(!Em)Em=1e5; var YS=0,JD=0; for(var i=this.fa-1;i>=0&&Em;i--){ var Ak=this.fZ[i].Type; if(Ak=="End")YS++; else if(Ak=="Start")YS--; else JD++; if(!YS)Em--;} return JD;}; _7h.prototype.DoUndo=function(Em,refresh,Pj){ var fc=this.fZ; if(!fc||!this.fa)return false; Em=this.fb(Em); if(!Em)return false; if(!Pj&&refresh&&Em>=this.SynchroCount){ this.ShowMessage(this.GetText("DoUndo")); var T=this;setTimeout(function(){ T.DoUndo(Em,1,1); T.HideMessage();},10); return;} this.fZ=null; for(var i=this.fa-1;i>=0&&Em;i--){ var D5=fc[i]; switch(D5.Type){ case "Change": this.SetValue(D5.Row,D5.Col,D5.fd,refresh); D5.Row.Changed=D5.fe; D5.Row[D5.Col+"Changed"]=D5.ff; Em--; break; case "Add": case "Copy": this.DelRow(D5.Row); Em--; break; case "Delete": D5.Row.Deleted=D5.Deleted; D5.Row.Selected=D5.Selected; if(refresh){ if(!this.ShowDeleted){ if(D5.Row.Deleted)this.HideRow(D5.Row); else this.ShowRow(D5.Row);} if(this.ColorClasses&1)this.RefreshRow(D5.Row); else this.ColorRow(D5.Row);} if(!D5.Row.Expanded&&D5.Expanded){ if(refresh)this.Expand(D5.Row); else row.Expanded=1;} Em--; break; case "Move": this.N4(D5.Row,D5.an,D5.ao,refresh); D5.Row.Moved=D5.Moved; if(refresh){ if(this.ColorClasses&1)this.RefreshRow(D5.Row); else this.ColorRow(D5.Row);} Em--; break;}} while(i>=0&&fc[i].Type=="Start")i--; this.fa=i+1; this.fZ=fc; return true;}; _7h.prototype.fg=function(Em){ if(!Em)Em=1e5; var YS=0,JD=0; for(var i=this.fa;i<this.fZ.length&&Em;i++){ var Ak=this.fZ[i].Type; if(Ak=="End")YS--; else if(Ak=="Start")YS++; else JD++; if(!YS)Em--;} return JD;}; _7h.prototype.DoRedo=function(Em,refresh,Pj){ var fc=this.fZ; if(!fc||!fc.length)return false; Em=this.fg(Em); if(!Em)return false; if(!Pj&&refresh&&Em>=this.SynchroCount){ this.ShowMessage(this.GetText("DoRedo")); var T=this;setTimeout(function(){ T.DoRedo(Em,1,1); T.HideMessage();},10); return;} this.fZ=null; for(var i=this.fa;i<fc.length&&Em;i++){ var D5=fc[i]; switch(D5.Type){ case "Change": this.SetValue(D5.Row,D5.Col,D5.fh,refresh); Em--; break; case "Add": case "Copy": var Lq=D5.Row; if(D5.Type=="Add")D5.Row=this.AddRow(D5.Parent,D5.Next,refresh,D5.ac,D5.Def,D5.ad); else{ D5.Row=this.CopyRow(D5.Source,D5.Parent,D5.Next,D5.Grid,D5.a1,D5.Ea); if(refresh)this.ShowRow(D5.Row);}; for(var j=i+1;j<fc.length;j++){ var D4=fc[j]; for(var k in D4){if(D4[k]==Lq)D4[k]=D5.Row;}} Em--; break; case "Delete": D5.Row.Deleted=D5.bJ; if(refresh){ if(!this.ShowDeleted){ if(D5.Row.Deleted)this.HideRow(D5.Row); else this.ShowRow(D5.Row);} if(this.ColorClasses&1)this.RefreshRow(D5.Row); else this.ColorRow(D5.Row);} Em--; break; case "Move": this.N4(D5.Row,D5.Par,D5.Next,refresh); Em--; break;}} while(i<fc.length&&fc[i].Type=="End")i++; this.fa=i; this.fZ=fc; return true;}; _7h.prototype.ActionUndo=function(){return this.DoUndo(1,1);}; _7h.prototype.ActionUndoAll=function(){return this.DoUndo(0,1);}; _7h.prototype.ActionRedo=function(){return this.DoRedo(1,1);}; _7h.prototype.ActionRedoAll=function(){return this.DoRedo(0,1);}; _7h.prototype.ActionClearUndo=function(){this.ClearUndo();return true;}; _7h.prototype.SL=function(HQ,all){ if(!this.MainCol)return; var C=this.Cols[this.MainCol]; for(var AP=this.XB.firstChild;AP;AP=AP.nextSibling){AP.Level=-1;this.Yf(AP,HQ,all);}}; _7h.prototype.fi=function(row){ var FX=row.Level+1; for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(AP.Level!=FX){ AP.Level=FX; if(AP.firstChild)this.fi(AP);}}}; _7h.prototype.Yf=function(row,HQ,all){ var AP=row.firstChild,FX=row.Level+1; if(AP)while(1){ var fj=all; if(AP.Level!=FX){ AP.Level=FX; fj=1;} var Es=AP.nextSibling; while(Es&&!Es.Visible){ if(Es.Level!=FX){ Es.Level=FX; if(Es.firstChild)this.fi(Es);} Es=Es.nextSibling;} if(!Es){ var Iu=row.Page&&AP.parentNode.nextSibling?1:0; if(AP.LevelImg!=Iu){AP.LevelImg=Iu;fj=1;} if(fj&&HQ)this.Li(AP); if(AP.firstChild)this.Yf(AP,HQ,fj); break;} if(AP.LevelImg!=1){AP.LevelImg=1;fj=1;} if(fj&&HQ)this.Li(AP); if(AP.firstChild)this.Yf(AP,HQ,fj); AP=Es;}}; _7h.prototype.LV=function(row,HQ){ if(!this.MainCol)return; row.LevelImg=0; for(var AP=row.nextSibling;AP;AP=AP.nextSibling)if(AP.Visible){row.LevelImg=1;break;} row.Level=row.parentNode.Level+1; if(HQ)this.Li(row);}; _7h.prototype.Li=function(row,aK){ if(this.HW==null||!row||!this.MainCol||row.Fixed)return; for(var AN=row;AN&&AN!=this.XB;AN=AN.parentNode);if(!AN)return; var H6=this.GetCell(row,this.MainCol),aE=this.aG(row,aK); if(H6&&aE.length){ if(this.SpannedTree){ H6=H6.firstChild.firstChild.firstChild.firstChild; H6.innerHTML=aE.length<5?this.Z7(aE):aE; if(this.NoTreeLines){ if(this.HideRootTree&&!row.Level){H6.style.width="";H6.innerHTML="";} else H6.style.width=((row.Level+(this.HideRootTree?-1:0))*this.Img.Line+this.Img.Tree)+"px";} return;} H6=H6.previousSibling; var fk=H6.firstChild.nodeType==1; if(aE.length<5){ if(_7T){ if(!fk)H6.className=H6.className.replace(/NoRight.*/,"NoRight "+this.Img.Style+(this.NoTreeLines?"NoTreeLines"+this.NoTreeLines:"Tree")); H6.innerHTML=this.Z7(aE);} else{ if(fk)H6.innerHTML=_7D; H6.className=H6.className.replace(/NoRight.*/,"NoRight "+this.Img.Style+"Empty "+this.Img.Style+aE);}} else{ if(!fk)H6.className=H6.className.replace(/NoRight.*/,"NoRight "+this.Img.Style+(this.NoTreeLines?"NoTreeLines"+this.NoTreeLines:"Tree")); H6.innerHTML=aE;}}}; _7h.prototype.N3=function(row,HQ){ if(this.HW==null||!this.MainCol||row.Fixed)return; this.LV(row); if(row.LevelImg)return; for(var AP=row.previousSibling;AP&&!AP.Visible;AP=AP.previousSibling); if(!AP){ var GP=row.parentNode; if(HQ&&!GP.Page)this.Li(GP);} else{ AP.LevelImg=row.Visible?1:0; if(HQ)for(var FX=row.Level;AP&&AP.Level>=FX;AP=this.GetNextVisible(AP))this.Li(AP);}}; _7h.prototype.UpdateRowHeight=function(row,complete){ if(!row.r1||row.Space)return; var CS=row.Height;if(!CS)CS=row.Def.Height;if(!CS)CS=this.Hu; CS=CS?CS+"px":""; row.r1.style.height=CS; if(row.r0)row.r0.style.height=CS; if(row.r2)row.r2.style.height=CS; if(this.KJ){ row.r1.firstChild.style.height=CS; if(row.r0)row.r0.firstChild.style.height=CS; if(row.r2)row.r2.firstChild.style.height=CS;} if(row.Gb){ for(var F6 in row.Gb){ var H6=this.GetCell(row,F6); if(H6)H6.firstChild.style.height="1px";}} CS=row.r1.offsetHeight; if(row.r0&&row.r0.offsetHeight>CS)CS=row.r0.offsetHeight; if(row.r2&&row.r2.offsetHeight>CS)CS=row.r2.offsetHeight; if(row.G4)CS=this.cT(row,CS); if(CS<0)return; var Ht=CS+"px"; row.r1.style.height=Ht; if(row.r0)row.r0.style.height=Ht; if(row.r2)row.r2.style.height=Ht; if(this.KJ){ row.r1.firstChild.style.height=Ht; if(row.r0)row.r0.firstChild.style.height=Ht; if(row.r2)row.r2.firstChild.style.height=Ht;} if(row.Gb){ for(var F6 in row.Gb){ var H6=this.GetCell(row,F6); if(H6){ var Gn=row[F6+"BorderHeight"]; if(Gn==null){ Gn=_7AI(GetStyle(H6)); row[F6+"BorderHeight"]=Gn;} H6.firstChild.style.height=(CS-Gn)+"px";}}} if(complete){ this.Update();} CS=row.r1.offsetHeight; return(!row.r0||row.r0.offsetHeight==CS)&&(!row.r2||row.r2.offsetHeight==CS);}; _7h.prototype.fl=function(row){ if(!row._7AZ)return; var CS=row.r1.nextSibling.offsetHeight; if((!row.r0||row.r0.nextSibling.offsetHeight==CS)&&(!row.r2||row.r2.nextSibling.offsetHeight==CS))return; if(row.G4){ if(_7N){ var AJ=[]; for(var F6 in this.cI){ var AP=this.Q4(row,F6); for(var i=0;i<AJ.length;i++)if(AJ[i]==AP)break; if(i==AJ.length){AJ[i]=AP;this.UpdateRowHeight(AP);}}} else this.UpdateRowHeight(row); var CS=row.r1.nextSibling.offsetHeight; if((!row.r0||row.r0.nextSibling.offsetHeight==CS)&&(!row.r2||row.r2.nextSibling.offsetHeight==CS))return;} var Ff=0; for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(!AP.r1)continue; CS=AP.r1.offsetHeight; if(AP.r0&&AP.r0.offsetHeight!=CS||AP.r2&&AP.r2.offsetHeight!=CS){if(this.UpdateRowHeight(AP))Ff=1;} if(AP._7AZ&&this.fl(AP))Ff=1;} return Ff;}; _7h.prototype.UpdateHeights=function(){ var AN=this.N; if(!AN[1]||!AN[1].firstChild)return; var Ff=0,CS=AN[1].lastChild.offsetTop+AN[1].lastChild.offsetHeight; if(AN[0]&&AN[0].lastChild.offsetTop+AN[0].lastChild.offsetHeight!=CS||AN[2]&&AN[2].lastChild.offsetTop+AN[2].lastChild.offsetHeight!=CS){ this.LB("UpdateHeights"); for(var Ey=this.XB.firstChild;Ey;Ey=Ey.nextSibling){ if(!Ey.r1)continue; CS=Ey.r1.offsetHeight; if(Ey.r0&&Ey.r0.offsetHeight!=CS||Ey.r2&&Ey.r2.offsetHeight!=CS){ for(var AP=Ey.firstChild;AP;AP=AP.nextSibling){ if(!AP.r1)continue; CS=AP.r1.offsetHeight; if(AP.r0&&AP.r0.offsetHeight!=CS||AP.r2&&AP.r2.offsetHeight!=CS){ if(this.UpdateRowHeight(AP))Ff=1;} if(AP._7AZ&&this.fl(AP))Ff=1;}}} CS=AN[1].lastChild.offsetTop+AN[1].lastChild.offsetHeight; if(AN[0]&&AN[0].lastChild.offsetTop+AN[0].lastChild.offsetHeight!=CS||AN[2]&&AN[2].lastChild.offsetTop+AN[2].lastChild.offsetHeight!=CS)Ff=0; if(Ff)this.LC("UpdateHeights");else this.Nf("UpdateHeights");} if(this.L[1]){ var CS=this.L[1].firstChild.offsetHeight; if(this.L[0]&&this.L[0].firstChild.offsetHeight!=CS||this.L[2]&&this.L[2].firstChild.offsetHeight!=CS){ for(var AP=this.XH.firstChild;AP;AP=AP.nextSibling)this.UpdateRowHeight(AP); var CS=this.L[1].firstChild.offsetHeight; if((!this.L[0]||this.L[0].firstChild.offsetHeight==CS)&&(!this.L[2]||this.L[2].firstChild.offsetHeight==CS))Ff=1;}} if(this.O[1]){ var CS=this.O[1].firstChild.offsetHeight; if(this.O[0]&&this.O[0].firstChild.offsetHeight!=CS||this.O[2]&&this.O[2].firstChild.offsetHeight!=CS){ for(var AP=this.XF.firstChild;AP;AP=AP.nextSibling)this.UpdateRowHeight(AP); var CS=this.O[1].firstChild.offsetHeight; if((!this.O[0]||this.O[0].firstChild.offsetHeight==CS)&&(!this.O[2]||this.O[2].firstChild.offsetHeight==CS))Ff=1;}} if(Ff)this.Update();}; _7h.prototype.Ne=function(){ if(this.Rendering||this.Loading)return; var fm=this.GetFirstVisible()||this.XB.firstChild.State<2?"":"none"; if(this.c2==fm)return; for(var i=0;i<3;i++){ var AN=this.A9(i); if(AN)AN.parentNode.style.display=fm;} this.c2=fm; this.Update();}; _7h.prototype.NR=function(row){ if(row.tagName=="BR"){ var AP=_7i.createElement(row.Page?"B":"I"); for(var i in row)if(!Grids.AH[i])AP[i]=row[i]; AP.id=row.id; row.parentNode.replaceChild(AP,row); if(this.FRow==row)this.FRow=AP; row=AP;} return row;}; _7h.prototype.fn=function(){ var Cq=this.Focused; if(Cq!=null&&Cq!==""&&!this.IgnoreFocused){ var AN; if(typeof(Cq)=="number")AN=_7k(this.XB,Cq); else for(AN=this.XB.firstChild;AN;AN=AN.nextSibling)if(AN.id==Cq)break; if(AN){ this.Focus(AN,this.FocusedCol,this.FocusedPos);} else{ Cq=this.GetRowById(Cq); this.Focus(Cq,this.FocusedCol);}} this.Focused=null;this.FocusedPos=null;this.FocusedCol=null;}; _7h.prototype.Nd=function(){ if((this.Jb||this.Jc)&&this.SaveExpanded){ var E=this.Jb,C=this.Jc; for(var AP=this.GetFirst();AP;AP=this.GetNext(AP)){ if(Is(AP,"CanExpand")&&AP.id){ if(E.search("&"+AP.id+"&")>=0)AP.Expanded=1; else if(C.search("&"+AP.id+"&")>=0)AP.Expanded=0;}}} if(this.Jd&&this.SaveSelected){ var S=this.Jd; for(var AP=this.GetFirst();AP;AP=this.GetNext(AP)){ if(Is(AP,"CanSelect")&&AP.id){ if(S.search("&"+AP.id+"&")>=0)AP.Selected=1; else AP.Selected=0;}}} if(this.SaveValues){ var S=this.Je; for(var bg in S){ var AP=this.GetRowById(bg); if(AP){ var Fj=S[bg].split("&"),Au=1; if(Fj[0]=='D'){AP.Deleted=1;AP.Visible=0;} else if(Fj[0]=='A'){ AP.Added=1; AP.Par=Fj[1]; AP.Def=this.Def[Fj[2]]; AP.Parent=(Fj[3]-0)>=0?_7k(this.XB,Fj[3]-0):(Fj[3]?this.GetRowById(Fj[3]):null); AP.Next=Fj[4]?this.GetRowById(Fj[4]):null; AP.Copy=Fj[5]?this.GetRowById(Fj[5]):null; Au=6;} else if(Fj[0]=='M'){ AP.Moved=Fj[1]-0; AP.Parent=(Fj[2]-0)>=0?_7k(this.XB,Fj[2]-0):(Fj[2]?this.GetRowById(Fj[2]):null); AP.Next=Fj[3]?this.GetRowById(Fj[3]):null; Au=4;} else if(Fj[0]=='C')AP.Changed=1; for(var i=Au;i<Fj.length;i+=2){ var Dh=unescape(Fj[i+1]); if((Dh-0)+""==Dh)Dh=Dh-0; AP[Fj[i]]=Dh; AP[Fj[i]+"Changed"]=1;}}}}}; _7h.prototype.ci=function(){ var GK=this.MainTag;if(!GK.offsetWidth)return; if(!this.NoScroll){ var fo=GetStyle(GK),abs=fo.position.toLowerCase()=="absolute"; if(this.MaxWidth)GK.style.width="100%"; else if(!parseInt(fo.width)&&(!abs||isNaN(parseInt(fo.left))||isNaN(parseInt(fo.right)))){ this.Debug(2,"Set neither width for main <div> tag nor MaxWidth / NoHScroll / MaxHScroll => forced setting width of the <div> to ","100%"); GK.style.width="100%";} var fp=0; if(_7U&&this.RG) fp=this.RG.scrollTop; if(this.HW)this.HW.style.display="none"; if(!this.MaxHeight&&!this.NoVScroll&&!this.MaxVScroll){ if(this.MainTag.offsetHeight<40&&this.MainTag.offsetWidth){ GK.style.height="100%"; if(this.MainTag.offsetHeight<40){ this.Debug(2,"Set neither ","fixed"," height for main <div> tag nor MaxHeight / NoVScroll / MaxVScroll => forced setting ","<Cfg MaxVScroll='2000'/>"); this.MaxVScroll=2000;} else{ this.Debug(2,"Set neither width for main <div> tag nor MaxHeight / NoVScroll / MaxVScroll => forced setting height of the <div> to ","100%");}}} GK.style.overflow="hidden"; if(this.HW)this.HW.style.display=""; try{ if(_7U&&this.RG){ if(('undefined'!=fp)){ this.RG.scrollTop=fp;}}}catch(H){};} else GK.style.overflow="visible";}; _7h.prototype.fF=function(fq,Em){ if(!this.Loading)return; if(!document.body.offsetWidth){ var T=this;setTimeout(function(){T.fF(fq,Em);},100); return;} if(!this.Img.fG){ if(!this.t["Styles"]&&!fq){this.Debug(fq?2:4,"Loading styles");this.LB("Styles");} if(!Em)Em=1; else Em++; if(this.CacheTimeout*10<Em||fq){ var NH=this.GetAlert("StyleErr"); if(NH)alert(NH); this.Debug(0,"Cannot load CSS style from ",this.Ae(this.CSS)); this.e8(); return;} if(!this.SuppressMessage){this.HideMessage();_7Au(this.GetText("LoadStyles"),this.MainTag,"GridMessage",null,this.MessageWidth);} var T=this;setTimeout(function(){T.fI();T.fF(fq,Em);},100); return;} this.MainTag.innerHTML=""; if(this.t["Styles"])this.Debug(4,"Styles loaded in ",this.Nf("Styles")," ms"); this.Debug(4,"Updating layout and values");this.LB("Update");this.LB("UpdateGrid"); this.ci(); if(!this.cW&&this.MainCol){this.MainCol=null;_7Ae("Tree");} if(!this.ShowPages&&this.Paging){this.Paging=0;_7Ae("Paging");} if(!this.Paging){this.NoPager=1;this.AllPages=1;} if(this.NoPager){this.Pager.CanHide=0;this.Pager.Visible=0;this.MenuCfg.ShowPager=0;} if(this.RemoveCollapsed>this.ChildPaging)this.RemoveCollapsed=this.ChildPaging; this.Kt=1; if(this.InEditMode==0){ this.ChangeAction("OnClickCell","ChangeFocus OR Focus AND StartEdit"); this.ChangeAction("OnDblClickCell","Focus AND StartEdit");} this.ControlPanel={ Click:new Function("num",this.K+".ToolbarClick(num);"), HideCfg:new Function("save",this.K+".HideCfg(save);")}; if(this.Selecting&8)this.SelectingCells=1; s=this.Lang.Format; if(this.EmptyNumber!=null)this.Lang.Format.EmptyNumber=this.EmptyNumber; if(this.EmptyDate!=null)this.Lang.Format.EmptyDate=this.EmptyDate; if(this.ShowVScrollbar)this.ShowVScroll=1; var CZ=["Header","Toolbar","Filter","Group","Search"],CE=this.GetFixedRows(); for(var j=0;j<CZ.length;j++){ var Es=CZ[j],AP=this[Es]; for(var i=0;i<CE.length;i++){ if(CE[i].id==Es&&(CE[i].Kind==Es||!CE[i].Kind)||!AP&&CE[i].Kind==Es){ if(AP){for(var DU in AP)if(!Grids.AH[DU]&&AP[DU]!=null&&CE[i][DU]==null)CE[i][DU]=AP[DU];} else if(CE[i].id==null)CE[i].id=Es; this[Es]=CE[i]; break;}} if(AP&&i==CE.length){ if(Es=="Header"||Es=="Filter")this.XH.insertBefore(AP,this.XH.firstChild); else if(Es=="Toolbar")this.XF.appendChild(AP); else this.XH.appendChild(AP); if(AP.id==null)AP.id=Es; AP.Kind=Es;}} if(this.Header.Rows>1){ var CZ=this.Header,HU=this.GetSections(),X=CZ; for(var i=0;i<CZ.Rows;i++){ if(i==CZ.Main){X=CZ.nextSibling;continue;} var AP=_7i.createElement("I"); AP.Spanned=1; AP.Kind="Header"; for(var Hj=HU[0];Hj<HU[1];Hj++){ var S=this.ColNames[Hj],AL=(Hj==0?"Left":Hj==1?"Mid":"Right")+i; for(var Vg=0,Fa=0;Vg<S.length;Vg+=HR,Fa++){ var F6=S[Vg],HR=CZ[AL+Fa+"Span"];if(!HR)HR=1; AP[F6]=CZ[AL+Fa];if(!AP[F6])AP[F6]=_7D; AP[F6+"Type"]="Html"; AP[F6+"SortCol"]=""; if(HR>1)AP[F6+"Span"]=HR;}} if(X)CZ.parentNode.insertBefore(AP,X); else CZ.parentNode.appendChild(AP);}} if(!this.IdNames)this.IdNames="id"; if(typeof(this.IdNames)=="string"){ this.IdNames=this.IdNames.split(","); this.Om=null;} var bV=this.IdNames.length!=1||this.IdNames[0]!="id"?this.IdNames.length:0; if(!bV&&this.FullId)bV=1; this.Ol=bV; if(!this.Om){ this.Om=new Object(); for(var i=0;i<this.IdNames.length;i++)this.Om[this.IdNames[i]]=1;} this.Nr=this.IdNames[this.IdNames.length-1]; this.IdPrefix=this.IdPrefix==null?"":this.IdPrefix+""; this.IdPostfix=this.IdPostfix==null?"":this.IdPostfix+""; this.IdChars=this.IdChars+""; if(!this.IdChars)this.IdChars="0123456789"; this.bb=/[\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}]/g; this.bc=this.IdPrefix.replace(this.bb,"\\$&")+"(["+this.IdChars.replace(this.bb,"\\$&")+"]*)"+this.IdPostfix.replace(this.bb,"\\$&")+"$"; this.bT=new Object(); for(var i=0;i<this.IdChars.length;i++)this.bT[this.IdChars.charAt(i)]=i; this.LastId=this.LastId==null?"":this.LastId+""; if(this.LastId){ var M=this.LastId.match(new RegExp("^"+this.bc,this.IdCompare&4?"i":"")); if(M)this.LastId=M[1];} var fr=(this["Co"+'de']+"").search(/^\s*GT\s*GCS\n?MU\n*A\d*Q\s?AHP\t?P\d?C\s*$/i); this.e0(); this.N0(); var fs=window["tnenopmoC".split("").reverse().join("")]; if(fs){ var AJ=new Array(),Au=0,B3="",ft=0,fu="seludoM".split("").reverse().join(""); for(var i in fs)if(typeof(fs[i])=="string"&&i!=fu)AJ[Au++]=i; AJ.sort(); for(var i=0;i<Au;i++)B3+=fs[AJ[i]]; B3+=fs[fu]; for(var i=0;i<B3.length;i++){ if(i%3)ft+=B3.charCodeAt(i); else if(i%11)ft-=B3.charCodeAt(i); else ft^=B3.charCodeAt(i);} if(ft!=35371)fs=null;} if(!fs){this.e8("ecnecil gnorW".split("").reverse().join(""));return;} var Em=0; for(var BD in this.Cols){ var C=this.Cols[BD]; if(C.Width!=null&&C.Width<=0){C.Width=null;C.Visible=0;} if(C.WhiteChars&&typeof(C.WhiteChars=="string")){ C.WhiteChars=new RegExp("["+(C.WhiteChars+"").replace(/[\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}\/]/g,"\\$&")+"]","g");} if(C.CharCodes&&typeof(C.CharCodes=="string")){ var BD=C.CharCodes.split(C.CharCodes.charAt(0)); var D2=new Object(); for(var i=1;i<BD.length;i+=2)D2[BD[i]]=BD[i+1]; C.CharCodes=D2;} if(!C.CharCodes&&Grids.CharCodes)C.CharCodes=Grids.CharCodes; Em++;} if(this.ConstWidth){ if(this.RelWidth||this.NoHScroll||this.MaxHScroll)this.ConstWidth=false; else{ this.RelWidth=true; var Yb=this.GetSections()[1]==3&&this.ConstWidth!=2; var BD=this.AddCol("_ConstWidth",Yb?2:1,Yb?0:-1,100,0,"Html"," "); BD.MinWidth=0;BD.Visible=1;BD.RelWidth=1; BD.CanHide=0;BD.CanFocus=0;BD.CanSort=0;BD.CanMove=0;BD.CanResize=0; BD.NoColor=1;}} var S=this.ColNames,HU=this.GetSections(),D2=0,C=this.Cols; for(var i=HU[0];i<HU[1];i++){ for(var j=0;j<S[i].length;j++){ var fv=C[S[i][j]].Group; if(fv&&fv!=D2){C[S[i][j]].Wj=1;D2=fv;} if(!C[S[i][j]].Group)C[S[i][j]].Group=0;}} var C=this.Cols.Panel;if(C&&!C.Type)C.Type="Panel"; for(var F6 in this.Cols){ var C=this.Cols[F6]; if(C.Type!="Panel")continue; C.Z8=(this.Dragging&&C.Move?1:0)+(this.Selecting&&C.Select?1:0)+(this.Deleting&&C.Delete?1:0)+(this.Copying&&C.Copy?1:0); if(!C.Width)C.Width=this.Img.Kj+this.Img.Ki+this.Img.Panel*C.Z8; if(C.Width<5){C.Visible=0;C.CanHide=0;}} var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++){ var AP=CE[i]; if(AP.Kind=="Header"){ for(var BD in this.Cols){ if(AP[BD]==null)AP[BD]=BD; if(AP[BD+"Button"]==null&&this.Sorting&&this.Cols[BD].Type!="Pass"&&this.Cols[BD].Type!="Panel"){ var Vm=AP[BD+"SortCol"]; if(Vm!==""){ if(!Vm)Vm=BD; if(this.Cols[Vm].CanSort&1)AP[BD+"Button"]="Sort";}} if(!AP[BD+"Button"])AP[BD+"Button"]=""; AP[BD+"RightButton"]=""; if(this.Cols[BD].Type=="Panel"){ if(AP[BD]==BD)AP[BD]="";} else if(AP[BD+"Type"]==null)AP[BD+"Type"]=AP.NoEscape?"Html":"Text"; if(AP[BD+"Format"]==null)AP[BD+"Format"]="";}} else if(AP.Kind=="Filter"){ for(var BD in this.Cols){ if(Get(AP,BD+"ShowMenu")!="0"){ if(this.GetType(AP,BD)=="Enum"&&Get(AP,BD+"ShowMenu")!="1")continue; var Bo=this.Gw(AP,BD,"Button");if(Bo=="Filter")continue; if(Bo&&!this.Gw(AP,BD,"RightButton")){ AP[BD+"RightButton"]=Bo;Bo=null;} if(!Bo&&this.GetType(AP,BD)=="Enum"&&this.Gw(AP,BD,"EnumType")){ if(this.Gw(AP,BD,"RightButton"))Bo="Enum"; else AP[BD+"RightButton"]="Enum";} if(!Bo){ AP[BD+"Button"]="Filter"; AP[BD+"ButtonPos"]=0;}}}} else if(AP.Kind=="User"){ AP["LeftHtml"]=AP["LeftVal"]?AP["LeftVal"]:_7D; AP["MidHtml"]=AP["MidVal"]?AP["MidVal"]:_7D; AP["RightHtml"]=AP["RightVal"]?AP["RightVal"]:_7D; AP.CanExport=0;}} if(fr){this.e8("edoc laires gnorW".split("").reverse().join(""));return;} this.Nd(); this._7A0=this.MainCol; this.RootCDef=this.Root.CDef; this.Vi=this.Root.AcceptDef; if(this.Def["GroupLast"])this.Def["GroupLast"].GroupCol=-1; this.KJ=_7R||_7K?1:0; this.cH(); if(this.ExportRound!=null)this.ExportRound=Math.pow(10,this.ExportRound); for(var F6 in this.Cols)if(this.Cols[F6].Type=="Gantt")this.Gantt=1; if(this.Lang.Format.GMT-0){this.T8=this.T3;this.Tx=this.T5;} else{this.T8=this.T2;this.Tx=this.T4;}; this.LC("UpdateGrid"); if(fq){this.Nc(1);return;} this.ShowMessage(this.GetText("Calculate")); var T=this;setTimeout(function(){T.Nc();},10);}; _7h.prototype.Nc=function(fq){ if(!this.Loading&&!fq)return; this.fw=this.Gantt;this.Gantt=0; this.Debug(4,"Calculating formulas");this.LB("Calculate"); this.Calculate(); this.LC("Calculate"); if(this.Paging==3){ if(this.Pager.CanHide||this.Pager.Visible||this.MenuCfg.ShowPager)this.YB(); if(this.SA)this.SA(true); if(this.Grouping&&(!this.NT||this.NT=="Group")){ if(this.Grouped&&this.Z){ this.VU(); this.VV(); this.Vt(0); for(var i=0;i<this.Z;i++){ var F6=this.GroupCols[i]; if(F6!=this.MainCol&&this.Cols[F6].CanGroup!=2)this.Cols[F6].Visible=0;} this.Va(this.SortCols,this.SortTypes);} else this.VS();}} if(this.Paging==3){ if(fq){this.fx(1);return;} this.ShowMessage(this.GetText("UpdateTree")); var T=this;setTimeout(function(){T.fx();},10);} else{ if(fq){this.fy(1);return;} this.ShowMessage(this.GetText("DoFilter")); var T=this;setTimeout(function(){T.fy();},10);}}; _7h.prototype.fy=function(fq){ if(!this.Loading&&!fq)return; var Cq=0; var G3=this.R5&&(!Grids.OnCanFilter||Grids.OnCanFilter(this,true)); if(G3){this.R5();this.SA();} var BJ=this.DoSearch&&this.SearchAction&&this.SearchAction!="Find"&&(!Grids.OnCanSearch||Grids.OnCanSearch(this,true)); var fz=BJ&&this.SearchAction=="Filter"; if(fz)Cq=this.DoSearch(this.SearchAction,true); else if(G3&&(this.N7||this.OB))Cq=this.SB(true); if(Cq){ if(this.Calculating&&this.Calculated)this.Calculate(false,false); if(this.MainCol)this.SL(false,true);} if(BJ&&!fz)this.DoSearch(this.SearchAction,true); if(fq){this.f0(1);return;} this.ShowMessage(this.GetText("Group")); var T=this;setTimeout(function(){T.f0();},10);}; _7h.prototype.f0=function(fq){ if(!this.Loading&&!fq)return; if(this.Z&&(!(this.OnePage&4)||this.AllPages)){ this.Debug(4,"Grouping rows");this.LB("Group"); this.VU(); this.VV(); this.GroupAll(1); if(this.FilterEmpty&&(this.N7||this.N9||this.OB||Grids.OnRowFilter))this.SE(1); this.LC("Group");} if(fq){this.f1(1);return;} this.ShowMessage(this.GetText("Sort")); var T=this;setTimeout(function(){T.f1();},10);}; _7h.prototype.f1=function(fq){ if(!this.Loading&&!fq)return; for(var i=0;i<this.W;i++){ if(!this.Cols[this.SortCols[i]])this.W=0;} if(this.Sorting&&this.Sorted&&this.W&&this.DoSort){ this.DoSort(); for(var Au=this.XB.firstChild;Au;Au=Au.nextSibling)this.HX(Au);} else{ this.LB("Pages"); if(this.Paging==1||this.Paging==2)this.CreatePages(); if(this.ChildPaging)this.LP(this.XB); this.LC("Pages");}; if(fq){this.fx(1);return;} this.ShowMessage(this.GetText(this.Gantt?"CreateGantt":"UpdateTree")); var T=this;setTimeout(function(){T.fx();},10);}; _7h.prototype.fx=function(Kf){ if(!this.Loading&&!Kf)return; if(this.MainCol){ this.Debug(4,"Updating tree");this.LB("Tree"); this.SL();} this.SC(0); if(this.MainCol)this.LC("Tree"); this.Debug(4,"Calculating column widths");this.LB("Widths");var Ai=""; var C=this.Cols,min=this.Img.Ki+this.Img.Kj; for(var i in C){ if(C[i].JZ==true){ if(this.CalcWidth)this.CalcWidth(i,1); else C[i].Width=50; Ai+=C[i].Name+"="+C[i].Width+"px; ";} if(C[i].RelWidth||C[i].Ja){ if(this.NoHScroll||this.MaxHScroll){C[i].RelWidth=0;C[i].Ja=0;} else this.RelWidth=true;} if(!(C[i].MinWidth>=min))C[i].MinWidth=min;} var AM=this.Pager; if(!AM.MinWidth)AM.MinWidth=0; if(AM.RelWidth||AM.Ja){ if(this.NoHScroll||this.MaxHScroll){AM.RelWidth=0;AM.Ja=0;} else this.RelWidth=true;} this.Debug(4,"Column widths calculated in ",this.LC("Widths")," ms (results: "+Ai+")"); this.Gantt=this.fw; if(this.Gantt){ this.Debug(4,"Creating Gantt");this.LB("Gantt"); if(!Grids.OnGanttStart||!Grids.OnGanttStart(this))this.Iw(); this.LC("Gantt");} this.fn(); this.SetVPos(); this.Loading=0; this.Nj=0; this.ClearUndo(); this.KE=0; var filter=this.PB("Filter"); var Fu=this.PB("Group"); var sort=this.PB("Sort"); var f2=this.PB("Pages"); var aE=this.PB("Tree"); var cols=this.PB("Tree"); var gantt=this.PB("Gantt"); this.Debug(4,"TreeGrid updated in ",this.Nf("Update")," ms (data updated: ",this.PB("UpdateGrid")," ms, calculated: ",this.PB("Calculate"),filter!=null?" ms, filtered: ":"",filter,Fu!=null?" ms, grouped: ":"",Fu,sort!=null?" ms, sorted: ":"",sort,f2!=null?" ms, paged: ":"",f2,aE!=null?" ms, tree updated: ":"",aE,cols!=null?" ms, column widths calculated: ":"",cols,gantt!=null?" ms, Gantt created: ":"",gantt," ms)"); if(Kf!=2){ if(Kf==1)this.Render(); else this.Rerender();}}; _7h.prototype.HS=function(AP){ for(var i=0;i<3;i++){ var Jf=this.ColNames[i]; for(var j=0;j<Jf.length;j++){ var HR=Jf[j]+"Span",KP=AP[HR];if(KP==null&&AP.Def)KP=AP.Def[HR]; if(KP>1){ AP[HR]=KP; for(j++;KP>1;KP--,j++)AP[Jf[j]+"Span"]=0; j--;} else AP[HR]=1;}}}; _7h.prototype.PU=function(Ep,BA){ if(!Ep)return ""; var DY=this.Lang.Format,AJ=(Ep+"").split(DY.ValueSeparator),f3=0; for(var i=0;i<AJ.length;i++){ var AN=AJ[i].split(DY.RangeSeparator); for(var j=0;j<AN.length;j++){ var Ey=AN[j]; if((!(Ey-0)||Ey<3000)&&Ey!="0"){ var BM=BA?DY.StringToDate(Ey,BA):(f3?DY._7A6(Ey):DY._7o(Ey)); if(BM)AN[j]=BM;}} AJ[i]=AN.join(DY.RangeSeparator);} return AJ.join(DY.ValueSeparator);}; _7h.prototype.I2=function(Ep){ var M=Ep; if(typeof(M)=="string"){ M=new Array(),Au=0; Ep=Ep.split(this.Lang.Format.ValueSeparator); for(var i=0;i<Ep.length;i++){ if(!Ep[i])continue; var Dh=Ep[i].split(this.Lang.Format.RangeSeparator); M[Au++]=Dh[0]-0; M[Au++]=Dh[1]?Dh[1]-0:Dh[0]-0;}} for(var i=0;i<M.length;i+=2){ var a=M[i],Ey=M[i+1];if(a==null)continue; a=new Date(a);Ey=new Date(Ey); a.setDate(a.getDate()-1);a=a.getTime(); Ey.setDate(Ey.getDate()+1);Ey=Ey.getTime(); for(var j=0;j<M.length;j+=2){ if(i==j||M[j]==null)continue; if(M[j]>=a&&M[j]<=Ey){ if(M[j+1]>=Ey)M[i+1]=M[j+1]; if(M[j]==a)M[i]=a; M[j]=null;M[j+1]=null; i=-2;break;} else if(M[j+1]>=a&&M[j+1]<=Ey){ M[i]=M[j]; M[j]=null;M[j+1]=null; i=-2;break;}}} M.sort(); var B3=""; for(var i=0;i<M.length;i+=2){ if(M[i]==null)continue; if(B3)B3+=this.Lang.Format.ValueSeparator; B3+=M[i]; if(M[i+1]!=M[i])B3+=this.Lang.Format.RangeSeparator+M[i+1];} return B3;}; _7h.prototype.f4=function(AP,HU,f5,f6){ var AS=AP.Def,DY=this.Lang.Format,BE=DY.GMT-0,f3=0;; if(!AS){ var f7=AP.parentNode; AS=Get(f7.Def?f7:this.Root,"CDef");} else if(typeof(AS)!="string")return; AS=this.Def[AS]; if(!AS)AS=this.Def["R"]; AP.Def=AS; if(AS.Expanded!=null&&AP.Expanded==null)AP.Expanded=AS.Expanded-0; if(AS.Kind!=null&&AP.Kind==null)AP.Kind=AS.Kind; if(AS.Visible!=null&&AP.Visible==null)AP.Visible=AS.Visible-0; if(AS.Calculated!=null&&AP.Calculated==null)AP.Calculated=AS.Calculated-0; if(AS.G4!=null&&AP.G4==null)AP.G4=AS.G4-0; if(AS.Spanned!=null&&AP.Spanned==null)AP.Spanned=AS.Spanned-0; if(AP.Spanned){this.Kt=1;this.HS(AP);} if((this.Ol||this.FullId)&&AP.Kind=="Data"){ var id="",x,i,Es,bV=this.Ol; for(i=0;i<bV;i++){ Es=this.IdNames[i]; if(Es=="Def")x=AS.Name; else x=Get(AP,Es); if(x==null)x=""; if(Es=="id")id+="$"+(x+"").replace(/.\$/g,""); else id+="$"+(x+"").replace(/\$/g,"_");} AP.id=id.slice(1); if(this.FullId){ var U0=AP.parentNode.id; if(U0)AP.id=U0+"$"+AP.id;}} var BD,BM,Au; if(!f6){ if(HU)Au=HU.length; else{ HU=[];f5=[];Au=0; for(var BD in C)if(BD!="Panel"){f5[Au]=BD+"Type";HU[Au++]=BD;}}; var ZN=Grids.OnGetType!=null,C=this.Cols; var f8={"Date":1,"Float":1,"Select":1,"Int":1}; for(var i=0;i<Au;i++){ var type=AP[f5[i]]; if(type==null){ type=AS[f5[i]]; if(type==null){BD=C[HU[i]];if(BD)type=BD.Type;}} if(ZN)type=Grids.OnGetType(this,AP,HU[i],type); if(!f8[type])continue; var BD=HU[i],Bb=AP[BD]; if(type=="Date"){ if(!Bb){if(Bb!==0)AP[BD]=DY.EmptyDate!=null||this.G2(AP,BD)?"":0;} else if((Bb-0)+""!=Bb){ AP[BD]=Date.parse(Bb); if(isNaN(AP[BD])||BE||(_7G||_7F)&&this.G2(AP,BD)){ if(this.G2(AP,BD)){ Bb=this.PU(Bb); if(Bb)AP[BD]=(Bb-0)+""==Bb?Bb-0:Bb;} else AP[BD]=f3?DY._7A6(Bb):DY._7o(Bb);}}} else if(type=="Float"||type=="Int"){ if(!Bb){if(Bb!==0)AP[BD]=DY.EmptyNumber!=null||this.G2(AP,BD)?"":0;} else if(typeof(Bb)=="string"&&((Bb-0)+""==Bb||!this.G2(AP,BD)))AP[BD]-=0;} else if(type=="Select"){ AP[BD+"Button"]="Defaults"; AP[BD+"CanEdit"]=0; AP[BD+"Type"]="Html"; if(AP[BD+"CanFocus"]==null)AP[BD+"CanFocus"]=0;}}} if(AP.Calculated){ var Ia=AP.CalcOrder;if(Ia==null)Ia=AS.CalcOrder; if(!Ia){ Ia=""; for(var i=0;i<Au;i++){ var G3=HU[i]+"Formula"; var Cq=AP[G3];if(Cq==null)Cq=AS[G3]; if(Cq)Ia+=(Ia?",":"")+HU[i];} AP.CalcOrder=Ia;} if(this.Calculating==null)this.Calculating=1;}}; _7h.prototype.f9=function(row,HU,f5,f6){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ this.f4(AP,HU,f5,f6); if(AP.firstChild)this.f9(AP,HU,f5,f6);}}; _7h.prototype.gA=function(Gy,HU,f5){ var BC=Gy.Children; if(!BC)return; for(var i=0;i<BC.length;i++){ var BM=BC[i]; if(!BM.Def)BM.Def='R'; this.f4(BM,HU,f5); this.gA(BM,HU,f5);}}; _7h.prototype.gB=function(AP,HU,f5,f6){ AP.OU=1; this.gA(AP,HU,f5); var BD,BM,gC=0,Au=HU.length,C=this.Cols,DY=this.Lang.Format,BE=DY.GMT-0,f3=0; for(var i=0;i<Au;i++){ BD=HU[i]; var type=AP[BD+"Type"];if(type==null)type=C[BD].Type; if(type=="Date"){ BM=AP[BD]; if(!BM){if(BM!==0)AP[BD]=DY.EmptyDate!=null||AP[BD+"Range"]?"":0;} else if((BM-0)+""!=BM){ AP[BD]=Date.parse(BM); if(isNaN(AP[BD])||BE){ if(AP[BD+"Range"]){ BM=this.PU(BM); if(BM)AP[BD]=(BM-0)+""==BM?BM-0:BM;} else AP[BD]=f3?DY._7A6(BM):DY._7o(BM);}}} else if(type=="Float"||type=="Int"){ if(!AP[BD]){if(AP[BD]!==0)AP[BD]=DY.EmptyNumber!=null||AP[BD+"Range"]?"":0;} else if(typeof(AP[BD])=="string"&&(!AP[BD+"Range"]||(AP[BD]-0)+""==AP[BD]))AP[BD]-=0;} if(AP[BD+"CopyTo"])gC=1;} if(gC)AP._7A1=1; if(AP.Calculated&&this.Calculating==null)this.Calculating=1; if(AP.Spanned)this.HS(AP);}; _7h.prototype.gD=function(AP){ var R=this.Def[AP.Def]; if(R)this.gD(R); for(var i in R)if(AP[i]==null)AP[i]=R[i]; delete AP.Def;}; _7h.prototype.gE=function(HU,f5){ var X=this.Def; for(var gF in X)if(X[gF].Def)this.gD(X[gF]); for(var gF in X){ var AP=this.Def[gF]; if(!AP.OU)this.gB(AP,HU,f5);}}; _7h.prototype.Ye=function(row){ var C=this.Cols,HU=[],f5=[],Au=0; for(var BD in C)if(C[BD].Type!="Panel"){f5[Au]=BD+"Type";HU[Au++]=BD;} this.gE(HU,f5); this.f9(row,HU,f5);}; _7h.prototype.Nb=function(){ if(this.RootCount&&this.XB.lastChild.Count==null)this.XB.lastChild.Count=this.RootCount-(this.XB.childNodes.length-1)*this.PageLength; for(var Au=this.XB.firstChild,AO=0;Au;Au=Au.nextSibling){ if(Au.State==null)Au.State=Au.firstChild||this.Paging!=3?2:0; Au.Page=1; Au.Pos=AO++; if(Au.State>=2)Au.Count=null; else if(!Au.Count)Au.Count=this.PageLength; if(!this.XB.gG&&Au.firstChild)this.Ye(Au);}}; _7h.prototype.N0=function(){ var C=this.Cols,HU=new Array(),f5=new Array(),Au=0; var R=this.Def["R"],BE=this.Lang.GMT-0,f3=0; for(var BD in C){ if(BD=="Panel")continue; f5[Au]=BD+"Type"; HU[Au++]=BD; if(R[BD]==null)R[BD]=""; if(C[BD].Type=="Select"){ C[BD]["Button"]="Defaults"; C[BD]["CanEdit"]=0; C[BD]["Type"]="Html"; if(C[BD]["CanFocus"]==null)C[BD]["CanFocus"]=0;}} this.gE(HU,f5); if(this.Calculating==null)for(var BD in C)if(C[BD].Formula){this.Calculating=1;break;} var R=this.GetFixedRows(),gH=this.XH.childNodes.length; for(var i=0;i<R.length;i++){ var AP=R[i]; if(!AP.Def)AP.Def=AP.Kind=="Header"?"Header":"Fixed"; this.f4(AP,HU,f5,AP.Kind=="Header"); AP.Fixed=i>=gH?"Foot":"Head";} var f6=this.Prepared; for(var AN=this.XB.firstChild;AN;AN=AN.nextSibling)this.f9(AN,HU,f5,f6); this.XB.firstChild.Page=1; if(!this.Paging){ this.XB.firstChild.State=4; var CE=this.XB.firstChild; if(CE.nextSibling){ for(var AN=CE.nextSibling;AN;AN=CE.nextSibling){ for(var AP=AN.firstChild;AP;AP=AN.firstChild)CE.appendChild(AP); this.XB.removeChild(AN);}}} else if(this.Paging==2){ for(var Ey=this.XB.firstChild;Ey;Ey=Ey.nextSibling){ Ey.Page=1; Ey.State=2;}} else if(this.Paging==3){ if(this.Nb)this.Nb(); else _7Ae("ReloadBody");} if(this.Calculating==null)this.Calculating=0; for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){ if(Is(AP,"Panel")&&AP.Cells&&AP.Cells[0]!="Panel")AP.Cells.unshift("Panel"); AP["PanelType"]="Panel";if(AP.Panel-0)AP.Panel=""; if(AP.Space==0)AP.Space='0';} for(var AP=this.XS.firstChild;AP;AP=AP.nextSibling){ var gI=AP.Cells; var gJ=new Array(); if(gI){ for(var i=0;i<gI.length;i++)gJ[i]=gI[i]+"Type";} else gI=new Array(); this.f4(AP,gI,gJ);}}; _7h.prototype.GetValue=function(row,F6){ var Bb=Get(row,F6),type=this.GetType(row,F6); switch(type){ case "Int": case "Float": if(Bb===""&&this.Lang.Format.EmptyNumber!=null)return ""; if(Bb&&typeof(Bb)=="string"&&this.G2(row,F6))return Bb; return Bb?Bb-0:0; case "Bool": return Bb?Bb-0:0; case "Date": if(Bb===""&&this.Lang.Format.EmptyDate!=null)return ""; if(typeof(Bb)=="string"&&this.G2(row,F6))return Bb; return Bb?Bb-0:0; case "Enum": return Bb-0+""==Bb?Bb-0:Bb; case "Radio":return Bb; default:return Bb==null?"":Bb;}}; _7h.prototype.GetString=function(row,F6,gK){ var type=this.GetType(row,F6),Value=Get(row,F6),DY=this.Lang.Format; switch(type){ case "Text": case "Lines":return DY.Ez(Value,this.GetFormat(row,F6,gK==4),0); case "Int": case "Float":return Value===""&&DY.EmptyNumber!=null?DY.EmptyNumber:DY.NumberToString(Value,this.GetFormat(row,F6,gK==4),this.G2(row,F6)); case "Date":return Value===""&&DY.EmptyDate!=null?DY.EmptyDate:DY.DateToString(Value,this.GetFormat(row,F6,gK==4),this.G2(row,F6)); case "Bool":return!Value?"0":"1"; case "Enum":return this.HB(row,F6,0); case "Radio": var BA=this.GetFormat(row,F6,gK==4); if(!BA)return Value+""; BA=BA.split(BA.charAt(0)); if(BA.length<=7)return Value+""; Value-=0; if(!Value||Value<0)Value=0; Value+=7; if(Value>=BA.length)Value=BA.length-1; return BA[Value]; case "Pass": return gK?"":Value+""; case "Link": if(Value=="")return ""; if(!gK||gK==1)return Value; Value=Value.split(Value.charAt(0)); return Value[2]!=null?Value[2]:(Value[1]!=null?Value[1]:""); case "Img": if(!gK||gK==1)return Value; Value=Value.split(Value.charAt(0)); return Value[6]!=null?Value[6]:(Value[1]!=null?Value[1]:""); case "Html": return Value+""; case "Abs": case "Gantt": return Value+""; case "List": return Value+""; default:return "";}}; _7h.prototype.SetString=function(row,F6,Value,refresh){ var type=this.GetType(row,F6); if(type=="Float"&&Value-0+""==Value&&!this.G2(row,F6))Value-=0; if(type=="Date"){ var BM=Value; if(BM&&(BM-0)+""!=BM){ Value=Date.parse(BM); if(isNaN(Value)||this.Lang.Format.GMT-0){ if(this.G2(row,F6)){ BM=this.PU(BM); if(BM)Value=(BM-0)+""==BM?BM-0:BM;} else Value=this.Lang.Format.StringToDate(BM,this.GetFormat(row,F6));}}} this.SetValue(row,F6,Value,refresh); return this.GetString(row,F6);}; _7h.prototype.SetValue=function(row,F6,Value,refresh,Op,ae){ var Bb=this.GetValue(row,F6); if(Value==Bb&&(Value||Value===Bb)){ if(!Value&&!isNaN(Value)&&isNaN(row[F6])&&row[F6]!=null); else return false;} if(!row.LN){ if(this.StoreOriginalValues&&!row[F6+"Changed"])row[F6+"Orig"]=Bb; if(row.Kind!="Filter"&&!row.NoUpload)this.ab({Type:"Change",Row:row,Col:F6,fd:Bb,fh:Value,fe:row.Changed,ff:row[F6+"Changed"]}); row.Changed=1; row[F6+"Changed"]=1;} row[F6]=Value; if(!Op){ if(row.MasterRow){ this.J6.SetValue(row.MasterRow,F6,Value,1,1,ae);} if(row.DetailRow&&!row.DetailRow.Page){ row.DetailGrid.SetValue(row.DetailRow,F6,Value,1,1,ae);}} var H4=Get(row,F6+"CopyTo"); if(H4){ H4=H4.split(','); for(var i=0;i<H4.length;i+=2){ var AP=null; if(H4[i]=="Parent")AP=row.parentNode; else if(H4[i]=="Next")AP=row.nextSibling; else if(H4[i]=="Prev")AP=row.previousSibling; else{ var B3=H4[i].split('_'),Au=null; if(B3[0]=="Child")Au=row; else if(B3[0]=="Sibling")Au=row.parentNode; else if(B3[0]=="Children"){ for(var AP=row.firstChild;AP;AP=AP.nextSibling)if(!B3[1]||AP.Def.Name==B3[1]){ this.SetValue(AP,H4[i+1],Value,1,0,ae); if(this.Qa)this.Qa(AP,H4[i+1]);} continue;} if(Au){ if(B3[1]-0+""==B3[1])AP=_7k(Au,B3[1]); else for(var AP=Au.firstChild;AP;AP=AP.nextSibling)if(AP.Def.Name==B3[1])break;} else AP=this.GetRowById(H4[i]);}; if(AP){ this.SetValue(AP,H4[i+1],Value,1,0,ae); if(this.Qa)this.Qa(AP,H4[i+1]);}}} if(row.Def.Group&&F6==this.MainCol){ var T=this; for(var Ve=-1,GP=row;GP.Def&&GP.Def.Group;GP=GP.parentNode,Ve++); Ve=this.GroupCols[Ve]; function Wq(row){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(AP.Def&&AP.Def.Group)Wq(AP); else T.SetValue(AP,Ve,Value,1,0,ae);}}; Wq(row); if(this.AutoUpdate){ row.Changed=null; row[F6+"Changed"]=null;}} if(this.SaveAttrs)this.Jp(row,F6); var Md=row.firstChild; if(Md&&Md.LN){ for(;Md;Md=Md.nextSibling)this.SetValue(Md,F6,Value,1,1,ae);} if(!ae)this.DoAction(row,F6); if(this.StoreOriginalValues){ var gL=row[F6+"Orig"]; if(gL==Value&&(Value||gL===Value)){ row[F6+"Changed"]=null; var BC=0; for(var Fa in this.Cols)if(row[Fa+"Changed"]){BC=1;break;} if(!BC)row.Changed=null;}} if(this.Om&&this.Om[F6])this.am(row); if(row.Kind!="Filter"&&!ae)this.Recalculate(row,F6,true); if(!Op&&!ae){ if(row.MasterRow)this.J6.UploadChanges(row.MasterRow); else this.UploadChanges(row);} if(refresh){ if(this.ColorClasses&1)this.RefreshRow(row); else{this.RefreshCell(row,F6);this.ColorRow(row);}} return true;}; _7h.prototype.SetWidth=function(F6,Ca,Ij,Yd,gM){ var C=this.Cols[F6],Hj=C.Sec,gN=C.Width,A5=C.Width+Ca,AI=this.Img,bL=0; var min=AI.Ki+AI.Kj;if(min<C.MinWidth)min=C.MinWidth; if(Ca==null){ if(!C.Visible){ if(C.Hidden){ A5=C.Width;Ca=C.Width;gN=0; C.Visible=1;C.Hidden=0;} else{}} else{ A5=0;bL=1;Ca=-C.Width; C.Visible=0;C.Hidden=1;}} else if(A5<min){ if(C.RelWidth)A5=0; else{ if(C.Ja){C.RelWidth=C.Ja;if(!Yd)this.Update();return;} C.JZ=true; if(min>=20)C.Width=min; else this.CalcWidth(F6,1); Ca=C.Width+Ca-A5; A5=C.Width;}} else if(!gM){ C.Width=A5; C.JZ=false;} var S=this.ColNames[Hj],Cols=this.Cols,KH=this.MainCol,Ka=0,AO=C.KK; var M=Cols[KH];if(M&&M.Sec==C.Sec&&M.KK>=0&&M.KK<=C.KK){Ka=1;AO--;} var KU=C.WidthPad,gO=0; if(KU){ A5-=KU;gN-=KU; if(A5<AI.Kj){KU+=A5-AI.Ki;A5=AI.Ki;gO=1;} else if(gN<AI.Kj)gO=1; if(KU<0)KU=0;} if(bL){KU=0;A5=0;} var KS=this.ChildPages; function gP(row,AP){ var H6=AP.firstChild.rows[0].cells[AO]; H6.style.width=A5+"px"; if(gO)H6.nextSibling.style.width=KU+"px"; if(row){ for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(AP.r1&&AP._7AZ==4){ if(!KS)gP(AP,AP[KV].nextSibling.cells[0]); else for(var V9=AP[KV].nextSibling.cells[0].firstChild;V9;V9=V9.nextSibling)if(V9.firstChild&&V9.firstChild.nodeType==1)gP(AP,V9);}}}}; function gQ(row,AP,A5,Ss,gR){ var H6=AP.firstChild.rows[0].cells[AO]; H6.style.width=A5+"px"; if(gO)H6.nextSibling.style.width=KU+"px"; if(gR)H6.previousSibling.style.width=Ss+"px"; if(_7N&&gM)H6.colSpan=1; if(!bL){ A5-=AI.Line;Ss+=AI.Line; if(A5<AI.Ki){Ss+=A5-AI.Ki;A5=AI.Ki;gR=1;} else if(gN-Ss<AI.Ki)gR=1;} for(var AP=row.firstChild;AP;AP=AP.nextSibling){ if(AP.r1&&AP._7AZ==4){ if(!KS)gQ(AP,AP[KV].nextSibling.cells[0],A5,Ss,gR); else for(var V9=AP[KV].nextSibling.cells[0].firstChild;V9;V9=V9.nextSibling)if(V9.firstChild&&V9.firstChild.nodeType==1)gQ(AP,V9,A5,Ss,gR);}}}; if(!gM){ if(this.L[Hj])gP(null,this.L[Hj]); if(this.O[Hj])gP(null,this.O[Hj]);} var KV="r"+Hj;if(Ka)AO++; if(F6==KH){ var FX=-1,gR=0; if(this.HideRootTree)FX--; if(gM){FX=gM.Level;gR=1;} var Ss=(FX+1)*AI.Line+AI.Tree+AI.Kj; if(FX==-2)Ss=AI.Kj; if(this.SpannedTree){Ss=0;gR=0;bL=1;} else if(bL){Ss=0;gR=1;} else{ A5-=Ss; if(A5<AI.Ki){Ss+=A5-AI.Ki;A5=AI.Ki;gR=1;} else if(gN-Ss<AI.Ki)gR=1;}; if(gM){ if(!KS)gQ(gM,gM[KV].nextSibling.cells[0],A5,Ss,gR); else for(var V9=gM[KV].nextSibling.cells[0].firstChild;V9;V9=V9.nextSibling)if(V9.firstChild&&V9.firstChild.nodeType==1)gQ(gM,V9,A5,Ss,gR);} else for(var row=this.XB.firstChild;row;row=row.nextSibling)if(row.r1&&row.State==4){ gQ(row,row[KV],A5,Ss,gR);}} else if(gM){ if(!KS)gP(gM,gM[KV].nextSibling.cells[0]); else for(var V9=gM[KV].nextSibling.cells[0].firstChild;V9;V9=V9.nextSibling)if(V9.firstChild&&V9.firstChild.nodeType==1)gP(gM,V9);} else for(var row=this.XB.firstChild;row;row=row.nextSibling)if(row.r1&&row.State==4)gP(row,row[KV]); if(Ca<0)this.Kc(); if(!Yd)this.Update(1); if(Grids.OnColResize)Grids.OnColResize(this,F6);}; _7h.prototype.Il=function(AP,Cn){ if(!this.N[1]||!AP.r1||this.Y2)return; var gS=null,LE=0; if(!Cn){ Cn=AP.r1.clientWidth; if(!Cn)Cn=AP.r1.parentNode.offsetWidth; var GM=AP.dO;if(GM)Cn-=GM;} var A5=AP.r1.firstChild.rows[0].cells; A5=A5[A5.length-1]; if(!A5)return; A5=A5.offsetWidth+A5.offsetLeft; for(var i=0;i<AP.Cells.length;i++){ var BD=AP.Cells[i],Lp=AP[BD+"RelWidth"]; if(Lp){ var H6=this.GetCell(AP,BD); if(H6){ A5-=H6.offsetWidth; LE+=Lp; var GW=AP[BD+"MinWidth"]; if(GW)Cn-=GW; gS=BD;}}} Cn-=A5; var dC=Cn; for(var i=0;i<AP.Cells.length;i++){ var BD=AP.Cells[i],Lp=AP[BD+"RelWidth"]; if(Lp){ var A5=Math.floor(Cn*Lp/LE);if(A5<0)A5=1; if(BD==gS&&dC>0)A5=dC; dC-=A5; var GW=AP[BD+"MinWidth"]; if(GW)A5+=GW; var H6=this.GetCell(AP,BD); if(H6&&H6.offsetWidth!=A5){ H6.firstChild.style.width=A5+"px"; H6.firstChild.style.overflow="hidden"; if(H6.offsetHeight!=H6.firstChild.offsetHeight)H6.parentNode.firstChild.innerHTML=H6.parentNode.firstChild.innerHTML; if(H6.offsetWidth!=A5){ A5=A5*2-H6.offsetWidth; if(A5>0)H6.firstChild.style.width=A5+"px";}}} if(AP[BD+"Type"]=="DropCols"){ var H6=this.GetCell(AP,BD,1); var Bb=Get(AP,BD); if(Bb&&H6){ Bb=(Bb+"").split(","); var gT=Math.floor((H6.parentNode.offsetWidth-40)/Bb.length); if(gT<=0)continue; for(var j=0;j<Bb.length;j++){ if(Bb[j]&&this.Cols[Bb[j]]&&gT<this.Cols[Bb[j]].Width){ var style=H6.firstChild.firstChild.rows[0].cells[j].firstChild.style; if(style)style.width=gT+"px";}}}}} if(AP.YJ)this.YL(AP);}; _7h.prototype.CalcWidth=function(F6,gU){ var C=this.Cols[F6]; if(C.Type=="Panel")return; var Kg=C.Visible;C.Visible=1; var E=document.createElement("div"); E.className="GridTmpTag"; B2(E); var AJ=[],max=100,AI=this.Img,gV=this.SpannedTree; if(F6==this.MainCol)this.SpannedTree=1; var CE=this.GetFixedRows(); for(var i=0;i<CE.length;i++){ var row=CE[i]; if(row.Spanned&&row[F6+"Span"]!=1)continue; AJ[AJ.length]="<tr>";if(F6==this.MainCol)AJ[AJ.length]="<td></td>"; this.KY(row,AJ,AJ,AJ,0,F6,null,1); AJ[AJ.length]="</tr>";} for(var row=this.GetFirstVisible();row&&max;row=this.GetNextVisible(row,1)){ if(row.Spanned&&row[F6+"Span"]!=1)continue; AJ[AJ.length]="<tr>"; this.KY(row,AJ,AJ,AJ,0,F6,null,1); AJ[AJ.length]="</tr>"; max--;} E.innerHTML=_7A+_7B+AJ.join("")+_7C; var KN=E.firstChild.offsetWidth,GW=this.MainTag.offsetWidth;if(!GW)GW=GetWindowSize()[0]-20; if(KN>GW-10)KN=GW-10; if(KN<C.MinWidth)KN=C.MinWidth; C.Visible=Kg; this.SpannedTree=gV; document.body.removeChild(E); if(!gU&&C.Visible&&!this.Loading&&!this.Rendering&&this.N[1])this.SetWidth(F6,KN-C.Width); C.Width=KN;}; function _7A7(){ this.nodeType=1; this.attributes=[]; this.childNodes={length:0};}; _7A7.prototype.removeChild=function(AL){ if(!AL)return null; var AM=AL.parentNode; if(!AM)return null; if(AL==AM.firstChild)AM.firstChild=AL.nextSibling; else AL.previousSibling.nextSibling=AL.nextSibling; if(AL==AM.lastChild)AM.lastChild=AL.previousSibling; else AL.nextSibling.previousSibling=AL.previousSibling; AL.parentNode=null; AL.previousSibling=null; AL.nextSibling=null; this.childNodes.length--; return AL;}; _7A7.prototype.appendChild=function(AL){ if(!AL)return null; if(AL.parentNode)AL.parentNode.removeChild(AL); if(this.lastChild){ this.lastChild.nextSibling=AL; AL.previousSibling=this.lastChild;} else{ this.firstChild=AL; AL.previousSibling=null;}; this.lastChild=AL; AL.nextSibling=null; AL.parentNode=this; AL.index=this.childNodes.length++; return AL;}; _7A7.prototype.insertBefore=function(AL,C){ if(!AL)return null; if(!C)return this.appendChild(AL); if(AL.parentNode)AL.parentNode.removeChild(AL); if(C.previousSibling)C.previousSibling.nextSibling=AL; else this.firstChild=AL; AL.previousSibling=C.previousSibling; AL.nextSibling=C; AL.parentNode=this; AL.index=this.childNodes.length++; return AL;}; _7A7.prototype.getAttribute=function(name){return this[name];}; _7A7.prototype.hasAttribute=function(name){return this[name]!=undefined;}; _7A7.prototype.setAttribute=function(name,value){ var AJ=this.attributes; if(this[name]==undefined){ this[name]=value; AJ[AJ.length]={nodeName:name,nodeValue:value}} else{ this[name]=value; for(var i=0;i<AJ.length;i++)if(AJ[i].nodeName==name){AJ[i].nodeValue=value;break;}}}; _7A7.prototype.getElementsByTagName=function(name){ var AJ=[]; for(var AP=this.firstChild;AP;AP=AP.nextSibling){ if(AP.nodeName==name)AJ[AJ.length]=AP; if(AP.firstChild){ var AN=AP.getElementsByTagName(name); if(AN.length)AJ.concat(AN);}} return AJ;}; function _7A8(){}; _7A8.prototype=new _7A7(); _7A8.prototype.createElement=function(name){ var E=new _7A7(); E.tagName=name; E.nodeName=name; return E;}; function _7A9(AN,AJ){ var B3="<"+AN.tagName; for(a in AN){ var Ak=typeof(AN[a]); if(a!='tagName'){ if(Ak=="string")B3+=" "+a+"=\""+AN[a].replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/"/g,"&quot;").replace(/\n/g,"&#x0A;")+"\""; else if(Ak=="number")B3+=" "+a+"=\""+AN[a]+"\""; else if(Ak=="boolean")B3+=" "+a+"=\""+(AN[a]?1:0)+"\"";}} if(AJ){ if(AN.firstChild){ AJ[AJ.length]=B3+">"; for(var AP=AN.firstChild;AP;AP=AP.nextSibling)_7A9(AP,AJ); AJ[AJ.length]="</"+AN.tagName+">";} else AJ[AJ.length]=B3;} else if(AN.firstChild){ B3+=">"; for(var AP=AN.firstChild;AP;AP=AP.nextSibling)B3+=_7A9(AP); B3+="</"+AN.tagName+">"; return B3;} else return B3+"/>";}; function _7BA(Xml,gW,Parent){ var AM=Parent?Parent:gW; var gX=/[^\s\/\>]/; var AP=/\w+|\'[^\']*\'|\"[^\"]*\"|\/?\>[\s\S]*/g; Xml=Xml.replace(/<!--[\s\S]*?-->/g,""); var Md=Xml.search(/\<\w+\>/); if(Md<0)return false; Xml=Xml.slice(Md+1); var AJ=Xml.split('<'),OM=AJ.length; function OI(Dh){ if(Dh.indexOf('&#')>=0){ var AJ=Dh.match(/\&\#x\w*\;/g); if(AJ)for(var i=0;i<AJ.length;i++)Dh=Dh.replace(AJ[i],String.fromCharCode(parseInt(AJ[i].slice(3),16))); var AJ=Dh.match(/\&\#\w*\;/g); if(AJ)for(var i=0;i<AJ.length;i++)Dh=Dh.replace(AJ[i],String.fromCharCode(parseInt(AJ[i].slice(2),10)));} return Dh.replace(/\&lt\;/g,"<").replace(/\&gt\;/g,">").replace(/\&quot\;/g,"\"").replace(/\&apos\;/g,"'").replace(/\&amp\;/g,"&");}; for(var i=0;i<OM;i++){ var B3=AJ[i]; if(B3.charCodeAt(0)==47){ AM=AM.parentNode; if(!AM)return false; continue;} var AN=B3.match(AP),GM=AN.length-1; AL=gW.createElement(AN[0]); AM.appendChild(AL); for(var j=1;j<GM;j+=2){ var Dh=AN[j+1].slice(1,-1); if(Dh.indexOf('&')>=0)Dh=OI(Dh); Dh=(Dh-0)+""==Dh?Dh-0:Dh; AL.setAttribute(AN[j],Dh);} var B3=AN[GM],Ak=0; if(B3.charCodeAt(0)!=47){ AM=AL; if(B3.length>6||B3.search(gX)>=0)Ak=1;} else if(B3.length>7||B3.search(gX)>=0)Ak=2; if(Ak){ Ak=B3.slice(Ak); if(Ak.indexOf('&')>=0)Ak=OI(Ak); var T=gW.createElement("#text"); T.nodeType=3; T.nodeValue=Ak; AM.appendChild(T);}} gW.documentElement=gW.firstChild; return true;}; function _7As(Ep){ var GG=new _7A8(); if(_7BA(Ep,GG))return GG; return null;}//]]></script>
<script type="text/javascript" src="/Agile/static/d30f16e623c7dc358f8d4a25f4cd848e/release/agile-fileupload-min.js"></script>


	



<!-- #########################################################################################
     COQSOFT TreeGrid JS files. These files are included in these order for debugging purpose.
     ######################################################################################### -->




 



<script>
	// intialize attachment related variables
	hcmCONTEXT_TYPE = 'ContextType';
	hcmOBJECTNAME = 'objectname';
	hcmREVSELECTNAME = 'revSelectName';
    hcmVERSIONSELECTNAME = 'VERSION_SELECT_NAME';
	hcmVERSION_CONTROL_ITEM_CLASS_ID = 'versionControlItemClassId';
	hcmVERSION_CONTROL_ITEM_OBJ_ID = 'versionControlItemObjId';
	hcmVERSION_CONTROL_ITEM_ROW_ID = 'versionControlItemRowId';
	hcmVERSION = 'version';
	hcmIS_FROM_ATTACHMENT_VERSION_VIEWER = 'fromAttachmentVersionViewer';
	hcmREQUEST_FROM = 'REQUEST_FROM';
	hcmADVANCE_COMPARE_FILES_ACTION = 'advanceCompareFiles';
	hcmBATCH_PRINT_ACTION = 'batchPrint';
	hcmVIEW_MULTIPLE_FILES_ACTION = 'viewMultipleFiles';
	hcmJVUE_ACTION = 'jvueAction';
	hcmCOMPARE_FILES_ACTION = 'compareFiles';
	hcmOVERLAY_FILES_ACTION = 'overlayFiles';
	hcmCROSS_PROBE_FILES_ACTION = 'crossProbeFiles';
	hcmMOCKUP_FILES_ACTION = 'mockupFiles';
	hcmTABLE_ID = 'tableId'; 
	hcmVERSION_CONTROL_ITEM_CLASS_ID = 'versionControlItemClassId'; 
	adminCLASS_ATTACHMENT = '6159';
	adminFILE_UPLOAD_MODE_STANDARD = 1; 
	cmtypeATTACHMENT_ALL_FILES = 0
	hcmQUICKADD = 'QUICKADD';	
	hcmCURRENTROWID = 'currentrowid';
	hcmUSER_SELECTED_FILEOPMODE = 'USER_SELECTED_FILEOPMODE';
	hcmUSER_SELECTED_STRUCTURE_MODE = 'USER_SELECTED_STRUCTURE_MODE';
	hcmATTACHMENT_NUMBER = 'attachmentNumber';
	hcmFROM_CHECKOUT_BO = 'FROM_CHECKOUT_BO';
	hcmGOTO_STEP = 'goToStep';
	hcmFROM_CHECKIN_BO = 'FROM_CHECKIN_BO';
	hcmFROM_GETBOFILES = 'FROM_GETBOFILES';
	hcmREPLACE_ROW_ID = 'replaceRowId';
	hcmFILENAME = 'fileName';
	ATT_FILEFILENAME_ID = "1046";
	ATTACHMENT_ALL_FILES_ID = "0";
	ATTACHMENT_ALL_FILES_LABEL = "[All Files]";
	ATTACHMENT_LATEST_VSN_ID = '9999';
	ATT_FILEVERSION_ID = '3622';
	TABLE_ROW_INFO_ID = '1234567';
	cmtypeATT_FILEFILENAME = '1046';
	cmtypeATTACHMENT_ALL_FILES = 0;
	cmTypeREV_CHANGE_DELIMITER = 	'        ';	
    hcmIS_FROM_PREVIEW_PANE = 'IS_FROM_PREVIEW_PANE';
	hcmFROM_GETFILES = 'FROM_GETFILES';

    revFldName = 'R1_1014_0';
    versionFldName = 'R1_7951_0';
	hcmFROM_ATTACHMENT_VERSIONS = 'JVUE_FROM_SHOW_VERSIONS'; 
	hcmFROMGETALLFILES = 'fromGetAllFiles'; 
	hcmREDLINE_ATTACHMENTS = 'REDLINE_ATTACHMENTS';
	hcmVIEW_REDLINE_ATTACHMENTS = 'VIEW_REDLINE_ATTACHMENTS'; 	

    
    userFileUploadMode = 1;
	structureGetMode = 3;
</script>

	


	<script type="text/javascript">
	    registerNS("AGILE.security.csrf");
	    AGILE.security.csrf.tokenName = "AGILE_CSRF_TOKEN_NAME";
	    AGILE.security.csrf.tokenValue = "irSddVHz9tWrM43JllSRIxIzvJEBd6kh";
	</script>    

<script type="text/javascript">isPageLoading=true;</script><script type="text/javascript">
var tree_gST = null;
function loadSearchTree() {
tree_gST = new YAHOO.widget.AgileTreeView("searchTree");
tree_gST.setTreeContextInfo("1", "gST", "PCMServlet", "LeftPaneHandler", "updateExpansions", "loadTreeNodes", true, 
false);
tree_gST.setDynamicLoad(loadDataForNode, 1);
var treeNode_Searches = new YAHOO.widget.AgileRootNode(new TreeNode("_nodeId_Searches", "Searches", "Searches","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, true, true, "Searches", "emphasis", false),tree_gST.getRoot(), true);
var treeNode_4_100_100 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_100_100", "Global Searches", "Global Searches","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, true, "4_100_100", null, true, -1), treeNode_Searches, false);
var treeNode_4_232333079_232333079 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_232333079_232333079", "Personal Searches", "Personal Searches","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, true, "4_232333079_232333079", null, true, -1), treeNode_Searches, false);
tree_gST._el.onkeydown  = function (evt) { tree_gST.handleKeyDownEvent(evt); }; 
tree_gST.draw();
} 
var namesArrgST = new Array();
namesArrgST[0]="Global Searches";namesArrgST[1]="Personal Searches";namesArrgST[2]="My Bookmarks";</script><script type="text/javascript">
var tree_fT = null;
function loadBookmarkTree() {
tree_fT = new YAHOO.widget.AgileTreeView("bookmarkTree");
tree_fT.setTreeContextInfo("1", "fT", "PCMServlet", "LeftPaneHandler", "updateExpansions", "loadTreeNodes", true, 
false);
tree_fT.setDynamicLoad(loadDataForNode, 1);
var treeNode_Bookmark = new YAHOO.widget.AgileRootNode(new TreeNode("_nodeId_Bookmark", "My Bookmarks", "My Bookmarks","javascript:noaction();", null, "/Agile/static/ce36d627199915d0fdf0d5289e01a113/images/bookmark.png", "/Agile/static/ce36d627199915d0fdf0d5289e01a113/images/bookmark.png", null, null, null, true, true, "Bookmark", "emphasis", false),tree_fT.getRoot(), true);
tree_fT._el.onkeydown  = function (evt) { tree_fT.handleKeyDownEvent(evt); }; 
tree_fT.draw();
tree_fT.registarDD();
} 
var namesArrfT = new Array();
namesArrfT[0]="Global Searches";namesArrfT[1]="Personal Searches";namesArrfT[2]="My Bookmarks";</script><script type="text/javascript">
var tree_RV = null;
function loadRecentlyVisitedTree() {
tree_RV = new YAHOO.widget.AgileTreeView("recentlyVisitedTree");
tree_RV.setTreeContextInfo("RV", "RV", "PCMServlet", "LeftPaneHandler", "updateExpansions", "loadTreeNodes", false, 
false);
var treeNode_RVisited = new YAHOO.widget.AgileRootNode(new TreeNode("_nodeId_RVisited", "Recently Visited", "Recently Visited","javascript:noaction();", null, "/Agile/static/18dab1e1dd3c80e8e86ef3d67355795d/images/history.png", "/Agile/static/18dab1e1dd3c80e8e86ef3d67355795d/images/history.png", null, null, null, true, true, "RVisited", "emphasis", false),tree_RV.getRoot(), true);
var treeNode_4878_232336885 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232336885", "FA-0505813 : IQS2.0 PID Profile for QSFP-100G-AOC7M= - Criteria = Customer Name - T-MOBILE: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801773207: Service Request No - 692011554: Service Contract No - 200941956:,", "FA-0505813 : IQS2.0 PID Profile for QSFP-100G-AOC7M= - Criteria = Customer Name - T-MOBILE: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801773207: Service Request No - 692011554: Service Contract No - 200941956:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232336885', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232336885", null, true, 4750), treeNode_RVisited, false, true, '4878','232336885','null');
var treeNode_4878_230433739 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_230433739", "FA-0481375 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - DEUTSCHE BANK AG: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801511178: Service Request No - 691118129: Service Contract No - 203229531:,", "FA-0481375 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - DEUTSCHE BANK AG: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801511178: Service Request No - 691118129: Service Contract No - 203229531:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '230433739', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_230433739", null, true, 4750), treeNode_RVisited, false, true, '4878','230433739','null');
var treeNode_4878_232594404 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232594404", "FA-0509042 : IQS2.0 PID Profile for QSFP-100G-PSM4-S= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801817212: Service Request No - 639843408: Service Contract No - 200214276:,", "FA-0509042 : IQS2.0 PID Profile for QSFP-100G-PSM4-S= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801817212: Service Request No - 639843408: Service Contract No - 200214276:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232594404', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232594404", null, true, 4750), treeNode_RVisited, false, true, '4878','232594404','null');
var treeNode_4878_232580233 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232580233", "FA-0508853 : IQS2.0 PID Profile for QSFP-40G-SR-BD= - Criteria = Customer Name - OKI CROSSTECH LTD: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801808576: Service Request No - 639841849: Service Contract No - 201258888:,", "FA-0508853 : IQS2.0 PID Profile for QSFP-40G-SR-BD= - Criteria = Customer Name - OKI CROSSTECH LTD: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801808576: Service Request No - 639841849: Service Contract No - 201258888:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232580233', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232580233", null, true, 4750), treeNode_RVisited, false, true, '4878','232580233','null');
var treeNode_4878_232542031 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232542031", "FA-0508413 : IQS2.0 PID Profile for GLC-LH-SMD= - Criteria = Customer Name - IBM JAPAN LTD: Return Reason Code - OHW2: Theater - JPN: RMA Number - 801809027: Service Request No - 639841954: Service Contract No - 95281942:,", "FA-0508413 : IQS2.0 PID Profile for GLC-LH-SMD= - Criteria = Customer Name - IBM JAPAN LTD: Return Reason Code - OHW2: Theater - JPN: RMA Number - 801809027: Service Request No - 639841954: Service Contract No - 95281942:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232542031', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232542031", null, true, 4750), treeNode_RVisited, false, true, '4878','232542031','null');
var treeNode_4878_232539535 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232539535", "FA-0508324 : IQS2.0 PID Profile for XFP-10G-MM-SR= - Criteria = Customer Name - ARVATO DISTRIBUTION GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801806470: Service Request No - 639841497: Service Contract No - 91449988:,", "FA-0508324 : IQS2.0 PID Profile for XFP-10G-MM-SR= - Criteria = Customer Name - ARVATO DISTRIBUTION GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801806470: Service Request No - 639841497: Service Contract No - 91449988:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232539535', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232539535", null, true, 4750), treeNode_RVisited, false, true, '4878','232539535','null');
var treeNode_4878_232538200 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232538200", "FA-0508284 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803611: Service Request No - 639840892: Service Contract No - 204025098:,", "FA-0508284 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803611: Service Request No - 639840892: Service Contract No - 204025098:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232538200', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232538200", null, true, 4750), treeNode_RVisited, false, true, '4878','232538200','null');
var treeNode_4878_232538158 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232538158", "FA-0508283 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803561: Service Request No - 639840882: Service Contract No - 204025098:,", "FA-0508283 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803561: Service Request No - 639840882: Service Contract No - 204025098:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232538158', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232538158", null, true, 4750), treeNode_RVisited, false, true, '4878','232538158','null');
var treeNode_4878_232537871 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232537871", "FA-0508277 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803129: Service Request No - 639840763: Service Contract No - 203571222:,", "FA-0508277 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803129: Service Request No - 639840763: Service Contract No - 203571222:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232537871', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232537871", null, true, 4750), treeNode_RVisited, false, true, '4878','232537871','null');
var treeNode_4878_232538100 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232538100", "FA-0508276 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803138: Service Request No - 639840768: Service Contract No - 203571222:,", "FA-0508276 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803138: Service Request No - 639840768: Service Contract No - 203571222:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232538100', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232538100", null, true, 4750), treeNode_RVisited, false, true, '4878','232538100','null');
var treeNode_4878_232536311 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232536311", "FA-0508231 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE DEUTSCHLAND GMBH: Return Reason Code - OHW2: Theater - EMEA: RMA Number - 801804348: Service Request No - 692130170: Service Contract No - 91238831:,", "FA-0508231 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE DEUTSCHLAND GMBH: Return Reason Code - OHW2: Theater - EMEA: RMA Number - 801804348: Service Request No - 692130170: Service Contract No - 91238831:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232536311', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232536311", null, true, 4750), treeNode_RVisited, false, true, '4878','232536311','null');
var treeNode_4878_232501850 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232501850", "FA-0508025 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - NAVAXX SA: Return Reason Code - OHW3: Theater - EMEA: RMA Number - 801801828: Service Request No - 692121287: Service Contract No - 94836090:,", "FA-0508025 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - NAVAXX SA: Return Reason Code - OHW3: Theater - EMEA: RMA Number - 801801828: Service Request No - 692121287: Service Contract No - 94836090:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232501850', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232501850", null, true, 4750), treeNode_RVisited, false, true, '4878','232501850','null');
var treeNode_4878_232474624 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232474624", "FA-0507796 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CGI SVERIGE AB: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801795926: Service Request No - 639839413: Service Contract No - 203052937:,", "FA-0507796 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CGI SVERIGE AB: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801795926: Service Request No - 639839413: Service Contract No - 203052937:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232474624', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232474624", null, true, 4750), treeNode_RVisited, false, true, '4878','232474624','null');
var treeNode_4878_232475178 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232475178", "FA-0507782 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - OLYMPIC STEEL: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801797376: Service Request No - 691831047: Service Contract No - 204188687:,", "FA-0507782 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - OLYMPIC STEEL: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801797376: Service Request No - 691831047: Service Contract No - 204188687:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232475178', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232475178", null, true, 4750), treeNode_RVisited, false, true, '4878','232475178','null');
var treeNode_4878_232466083 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232466083", "FA-0507698 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - NEC PLATFORMS LTD: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801795197: Service Request No - 639839265: Service Contract No - 3095860:,", "FA-0507698 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - NEC PLATFORMS LTD: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801795197: Service Request No - 639839265: Service Contract No - 3095860:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232466083', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232466083", null, true, 4750), treeNode_RVisited, false, true, '4878','232466083','null');
var treeNode_4878_232456730 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232456730", "FA-0507549 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - HITACHI INFORMATION &amp; TELECOMMUNICATION ENGINEERING, LTD: Return Reason Code - OHW2: Theater - JPN: RMA Number - 801787811: Service Request No - 639837867: Service Contract No ...", "FA-0507549 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - HITACHI INFORMATION &amp; TELECOMMUNICATION ENGINEERING, LTD: Return Reason Code - OHW2: Theater - JPN: RMA Number - 801787811: Service Request No - 639837867: Service Contract No ...","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232456730', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232456730", null, true, 4750), treeNode_RVisited, false, true, '4878','232456730','null');
var treeNode_4878_232428856 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232428856", "FA-0506915 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - HSBC BANK PLC: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801790980: Service Request No - 639836464: Service Contract No - 93070170:,", "FA-0506915 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - HSBC BANK PLC: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801790980: Service Request No - 639836464: Service Contract No - 93070170:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232428856', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232428856", null, true, 4750), treeNode_RVisited, false, true, '4878','232428856','null');
var treeNode_4878_232425861 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232425861", "FA-0506751 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - NTT EAST CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801786640: Service Request No - 639837653: Service Contract No - 94752412:,", "FA-0506751 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - NTT EAST CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801786640: Service Request No - 639837653: Service Contract No - 94752412:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232425861', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232425861", null, true, 4750), treeNode_RVisited, false, true, '4878','232425861','null');
var treeNode_4878_232402224 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232402224", "FA-0506275 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - WELLS FARGO: Return Reason Code - OHW3: Theater - NAM: RMA Number - 801786868: Service Request No - 692080959: Service Contract No - 201629820:,", "FA-0506275 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - WELLS FARGO: Return Reason Code - OHW3: Theater - NAM: RMA Number - 801786868: Service Request No - 692080959: Service Contract No - 201629820:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232402224', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232402224", null, true, 4750), treeNode_RVisited, false, true, '4878','232402224','null');
var treeNode_4878_232375989 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232375989", "FA-0506113 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE GROUP SERVICES GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801776047: Service Request No - 692047226: Service Contract No - 92281781:,", "FA-0506113 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE GROUP SERVICES GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801776047: Service Request No - 692047226: Service Contract No - 92281781:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232375989', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232375989", null, true, 4750), treeNode_RVisited, false, true, '4878','232375989','null');
var treeNode_4878_232350716 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232350716", "FA-0505935 : IQS2.0 PID Profile for QSFP-40/100-SRBD= - Criteria = Customer Name - ALLSTATE INSURANCE COMPANY: Return Reason Code - ARFN: Theater - NAM: RMA Number - 801778650: Service Request No - 692054869: Service Contract No - 93725723:,", "FA-0505935 : IQS2.0 PID Profile for QSFP-40/100-SRBD= - Criteria = Customer Name - ALLSTATE INSURANCE COMPANY: Return Reason Code - ARFN: Theater - NAM: RMA Number - 801778650: Service Request No - 692054869: Service Contract No - 93725723:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232350716', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232350716", null, true, 4750), treeNode_RVisited, false, true, '4878','232350716','null');
var treeNode_4878_232315305 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232315305", "FA-0505648 : IQS2.0 PID Profile for QSFP-40G-SR-BD= - Criteria = Customer Name - BANK OF AMERICA: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801772895: Service Request No - 639835050: Service Contract No - 201605943:,", "FA-0505648 : IQS2.0 PID Profile for QSFP-40G-SR-BD= - Criteria = Customer Name - BANK OF AMERICA: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801772895: Service Request No - 639835050: Service Contract No - 201605943:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232315305', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232315305", null, true, 4750), treeNode_RVisited, false, true, '4878','232315305','null');
var treeNode_4878_232280756 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232280756", "FA-0505262 : IQS2.0 PID Profile for SFP-10G-LR= - Criteria = Customer Name - COACHELLA VALLEY UNIFIED SCHOOL DISTRICT: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801767468: Service Request No - 692000896: Service Contract No - 202556478:,", "FA-0505262 : IQS2.0 PID Profile for SFP-10G-LR= - Criteria = Customer Name - COACHELLA VALLEY UNIFIED SCHOOL DISTRICT: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801767468: Service Request No - 692000896: Service Contract No - 202556478:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232280756', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232280756", null, true, 4750), treeNode_RVisited, false, true, '4878','232280756','null');
var treeNode_4878_232263831 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232263831", "FA-0505057 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE GROUP SERVICES GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801761158: Service Request No - 692001331: Service Contract No - 92281781:,", "FA-0505057 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE GROUP SERVICES GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801761158: Service Request No - 692001331: Service Contract No - 92281781:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232263831', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232263831", null, true, 4750), treeNode_RVisited, false, true, '4878','232263831','null');
var treeNode_4878_232232577 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232232577", "FA-0504596 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - WELLS FARGO: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801758390: Service Request No - 691994119: Service Contract No - 201629820:,", "FA-0504596 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - WELLS FARGO: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801758390: Service Request No - 691994119: Service Contract No - 201629820:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232232577', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232232577", null, true, 4750), treeNode_RVisited, false, true, '4878','232232577','null');
tree_RV._el.onkeydown  = function (evt) { tree_RV.handleKeyDownEvent(evt); }; 
tree_RV.draw();
tree_RV.registarDD();
} 
var namesArrRV = new Array();
</script><script type="text/javascript">
var tree_lPRT = null;
function loadReportsTree() {
tree_lPRT = new YAHOO.widget.AgileTreeView("reportsTree");
tree_lPRT.setTreeContextInfo("2", "lPRT", "PCMServlet", "LeftPaneHandler", "updateExpansions", "loadTreeNodes", true, 
false);
tree_lPRT.setDynamicLoad(loadDataForNode, 1);
var treeNode_ReportsT = new YAHOO.widget.AgileRootNode(new TreeNode("_nodeId_ReportsT", "Reports and Analytics", "Reports and Analytics","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, true, true, "ReportsT", "emphasis", false),tree_lPRT.getRoot(), true);
var treeNode_4_211_211 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_211_211", "PLM Analytics", "PLM Analytics","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, true, "4_211_211", null, true, -1), treeNode_ReportsT, false);
var treeNode_4_232333084_232333084 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_232333084_232333084", "Personal Reports", "Personal Reports","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, false, "4_232333084_232333084", null, true, -1), treeNode_ReportsT, false);
var treeNode_4_260_260 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_260_260", "Global Reports", "Global Reports","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, true, "4_260_260", null, true, -1), treeNode_ReportsT, false);
var treeNode_4_212_212 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_212_212", "Standard Reports", "Standard Reports","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, true, "4_212_212", null, true, -1), treeNode_ReportsT, false);
tree_lPRT._el.onkeydown  = function (evt) { tree_lPRT.handleKeyDownEvent(evt); }; 
tree_lPRT.draw();
} 
var namesArrlPRT = new Array();
namesArrlPRT[0]="PLM Analytics";namesArrlPRT[1]="Personal Reports";namesArrlPRT[2]="Global Reports";namesArrlPRT[3]="Standard Reports";</script><script type="text/javascript">isPageLoading=false;</script><script type="text/javascript">

function refreshCtxNavTree(){
	var tree = YAHOO.widget.TreeView.getTree('ctxNavTree');
	if(tree != null){
		var hasTreeActions = false;

		if(tree._classId == 18022 || 
			tree._classId == 18387) {
			hasTreeActions = true;
		}

		loadCtxNavTree(hasTreeActions, YAHOO.widget.TreeView.getTree('ctxNavTree').getObjectTreeParams())
	}
}

function buildTreeActions(){
	var act = '<p><a class="expand_all first" title="Expand All" '+
			  'href="javascript:expandAllTree(\'ctxNavTree\')" '+
			  'onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, \'tree_actions_hover\')" ' + 'onblur="YAHOO.util.Dom.removeClass(this, \'tree_actions_hover\')">&nbsp;</a>&nbsp;' +
			  '<a class="collapse_all" title="Collapse All" '+
			  'href="javascript:collapseAllTree(\'ctxNavTree\')" ' + 
		      'onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, \'tree_actions_hover\')" ' + 'onblur="YAHOO.util.Dom.removeClass(this, \'tree_actions_hover\')">&nbsp;</a></p>';

	document.getElementById('ctxNavActions').innerHTML = act;
	document.getElementById('ctxNavActions').className = "title first";
}

var dock = "Dock";
var undock = "Undock";

function toggleMDI(fld){
	if(fld.title.indexOf(undock) != -1)
		fld.title = dock;
	else
		fld.title = undock;

	alert('Behavior not defined yet!')
}

var toolsMenu;
var helpMenu;

function loadMenus(){
	var toolsMenuItems = [ [{ text : "Export" , url : "javascript:displayNewPDX()"} , { text : "Create Project from XML File" , url : "javascript:openMSProjectPublishWindow()"}] , [{ text : "Address Book" , url : "javascript:noaction()" , submenu :  { id:"18275", itemdata : [ [{ text : "Users" , url : "javascript:showAddressBook(0)" } ,{ text : "User Groups" , url : "javascript:showAddressBook(1)" } ,{ text : "Functional Teams" , url : "javascript:showAddressBook(2)" } ,{ text : "Supplier Groups" , url : "javascript:showAddressBook(3)" } ], [] ] }} , { text : "View files in separate Viewer windows" , id : "link_autovue_open" , url : "javascript:setAutovueOpeningMode()"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://www-pqmprd.cisco.com/BagnTagUserService/UserServlet"},"fn":"onURLPXClickFromToolsMenu"} , text : "Bag and Tag Inventory" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://www-pqmprd.cisco.com/BagnTagUserService/ClosureDescUserServlet"},"fn":"onURLPXClickFromToolsMenu"} , text : "Closure Description Approval Tool" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://www-pqmprd.cisco.com/MasterDataMaintenance/MainServlet"},"fn":"onURLPXClickFromToolsMenu"} , text : "Master Data Maintenance" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://www-pqmprd.cisco.com/BagnTagUserService/DashBoardUserServlet"},"fn":"onURLPXClickFromToolsMenu"} , text : "QIT Dashboard" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://cqi-cae.cisco.com/cqi/"},"fn":"onURLPXClickFromToolsMenu"} , text : "QMS FA Reporting Dashboard" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"http://wwwin.cisco.com/mfg/organizations/qms/qms.shtml"},"fn":"onURLPXClickFromToolsMenu"} , text : "QMS Launch Page" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://ibpm.cisco.com/rma/home/"},"fn":"onURLPXClickFromToolsMenu"} , text : "RMA Tool" , url : "#"}]];
	for(var i=0;i<toolsMenuItems.length;i++) {
		for(var j=0;j<toolsMenuItems[i].length;j++){
			if(toolsMenuItems[i][j].onclick != null){
				if(toolsMenuItems[i][j].onclick.fn != null){
					if(toolsMenuItems[i][j].onclick.fn == "onURLPXClickFromToolsMenu"){
						toolsMenuItems[i][j].onclick.fn = onURLPXClickFromToolsMenu;
					}				
				}
			}
		}
	}
	toolsMenu = new YAHOO.widget.Menu("tools", { constraintoviewport:false, zindex: 99998, hidedelay:600 });
	toolsMenu.addItems(toolsMenuItems);
	toolsMenu.render(document.body);
	toolsMenu.cfg.setProperty("context", ["preferences", "tl","bl"]);

	var helpMenuItems = [ [{ text : "Help" , url : "javascript:showOnlineHelp('http://www.oracle.com/technology/documentation/agile.html?Lang=en_US&CTXEX=');"} , { text : "About" , url : "javascript:displayAbout()"}] , [{ text : "Keyboard Controls" , url : "javascript:openKeyBoardControls()"} , { text : "Quick Tours" , url : "javascript:openMoviePopup()"}]];
		helpMenu = new YAHOO.widget.Menu("helpMenu", { constraintoviewport:false, zindex: 99998, hidedelay:600 });
	helpMenu.addItems(helpMenuItems);
	helpMenu.render(document.body);
	helpMenu.cfg.setProperty("context", ["help", "tl","bl"]);
}



AGILE.EventManager.addEvent(LEFTPANECONTENT, ON_LOAD, function() {
								doOnloadLeftActions();
							  });

AGILE.EventManager.addEvent(LEFTPANECONTENT, ON_WINDOW_RESIZE, function() {
								doLeftResizeActions();
							  });

AGILE.EventManager.addEvent('', OBJECT_CHANGED, function() {
									 markRecentlyForRefresh = true;
   	                                 });

</script><script type="text/javascript">isPageLoading=true;</script><script type="text/javascript">tabsMenu = [];tabsMenu['menu_2'] = [ [
 getMenuItemObj("Notifications", null, "javascript:showNotifications()", null, null, null, false, null, null, null, null, "tabMenu "), 
 getMenuItemObj("Workflow Routings", null, "javascript:showWorkflowRoutings()", null, true, null, false, null, null, null, null, "tabMenu selecteditem "), 
 getMenuItemObj("My Assignments", null, "javascript:showMyToDoList()", null, null, null, false, null, null, null, null, "tabMenu ")] ];</script><script type="text/javascript">var arMenu2_obj; menuIds[menuIds.length] =  '2'; </script><script type="text/javascript">


</script><script type="text/javascript">
if(document.MainForm && document.MainForm.registeredTables)
document.MainForm.registeredTables.value = '121';
var tel = document.getElementById('tableIdName'); if (tel) tel.innerHTML = 'WORKFLOW_ROUTING_TABLE_GRID';
try{ StartTreeGrid(); } catch(err) { }
setTimeout("AGILE.grid.showTableLoading('WORKFLOW_ROUTING_TABLE_GRID')", 10)
</script><script type="text/javascript">isPageLoading=false;</script><script type="text/javascript">

postAccept.subscribe(handleDateOnBlur);
dateOnBlur.subscribe(handleDateOnBlur);

function handleDateOnBlur(){
	if(AGILE.grid.GridActiveCell.getGridId() == 'MYTODOLIST_TABLE_GRID'){
		var fld = document.getElementById(AGILE.grid.GridActiveCell._col);
		var row_subclsid = AGILE.grid.GridActiveCell._row["row_subclsid"];		
		if(row_subclsid == 1) return;

		//REQ01016 PPM Calendar, My Assignment not support calendar exception checking 
		//checkstartDate(fld, 'MM/dd/yyyy hh:mm:ss aaa');
	}
}


	function showErrorWarningPopup() {
	
		assignmentsExpHead = "";
		assignmentsExpText = "";
		var addlparam = 'AssignmentsExpHead=' + assignmentsExpHead + '&AssignmentsExpText=' + assignmentsExpText + '&ERRORS_FROM_MARKCOMPLETE=';
		openDialogWindowFrom2ndForm('MainForm',document.MainForm.module.value, 'showErrorAndWarningsInAssign', '_New', 410, 700, "true", "no", addlparam);
	}


</script><script type="text/javascript">
        var weekend = new Array(2);
        var firstWorkingDayOfWeek = -1; 		
        
                    
                    weekend[0] = 0;
                    
                
                    
                    weekend[1] = 6;
                    
                
        </script><script type="text/javascript">
var saveObject;
var saveTableRows;
var arTabText = new Array();
var arTabAction = new Array();
var arSelectedTab = new Array();

// Used for table sorting. .. overriding from PCFormsLib.js
 function sortTableBy(tableId, attrId, sortType)
 {
   var frm = getForm('');
   //var formName = frm.getName();
   //var currentPage = 'currentPage' + '_' + tableId;
   //eval('frm.' + currentPage).value = pageNumber;

   // set the sort criteria for this table
   var sortCriteria = 'sortCriteria' + '_' + tableId;
   eval('frm.' + sortCriteria).value = '&sortBy=' + attrId + '&sortType=' + sortType;
   showPleaseWait('myWaitLayer');
   // set the attrId for sort and the sort type.
   reloadData();
 }

  function showPleaseWait(object)
  {
    var isNS = (navigator.vendor == ("Netscape6") || navigator.product == ("Gecko"));
     obj = document.getElementById(object);
     if (!obj) return;

     if (isNS){
       //alert(window.scrollX + "  ::  " + window.scrollY);
       obj.style.left = (document.body.offsetWidth-200)/2+window.scrollX;
       obj.style.top = (document.body.offsetHeight-150)/2+window.scrollY;
     }else{
       //alert(document.body.scrollLeft + "  ::  " + document.body.scrollTop);
       obj.style.posLeft = (document.body.offsetWidth-200)/2+document.body.scrollLeft;
       obj.style.posTop = (document.body.offsetHeight-150)/2+document.body.scrollTop;
     }
     obj.style.visibility = 'visible';
  }

function updateActionItemPopUp(handler, classId, objId, rowId, tabId, target, invokeFrom)
{
	document.MainForm.classid.value = classId;
    document.MainForm.objid.value = objId;
    document.MainForm.tabid.value = tabId;

  openDialogWindow('MainForm', handler, 'modifyActionItem', 'popupWindow', 450, 650, 'true', 'no', '&tabid='+tabId+'&currentrowid='+rowId+'&redirectedFrom='+invokeFrom);
}


  function clickActionItem() {
    obj = document.getElementById("goToActItem");
    if (obj)
      obj.click();
  }

  function changeWFLFilter(gridId) {
	  Grids[gridId]['CurrentPage'] = 0 //reset
	  showWorkflowRoutings(true);
  }
    function changeNotiFilter(gridId) {
	  Grids[gridId]['CurrentPage'] = 0 //reset
	  saveCookie('NOTIFICATION_ROUTING_DATE_FILTER', document.getElementById('NOTIFICATION_ROUTING_DATE_FILTER').value, 100);
	  showNotifications();
  }
    function showWorkflowRoutings(refresh) {

		if(isMainPageDirty())
		{
			if ( !confirm(localMsg.unsavedChangeError) )
			return ;
		}
		var module = eval('document.MainForm.' + 'module');
		document.MainForm.tabid.value = '1';
		if(refresh) {
			document.MainForm.refresh.value = refresh;
		}
		var opcode = 'showPreferredInbox';
		var additionalParameters = '';
		var workflowRoutingDateFilter = document.getElementById('WORKFLOW_ROUTING_DATE_FILTER');
		if (workflowRoutingDateFilter) {
			additionalParameters = "workflowRoutingDateFilter" + "=" + '3#' + workflowRoutingDateFilter.value;
		}
		submitForm2({opcode:'showPreferredInbox',module:'InboxSearchHandler', containerToUpdate:'content_view'}, additionalParameters);
		//submitForm2('MainForm', module, opcode, '_self', '&','','0');

    } // fn


    function showNotifications() {
	
	if(isMainPageDirty())
	{
		if ( !confirm(localMsg.unsavedChangeError) )
		return ;
	}
        var module = eval('document.MainForm.' + 'module');
		document.MainForm.tabid.value = '3';
        var opcode = 'showPreferredInbox';
		submitForm2({opcode:'showPreferredInbox',module:'InboxSearchHandler',containerToUpdate:'content_view'})
		//submitForm2('MainForm', module, opcode, '_self', '&','','0');

    } // fn

    function showMyActivities() {
		var displayTableName = 'displayModeForTable' + '_' +100;
		if(eval("document.MainForm."+ displayTableName))
		{
			eval("document.MainForm."+ displayTableName).value='0';
		}
        var module = eval('document.MainForm.' + 'module');
        var opcode = 'showRefreshMyActivity';
		submitForm2({opcode:'showRefreshMyActivity',module:'InboxSearchHandler',containerToUpdate:'content_view'})
        //submitForm2('MainForm', module, opcode, '_self', '&','','0');

    } // fn

    function showActionItems() {

	if(isMainPageDirty())
	{
		if ( !confirm(localMsg.unsavedChangeError) )
		return ;
	}
      document.MainForm.InboxActionItemClicked.value = 1;
      var module = eval('document.MainForm.' + 'module');
      var opcode = 'showRefreshMyActionItems';
	  var displayTableName = 'displayModeForTable' + '_' +101;
	  if(eval("document.MainForm."+ displayTableName))
	  {
		eval("document.MainForm."+ displayTableName).value='0';
	  }
	  submitForm('MainForm', module, opcode, '_self', '&','','0');
    } // fn

    function showMyResourcePools() {

	if(isMainPageDirty())
	{
		if ( !confirm(localMsg.unsavedChangeError) )
		return ;
	}

        var module = eval('document.MainForm.' + 'module');
        var opcode = 'showRefreshMyResourcePools';
        submitForm('MainForm', module, opcode, '_self', '&','','0');

    } // fn


  function showMyToDoList() {

		if(isMainPageDirty()) {
			if ( !confirm(localMsg.unsavedChangeError) )
			return ;
		}
		document.MainForm.tabid.value = '2';
		document.MainForm.classid.value = '0';
		document.MainForm.objid.value = '0';		
        var module = eval('document.MainForm.' + 'module');
        var opcode = 'showPreferredInbox';
		submitForm2({opcode:'showPreferredInbox',module:'InboxSearchHandler',containerToUpdate:'content_view'})
		//submitForm2('MainForm', module, opcode, '_self', '&','','0');
    } // fn

	function showTimeSheet() {        
		if(isMainPageDirty()) {
			if ( !confirm(localMsg.unsavedChangeError) )
			return ;
		}
		document.MainForm.tabid.value = '4';
		document.MainForm.classid.value = '0';
		document.MainForm.objid.value = '0';
        var module = eval('document.MainForm.' + 'module');
        var opcode = 'showPreferredInbox';
		submitForm2({opcode:'showPreferredInbox',module:'InboxSearchHandler',containerToUpdate:'content_view'})
    } // fn
	
	function refreshShowTimeSheet() {
		if(isMainPageDirty()) {
			if ( !confirm(localMsg.unsavedChangeError) )
			return ;
		}
		document.MainForm.tabid.value = '4';
        var module = eval('document.MainForm.' + 'module');
        var opcode = 'showRefreshTimeSheet';
        submitForm('MainForm', module, opcode, '_self', '&','','0');

    } // fn
	

  function showUserProfile() {

    if(isMainPageDirty())
	{
		if ( !confirm(localMsg.unsavedChangeError) )
		return ;
	}
        var module = "UserProfileObjectHandler";
        var opcode = 'showMyUserProfile';
		document.MainForm.tabid.value = '0';
        submitForm('MainForm', module, opcode, '_self', '&','','0');

    } // fn

  /*function showChangePassword() {

   if(isMainPageDirty())
	{
		if ( !confirm(localMsg.unsavedChangeError) )
		return ;
	}
		document.MainForm.isFromInbox.value= true;
        var module = "SettingsHandler";
        var opcode = 'showChangePassword';
        submitForm('MainForm', module, opcode, '_self', '&');

  } // fn */

  function showReports() {

  if(isMainPageDirty())
	{
		if ( !confirm(localMsg.unsavedChangeError) )
		return ;
	}
        var module = "SettingsHandler";
        var opcode = 'organizeReports';
        submitForm('MainForm', module, opcode, '_self', 'empty');

    } // fn


    function printInbox(addlParam)
    {
        var frm = getForm('');
        var oldOpcode = frm.opcode.value;
        openDialogWindow('MainForm', 'InboxSearchHandler', 'printInbox', '_New', 600, 800, 'true', 'true', addlParam+'');
        frm.target = "RightPane";
        frm.opcode.value = oldOpcode;
    }


	function exportData(exportType){
	  // Remember the existing opcode so that it can be reset
	  // after export operation is done.
	  var frm = getForm('');
	  var oldOpcode = frm.opcode.value;
	  openDialogWindow('MainForm', 'InboxSearchHandler', 'exportQuery', '_parent', '&reportExportType=' + exportType);
	  frm.target = "RightPane";
	  frm.opcode.value = oldOpcode;
	}

    function deleteNotification() {
		var count = AGILE.grid.rowSelections["NOTIFICATION_TABLE_GRID"].getSelectedCount();
		if(count == 0)
			return;
		var module = document.MainForm.module.value;
		var classId = document.MainForm.classid.value;
		var objId = document.MainForm.objid.value;
		var gridName = "NOTIFICATION_TABLE_GRID";
		var params = [];
		params[params.length] = "ajaxRequest=true&module="+module;
		params[params.length] = "&opcode=deleteNotification&classid="+classId;
		params[params.length] = "&objid="+objId;
		params[params.length] = AGILE.grid.rowSelections["NOTIFICATION_TABLE_GRID"].postStr();
		params[params.length] = "&GRID_CTX_NAME="+gridName+"&reloadGrid=true";
		sendAJAXRequest(params.join(""),afterDeleteRows,false);
    } // fn

	function afterDeleteRows(response) {
		if(response.success){
			if(AGILE.util.hasErrors(response)) {
				AGILE.util.DMS.showErrorMessage(response.text);
			} else {
				var responseObject = eval('('+response.text+')'); 	
				var success = responseObject.DeleteActionInfo[0].success;
				var notiGridID = "NOTIFICATION_TABLE_GRID";
				if(success == 'true') {
					var count = parseInt(responseObject.DeleteActionInfo[0].deletedRowCount);
					var msg = count == 1 ? localMsg.TableRemoveAction_1 : localMsg.TableRemoveAction;
					AGILE.util.DMS.showInfoMessage(count+" " +msg);
					AGILE.util.refreshGrid(notiGridID, true, {}, '', AGILE.util.renderGrid, {gridID:notiGridID});
				}
			}
		}
	}


    function changeFilter() {
        var module = eval('document.MainForm.' + 'module');
        var opcode = 'initNotification';
		submitForm('MainForm', '', '', '_self', '&refresh=true');
    } // fn

	function refresh() {
		document.MainForm.refresh.value = 'true';
		submitForm('MainForm', 'InboxSearchHandler', 'showPreferredInbox', '', '');
    } // fn
    
    // these messages are used in the palette
    var notfPaletteMsgs = new Array();
    notfPaletteMsgs.notfTitle = 'Notification';
    notfPaletteMsgs.next = 'Next';
    notfPaletteMsgs.back = 'Back';
    notfPaletteMsgs.deleteMsg = 'Delete';
    notfPaletteMsgs.close = 'Close';

    function displayNotificationReq(notifyId, notifyType, rowId, imageSource, imageAlt)
    {
	showNotificationPalette(notifyId, 0,
				rowId, imageSource, imageAlt,
				-1, 0, 
				-1, -1, 
				"NOTIFICATION_TABLE_GRID", notfPaletteMsgs);
    }

	function displayNotificationReqChangeImage(notifyId, notifyType, imageSource, rowIndex) {
		var imageObject = document.getElementById('R' + rowIndex + '_1_145');
		imageObject.src = imageSource;
		imageObject.alt = "Read Notification";
		imageObject.title = imageObject.alt;
		//document.getElementById("unreadNotiCount").innerHTML = parseInt(document.getElementById("unreadNotiCount").innerHTML) - 1;
		var rowId = 'R' + rowIndex;
		displayNotificationReq(notifyId, notifyType, rowId, imageSource, imageObject.alt);
	} // fn
    function ignoreClick() {
	}

    function performAction(button, action, tableId, mode) {    
		// Fix for Bug : agile00249505 : In My Assignments editing many rows (say 250) and saving is giving Application error.
		// Not allowing the user to save the changes while page is loading when there are huge number of records
		if(isPageLoading){
			alert(localMsg.Page_Not_Loaded_Wait);
			return;
		}
		if(checkSelections(2000007865)){
			document.body.style.cursor = 'wait';
			var cancelButton = document.getElementById("Cancel");
            if(cancelButton!=null) {  				
				cancelButton.disabled = true;
				cancelButton.onclick=ignoreClick;
				cancelButton.className='menuBarDisabled';
			}
			button.className='menuBarDisabled';
			button.disabled=true;
			var displayTableName = 'displayModeForTable' + '_' + tableId;
			eval("document.MainForm."+ displayTableName).value=mode;
			document.MainForm.currentTableId.value = tableId;
			submitForm('MainForm', 'InboxSearchHandler',action,'RightPane', '&refresh=false');
		}
    }
    function performCancel(button, opcode)
    {
		if(isMainPageDirty())
		{
			if ( !confirm(localMsg.unsavedChangeError) )
			return ;
		}
		button.className='menuBarDisabled';
		button.disabled=true;
		submitForm('MainForm', 'InboxSearchHandler',opcode,'RightPane', '&refresh=true');

    }

    function changeMyActivityAndActionItem() {
        var module = eval('document.MainForm.' + 'module');
        var opcode = 'removeMyActivityAndActionItemTable';
        submitForm('MainForm', module, opcode, '_self', '');

    } // fn

  function changeActionItem() {
        var module = eval('document.MainForm.' + 'module');
        var opcode = 'removeActionItemTable';
        submitForm('MainForm', module, opcode, '_self', '');

    } // fn


  function checkPercent(fld)
    {
        var exp = /[^0-9]/;

        if (fld.value == "")
        {
            return;
        }

        if (exp.test(fld.value))
        {
            alert("Invalid number.");
            //fld.select();
            //fld.focus();
            return;
        }

        if (fld.value > 100)
        {
            alert("Percentage must be less than or equal to 100.");
            //fld.select();
            //fld.focus();
            return;
        }
    }

  function doInboxOnloadActions(){ 
	doOnloadMenuActions();
    document.MainForm.addlParam.value = '';
    var frm = getFormNN('', 1);
    frm.addlParam.value = '';	
	
	var fromCompareDesignURL = '';
	if(fromCompareDesignURL){
	     var design1 = '';
		 var version1 = '';
		 var design2 = '';
		 var version2 = '';		
		 var addlparam = 'DESIGN1=' + design1 + '&DESIGN2=' + design2 + '&VERSION1=' + version1 + '&VERSION2=' + version2 + '&fromCompareDesignURL=' + fromCompareDesignURL;
         openDialogWindow(frm.name, 'AttachmentHandler', 'launchDesignComparision', 'popupWindow',
															600, 700, 'true', 'no', addlparam);
    }															
    
    var fileId = '';
    var fileName = '';  
    var isFromMSP = 'false';
	if(isFromMSP == 'true' && (fileId != "" && fileName != "")){
	   	setTimeout("showPublishAgilePEDialog()", 1000);
	}
	
    var isFromExport = 'false'; 
	if(isFromExport == 'true'){
	  ShowExportDialog();
    }	
  }

  function showPublishAgilePEDialog() {
      var frm = getFormNN('', 1);
	  var fileId = '';
	  var fileName = '';  
	  var isFromMSP = 'false';
	  if(isFromMSP == 'true' && (fileId != "" && fileName != "")){
		  frm.classid.value = '';    	
		  frm.objid.value = '';    			
		  var addlparam = 'FileId='+fileId+'&PrjFile='+fileName;
		  openDialogWindow(frm.name, 'ActivityHandler', 'publishAgilePEFromWait', 'popupWindow', 450, 600, 'true', 'no', addlparam);
	  }
  }

  function fx()
  {
	  registerDualSelectElement('MainForm','from','SelectedValues',200,440);
	  adjustDualSelectElementWidths()
  }


   function showABWFProcess() {
   document.MainForm.objid.value="1736699833";
   document.MainForm.classid.value="2000000792";
    submitForm('MainForm', 'ABWFProcessHandler', 'displayObject',  'RightPane');

   }

function refreshInboxContent() {
	displayContent({module: 'InboxSearchHandler', opcode: 'refreshPreferredInbox', containerToUpdate: RIGHTPANECONTENT});
}

function searchQuery(){
	submitForm('MainForm', 'CreateSearchHandler', 'constructParamSearch', 'RightPane');
}
function cancelEditQuickLinks(){
	if(confirm("Are you sure you want to cancel this operation? ")){
		//document.getElementById("linksDiv").style.display="";
		//document.getElementById("editDiv").style.display="none";
	}
	}

function saveQuickLinks(){
	
	for (i = 0 ; i < document.MainForm.SelectedValues.options.length ; i++) {
		document.MainForm.SelectedValues.options[i].selected = true;
	}
	var nameValue = "";
	var value;
    var text;
	var selectBox = document.MainForm.SelectedValues;
	var selectionLength = document.MainForm.SelectedValues.length;
	for (var i=0; i<selectionLength; i++) {
          selectBox.options[i].selected = true;
          text = selectBox.options[i].text;
		  value = selectBox.options[i].value;
          nameValue = nameValue + text + "=" + value + ";";
	} // for
	eval('document.MainForm.SelectedNameValues').value = nameValue;
	//document.getElementById("linksDiv").style.display="";
	//document.getElementById("editDiv").style.display="none";
	submitForm('MainForm', 'InboxSearchHandler', 'saveQuickLinks', 'RightPane');
}


function editQuickLinksinIframe(){
	for (i = 0 ; i < document.MainForm.SelectedValues.options.length ; i++) {
		document.MainForm.SelectedValues.options[i].selected = true;
	}
	var lastSelectId = document.MainForm.lastSelectId.value;
	var nameValue = "";
	var value;
    var text;
	var selectBox = document.MainForm.SelectedValues;
	var selectionLength = document.MainForm.SelectedValues.length;
	for (var i=0; i<selectionLength; i++) {
          selectBox.options[i].selected = true;
          text = selectBox.options[i].text;
		  value = selectBox.options[i].value;
          nameValue = nameValue + text + "=" + value+ ";";
	} // for
	eval('document.MainForm.SelectedNameValues').value = nameValue;
	submitForm("MainForm","InboxSearchHandler","editQuickLinks","editLinksFrame")
}

function displayQuickLinksQuery(objid, queryName, formName){
	
	var secs = new Date().getTime();
	var xmlhttp = xmlRequest();
	//Bug 22999665 - AGILE25 MODERATE: POST REQUESTS CAN ALSO BE SENT AS GET REQUESTS
	//Reverted the fix of bug 22999665 - AGILE25 MODERATE: POST REQUESTS CAN ALSO BE SENT AS GET REQUESTS
	xmlhttp.open("GET", "PCMServlet?ajaxRequest=true&module=InboxSearchHandler&opcode=checkParamQuery&object_Id="+objid+"&popup=true&ctr="+secs, true);
    //xmlhttp.open("POST", "PCMServlet", true);
	//xmlhttp.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
	
	xmlhttp.onreadystatechange=function() {
	    if (xmlhttp.readyState==4) {
			var isParamQuery = xmlhttp.responseText;
			if (isParamQuery.indexOf("Error") == 0) {
				alert(isParamQuery.substring(7, isParamQuery.length));
			} else {
				displayQuery (objid, queryName, isParamQuery, formName);	
			}			
		}
	}
	xmlhttp.send(null);
	//xmlhttp.send("ajaxRequest=true&module=InboxSearchHandler&opcode=checkParamQuery&object_Id="+objid+"&popup=true&ctr="+secs);
}

function removeFromView(tableId){
	var viewEle = document.getElementById("TABLE_VIEWS_LIST_" + tableId);
	var removeFromViewId = viewEle[viewEle.selectedIndex].value;
	var count = AGILE.grid.rowSelections["MYTODOLIST_TABLE_GRID"].getSelectedCount();
	if(count == 0){
		AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR, localMsg.checkSelections);
		return;
	}
	if(removeFromViewId == 52 || removeFromViewId == 58) {
		var selections = AGILE.grid.rowSelections["MYTODOLIST_TABLE_GRID"].postStr();
		var gridName = "MYTODOLIST_TABLE_GRID";
		var param ="PCMServlet?ajaxRequest=true&module=InboxSearchHandler&opcode=removeFromView"+selections+"&GRID_CTX_NAME="+gridName+"&popup=false&ADDTO_VIEWID="+removeFromViewId;
		sendAJAXRequest(param,postRemoveFromView,true);
	}else {
		AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR, localMsg.removeViewError);
		return;
	}
}

function postRemoveFromView(response){
	  if(response.success){
		  var responseObject = eval('('+response.text+')');
		  var success = responseObject.removeAssignmentsFromViewStatus[0].success;
		  if(success == 'true'){	
			  AGILE.util.refreshGrid('MYTODOLIST_TABLE_GRID', true, {opcode:'reloadGrid'}, '', AGILE.util.renderGrid, {gridID:'MYTODOLIST_TABLE_GRID'});
		  }else{
			if(responseObject.removeAssignmentsFromViewStatus[0].error == "true"){
				AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR, responseObject.removeAssignmentsFromViewStatus[0].errorMsg);			
			}
		}
	  }
	}

function addToView(addToViewId) {
	var count = AGILE.grid.rowSelections["MYTODOLIST_TABLE_GRID"].getSelectedCount();
	if(count == 0){
		AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR, localMsg.checkSelections);
		return;
	}
	var selections = AGILE.grid.rowSelections["MYTODOLIST_TABLE_GRID"].postStr();
	var gridName = "MYTODOLIST_TABLE_GRID";
	var param ="PCMServlet?ajaxRequest=true&module=InboxSearchHandler&opcode=addToView"+selections+"&GRID_CTX_NAME="+gridName+"&popup=false&ADDTO_VIEWID="+addToViewId;
	sendAJAXRequest(param,postAddToView,true);
}

function postAddToView(response){
	  if(response.success){
		  var responseObject = eval('('+response.text+')');
		  var success = responseObject.addAssignmentsToViewStatus[0].success;
		  if(success == 'true'){	
			  AGILE.util.refreshGrid('MYTODOLIST_TABLE_GRID', true, {opcode:'reloadGrid'}, '', AGILE.util.renderGrid, {gridID:'MYTODOLIST_TABLE_GRID'});
		  }else{
			if(responseObject.addAssignmentsToViewStatus[0].error == "true"){
				AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR, responseObject.addAssignmentsToViewStatus[0].errorMsg);			
			}
		}
	  }
	}

function showObjectPreviewPopup(evt, classId, objectId, reqId) 
{
	preparePreviewPopUp(evt, classId, objectId)

	var theForm = getForm('ConfiguredViewForm');
    theForm.requesId.value = reqId;

	submitForm("ConfiguredViewForm", "InboxSearchHandler", "displayToDoListConfigurableObject", "ConfiguredView_IFrame");
	var windowAxis = windowSize();
	if(windowAxis){
		var offset = windowAxis[1] - invo.event.getEventY(evt);
		if(offset+100 < document.getElementById("ConfiguredView_IFrame").height ){
			document.ConfiguredViewForm.checkFlag.value = "true";
		}else{
			document.ConfiguredViewForm.checkFlag.value = "false";
		}
	}

}

function persistScrollBarPos(){
	var scrollBarPos = 0;
	if(document.getElementById("scrollTableDiv")) {
		scrollBarPos = document.getElementById("scrollTableDiv").scrollTop;
	} else {
		scrollBarPos = document.body.scrollTop;
	}
	document.MainForm.SCROLLBAR_POSITION.value = scrollBarPos;
}

function showAcceptDeclinePopup(evt) {
	setEventPosition(evt);
	persistScrollBarPos();
    var theForm = getForm('ConfiguredViewForm');
	document.getElementById("ConfiguredView_IFrame").width = 200;
	document.getElementById("ConfiguredView_IFrame").height = 200;

	submitForm("MainForm", "InboxSearchHandler", "displayDeclineWindow", "ConfiguredView_IFrame");
}
function reloadDataAfterMarkComplete() {
	refreshRightPane();
}

function toggleFlaggedView(objClass, objId) {
	var id = "flag_" + objClass + "_" + objId;
	var element = document.getElementById(id);
	var opcode = "addToFlaggedView";
	if(element.src.indexOf("unflagged")==-1){
		opcode = "removeFromFlaggedView";
	}
	
	var flaggedViewHandler = function (response, args) {
		var responeTxt = response.text;

		if (responeTxt.indexOf("Error") !== 0) {
			if(element.src.indexOf("unflagged")==-1){
				element.src = "/Agile/static/b03dfe0a1598f237838231f3c0db74e6/images/unflagged.gif";
				element.title = "UnFlagged";
				element.alt = "UnFlagged";
			}else{
				element.src = "/Agile/static/651dec62ab9c8fd804513fa58f5e063e/images/icn_status_flagged.png";
				element.title = "Flagged";
				element.alt = "Flagged";
			}
		}
	};
	
	var params = [];
	params[params.length] = "PCMServlet?ajaxRequest=true&popup=true&module=InboxSearchHandler";
	params[params.length] = "&opcode=" + opcode;
	params[params.length] = "&objectClass=" + objClass;
	params[params.length] = "&objectKey=" + objId;
	
	sendAJAXRequest(params.join(""), flaggedViewHandler, true, null, null, true);
}

function trackEvent(evt) {
	if(invo.event.getEventTarget(evt)) {
		clickTgtElem = invo.event.getEventTarget(evt);
		if(clickTgtElem.id == "scrollTableDiv"){
			eval(hideFunction);
			bCOBFocus = false;
		}
	}
}

function doInboxContentResize()
{ 
	//setPageViewContent();
	//setTableViewContent();
	setGridViewContent();
}

function fill(date) {
    // Fix for agile00262387
    // User date format should be considered while converting between
    // Date to String & String to Date.
    if(firstWorkingDayOfWeek == -1) {
        for(i=0;i<7;i++) {
            if(!isWeekEndDay(i)) {
                firstWorkingDayOfWeek = i;
                break;
            }
        }
    }
    var timeSheetDate = date;
	var today = new Date();
	if (timeSheetDate != null) {
		today = datePicker.parse(timeSheetDate);
		if (today == null) {
			var today = calMgr.getDateFromFormat(date, 'MM/dd/yyyy');
		}
	}	
//	var cal = new Calendar();
//	cal.setMonthYear(today.getMonth(), today.getFullYear());
if (timeSheetDate != null) {
	document.getElementById('timeSheetDate').value = timeSheetDate;
}

    var weekDay = today.getDay();
    var diff = weekDay - firstWorkingDayOfWeek; // 1 is Monday
    if(diff < 0) {
        diff = diff+7;
    }
    today.setMilliseconds(0);
    today.setSeconds(0);
    today.setMinutes(0);
    today.setHours(0);
    today.setDate(today.getDate() - diff);
    var monthName = FULL_MONTH_NAMES[today.getMonth()];	
    var tDate = monthName.substr(0, 3)+" "+today.getDate();
    document.MainForm.weekStartDateHidden.value = calMgr.scFormatDate(today,'MM/dd/yyyy');
    var endDate = today;
    endDate.setDate(endDate.getDate()+6);
	monthName = FULL_MONTH_NAMES[endDate.getMonth()]; 
	var weekRange = tDate+" - "+ monthName.substr(0, 3)+" "+endDate.getDate()+", "+endDate.getFullYear();
    document.MainForm.weekRangeDate.value = weekRange;
	document.getElementById("timesheet_range").innerHTML = weekRange;
    document.MainForm.weekEndDateHidden.value = calMgr.scFormatDate(today,'MM/dd/yyyy');
}

function onDateChange(){
	if(isMainPageDirty()) {
		if ( !confirm(localMsg.unsavedChangeError) )
			return ;
	}
    // Fix for agile00263441
    // Validate the date entered as per User's preferred Date Format.
    fill(document.MainForm.timeSheetDate.value);        
    document.MainForm.tabid.value = '4';
    var module = eval('document.MainForm.' + 'module');
    var opcode = 'showRefreshTimeSheet';
    submitForm2({opcode:opcode,module:'InboxSearchHandler',containerToUpdate:'content_view'})
}
function previousWeek(){
	if(isMainPageDirty()) {
		if ( !confirm(localMsg.unsavedChangeError) )
			return ;
	}
    // Fix for agile00262387
    // User date format should be considered while converting between
    // Date to String & String to Date.
    var weekStartDate = calMgr.getDateFromFormat(document.MainForm.weekStartDateHidden.value, 'MM/dd/yyyy');
    weekStartDate.setDate(weekStartDate.getDate()-1)
    fill(calMgr.scFormatDate(weekStartDate, 'MM/dd/yyyy'));
    document.MainForm.tabid.value = '4';
    var module = eval('document.MainForm.' + 'module');
    var opcode = 'showRefreshTimeSheet';
    submitForm2({opcode:opcode,module:'InboxSearchHandler',containerToUpdate:'content_view'})
}

function nextWeek(){
	if(isMainPageDirty()) {
		if ( !confirm(localMsg.unsavedChangeError) )
			return ;
	}
    // Fix for agile00262387
    // User date format should be considered while converting between
    // Date to String & String to Date.
    var weekEndDate = calMgr.getDateFromFormat(document.MainForm.weekEndDateHidden.value, 'MM/dd/yyyy');
    weekEndDate.setDate(weekEndDate.getDate()+1)
    fill(calMgr.scFormatDate(weekEndDate, 'MM/dd/yyyy'));
    document.MainForm.tabid.value = '4';
    var module = eval('document.MainForm.' + 'module');
    var opcode = 'showRefreshTimeSheet';
    submitForm2({opcode:opcode,module:'InboxSearchHandler',containerToUpdate:'content_view'})
}

function currentWeek(){
	if(isMainPageDirty()) {
		if ( !confirm(localMsg.unsavedChangeError) )
			return ;
	}
    // Fix for agile00262387
    // User date format should be considered while converting between
    // Date to String & String to Date.
    var currentWeekDate = new Date();
    fill(calMgr.scFormatDate(currentWeekDate, 'MM/dd/yyyy'));
    document.MainForm.tabid.value = '4';
    var module = eval('document.MainForm.' + 'module');
    var opcode = 'showRefreshTimeSheet';
    submitForm2({opcode:opcode,module:'InboxSearchHandler',containerToUpdate:'content_view'})
}

function doTimeSheetOnloadActions() {
    if(document.MainForm.weekStartDateHidden.value != null && document.MainForm.weekStartDateHidden.value != ""){
        fill(document.MainForm.weekStartDateHidden.value);
    }else{
        fill(document.MainForm.currentWeekDateHidden.value);
    }
}

var setDashboardViewContent;
var dashboardLoadActions;
AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_LOAD, function() {
										   doInboxOnloadActions();									   
										   if(dashboardLoadActions)   
						                       dashboardLoadActions();
						                    
						
   	                                 });
AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_UNLOAD, function() 
{
	postAccept.unsubscribe(handleDateOnBlur);
	dateOnBlur.subscribe(handleDateOnBlur);

	if(AGILE.widget.CloseAllPalettes)
		AGILE.widget.CloseAllPalettes();
});
AGILE.EventManager.addEvent(RIGHTPANECONTENT, REFRESH_PAGE, function() {
										   refreshInboxContent();
   	                                 });
AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_WINDOW_RESIZE, function() {
										
										 if(setDashboardViewContent)   
						                     setDashboardViewContent();
						                 else
											 doInboxContentResize();
										 
									});
</script><script type="text/javascript">
function editQuickLinks(){
	var pal = new AGILE.widget.QuickLinksPalette();
	//pal.setContextInfo(ctxinfo);
	pal.setTitle("Edit Quick Links");
	pal.setSize(550, 300);
	pal.showPalette();
}

//Quick links Palette
AGILE.widget.QuickLinksPalette = function(id){
	if(typeof(id) != 'undefined'){
		this.generatePaletteIds(id);
	}

	this.initialize(this.paletteWindow);
};

YAHOO.extend(AGILE.widget.QuickLinksPalette, AGILE.widget.BasePalette, {

	_shuttleControl : null,

	getFocusIds: function(oSelf){		
		return ['quickLinksSelect', 'saveQL', 'closeQL'];
	},

	setBodyHeight : function(){
		var ht = this.paletteWindowEl.offsetHeight - (YAHOO.util.Dom.get(this.paletteWindowTitle).offsetHeight +
													YAHOO.util.Dom.get(this.paletteWindowHead).offsetHeight + 
													YAHOO.util.Dom.get(this.paletteWindowFooter).offsetHeight);

		if(is_ie)
			YAHOO.util.Dom.get(this.paletteWindowBodyContent).style.height = ht - 15 + "px";
		else
			YAHOO.util.Dom.get(this.paletteWindowBodyContent).style.height = ht - 25 + "px";
	},

	postShowPalette : function(){

		var self = this;

		var body = [];
		body[body.length] = '<br /><table width="95%" align="center"><tr><td style="padding-left:22px;padding-bottom:10px;">';
		body[body.length] = 'Select From:&nbsp;';
		body[body.length] = '<select id="quickLinksSelect" class="medium_width removeOutLine"';	
		body[body.length] = 'onChange="'+ this.getPalette() +'.chgQuickLinks(this)" ';
		body[body.length] = 'onblur="removeElementFocus(this);" onfocus="setElementFocus(this);" >';
		body[body.length] = '<option value="0">';
		body[body.length] = 'Links';
		body[body.length] = '</option>';
		body[body.length] = '<option value="1">';
		body[body.length] = 'Bookmarks';
		body[body.length] = '</option>';
		body[body.length] = '<option value="2">';
		body[body.length] = 'Searches';
		body[body.length] = '</option>';
		body[body.length] = '</select>';		
		body[body.length] = '</td></tr>';
		body[body.length] = '<tr><td id="quick_links">';
		body[body.length] = '</td></tr>'
		body[body.length] = '</table>';

		this.setBody(body.join(""));
		
		var footer = [];
		footer[footer.length] = '<a id="saveQL" href="#" ';
		footer[footer.length] = 'onclick="'+ this.getPalette () +'.saveQuickLinks();" ';
		footer[footer.length] = 'onfocus="buttonFocus(this.id);" onblur="buttonBlur(this.id);" class="button">';
		footer[footer.length] = '<span id="saveQLspan">'+ localMsg.Save +'</span></a>&nbsp;';

		footer[footer.length] = '<a id="closeQL" href="#" ';
		footer[footer.length] = 'onclick="'+ this.getPalette () +'.hidePalette();" ';
		footer[footer.length] = 'onfocus="buttonFocus(this.id);" onblur="buttonBlur(this.id);" class="button">';
		footer[footer.length] = '<span id="closeQLspan">'+ localMsg.Close +'</span></a>';	

		this.setRightFooter(footer.join(""));

		var params = [];
		params[params.length] = "ajaxRequest=true&module=InboxSearchHandler";
		params[params.length] = "&opcode=getPossibleQuickLinks";
		params[params.length] = "&quickLinksSelect=-1";
		
		sendAJAXRequest(params.join(""), this.loadQuickLinks, false, null, {parent:this});				
	},	

	chgQuickLinks : function(fld){

		var selectedLinks = this._shuttleControl.getSerializedSelectedNodes();
		if(selectedLinks != "")
			selectedLinks = selectedLinks +";";

		var params = [];
		params[params.length] = "ajaxRequest=true&module=InboxSearchHandler";
		params[params.length] = "&opcode=getPossibleQuickLinks";		
		params[params.length] = "&SelectedQuickLinks="+ selectedLinks;
		params[params.length] = "&quickLinksSelect="+ fld[fld.selectedIndex].value;
		
		sendAJAXRequest(params.join(""), this.loadQuickLinks, false, null, {parent:this});
	},

	loadQuickLinks : function(response, args){
		YAHOO.util.Dom.get('quick_links').innerHTML = "";
		args.parent.createControl(response.text);
	},

	createControl : function(JSONData){

		var result =  eval('('+JSONData + ')');
 
		var format = { FormatAttrs: result.display.defaultFormatAttrs};
		var dataSet = { format : { FormatAttributes: result.format, 
									  FormatCriteria: [ format ] }  }; 

		this._shuttleControl = new AGILE.widget.ShuttleControl( { id:"quickLinksList", 
															  dataSet: dataSet.format.FormatAttributes, 
															  isTreeView: false, // one level deep list
															  disableLock: true,
															  availableListTitle: "Hidden Links",
															  selectedListTitle: "Quick Links",
															  nextTabEl: "filter-palette-apply-button", 
															  lastTabEl: "filter-palette-close-button"
															});

		// attach to the DOM
		YAHOO.util.Dom.get('quick_links').appendChild(this._shuttleControl.getContentEl().content);
		// init
		this._shuttleControl._registerEventListeners();
		this._shuttleControl.initControls();
		this._shuttleControl.setControlsHeight('115');
		this._shuttleControl.hideLockButton();
		this._shuttleControl.loadDefaultValues(dataSet.format.FormatCriteria);

	},

	saveQuickLinks : function(){
		var selectedLinks = this._shuttleControl.getSerializedSelectedNodes();		
		var fld = document.getElementById('quickLinksSelect');
		var params = [];
		params[params.length] = "ajaxRequest=true&module=InboxSearchHandler";
		params[params.length] = "&opcode=saveQuickLinks";
		if(selectedLinks.strim() != "")
			params[params.length] = "&SelectedQuickLinks="+ encodeURIComponent(selectedLinks) +";";
		params[params.length] = "&quickLinksSelect="+ fld[fld.selectedIndex].value;
		
		sendAJAXRequest(params.join(""), this.closeQL, false, null, {parent:this});	
	},
	
	closeQL : function(response, args){
		if(response){
			document.getElementById('qLinks').innerHTML = response.text;
			doInboxContentResize();
		}

		args.parent.hidePalette();
	}
});

</script><script type="text/javascript">isPageLoading=true;</script><script type="text/javascript">

actionsMenu['arMenu13'] = new Array( new Array(
 getMenuItemObj("In Transit", null, "javascript:showNextWorkflowStatus('32056','preAuditDisplayChangeStatus');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fault Isolation", null, "javascript:showNextWorkflowStatus('32075','showNextWorkflowStatus');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Root Cause In Progress", null, "javascript:showNextWorkflowStatus('32078','showNextWorkflowStatus');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Pending Closure Approval", null, "javascript:showNextWorkflowStatus('32088','showNextWorkflowStatus');", null, null, null, false, null, null, null, null, null)) );
var arMenu13_obj; menuIds[menuIds.length] = '13'; 


</script><script type="text/javascript">
</script><script type="text/javascript">actionsMenu['arMenu15'] = new Array( new Array(
 getMenuItemObj("Bookmark", null, "javascript:addBookMarks()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Subscribe", null, "javascript:showSubscription()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Save As", null, "javascript:showSaveAsDialog()", null, null, null, true, null, null, null, null, null,null),
 getMenuItemObj("Delete", null, "javascript:deleteObject()", null, null, null, true, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Send", null, "javascript:sendObject()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Sharing", null, "javascript:loadShareDialog('PSRHandler')", null, null, null, true, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Copy URL to Clipboard", null, "javascript:copyToClipBoard()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Audit Status", null, "javascript:auditStatus()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Audit Release", null, "javascript:auditRelease()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("View Workflows", null, "javascript:viewWorkflows()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Print", null, "javascript:showPrintOptions()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Export", null, "javascript:ShowExportDialog()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Create Quality Change Requests", null, "javascript:showSaveAsDialog('CreateQCRHandler')", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Calculate FA Case Priority", null, "javascript:invokeProcessAction('48698')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Convert FA Case to Customer/Cisco Requested", null, "javascript:invokeProcessAction('40065')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Create OEM / Root Cause", null, "javascript:invokeProcessAction('48839')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Create SoftWare Root Cause Case", null, "javascript:invokeProcessAction('50743')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Generate 4-Block Report", null, "javascript:invokeProcessAction('51986')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Reset Validation for Submittal", null, "javascript:invokeProcessAction('37778')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Retrieve C3 Data", null, "javascript:invokeProcessAction('36460')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Set High Priority FA to Yes/No", null, "javascript:invokeProcessAction('48699')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Update CPN Information", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"https://www-pqmprd.cisco.com/ACTSUserService/ACTSServlet?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}}),
 getMenuItemObj("Update Final SRE Symptom Code Category and Sub Category", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"https://www-pqmprd.cisco.com/UpdateSRESymptomCategory/UpdateSRESymptomCategoryServlet?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}}),
 getMenuItemObj("Update  Issue Classification", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"https://www-pqmprd.cisco.com/DeriveAndUpdateIssueClassification/UpdateIssueClassificationServlet?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}}),
 getMenuItemObj("Validation for Submittal", null, "javascript:invokeProcessAction('37780')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("View Logistic information from FAST", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"http://wwwix-pqmprd.cisco.com:7009/LogisticInfoURLPX/FALogisticInfoMain.jsp?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}})) );</script><script type="text/javascript">menuIds[menuIds.length] =  '15'; </script><script type="text/javascript">

var leftEnabledImg = "/Agile/static/e8176e654a45303646af19ee11289146/images/icn_action_tabscroll_left_enabled.png";
var leftDisabledImg = "/Agile/static/c7e1230fb6e6767f97e3af39d4c5bc4d/images/icn_action_tabscroll_left_disabled.png";
var rightEnabledImg = "/Agile/static/6dbe07cad9d304865dea9dfd18d4cb59/images/icn_action_tabscroll_right_enabled.png";
var rightDisabledImg = "/Agile/static/5f2041e87043a6f311afca298dd87a84/images/icn_action_tabscroll_right_disabled.png";

</script><script type="text/javascript">tabsMenu = [];tabsMenu['menu_16'] = [ [
 getMenuItemObj("Cover Page", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '0','', '0');", null, true, null, false, null, null, null, null, "tabMenu selecteditem "), 
 getMenuItemObj("Affected Items", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '2','', '0');", null, null, null, false, null, null, null, null, "tabMenu icn_status_dot_gray"), 
 getMenuItemObj("Workflow", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '4','', '0');", null, null, null, false, null, null, null, null, "tabMenu icn_status_dot_gray"), 
 getMenuItemObj("Relationships", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '5','', '0');", null, null, null, false, null, null, null, null, "tabMenu "), 
 getMenuItemObj("Attachments", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '7','', '0');", null, null, null, false, null, null, null, null, "tabMenu icn_status_dot_gray"), 
 getMenuItemObj("History", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '8','', '0');", null, null, null, false, null, null, null, null, "tabMenu ")] ];</script><script type="text/javascript">var arMenu16_obj; menuIds[menuIds.length] =  '16'; </script><script type="text/javascript">

</script><script type="text/javascript">
	resizeHeadingLinks();
</script><script type="text/javascript">

function generateAutoNumber(formInputName, autoNumberName) {

    
    var clickEvent = document.getElementById("123").onclick;
    disableButton("123");  

	var module = eval('document.MainForm.module').value;

    var subclassId = eval('document.MainForm.subclsid').value;

    var param ="PCMServlet?ajaxRequest=true&module="+module+"&opcode=getAutoNumberValue&autonumname="+autoNumberName+"&subclsid="+subclassId;

	var callBackArg = formInputName;

   	sendAJAXRequest(param,callBackSetAutoNumber,true,null,callBackArg);

    enableButton("123",clickEvent);
}
 
function callBackSetAutoNumber(response,callBackArg){
	if(response.success) {
             var responseObject = eval('('+response.text+')'); 	
	    var success = responseObject.AutoNumberInfo[0].success;	
		if(success == "true"){
		  eval('document.MainForm.'+callBackArg).value = responseObject.AutoNumberInfo[0].nextAutoNumber;		  
		} else {
		   AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR, responseObject.AutoNumberInfo[0].nextAutoNumber);   
                     return;		   
		} 
		var tableId = eval('document.MainForm.registeredTables').value;
		//in case of object name changes, refresh the leftpane contents
		markRecentlyForRefresh = true;
		markBookmarksForRefresh = true;
		if(tableId != ''){
			if(tableId.indexOf(",") != -1)
				tableId = tableId.substring(0, tableId.indexOf(","));
			setRowEdited(tableId, 'R1');
		}

	} 
}

    function onChangeSubType(subtypefield) {
    clearWarningCodes();
        res = eval("document." + "MainForm");
        res.subtypenew.value = subtypefield.value;
        res.SKIP_P3_TABLE.value = "true";
        res.subClassTypeFldName.value=subtypefield.name;
        disableButton('Save');
        disableButton('Validate');
        ;
        submitForm2({module: 'PSRHandler', opcode: 'updateRefreshRows'});
        
    }
    function preSubmitForm(formName, module, opcode, target, xtraArgs, refresh, displayMode) {
        if (opcode != null && (opcode == 'updateRefreshRows' || opcode == 'updateRows')) {
            disableButton('Save');
            disableButton('Validate');
        }
    }

    function cancelUpdate()
    {
        clearWarningCodes();
        var subClassTypeObj =  document.MainForm.subClassTypeFldName;

        if(subClassTypeObj)
        {
            var subClassFieldId = subClassTypeObj.value;
            var obj = document.getElementById(subClassFieldId);
            var subClassType = document.MainForm.subclsid;

            if(obj && subClassType){
            for(var i=0;i<obj.length;i++){ 
                if(obj.options[i].value == subClassType.value)
                    obj.options[i].selected = "true";
                }
            }
        }
    }

    function postHandleCoverPageEditWarning(reqParams) {
        submitForm2({module: reqParams.module, opcode: reqParams.opcode});
    }
    
    function trimObjectNumber(el) {
      // skip leading and trailing whitespace
   	  // and return everything in between
      var x = el.value;
      if (x) {
  	     x = x.replace(/^\s*(.*)/, "$1");
  	     x = x.replace(/(.*?)\s*$/, "$1");
  	     el.value = x;
  	  }
    };

    </script><script type="text/javascript">


function setPageViewContent()
{
	resetPageViewContent();
	resetHeaderWrapperContent();	
}

function next() { 
	if(CoverpageThumbnail._pos<CoverpageThumbnail._smallThumbnails.length-1){
	  CoverpageThumbnail._pos++;
	}
	else{
		CoverpageThumbnail._pos=0;
	}
	navigate();
}

function prev() {
	 if(CoverpageThumbnail._pos>0){
		CoverpageThumbnail._pos--;
	 }else{
		CoverpageThumbnail._pos=CoverpageThumbnail._smallThumbnails.length-1;
	 }
	 navigate();
}

function navigate(){

	if(CoverpageThumbnail._thumbnailKeys[CoverpageThumbnail._pos]!=0)
		cancelQuickViewLink();

	if(CoverpageThumbnail._thumbnailStatus[CoverpageThumbnail._pos]==1){
	   document.getElementById("thumbImg").src=CoverpageThumbnail._baseURL+CoverpageThumbnail._bigThumbnails[CoverpageThumbnail._pos];	
	}
	else if(CoverpageThumbnail._thumbnailStatus[CoverpageThumbnail._pos]==5||CoverpageThumbnail._thumbnailStatus[CoverpageThumbnail._pos]==6||CoverpageThumbnail._thumbnailStatus[CoverpageThumbnail._pos]==7){
	   document.getElementById("thumbImg").src=CoverpageThumbnail._mediumThumbnails[CoverpageThumbnail._pos];
	}
	else{
   	   document.getElementById("thumbImg").src=getErrorImage(CoverpageThumbnail._pos,2);	
	}


	document.getElementById("thumb_set").innerHTML="&nbsp;&nbsp;"+(CoverpageThumbnail._pos+1)+"&nbsp;"+ localMsg.thumbnailOf +"&nbsp;"+ CoverpageThumbnail._bigThumbnails.length;

	CoverpageThumbnail.updateViewerLink(CoverpageThumbnail._pos);

}

</script><script type="text/javascript">addTableRow('0', 'R1', '', '4878_232336885_232336885', '1', false,false,true,true);</script><script type="text/javascript">
if(document.MainForm && document.MainForm.registeredTables)
document.MainForm.registeredTables.value = '0,0';
</script><script type="text/javascript">addTableRow('7', 'R1', '', '4878_232336885_232336885', '1', false,false,true,true);</script><script type="text/javascript">
if(document.MainForm && document.MainForm.registeredTables)
document.MainForm.registeredTables.value = '0,0,7,7';
</script><script type="text/javascript">addTableRow('8', 'R1', '', '4878_232336885_232336885', '1', false,false,true,true);</script><script type="text/javascript">
if(document.MainForm && document.MainForm.registeredTables)
document.MainForm.registeredTables.value = '0,0,7,7,8,8';
</script><script type="text/javascript">

// MADDY: Commented out as it is fired unnecessarily on page load
// fireResizeEvents();


//934 REQ00061
AGILE.richtext.registerLzld('pageViewContent', {fn: function () {
	//932 me 011
	if(typeof(document.getElementById('fromaudit')) != "undefined" && document.getElementById('fromaudit') != null 
			&& eval('document.MainForm.fromaudit').value == 'true'){
		if(typeof(document.getElementById('attrid'))!="undefined" && document.getElementById('attrid') != null){
			var attrId = eval('document.MainForm.attrid').value;
			if(document.getElementById("col_" + attrId))
				document.getElementById("col_" + attrId).scrollIntoView();
		}
	}
	
	
}});
</script><script type="text/javascript">
    function applyFolderValueChanged() {
        //mark report tree to be refreshed
         
	    	return;
        
        markReportsForRefresh = true;
    }
    
    function preCancelEditObject() {
     	
	    	return;
        
        cancelFolderValueChange();
    }
    
    function cancelFolderValueChange() {
        markReportsForRefresh = false;
    }
</script><script type="text/javascript">
	

	
</script><script type="text/javascript">

var res = eval("document.MainForm");
var doYesProceed;
var isPopup;


	isPopup = false;






function yesProceed(){
	setWarningCodes();

	if(eval(res.stepCommand))
		eval(res.stepCommand).value = "null";

	if(eval(res.deleteRowsTableId))
		eval(res.deleteRowsTableId).value = "null";

	disableButtons();

	if (doYesProceed != null) {
		doYesProceed();
	}

	if (disableButton != null) {
		disableButton('Save');
		disableButton('Validate');
	}
	if(isPopup == true)
	{
		submitForm('MainForm',"QuickSearchHandler","executeQuickSearch", "_self");
	}else{
		submitForm2({module: 'QuickSearchHandler', opcode: 'executeQuickSearch'});	
	}

}

function disableButtons() {

} // fn

function noProceed()
{
	setRepWarningCodes();

	if(eval(res.stepCommand))
		eval(res.stepCommand).value = "null";
	if(isPopup == true) {
		submitForm('MainForm',"QuickSearchHandler","executeQuickSearch", "_self");
	}else{
		submitForm2({module: 'QuickSearchHandler', opcode: 'executeQuickSearch'});
	}
}

function noNext()
{
	

	clearWarningCodes("null");

	
}

function setWarningCodes()
{
	res.pgWarnID.value = "null";
	res.pgWarnCode.value = "null";
	res.commonWarnCode.value = "null";
}

function setRepWarningCodes()
{
	res.pgWarnID.value = "null";
	res.pgWarnCode.value = "null";
}

function clearWarningCodes(wCode)
{
	if (wCode != null && wCode.length > 0) 
	{
		var allCodeIds = "null";
		var allCodes = "null";      
		var arrCodeIds = allCodeIds.split(";")
		var arrCodes = allCodes.split(";")
		var rCodeIds = "";
		var rCodes = "";

		for (var i=0; i<arrCodes.length; i++ ){
			if(wCode == arrCodes[i]) {
				continue;
			}
			rCodeIds = arrCodeIds[i] +";"+rCodeIds;
			rCodes = arrCodes[i] +";"+rCodes;
		}

		res.pgWarnID.value = rCodeIds;
		res.pgWarnCode.value = rCodes;

	} else {
		res.pgWarnID.value = "";
		res.pgWarnCode.value = "";
		res.commonWarnCode.value = "";
	}

}

function cancelWarning()
{
	clearWarningCodes();
	if(isPopup == true) {
		submitForm('MainForm', '', '', '_self');
	}else{
		submitForm2();
	}
}
</script><script type="text/javascript">isPageLoading=false;</script><script type="text/javascript">
if(is_ie5) {
	height = null;
	width = null;
}

/**
 * Destory any visiable palettes
 */
function destoryPalettes(id) {    
   var paletteDiv = document.getElementById(id);
   if (paletteDiv) {
      paletteDiv.style.display = "";
      destoryTablePalette();
   } 
   
   if(document.getElementById('gridTablePanel'))
	document.getElementById('gridTablePanel').style.display = 'none';
};

function checkWarnings()
{
	
}


function doRightPaneOnloadActions() 
{ 
    // destroy any visable palettes
    // curenty there is only 2 types of palettes: SelectControl & TablePalette
    // below are their respective ids.
    //@TODO When we have more floating divs we should have a way to remove all    
    destoryPalettes("floater_window2"); 
    destoryPalettes("floater_window");
    
	     
	  initializeScrollingTabs();	
		
	
	doOnloadMenuActions();	
    // MADDY: Commented out to improve performance
	// setPageViewContent();
	enablePageRefresh();
	//to allow client to overwrite warning check logic
	/*  */
	checkWarnings();
	
	/* ME-001 */
	var twoColumnsWrapperDivs = YAHOO.util.Dom.getElementsByClassName("two_columns_wrapper_div");
	for(i = 0; i < twoColumnsWrapperDivs.length; i++){
	  var twoColumnsWrapperDiv = twoColumnsWrapperDivs[i];
	  var children = twoColumnsWrapperDiv.childNodes;
	  if(2 == children.length){ /* two short fields in one line. */
	    var child1 = children[0];
		var child2 = children[1];
		if((child1.offsetTop != child2.offsetTop)&&(child1.offsetLeft != child2.offsetLeft)){
		  if(child2.style)
		    child2.style.clear = 'left';
		}
	  }
	}
	/* ME-001 */
	
	//18385955, move code to IncludeCoverPage.inc
	/* //932 me 011
	if(typeof(document.getElementById('fromaudit')) != "undefined" && document.getElementById('fromaudit') != null 
			&& eval('document.MainForm.fromaudit').value == 'true'){
		if(typeof(document.getElementById('attrid'))!="undefined" && document.getElementById('attrid') != null){
			var attrId = eval('document.MainForm.attrid').value;
			if(document.getElementById("col_" + attrId))
				document.getElementById("col_" + attrId).scrollIntoView();
		}
	} */
}



function getErrorImage(pos,size){ 	
	var imagePath="";
	switch(CoverpageThumbnail._thumbnailStatus[pos]){
	case '0':
	case '2':
	case '3':
		if(size==2)
		  imagePath="/Agile/static/5813514ddc6454daf3442f46adfc5034/images/thumbnail/medium/InProgress.gif";
		else if(size==0)
		  imagePath="/Agile/static/3f11e827f09f0cb3a62c135acfc69b64/images/thumbnail/big/InProgress.gif";
		else
          imagePath="/Agile/static/bf275bc7f81ca5042cc1c1384253e3e9/images/thumbnail/small/InProgressTable.gif";

		break;
	case '4':
		if(size==2)
		  imagePath="/Agile/static/68c007acd5615e415b36a06230943556/images/thumbnail/medium/Error.png";
		else if(size==0)
		  imagePath="/Agile/static/93768615e5a8fc7497e6ec3acc0c402e/images/thumbnail/big/Error.png";
		else
		  imagePath="/Agile/static/e397aae79ed105924af1c813dba5a707/images/thumbnail/small/Error.png";
		break;
	//Bug fix 13787389
	//For unsupported files, Thumbnail icon should display N/A image in the Where Used/BOM tab when default thumbnail is changed from thumbnail navigator
	case '7':
    	if(size==2)
    	  imagePath="/Agile/static/34be4254e340234407a89fab9b676776/images/thumbnail/medium/thumbnail_na_filetype.png";
        else if(size==0)
           imagePath="null";
        else
		   imagePath="/Agile/static/022c6efc178fe284211dae97724194ea/images/thumbnail/small/thumbnail_na_filetype.png";
		break;	 

	default:
		if(size==2)
		  imagePath="/Agile/static/5813514ddc6454daf3442f46adfc5034/images/thumbnail/medium/InProgress.gif";
		else if(size==0)
		  imagePath="/Agile/static/3f11e827f09f0cb3a62c135acfc69b64/images/thumbnail/big/InProgress.gif";
		else
		  imagePath="/Agile/static/bf275bc7f81ca5042cc1c1384253e3e9/images/thumbnail/small/InProgressTable.gif";
	}

		return imagePath;

}

function doRightResizeActions() {
	     
	  initializeScrollingTabs();	
	
 
	hideMenus()
	setPageViewContent();
	setTableViewContent();
	//resizeLastColumn();
	setGridViewContent();
	
	//933HF174
	var fullDisplay = jQuery('#rightpanecontent form[name="MainForm"] #fulltabledisplay').val();
	var fullTableId = jQuery('#rightpanecontent form[name="MainForm"] #fullgridtableid').val();
	if (fullDisplay == 'true' && fullTableId =='ITEMTABLE_TITLEBLOCK_RED') {
		resetPageViewContent('pageViewContent2');		
	}
}








 
AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_LOAD, function() {
										   doRightPaneOnloadActions();
										   
   	                                 });
AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_UNLOAD, function() 
{
	if(AGILE.widget.CloseAllPalettes)
		AGILE.widget.CloseAllPalettes();
});

AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_WINDOW_RESIZE, function() {
								doRightResizeActions();
							  });

AGILE.EventManager.addEvent(RIGHTPANECONTENT, REFRESH_PAGE, function() {
										   refreshRightPane();
   	                                 });
RefererURL = 'https\x3A\x2F\x2Fwww\x2Dplmprd.cisco.com\x2FAgile\x2F';



//18385955, move code to IncludeCoverPage.inc


</script><script type="text/javascript">

function handleTopPaneActions() {
	toggle(true, "top_back");
	toggle(false, "top_forward");
	toggle(true, "top_refresh");
	toggle(true, "top_home");
}

</script><script type="text/javascript">

var leftEnabledImg = "/Agile/static/e8176e654a45303646af19ee11289146/images/icn_action_tabscroll_left_enabled.png";
var leftDisabledImg = "/Agile/static/c7e1230fb6e6767f97e3af39d4c5bc4d/images/icn_action_tabscroll_left_disabled.png";
var rightEnabledImg = "/Agile/static/6dbe07cad9d304865dea9dfd18d4cb59/images/icn_action_tabscroll_right_enabled.png";
var rightDisabledImg = "/Agile/static/5f2041e87043a6f311afca298dd87a84/images/icn_action_tabscroll_right_disabled.png";

</script><script type="text/javascript">tabsMenu = [];tabsMenu['menu_19'] = [ [
 getMenuItemObj("Cover Page", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '0','', '0');", null, null, null, false, null, null, null, null, "tabMenu "), 
 getMenuItemObj("Affected Items", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '2','', '0');", null, null, null, false, null, null, null, null, "tabMenu icn_status_dot_gray"), 
 getMenuItemObj("Workflow", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '4','', '0');", null, null, null, false, null, null, null, null, "tabMenu icn_status_dot_gray"), 
 getMenuItemObj("Relationships", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '5','', '0');", null, null, null, false, null, null, null, null, "tabMenu "), 
 getMenuItemObj("Attachments", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '7','', '0');", null, true, null, false, null, null, null, null, "tabMenu selecteditem icn_status_dot_gray"), 
 getMenuItemObj("History", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '8','', '0');", null, null, null, false, null, null, null, null, "tabMenu ")] ];</script><script type="text/javascript">var arMenu19_obj; menuIds[menuIds.length] =  '19'; </script><script type="text/javascript">
	resizeHeadingLinks();
</script><script type="text/javascript">

	// Todo: need to place this common code into one place instead of copying/pasting, but not in HF
	function encodeToHex(str) { 
		var encodedStr = "";
		for (var i=0; i < str.length; i++) {
			if (str.charAt(i) == '&') {
				encodedStr += "\\x26";
			}
			else if (str.charAt(i) == '=') {
				encodedStr += "\\x3D";
			}
			else if (str.charAt(i) == '/') {
				encodedStr += "\\x2F";
			}
			else if (str.charAt(i) == '"') {
				encodedStr += "\\x22";
			}
			else if (str.charAt(i) == '#') {
				encodedStr += "\\x23";
			}
			else {
				encodedStr += str.charAt(i);
			}
		}

		return encodedStr;
	}




 attachCopyUrl = "https\x3A\x2F\x2Fwww\x2Dplmprd.cisco.com\x2FAgile"

</script><script type="text/javascript">
</script><script type="text/javascript">actionsMenu['arMenu20'] = new Array( new Array(
 getMenuItemObj("Personalize", null, "javascript:manageViewAction('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Save As", null, "javascript:saveAsViewAction('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Delete", null, "javascript:deleteViewAction('ATTACHMENTS_FILELIST','10')", null, null, null, true, null, null, null, null, null,null),
 getMenuItemObj("Set as Standard FA Case Default", null, "javascript:setAsDefaultViewAction('ATTACHMENTS_FILELIST','10','true','Set as Standard FA Case Default')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Set as Problem Reports Default", null, "javascript:setAsDefaultViewAction('ATTACHMENTS_FILELIST','10','false','Set as Problem Reports Default')", null, null, null, false, null, null, null, null, null,null)) );</script><script type="text/javascript">menuIds[menuIds.length] =  '20'; </script><script type="text/javascript">
		viewMenuIds['ATTACHMENTS_FILELIST'] = '20';  
		
		
					
					var viewModifyArray = viewsProperties['10'];
					
					if(viewModifyArray == null) {
						viewsProperties['10'] = new Array();
						viewModifyArray = viewsProperties['10'];
					}

					viewModifyArray['657'] = 'false';
					viewModifyArray['657_classLevelInfo'] = 'false';
			
			
		</script><script type="text/javascript">
actionsMenu['arMenu22'] = new Array( new Array(
 getMenuItemObj("Files", null, "javascript:addFilePopUp()", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("URLs", null, "javascript:addURLPopUp()", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("By Search", null, "javascript:AGILE.grid.ShowAttachmentsPalette('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null)) );
var arMenu22_obj; menuIds[menuIds.length] = '22'; 




actionsMenu['arMenu26'] = new Array( new Array(
 getMenuItemObj("View", null, "javascript:viewAction('viewMultipleFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null)), new Array(
 getMenuItemObj("Compare", null, "javascript:viewAction('compareFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Compare by Search", null, "javascript:viewAction('advanceCompareFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Overlay", null, "javascript:viewAction('overlayFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null)) );
var arMenu26_obj; menuIds[menuIds.length] = '26'; 




actionsMenu['arMenu30'] = new Array( new Array(
 getMenuItemObj("Get Shortcut", null, "javascript:copyRowToClipBoard('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("View Versions", null, "javascript:showVersionHistoryPalette('ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Print", null, "javascript:printBOAttachment('10');", null, null, null, false, null, null, null, null, null)), new Array(
 getMenuItemObj("Copy", "Ctrl + C", "javascript:AGILE.grid.copyRows('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Paste", "Ctrl + V", "javascript:AGILE.grid.pasteRows({gridID:'ATTACHMENTS_FILELIST'})", null, null, null, false, null, null, null, null, null)), new Array(
 getMenuItemObj("Fill-down", "Ctrl + Shift + D", "javascript:AGILE.grid.filldown('ATTACHMENTS_FILELIST', true)", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fill-down (selected cells)", "Ctrl + Shift + D", "javascript:AGILE.grid.filldown('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fill-up", "Ctrl + Shift + U", "javascript:AGILE.grid.fillup('ATTACHMENTS_FILELIST', true)", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fill-up (selected cells)", "Ctrl + Shift + U", "javascript:AGILE.grid.fillup('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null)) );
var arMenu30_obj; menuIds[menuIds.length] = '30'; 

</script><script type="text/javascript">


</script><script type="text/javascript">
if(document.MainForm && document.MainForm.registeredTables)
document.MainForm.registeredTables.value = '10';
var tel = document.getElementById('tableIdName'); if (tel) tel.innerHTML = 'ATTACHMENTS_FILELIST';
try{ StartTreeGrid(); } catch(err) { }
setTimeout("AGILE.grid.showTableLoading('ATTACHMENTS_FILELIST')", 10)
</script><script type="text/javascript">
	

	
</script><script type="text/javascript">
function onUnLoadTab(){
	if(AGILE.widget.CloseAllPalettes)
		AGILE.widget.CloseAllPalettes()
}

AGILE.EventManager.addEvent(TABSVIEW_WRAPPER, ON_LOAD, function() {
										   doRightPaneOnloadActions();
   	                                 });
AGILE.EventManager.addEvent(TABSVIEW_WRAPPER, ON_UNLOAD, function() {
										   onUnLoadTab();
   	                                 });									
</script><script type="text/javascript">isPageLoading=true;</script><script type="text/javascript">

actionsMenu['arMenu36'] = new Array( new Array(
 getMenuItemObj("In Transit", null, "javascript:showNextWorkflowStatus('32056','preAuditDisplayChangeStatus');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fault Isolation", null, "javascript:showNextWorkflowStatus('32075','showNextWorkflowStatus');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Root Cause In Progress", null, "javascript:showNextWorkflowStatus('32078','showNextWorkflowStatus');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Pending Closure Approval", null, "javascript:showNextWorkflowStatus('32088','showNextWorkflowStatus');", null, null, null, false, null, null, null, null, null)) );
var arMenu36_obj; menuIds[menuIds.length] = '36'; 


</script><script type="text/javascript">
</script><script type="text/javascript">actionsMenu['arMenu38'] = new Array( new Array(
 getMenuItemObj("Bookmark", null, "javascript:addBookMarks()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Subscribe", null, "javascript:showSubscription()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Save As", null, "javascript:showSaveAsDialog()", null, null, null, true, null, null, null, null, null,null),
 getMenuItemObj("Delete", null, "javascript:deleteObject()", null, null, null, true, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Send", null, "javascript:sendObject()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Sharing", null, "javascript:loadShareDialog('PSRHandler')", null, null, null, true, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Copy URL to Clipboard", null, "javascript:copyToClipBoard()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Audit Status", null, "javascript:auditStatus()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Audit Release", null, "javascript:auditRelease()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("View Workflows", null, "javascript:viewWorkflows()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Print", null, "javascript:showPrintOptions()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Export", null, "javascript:ShowExportDialog()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Create Quality Change Requests", null, "javascript:showSaveAsDialog('CreateQCRHandler')", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Calculate FA Case Priority", null, "javascript:invokeProcessAction('48698')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Convert FA Case to Customer/Cisco Requested", null, "javascript:invokeProcessAction('40065')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Create OEM / Root Cause", null, "javascript:invokeProcessAction('48839')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Create SoftWare Root Cause Case", null, "javascript:invokeProcessAction('50743')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Generate 4-Block Report", null, "javascript:invokeProcessAction('51986')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Reset Validation for Submittal", null, "javascript:invokeProcessAction('37778')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Retrieve C3 Data", null, "javascript:invokeProcessAction('36460')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Set High Priority FA to Yes/No", null, "javascript:invokeProcessAction('48699')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Update CPN Information", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"https://www-pqmprd.cisco.com/ACTSUserService/ACTSServlet?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}}),
 getMenuItemObj("Update Final SRE Symptom Code Category and Sub Category", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"https://www-pqmprd.cisco.com/UpdateSRESymptomCategory/UpdateSRESymptomCategoryServlet?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}}),
 getMenuItemObj("Update  Issue Classification", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"https://www-pqmprd.cisco.com/DeriveAndUpdateIssueClassification/UpdateIssueClassificationServlet?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}}),
 getMenuItemObj("Validation for Submittal", null, "javascript:invokeProcessAction('37780')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("View Logistic information from FAST", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"http://wwwix-pqmprd.cisco.com:7009/LogisticInfoURLPX/FALogisticInfoMain.jsp?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}})) );</script><script type="text/javascript">menuIds[menuIds.length] =  '38'; </script><script type="text/javascript">

var leftEnabledImg = "/Agile/static/e8176e654a45303646af19ee11289146/images/icn_action_tabscroll_left_enabled.png";
var leftDisabledImg = "/Agile/static/c7e1230fb6e6767f97e3af39d4c5bc4d/images/icn_action_tabscroll_left_disabled.png";
var rightEnabledImg = "/Agile/static/6dbe07cad9d304865dea9dfd18d4cb59/images/icn_action_tabscroll_right_enabled.png";
var rightDisabledImg = "/Agile/static/5f2041e87043a6f311afca298dd87a84/images/icn_action_tabscroll_right_disabled.png";

</script><script type="text/javascript">tabsMenu = [];tabsMenu['menu_39'] = [ [
 getMenuItemObj("Cover Page", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '0','', '0');", null, null, null, false, null, null, null, null, "tabMenu "), 
 getMenuItemObj("Affected Items", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '2','', '0');", null, null, null, false, null, null, null, null, "tabMenu icn_status_dot_gray"), 
 getMenuItemObj("Workflow", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '4','', '0');", null, null, null, false, null, null, null, null, "tabMenu icn_status_dot_gray"), 
 getMenuItemObj("Relationships", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '5','', '0');", null, null, null, false, null, null, null, null, "tabMenu "), 
 getMenuItemObj("Attachments", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '7','', '0');", null, true, null, false, null, null, null, null, "tabMenu selecteditem icn_status_dot_gray"), 
 getMenuItemObj("History", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '8','', '0');", null, null, null, false, null, null, null, null, "tabMenu ")] ];</script><script type="text/javascript">var arMenu39_obj; menuIds[menuIds.length] =  '39'; </script><script type="text/javascript">
	resizeHeadingLinks();
</script><script type="text/javascript">

	// Todo: need to place this common code into one place instead of copying/pasting, but not in HF
	function encodeToHex(str) { 
		var encodedStr = "";
		for (var i=0; i < str.length; i++) {
			if (str.charAt(i) == '&') {
				encodedStr += "\\x26";
			}
			else if (str.charAt(i) == '=') {
				encodedStr += "\\x3D";
			}
			else if (str.charAt(i) == '/') {
				encodedStr += "\\x2F";
			}
			else if (str.charAt(i) == '"') {
				encodedStr += "\\x22";
			}
			else if (str.charAt(i) == '#') {
				encodedStr += "\\x23";
			}
			else {
				encodedStr += str.charAt(i);
			}
		}

		return encodedStr;
	}




 attachCopyUrl = "https\x3A\x2F\x2Fwww\x2Dplmprd.cisco.com\x2FAgile"

</script><script type="text/javascript">
</script><script type="text/javascript">actionsMenu['arMenu40'] = new Array( new Array(
 getMenuItemObj("Personalize", null, "javascript:manageViewAction('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Save As", null, "javascript:saveAsViewAction('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Delete", null, "javascript:deleteViewAction('ATTACHMENTS_FILELIST','10')", null, null, null, true, null, null, null, null, null,null),
 getMenuItemObj("Set as Standard FA Case Default", null, "javascript:setAsDefaultViewAction('ATTACHMENTS_FILELIST','10','true','Set as Standard FA Case Default')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Set as Problem Reports Default", null, "javascript:setAsDefaultViewAction('ATTACHMENTS_FILELIST','10','false','Set as Problem Reports Default')", null, null, null, false, null, null, null, null, null,null)) );</script><script type="text/javascript">menuIds[menuIds.length] =  '40'; </script><script type="text/javascript">
		viewMenuIds['ATTACHMENTS_FILELIST'] = '40';  
		
		
					
					var viewModifyArray = viewsProperties['10'];
					
					if(viewModifyArray == null) {
						viewsProperties['10'] = new Array();
						viewModifyArray = viewsProperties['10'];
					}

					viewModifyArray['657'] = 'false';
					viewModifyArray['657_classLevelInfo'] = 'false';
			
			
		</script><script type="text/javascript">
actionsMenu['arMenu42'] = new Array( new Array(
 getMenuItemObj("Files", null, "javascript:addFilePopUp()", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("URLs", null, "javascript:addURLPopUp()", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("By Search", null, "javascript:AGILE.grid.ShowAttachmentsPalette('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null)) );
var arMenu42_obj; menuIds[menuIds.length] = '42'; 




actionsMenu['arMenu46'] = new Array( new Array(
 getMenuItemObj("View", null, "javascript:viewAction('viewMultipleFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null)), new Array(
 getMenuItemObj("Compare", null, "javascript:viewAction('compareFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Compare by Search", null, "javascript:viewAction('advanceCompareFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Overlay", null, "javascript:viewAction('overlayFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null)) );
var arMenu46_obj; menuIds[menuIds.length] = '46'; 




actionsMenu['arMenu50'] = new Array( new Array(
 getMenuItemObj("Get Shortcut", null, "javascript:copyRowToClipBoard('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("View Versions", null, "javascript:showVersionHistoryPalette('ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Print", null, "javascript:printBOAttachment('10');", null, null, null, false, null, null, null, null, null)), new Array(
 getMenuItemObj("Copy", "Ctrl + C", "javascript:AGILE.grid.copyRows('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Paste", "Ctrl + V", "javascript:AGILE.grid.pasteRows({gridID:'ATTACHMENTS_FILELIST'})", null, null, null, false, null, null, null, null, null)), new Array(
 getMenuItemObj("Fill-down", "Ctrl + Shift + D", "javascript:AGILE.grid.filldown('ATTACHMENTS_FILELIST', true)", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fill-down (selected cells)", "Ctrl + Shift + D", "javascript:AGILE.grid.filldown('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fill-up", "Ctrl + Shift + U", "javascript:AGILE.grid.fillup('ATTACHMENTS_FILELIST', true)", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fill-up (selected cells)", "Ctrl + Shift + U", "javascript:AGILE.grid.fillup('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null)) );
var arMenu50_obj; menuIds[menuIds.length] = '50'; 

</script><script type="text/javascript">


</script><script type="text/javascript">
if(document.MainForm && document.MainForm.registeredTables)
document.MainForm.registeredTables.value = '10';
var tel = document.getElementById('tableIdName'); if (tel) tel.innerHTML = 'ATTACHMENTS_FILELIST';
try{ StartTreeGrid(); } catch(err) { }
setTimeout("AGILE.grid.showTableLoading('ATTACHMENTS_FILELIST')", 10)
</script><script type="text/javascript">
	

	
</script><script type="text/javascript">

var res = eval("document.MainForm");
var doYesProceed;
var isPopup;


	isPopup = false;






function yesProceed(){
	setWarningCodes();

	if(eval(res.stepCommand))
		eval(res.stepCommand).value = "null";

	if(eval(res.deleteRowsTableId))
		eval(res.deleteRowsTableId).value = "";

	disableButtons();

	if (doYesProceed != null) {
		doYesProceed();
	}

	if (disableButton != null) {
		disableButton('Save');
		disableButton('Validate');
	}
	if(isPopup == true)
	{
		submitForm('MainForm',"PSRHandler","refreshObject", "_self");
	}else{
		submitForm2({module: 'PSRHandler', opcode: 'refreshObject'});	
	}

}

function disableButtons() {

} // fn

function noProceed()
{
	setRepWarningCodes();

	if(eval(res.stepCommand))
		eval(res.stepCommand).value = "null";
	if(isPopup == true) {
		submitForm('MainForm',"PSRHandler","refreshObject", "_self");
	}else{
		submitForm2({module: 'PSRHandler', opcode: 'refreshObject'});
	}
}

function noNext()
{
	

	clearWarningCodes("null");

	
}

function setWarningCodes()
{
	res.pgWarnID.value = "null";
	res.pgWarnCode.value = "null";
	res.commonWarnCode.value = "null";
}

function setRepWarningCodes()
{
	res.pgWarnID.value = "null";
	res.pgWarnCode.value = "null";
}

function clearWarningCodes(wCode)
{
	if (wCode != null && wCode.length > 0) 
	{
		var allCodeIds = "null";
		var allCodes = "null";      
		var arrCodeIds = allCodeIds.split(";")
		var arrCodes = allCodes.split(";")
		var rCodeIds = "";
		var rCodes = "";

		for (var i=0; i<arrCodes.length; i++ ){
			if(wCode == arrCodes[i]) {
				continue;
			}
			rCodeIds = arrCodeIds[i] +";"+rCodeIds;
			rCodes = arrCodes[i] +";"+rCodes;
		}

		res.pgWarnID.value = rCodeIds;
		res.pgWarnCode.value = rCodes;

	} else {
		res.pgWarnID.value = "";
		res.pgWarnCode.value = "";
		res.commonWarnCode.value = "";
	}

}

function cancelWarning()
{
	clearWarningCodes();
	if(isPopup == true) {
		submitForm('MainForm', '', '', '_self');
	}else{
		submitForm2();
	}
}
</script><script type="text/javascript">isPageLoading=false;</script><script type="text/javascript">
if(is_ie5) {
	height = null;
	width = null;
}

/**
 * Destory any visiable palettes
 */
function destoryPalettes(id) {    
   var paletteDiv = document.getElementById(id);
   if (paletteDiv) {
      paletteDiv.style.display = "";
      destoryTablePalette();
   } 
   
   if(document.getElementById('gridTablePanel'))
	document.getElementById('gridTablePanel').style.display = 'none';
};

function checkWarnings()
{
	
}


function doRightPaneOnloadActions() 
{ 
    // destroy any visable palettes
    // curenty there is only 2 types of palettes: SelectControl & TablePalette
    // below are their respective ids.
    //@TODO When we have more floating divs we should have a way to remove all    
    destoryPalettes("floater_window2"); 
    destoryPalettes("floater_window");
    
	     
	  initializeScrollingTabs();	
		
	
	doOnloadMenuActions();	
    // MADDY: Commented out to improve performance
	// setPageViewContent();
	enablePageRefresh();
	//to allow client to overwrite warning check logic
	/*  */
	checkWarnings();
	
	/* ME-001 */
	var twoColumnsWrapperDivs = YAHOO.util.Dom.getElementsByClassName("two_columns_wrapper_div");
	for(i = 0; i < twoColumnsWrapperDivs.length; i++){
	  var twoColumnsWrapperDiv = twoColumnsWrapperDivs[i];
	  var children = twoColumnsWrapperDiv.childNodes;
	  if(2 == children.length){ /* two short fields in one line. */
	    var child1 = children[0];
		var child2 = children[1];
		if((child1.offsetTop != child2.offsetTop)&&(child1.offsetLeft != child2.offsetLeft)){
		  if(child2.style)
		    child2.style.clear = 'left';
		}
	  }
	}
	/* ME-001 */
	
	//18385955, move code to IncludeCoverPage.inc
	/* //932 me 011
	if(typeof(document.getElementById('fromaudit')) != "undefined" && document.getElementById('fromaudit') != null 
			&& eval('document.MainForm.fromaudit').value == 'true'){
		if(typeof(document.getElementById('attrid'))!="undefined" && document.getElementById('attrid') != null){
			var attrId = eval('document.MainForm.attrid').value;
			if(document.getElementById("col_" + attrId))
				document.getElementById("col_" + attrId).scrollIntoView();
		}
	} */
}



function getErrorImage(pos,size){ 	
	var imagePath="";
	switch(CoverpageThumbnail._thumbnailStatus[pos]){
	case '0':
	case '2':
	case '3':
		if(size==2)
		  imagePath="/Agile/static/5813514ddc6454daf3442f46adfc5034/images/thumbnail/medium/InProgress.gif";
		else if(size==0)
		  imagePath="/Agile/static/3f11e827f09f0cb3a62c135acfc69b64/images/thumbnail/big/InProgress.gif";
		else
          imagePath="/Agile/static/bf275bc7f81ca5042cc1c1384253e3e9/images/thumbnail/small/InProgressTable.gif";

		break;
	case '4':
		if(size==2)
		  imagePath="/Agile/static/68c007acd5615e415b36a06230943556/images/thumbnail/medium/Error.png";
		else if(size==0)
		  imagePath="/Agile/static/93768615e5a8fc7497e6ec3acc0c402e/images/thumbnail/big/Error.png";
		else
		  imagePath="/Agile/static/e397aae79ed105924af1c813dba5a707/images/thumbnail/small/Error.png";
		break;
	//Bug fix 13787389
	//For unsupported files, Thumbnail icon should display N/A image in the Where Used/BOM tab when default thumbnail is changed from thumbnail navigator
	case '7':
    	if(size==2)
    	  imagePath="/Agile/static/34be4254e340234407a89fab9b676776/images/thumbnail/medium/thumbnail_na_filetype.png";
        else if(size==0)
           imagePath="null";
        else
		   imagePath="/Agile/static/022c6efc178fe284211dae97724194ea/images/thumbnail/small/thumbnail_na_filetype.png";
		break;	 

	default:
		if(size==2)
		  imagePath="/Agile/static/5813514ddc6454daf3442f46adfc5034/images/thumbnail/medium/InProgress.gif";
		else if(size==0)
		  imagePath="/Agile/static/3f11e827f09f0cb3a62c135acfc69b64/images/thumbnail/big/InProgress.gif";
		else
		  imagePath="/Agile/static/bf275bc7f81ca5042cc1c1384253e3e9/images/thumbnail/small/InProgressTable.gif";
	}

		return imagePath;

}

function doRightResizeActions() {
	     
	  initializeScrollingTabs();	
	
 
	hideMenus()
	setPageViewContent();
	setTableViewContent();
	//resizeLastColumn();
	setGridViewContent();
	
	//933HF174
	var fullDisplay = jQuery('#rightpanecontent form[name="MainForm"] #fulltabledisplay').val();
	var fullTableId = jQuery('#rightpanecontent form[name="MainForm"] #fullgridtableid').val();
	if (fullDisplay == 'true' && fullTableId =='ITEMTABLE_TITLEBLOCK_RED') {
		resetPageViewContent('pageViewContent2');		
	}
}








 
AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_LOAD, function() {
										   doRightPaneOnloadActions();
										   
   	                                 });
AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_UNLOAD, function() 
{
	if(AGILE.widget.CloseAllPalettes)
		AGILE.widget.CloseAllPalettes();
});

AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_WINDOW_RESIZE, function() {
								doRightResizeActions();
							  });

AGILE.EventManager.addEvent(RIGHTPANECONTENT, REFRESH_PAGE, function() {
										   refreshRightPane();
   	                                 });
RefererURL = 'https\x3A\x2F\x2Fwww\x2Dplmprd.cisco.com\x2FAgile\x2F';



//18385955, move code to IncludeCoverPage.inc


</script></head>



            <body onunload="doUnloadActions();" onload="doBodyOnloadActions();" style="cursor: default;"><div id="gridTablePanel" style="display: none;"></div> 
    


<input type="hidden" name="Grid_Defaults" id="Grid_Defaults" value="<?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?><Grid>
   
	<!-- Basic grid configuration -->
   <Cfg Adding=&quot;1&quot; AllPages=&quot;1&quot; AutoSort=&quot;0&quot; AutoUpdate=&quot;0&quot; CSS=&quot;agile.css&quot; CacheTimeout=&quot;10&quot; Calculated=&quot;0&quot; CellSpacing=&quot;0&quot; ChildPageLength=&quot;30&quot; ChildPageMin=&quot;0&quot; ChildPages=&quot;1&quot; ChildPaging=&quot;3&quot; Code=&quot;GTGCSMUAQAHPPC&quot; ColMoving=&quot;0&quot; ColResizing=&quot;1&quot; Copying=&quot;1&quot; DefaultsVersion=&quot;60024&quot; Deleting=&quot;1&quot; DragObject=&quot;1&quot; Dragging=&quot;1&quot; Dropping=&quot;1&quot; Editing=&quot;1&quot; ExpandAllType=&quot;1&quot; ExpandOnDrag=&quot;1&quot; ExportRows=&quot;0&quot; ExportType=&quot;2&quot; FastColumns=&quot;1&quot; FastMerge=&quot;1&quot; FastPanel=&quot;1&quot; Filtered=&quot;1&quot; Filtering=&quot;0&quot; FocusWholeRow=&quot;0&quot; Grouped=&quot;1&quot; Grouping=&quot;1&quot; HelpFile=&quot;Help.html&quot; HidePanel=&quot;0&quot; HideRootTree=&quot;0&quot; Hover=&quot;0&quot; IdChars=&quot;123456789&quot; IdPostfix=&quot;&quot; IdPrefix=&quot;Z&quot; IdSeparator=&quot;$&quot; LastId=&quot;&quot; MaxGroupLength=&quot;300&quot; MaxSortColumns=&quot;3&quot; MessageWidth=&quot;140&quot; MovingColBorder=&quot;3&quot; NoTreeLines=&quot;0&quot; PageLength=&quot;20&quot; PageLengthDiv=&quot;1&quot; PageTime=&quot;500&quot; PageUrlPostfix=&quot;&quot; PageUrlPrefix=&quot;&quot; Paging=&quot;3&quot; Pasting=&quot;1&quot; PrintRows=&quot;10&quot; PrintType=&quot;496&quot; ReloadChanged=&quot;5&quot; RemoveCollapsed=&quot;0&quot; ScrollOnDrag=&quot;1&quot; Searched=&quot;1&quot; Searching=&quot;0&quot; Selecting=&quot;1&quot; SelectingText=&quot;1&quot; ShowDeleted=&quot;0&quot; ShowDrag=&quot;1&quot; SortIcons=&quot;0&quot; Sorted=&quot;1&quot; Sorting=&quot;1&quot; StoreOriginalValues=&quot;0&quot; Style=&quot;GM&quot; StyleLap=&quot;1&quot; SuppressCfg=&quot;1&quot; SuppressMessage=&quot;1&quot; SynchroCount=&quot;100&quot; TipStart=&quot;500&quot; Version=&quot;0&quot; ZIndex=&quot;255&quot;/>

	<!-- Keys and mouse actions -->
   <Actions ClickSize=&quot;5&quot; DragSize=&quot;5&quot; EdgeSize=&quot;5&quot; KeyCodes1=&quot;Space=32,Enter=13,Esc=27,Backspace=8,Tab=9&quot; KeyCodes2=&quot;Tilde=192,Minus=189,Equal=187,Backslash=220,LeftBracket=219,RightBracket=221&quot; KeyCodes3=&quot;Semicolon=186,Apostrophe=222,Comma=188,Point=190,Slash=191&quot; KeyCodes4=&quot;F1=112,F2=113,F3=114,F4=115,F5=116,F6=117,F7=118,F8=119,F9=120,F10=121,F11=122,F12=123&quot; KeyCodes5=&quot;Ins=45,Del=46,Home=36,End=35,PageUp=33,PageDown=34,Up=38,Down=40,Left=37,Right=39,Pause=19&quot; KeyCodes6=&quot;NumDivide=111,NumStar=106,NumMinus=109,NumPlus=107,NumPoint=110&quot; KeyCodes7=&quot;Num0=96,Num1=97,Num2=98,Num3=99,Num4=100,Num5=101,Num6=102,Num7=103,Num8=104,Num9=105&quot; KeyCodes8=&quot;CapsLock=20,ScrollLock=145,NumLock=144&quot; OnAltEnterEdit=&quot;AcceptEdit&quot; OnClickButtonAdd=&quot;CopyMenuF OR AddRowF OR AddRowEnd&quot; OnClickButtonAddChild=&quot;CopyMenuF OR AddChildEndF&quot; OnClickButtonCalc=&quot;CalcOn OR CalcOff&quot; OnClickButtonCfg=&quot;ShowCfg&quot; OnClickButtonCollapseAll=&quot;CollapseAll&quot; OnClickButtonColumns=&quot;ShowColumns&quot; OnClickButtonDebug=&quot;ShowDebug&quot; OnClickButtonExpandAll=&quot;ExpandAllLoaded&quot; OnClickButtonExport=&quot;Export&quot; OnClickButtonHelp=&quot;ShowHelp&quot; OnClickButtonPrint=&quot;Print&quot; OnClickButtonReload=&quot;Reload&quot; OnClickButtonRepaint=&quot;Repaint&quot; OnClickButtonSave=&quot;Validate AND Save&quot; OnClickButtonSort=&quot;SortOn OR SortOff&quot; OnClickCell=&quot;Focus AND StartEdit+ShowDetail&quot; OnClickEditBool=&quot;Focus,ChangeBool&quot; OnClickEditRadio=&quot;Focus,ChangeRadio&quot; OnClickExpand=&quot;Focus,Expand OR Collapse&quot; OnClickHeaderDelete=&quot;UndeleteSelected OR DeleteSelected&quot; OnClickHeaderSelect=&quot;DeselectAll OR SelectAll&quot; OnClickLink=&quot;Focus,ShowLink&quot; OnClickNoFocus=&quot;FocusRow AND ShowDetail&quot; OnClickOutside=&quot;Blur&quot; OnClickPagerPage=&quot;ShowPage&quot; OnClickPanelCopy=&quot;CopyMenu&quot; OnClickPanelDelete=&quot;DeleteRow OR UndeleteRow&quot; OnClickPanelFiltered=&quot;FilterOn OR FilterOff&quot; OnClickPanelGrouped=&quot;GroupOn OR GroupOff&quot; OnClickPanelSearched=&quot;SearchOn OR SearchOff&quot; OnClickPanelSelect=&quot;SelectRow OR DeselectRow&quot; OnClickSideButton=&quot;ButtonClick&quot; OnClickSideDate=&quot;Focus,ShowCalendar&quot; OnClickSideDefaults=&quot;Focus,ShowDefaults&quot; OnClickSideFilter=&quot;Focus,ShowFilterMenu&quot; OnClickSideHtml=&quot;ButtonClick&quot; OnClickSideImg=&quot;ButtonClick&quot; OnClickSort=&quot;SortAsc OR SortDesc&quot; OnClickSortDown=&quot;SortDesc&quot; OnClickSortUp=&quot;SortAsc&quot; OnCtrlC=&quot;CCopySelected OR CCopyRow,0&quot; OnCtrlClickCell=&quot;SelectCell OR DeselectCell OR SelectRow OR DeselectRow,1&quot; OnCtrlClickGantt=&quot;DeleteGanttFlag OR DeleteGanttFlow OR DeleteGanttMain AND DeleteGanttDependencies OR DeleteGanttDependency&quot; OnCtrlClickHeaderSelect=&quot;InvertAll&quot; OnCtrlClickSort=&quot;NoSort&quot; OnCtrlClickSortDown=&quot;NoSort&quot; OnCtrlClickSortUp=&quot;NoSort&quot; OnCtrlDel=&quot;UndeleteSelected OR DeleteSelected&quot; OnCtrlDown=&quot;ShowDefaultsF OR ButtonClickF OR ShowCalendarF&quot; OnCtrlDragRow=&quot;InvertCellsFirst OR InvertRowsFirst&quot; OnCtrlEnter=&quot;ExpandF OR CollapseF&quot; OnCtrlEnterEdit=&quot;AcceptEdit&quot; OnCtrlIns=&quot;AddChildEndF&quot; OnCtrlRightClickGantt=&quot;SetGanttPercent&quot; OnCtrlSpace=&quot;SelectAll OR DeselectAll&quot; OnCtrlV=&quot;PasteToSelected OR PasteToNewRow,0&quot; OnCtrlX=&quot;ExcludeSelected OR ExcludeRow,0&quot; OnCtrlY=&quot;Redo&quot; OnCtrlZ=&quot;Undo&quot; OnDblClickButtonResize=&quot;GridResizeDefault&quot; OnDblClickGantt=&quot;EditGanttFlag OR EditGanttResource OR EditGanttDependencyLag OR NewGanttMilestone OR NewGanttFlag&quot; OnDblClickResize=&quot;GridResizeDefault&quot; OnDel=&quot;DeleteRowF OR UndeleteRowF&quot; OnDown=&quot;GoDown,1&quot; OnDownEdit=&quot;GoDownEdit AND StartEdit,1&quot; OnDragButtonResize=&quot;GridResize&quot; OnDragDropCol=&quot;DropColMove&quot; OnDragGantt=&quot;DragGantt&quot; OnDragHeader=&quot;ColMove&quot; OnDragHeaderLeft=&quot;ColResize&quot; OnDragHeaderRight=&quot;ColResize&quot; OnDragOverBody=&quot;ColorHover,HoverRowCell&quot; OnDragOverButton=&quot;ColorHover&quot; OnDragOverCell=&quot;CursorDragType&quot; OnDragOverFixed=&quot;ColorHover,HoverRowCell&quot; OnDragOverHeader=&quot;ColorHover&quot; OnDragOverNoFocus=&quot;ColorHover&quot; OnDragOverPagerPage=&quot;HoverPager&quot; OnDragOverPanel=&quot;ColorHover,HoverRow&quot; OnDragOverSpace=&quot;ColorHover&quot; OnDragPagerHeaderRight=&quot;ColResize&quot; OnDragPanelMove=&quot;DragRow&quot; OnDragPanelSelect=&quot;InvertOddRows&quot; OnDragResize=&quot;GridResize&quot; OnDragRow=&quot;DragSelected OR DragRow&quot; OnEnd=&quot;GoLast,1&quot; OnEnter=&quot;ChangeBoolF OR ChangeRadioRightF OR StartEdit OR ShowLinkF&quot; OnEnterEdit=&quot;AcceptEdit&quot; OnEscEdit=&quot;CancelEdit&quot; OnF2=&quot;StartEdit&quot; OnHome=&quot;GoFirst,1&quot; OnIns=&quot;AddRowF&quot; OnLeft=&quot;GoLeft,1&quot; OnLeftEdit=&quot;ChangeRadioLeft&quot; OnMouseOverBody=&quot;ColorHover,HoverRowCell&quot; OnMouseOverButton=&quot;ColorHover,CursorPointer&quot; OnMouseOverButtonResize=&quot;CursorResizeGrid&quot; OnMouseOverEditBool=&quot;CursorPointer&quot; OnMouseOverEditEnum=&quot;CursorPointer&quot; OnMouseOverEditRadio=&quot;CursorPointer&quot; OnMouseOverEditable=&quot;CursorText&quot; OnMouseOverExpand=&quot;CursorPointer&quot; OnMouseOverFixed=&quot;ColorHover,HoverRowCell&quot; OnMouseOverHeader=&quot;ColorHover,HoverRow&quot; OnMouseOverHeaderLeft=&quot;CursorResize&quot; OnMouseOverHeaderMove=&quot;CursorMove&quot; OnMouseOverHeaderOff=&quot;CursorDefault&quot; OnMouseOverHeaderRight=&quot;CursorResize&quot; OnMouseOverNoFocus=&quot;CursorDefault&quot; OnMouseOverNothing=&quot;CursorDefault&quot; OnMouseOverPagerHeaderRight=&quot;CursorResize&quot; OnMouseOverPagerPage=&quot;HoverPager&quot; OnMouseOverPanel=&quot;ColorHover,HoverRow,CursorPointer&quot; OnMouseOverPanelMove=&quot;CursorMove&quot; OnMouseOverPanelOff=&quot;CursorDefault&quot; OnMouseOverReadOnly=&quot;CursorDefault&quot; OnMouseOverResize=&quot;CursorResizeGrid&quot; OnMouseOverSide=&quot;CursorPointer&quot; OnMouseOverSort=&quot;CursorPointer&quot; OnMouseOverSortDown=&quot;CursorPointer&quot; OnMouseOverSortUp=&quot;CursorPointer&quot; OnMouseOverSpace=&quot;ColorHover&quot; OnMouseOverSpaceOff=&quot;CursorDefault&quot; OnMouseOverTree=&quot;CursorDefault&quot; OnPageDown=&quot;PageDown,1&quot; OnPageUp=&quot;PageUp,1&quot; OnRight=&quot;GoRight,1&quot; OnRightClickCell=&quot;ShowPopupMenu&quot; OnRightClickGantt=&quot;GanttMenu&quot; OnRightEdit=&quot;ChangeRadioRight&quot; OnShiftClickCell=&quot;InvertCellRangeFirst OR InvertRowRangeFirst,1&quot; OnShiftTab=&quot;TabLeft,1&quot; OnShiftTabEdit=&quot;TabLeftEdit AND StartEdit,1&quot; OnShiftTabEnum=&quot;TabLeftEdit AND StartEdit,1&quot; OnSpace=&quot;SelectRowF OR DeselectRowF&quot; OnSpaceEdit=&quot;ChangeBoolF&quot; OnTab=&quot;TabRight,1&quot; OnTabEdit=&quot;TabRightEdit AND StartEdit,1&quot; OnTabEnum=&quot;TabRightEdit AND StartEdit,1&quot; OnUp=&quot;GoUp,1&quot; OnUpEdit=&quot;GoUpEdit AND StartEdit,1&quot; xxxOnMouseOverGantt=&quot;HoverGantt&quot;/>
   
	<!-- Default rows and column -->
	<Def>
		<!-- Default row for all rows -->
		<D AcceptChild=&quot;1&quot; Added=&quot;0&quot; CDef=&quot;R&quot; Calculated=&quot;0&quot; CanCopy=&quot;1&quot; CanDelete=&quot;1&quot; CanDrag=&quot;1&quot; CanEdit=&quot;1&quot; CanExpand=&quot;1&quot; CanExport=&quot;1&quot; CanFilter=&quot;1&quot; CanFocus=&quot;1&quot; CanGroup=&quot;1&quot; CanSelect=&quot;1&quot; CanSort=&quot;1&quot; Changed=&quot;0&quot; Deleted=&quot;0&quot; Error=&quot;0&quot; Expanded=&quot;1&quot; Kind=&quot;Data&quot; MaxChildren=&quot;10000&quot; MaxChildrenDiff=&quot;20&quot; Moved=&quot;0&quot; Name=&quot;R&quot; Recalc=&quot;3&quot; Selected=&quot;0&quot; Visible=&quot;1&quot;/>
      
		<!-- Default row for fixed rows -->
		<D AcceptChild=&quot;0&quot; CanCopy=&quot;0&quot; CanDelete=&quot;0&quot; CanDrag=&quot;0&quot; CanFilter=&quot;0&quot; CanSelect=&quot;0&quot; Def=&quot;R&quot; Name=&quot;Fixed&quot;/>

		<!-- Default row for space rows -->
		<D AcceptChild=&quot;0&quot; CalcOrder=&quot;&quot; CanCopy=&quot;0&quot; CanDelete=&quot;0&quot; CanDrag=&quot;0&quot; CanFilter=&quot;0&quot; CanFocus=&quot;1&quot; CanSelect=&quot;0&quot; Def=&quot;&quot; Name=&quot;Solid&quot; Visible=&quot;1&quot;/>

		<!-- Default row created when grouping -->
		<D CanCopy=&quot;0&quot; CanDelete=&quot;0&quot; CanDrag=&quot;0&quot; CanEdit=&quot;0&quot; CanFilter=&quot;0&quot; CanSearch=&quot;0&quot; Def=&quot;R&quot; Expanded=&quot;0&quot; Group=&quot;1&quot; Name=&quot;Group&quot;/>

		<!-- Default column -->
		<D AutoWidth=&quot;1&quot; ButtonPos=&quot;1&quot; CanCopy=&quot;1&quot; CanDrag=&quot;1&quot; CanExport=&quot;1&quot; CanFilter=&quot;1&quot; CanGroup=&quot;1&quot; CanHide=&quot;1&quot; CanMove=&quot;2&quot; CanResize=&quot;1&quot; CanSearch=&quot;1&quot; CanSort=&quot;1&quot; EditFormat=&quot;&quot; Format=&quot;&quot; Name=&quot;C&quot; ShowHint=&quot;1&quot; SortType=&quot;0&quot; Type=&quot;Text&quot; WhiteChars=&quot; &quot; WidthPad=&quot;20&quot;/>
      <D AcceptChild=&quot;0&quot; Added=&quot;0&quot; Calculated=&quot;0&quot; CanCopy=&quot;1&quot; CanDrag=&quot;0&quot; CanEdit=&quot;0&quot; CanExport=&quot;1&quot; CanFilter=&quot;0&quot; CanFocus=&quot;0&quot; Changed=&quot;0&quot; Def=&quot;&quot; Deleted=&quot;0&quot; Error=&quot;0&quot; Expanded=&quot;0&quot; Moved=&quot;0&quot; Name=&quot;Header&quot; Selected=&quot;0&quot; Visible=&quot;1&quot;/>         
	</Def>

	<!-- First Header row = column captions -->
   <Header CanCopy=&quot;0&quot; CanDelete=&quot;0&quot; CanDrag=&quot;0&quot; CanSelect=&quot;0&quot; Def=&quot;Header&quot; Kind=&quot;Header&quot; id=&quot;Header&quot;/>
   
   <!-- Root settings -->
   <Root AddParent=&quot;0&quot; CDef=&quot;R&quot; CanDelete=&quot;1&quot; CanSelect=&quot;1&quot; CanSort=&quot;1&quot;/>

   <!-- Row left panel -->
	<Panel CanCopy=&quot;0&quot; CanDrag=&quot;1&quot; CanExport=&quot;0&quot; CanHide=&quot;1&quot; CanMove=&quot;0&quot; CanResize=&quot;0&quot; Copy=&quot;0&quot; Delete=&quot;0&quot; Move=&quot;0&quot; Select=&quot;1&quot; Visible=&quot;1&quot;/>

	<!-- Right side pager -->
	<Pager CanHide=&quot;1&quot; CanResize=&quot;1&quot; Caption=&quot;Pager&quot; MinWidth=&quot;10&quot; Visible=&quot;0&quot; Width=&quot;100&quot;/>

	<!-- Bottom toolbar -->
   <Toolbar AddChildCopyMenu=&quot;CopySelectedChildEnd,CopySelectedTreeChildEnd,CopySelectedEmptyChildEnd,AddChildEnd&quot; AddChildType=&quot;Button&quot; AddChildVisibleFormula=&quot;Grid.Adding &amp;amp;&amp;amp; !!Grid.MainCol&quot; AddCopyMenu=&quot;CopyRow,CopyTree,CopyEmpty,CopySelected,CopySelectedTree,CopySelectedEmpty,CopySelectedEnd,CopySelectedTreeEnd,CopySelectedEmptyEnd,AddRow,AddRowEnd&quot; AddType=&quot;Button&quot; AddVisibleFormula=&quot;Grid.Adding&quot; CalcFormula=&quot;Grid.Calculated&quot; CalcType=&quot;Button&quot; CanEdit=&quot;0&quot; CanFocus=&quot;0&quot; Cells=&quot;Save,Reload,Repaint,Print,Export,Add,AddChild,Sort,Calc,ExpandAll,CollapseAll,Columns,Cfg,Help,Debug,StyleTitle,StyleStandard,StyleLight,StyleOffice,StyleModern,StyleBorders,StyleRobust,Empty,Formula,Resize&quot; CfgType=&quot;Button&quot; CollapseAllType=&quot;Button&quot; CollapseAllVisibleFormula=&quot;!!Grid.MainCol&quot; ColumnsType=&quot;Button&quot; DebugType=&quot;Button&quot; DebugVisibleFormula=&quot;!!Grid.DebugFlags.length&quot; EmptyNoColor=&quot;1&quot; EmptyRelWidth=&quot;1&quot; ExpandAllType=&quot;Button&quot; ExpandAllVisibleFormula=&quot;!!Grid.MainCol&quot; ExportType=&quot;Button&quot; ExportVisibleFormula=&quot;!!Grid.Data.Export.Url&quot; FormulaNoColor=&quot;1&quot; FormulaWidth=&quot;-1&quot; HelpType=&quot;Button&quot; NoColorState=&quot;1&quot; NoUpload=&quot;1&quot; PrintType=&quot;Button&quot; ReloadType=&quot;Button&quot; ReloadVisibleFormula=&quot;!Grid.Detail&quot; RepaintType=&quot;Button&quot; RepaintVisibleFormula=&quot;Grid.Paging&amp;amp;&amp;amp;Grid.AllPages&quot; ResizeNoColor=&quot;1&quot; ResizeType=&quot;Button&quot; ResizeVisibleFormula=&quot;!!Grid.ResizingMain&quot; SaveType=&quot;Button&quot; SaveVisibleFormula=&quot;(Grid.Data.Upload.Url || Grid.Data.Upload.Tag) &amp;amp;&amp;amp; !Grid.Detail?1:0&quot; SortFormula=&quot;Grid.Sorted&quot; SortType=&quot;Button&quot; SortVisibleFormula=&quot;Grid.Sorting&quot; Space=&quot;4&quot; StyleBordersAction=&quot;Grid.SetStyle('GB',0,1)&quot; StyleBordersFormula=&quot;Grid.Style=='GB'&quot; StyleBordersIcon=&quot;Borders&quot; StyleBordersTab=&quot;1&quot; StyleBordersType=&quot;Button&quot; StyleBordersWidth=&quot;-1&quot; StyleLightAction=&quot;Grid.SetStyle('GL',0,1)&quot; StyleLightFormula=&quot;Grid.Style=='GL'&quot; StyleLightIcon=&quot;Light&quot; StyleLightTab=&quot;1&quot; StyleLightType=&quot;Button&quot; StyleLightWidth=&quot;-1&quot; StyleModernAction=&quot;Grid.SetStyle('GM',0,1)&quot; StyleModernFormula=&quot;Grid.Style=='GM'&quot; StyleModernIcon=&quot;Modern&quot; StyleModernTab=&quot;1&quot; StyleModernType=&quot;Button&quot; StyleModernWidth=&quot;-1&quot; StyleOfficeAction=&quot;Grid.SetStyle('GO',0,1)&quot; StyleOfficeFormula=&quot;Grid.Style=='GO'&quot; StyleOfficeIcon=&quot;Office&quot; StyleOfficeTab=&quot;1&quot; StyleOfficeType=&quot;Button&quot; StyleOfficeWidth=&quot;-1&quot; StyleRobustAction=&quot;Grid.SetStyle('GR',0,1)&quot; StyleRobustFormula=&quot;Grid.Style=='GR'&quot; StyleRobustIcon=&quot;Robust&quot; StyleRobustTab=&quot;1&quot; StyleRobustType=&quot;Button&quot; StyleRobustWidth=&quot;-1&quot; StyleStandardAction=&quot;Grid.SetStyle('GS',0,1)&quot; StyleStandardFormula=&quot;Grid.Style=='GS'&quot; StyleStandardIcon=&quot;Standard&quot; StyleStandardTab=&quot;1&quot; StyleStandardType=&quot;Button&quot; StyleStandardWidth=&quot;-1&quot; StyleTitle=&quot;&amp;lt;span style='color:#999;'&amp;gt;Style:&amp;lt;/span&amp;gt;&quot; StyleTitleNoColor=&quot;1&quot; StyleTitleType=&quot;Html&quot; StyleTitleWidth=&quot;-1&quot; Styles=&quot;1&quot; Tag=&quot;&quot; Visible=&quot;0&quot; id=&quot;Toolbar&quot;/>

   <!-- Configuration menu -->
	<MenuCfg AutoSort=&quot;1&quot; AutoUpdate=&quot;1&quot; CheckUpdates=&quot;1&quot; MouseHover=&quot;1&quot; Separator1=&quot;1&quot; ShowAllPages=&quot;1&quot; ShowDeleted=&quot;1&quot; ShowDrag=&quot;1&quot; ShowIcons=&quot;1&quot; ShowPager=&quot;1&quot; ShowPanel=&quot;1&quot;/>
</Grid>">
<input type="hidden" name="Grid_Text" id="Grid_Text" value="<?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?><Grid>
   <Cfg TextVersion=&quot;60024&quot;/>
   <Lang>
      
      <Alert AddEmpty=&quot;Do you want to add a new empty row?&quot; And=&quot; and &quot; AskTimeout=&quot;Cannot download data, server timeout !&amp;#10;Do you want to repeat request ?&quot; AskUploadTimeout=&quot;Cannot upload data, server timeout !&amp;#10;Do you want to send data again ?&quot; CanCancelChanges=&quot;cancels all changes&quot; CanReloadChanges=&quot;updates all changes to server&quot; CanReloadEnd=&quot;! Do you want to continue?&quot; CanReloadSelect=&quot;clears all selection&quot; CanReloadStart=&quot;This command &quot; ConfirmDel=&quot;Do you really want to delete&quot; DateClear=&quot;Clear&quot; DateOk=&quot;OK&quot; DateToday=&quot;Today&quot; ErrAdd=&quot;Cannot add new row here!&quot; ErrAddSelected1=&quot;There are selected rows, but they cannot be moved or copied together!&quot; ErrAddSelected2=&quot;There are selected rows, but they cannot be moved or copied to the target row!&quot; ErrBadUrl=&quot;Empty or bad data URL&quot; ErrCellNoUrl=&quot;No Url set for cell download!&amp;#10;(&amp;lt;treegrid Cell_Url=''&amp;gt;&quot; ErrCheck=&quot;Synchronizing with server failed!&amp;#10;Do you want to temporary disable the checking for updates?&quot; ErrDragSelected=&quot;These selected rows cannot be dragged together&quot; ErrEmptyReturn=&quot;Server response is empty!&amp;#10;&amp;#10;Server must return XML with at least &amp;lt;Grid&amp;gt;&amp;lt;IO Result='0'/&amp;gt;&amp;lt;/Grid&amp;gt;&quot; ErrFormatReturn=&quot;Bad XML data was returned from server&quot; ErrGanttDep=&quot;Cannot connect dependency here&quot; ErrGanttPercentEdit=&quot;Wrong input, the value must be in range 0 - 100&quot; ErrHide=&quot;You cannot hide all variable columns!&quot; ErrHideExt=&quot;Width of all fixed columns is too wide!&quot; ErrHtmlReturn=&quot;Server returned HTML instead of XML!&quot; ErrPageNoUrl=&quot;No Url set for page download!&amp;#10;(&amp;lt;treegrid Page_Url=''&amp;gt;&quot; ErrPasteRange=&quot;Pasted range size [%d rows, %d columns] is not the same as selected area [%d,%d] !&amp;#10;Do you want to paste data anyway ?&quot; ErrPermitPopup=&quot;&amp;#10;&amp;#10; Permit popup windows to see server request and response&quot; ErrPrint=&quot;The document was not successfully printed&quot; ErrPrintOpen=&quot;The print window could not be opened&amp;#10;&amp;#10; Permit popup windows to let print the grid&quot; ErrResultMask=&quot;The input value is incorrect !&quot; ErrSeeDebug=&quot;&amp;#10;&amp;#10; Look at popup window or its source code to see server request and response&quot; ErrSetDebug=&quot;&amp;#10;&amp;#10; Set &amp;lt;treegrid ... Debug='1' ...&amp;gt; to see server response&quot; ErrTextReturn=&quot;Server returned plain text instead of XML!&quot; ErrTimeout=&quot;Cannot download data, timeout expired&quot; ErrUpload=&quot;It is not certain that data have been uploaded correctly&quot; ErrXMLFormat=&quot;Bad input XML format&quot; ErrXMLSupport=&quot;Browser does not support XML functions&amp;#10;Supported from IE 5.0+, Mozilla 1.0+, Opera 7.60+&amp;#10;In IE the Security option 'Run ActiveX controls and plug-ins' must be enabled&quot; GanttDependencyLagEdit=&quot;Enter the lag for the dependency&quot; GanttFlagEdit=&quot;Enter text for the flag&quot; GanttPercentEdit=&quot;Enter new completed status in percent&quot; GanttResourceEdit=&quot;Enter the resource text&quot; Invalid=&quot;Invalid value&quot; MenuAll=&quot;All on&quot; MenuClear=&quot;Clear&quot; MenuOk=&quot;OK&quot; NoActivePage=&quot;&quot; NoDebugInfo=&quot;&amp;#10;&amp;#10;No information is provided due debugging level 0&quot; NotFound=&quot;Nothing found&quot; PasteMore=&quot;Do you want to paste values to %d rows from actual row?&quot; Row2=&quot;row&quot; SearchError=&quot;The search expression is invalid !&quot; SearchHelp=&quot;Enter string to search for like in Google&amp;#10;&amp;#10;individual keywords separate by space&amp;#10;phrases place into double quotes&amp;#10;variants separate by uppercase OR keyword&amp;#10;exceptions precede by &amp;quot;-&amp;quot; (minus)&amp;#10;&amp;#10;Or enter expression to search by&amp;#10;&amp;#10;specify columns caption to compare&amp;#10;use operators &amp;lt; &amp;lt;= &amp;gt; &amp;gt;= = &amp;lt;&amp;gt; ( ) + - * /&amp;#10;use AND OR keywords to join expressions&amp;#10;use special keywords STARTS ENDS CONTAINS&amp;#10;   for comparing strings (NOT to negate)&amp;#10;example: customer starts martin and date &amp;lt;= 1/1/2006&quot; SearchStart=&quot;Nothing found&amp;#10;Do you want to continue from beginning?&quot; SelRows=&quot;selected rows&quot; SoapErr=&quot;Unknown SOAP error&quot; StyleErr=&quot;Cannot load TreeGrid CSS style !&quot; UploadTimeout=&quot;Cannot upload data, timeout expired&quot; V2_3=&quot;&quot; V3_1=&quot;&quot; V3_2=&quot;&quot; V3_3=&quot;&quot; V3_5=&quot;&quot; V4_0=&quot;&quot; V4_2=&quot;&quot; V4_4_3=&quot;&quot; V4_7=&quot;&quot; V5_0_7=&quot;&quot; V5_1=&quot;&quot; V5_3=&quot;&quot; V5_6=&quot;&quot; V5_9=&quot;&quot; V6_0=&quot;&quot;/>
      
      <Text AddChild=&quot;Add new empty row as the first child&quot; AddChildEnd=&quot;Add new empty row as the last child&quot; AddCopy=&quot;Copy selected rows&quot; AddCopyChild=&quot;Copy with children&quot; AddEmpty=&quot;Add new empty row&quot; AddMove=&quot;Move selected rows&quot; AddRow=&quot;Add new empty row above&quot; AddRowBelow=&quot;Add new empty row below&quot; AddRowEnd=&quot;Add new empty row to the end&quot; AddRowEndGrid=&quot;Add new empty row to the end of grid&quot; AddRowEndPage=&quot;Add new empty row to the end of page&quot; And=&quot;and&quot; AssignGanttResource=&quot;Assign resources&quot; BadLayoutErr=&quot;&amp;lt;b style='color:red;'&amp;gt;Bad or missing TreeGrid layout ! &amp;lt;br/&amp;gt;TreeGrid cannot render&amp;lt;/b&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;span style='color:blue;'&amp;gt;Minimal required layout is:&amp;lt;br/&amp;gt;&amp;amp;lt;Grid&amp;amp;gt;&amp;amp;lt;Cols&amp;amp;gt;&amp;amp;lt;C Name='Col'/&amp;amp;gt;&amp;amp;lt;/Cols&amp;amp;gt;&amp;lt;br/&amp;gt;&amp;amp;lt;Body&amp;amp;gt;&amp;amp;lt;B/&amp;amp;gt;&amp;amp;lt;/Body&amp;amp;gt;&amp;amp;lt;/Grid&amp;amp;gt;&amp;lt;/span&amp;gt;&quot; BadLoadData=&quot;&amp;lt;b style='color:red;'&amp;gt;Bad or missing TreeGrid data source! &amp;lt;br/&amp;gt;TreeGrid cannot render&amp;lt;/b&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;span style='color:blue;'&amp;gt;Set at least one data source attribute in &amp;amp;lt;treegrid&amp;gt;:&amp;lt;br/&amp;gt;Data_Url, Data_Tag, Data_Data,&amp;lt;br/&amp;gt;Layout_Url, Layout_Tag, Layout_Data&amp;lt;/span&amp;gt;&quot; Caching=&quot;Caching images ...&quot; Calculate=&quot;Calculating cells ...&quot; Cancel=&quot;Cancel action&quot; ColMove=&quot;Moving column&quot; ColUpdate=&quot;Updating columns ...&quot; ColWidth=&quot;Changing width of column&quot; CollapseAll=&quot;Collapsing all rows&quot; ColumnsCaption=&quot;Select columns to display&quot; Contains=&quot;contains,has&quot; CopyEmpty=&quot;Duplicate the row tree structure&quot; CopyEmptyBelow=&quot;Duplicate the row tree structure&quot; CopyRow=&quot;Duplicate the row&quot; CopyRowBelow=&quot;Duplicate the row&quot; CopySelected=&quot;Copy selected rows above&quot; CopySelectedBelow=&quot;Copy selected rows below&quot; CopySelectedChild=&quot;Copy selected rows as the first children&quot; CopySelectedChildEnd=&quot;Copy selected rows as the last children&quot; CopySelectedEmpty=&quot;Copy selected row tree structures above&quot; CopySelectedEmptyBelow=&quot;Copy selected row tree structures below&quot; CopySelectedEmptyChild=&quot;Copy selected row tree structures as the first children&quot; CopySelectedEmptyChildEnd=&quot;Copy selected row tree structures as the last children&quot; CopySelectedEmptyEnd=&quot;Copy selected row tree structures to the end&quot; CopySelectedEmptyEndGrid=&quot;Copy selected row tree structures to the end of grid&quot; CopySelectedEmptyEndPage=&quot;Copy selected row tree structures to the end of page&quot; CopySelectedEnd=&quot;Copy selected rows to the end&quot; CopySelectedEndGrid=&quot;Copy selected rows to the end of grid&quot; CopySelectedEndPage=&quot;Copy selected rows to the end of page&quot; CopySelectedTree=&quot;Copy selected row trees above&quot; CopySelectedTreeBelow=&quot;Copy selected row trees below&quot; CopySelectedTreeChild=&quot;Copy selected row trees as the first children&quot; CopySelectedTreeChildEnd=&quot;Copy selected row trees as the last children&quot; CopySelectedTreeEnd=&quot;Copy selected row trees to the end&quot; CopySelectedTreeEndGrid=&quot;Copy selected row trees to the end of grid&quot; CopySelectedTreeEndPage=&quot;Copy selected row trees to the end of page&quot; CopyTree=&quot;Duplicate the row tree&quot; CopyTreeBelow=&quot;Duplicate the row tree&quot; CorrectAllDependencies=&quot;Correct all dependencies in chart&quot; CorrectDep=&quot;Moving %d bars&quot; CorrectRelatedDependencies=&quot;Correct related dependencies&quot; CreateGantt=&quot;Creating Gantt ...&quot; DataErr=&quot;TreeGrid cannot render&amp;lt;br/&amp;gt;Missing or wrong input data&quot; DefaultsAll=&quot;Select all&quot; DefaultsButton=&quot;Select ...&quot; DefaultsDate=&quot;Select date ...&quot; DefaultsFilterOff=&quot;(All)&quot; DelAllGanttDep=&quot;Disconnect all dependency lines&quot; DelGanttAll=&quot;Clear the gantt cell&quot; DelGanttDepEnd=&quot;Disconnect line from &amp;lt;b style='color:blue;'&amp;gt; %d&amp;lt;/b&amp;gt;&quot; DelGanttDepStart=&quot;Disconnect line to &amp;lt;b style='color:#00AA00;'&amp;gt; %d&amp;lt;/b&amp;gt;&quot; DelGanttFlag=&quot;Delete selected flag&quot; DelGanttFlags=&quot;Delete all flags&quot; DelGanttFlow=&quot;Delete real flow&quot; DelGanttFlowPart=&quot;Delete selected real flow bar&quot; DelGanttMain=&quot;Delete main bar&quot; DelGanttMainDep=&quot;Delete main bar and dependencies&quot; DelGanttMilestone=&quot;Delete milestone&quot; DelGanttMilestoneDep=&quot;Delete milestone and dependencies&quot; DelSelected=&quot;Deleting selected rows&quot; DoFilter=&quot;Filtering rows ...&quot; DoRedo=&quot;Performing redo ...&quot; DoUndo=&quot;Performing undo ...&quot; DragObjectCopy=&quot;copying row &amp;lt;b style='color:green;'&amp;gt;%d&amp;lt;/b&amp;gt;&quot; DragObjectMoreCopy=&quot;copying &amp;lt;b style='color:blue;'&amp;gt;%d&amp;lt;/b&amp;gt; rows&quot; DragObjectMoreMove=&quot;moving &amp;lt;b style='color:blue;'&amp;gt;%d&amp;lt;/b&amp;gt; rows&quot; DragObjectMove=&quot;moving row &amp;lt;b style='color:green;'&amp;gt;%d&amp;lt;/b&amp;gt;&quot; EditGanttDepLag=&quot;Change lag of line to &amp;lt;b style='color:#00AA00;'&amp;gt; %d&amp;lt;/b&amp;gt;&quot; EditGanttFlag=&quot;Enter the flag text&quot; EditGanttPercent=&quot;Enter completed status&quot; EditGanttResource=&quot;Change resources&quot; Ends=&quot;ends,ends by, ends with&quot; ExpandAll=&quot;Expanding all rows&quot; ExportProgress=&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Generating report&amp;lt;/b&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;Finished %d rows from %d&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;div style='text-align:left;width:150px;border:1px solid blue;padding:2px;'&amp;gt;&amp;lt;div style='width:%d%;height:10px;background:green;'&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/center&amp;gt;&quot; GanttUpdate=&quot;Updating Gantt chart ...&quot; Group=&quot;Grouping rows ...&quot; GroupCustom=&quot;To group by, drag column caption here ...&quot; ImgEdit=&quot;|Url:|W:|H:|L:|T:&quot; Items=&quot;Items %d - %d&quot; Layout=&quot;&quot; Load=&quot;Loading data ...&quot; LoadStyles=&quot;Loading style ...&quot; NewGanttFlag=&quot;Add new flag to selected point&quot; NoMenuItem=&quot;None available&quot; NoPages=&quot;Empty&quot; Not=&quot;not&quot; Or=&quot;or&quot; Page=&quot;Page&quot; PageErr=&quot;Cannot download this data part !&quot; Password=&quot;***&quot; Picture=&quot;Picture&quot; Print=&quot;&amp;lt;h2&amp;gt;&amp;lt;center&amp;gt;Please wait while generating report for printing ...&amp;lt;/center&amp;gt;&amp;lt;/h2&amp;gt;&quot; Printed=&quot;Please switch to window containing the report to print it&quot; ReRender=&quot;Repainting ...&quot; Render=&quot;Rendering ...&quot; Save=&quot;Saving data ...&quot; Search=&quot;Searching ...&quot; SearchClear=&quot;Clear&quot; SearchColor=&quot;Color&quot; SearchFilter=&quot;Filter&quot; SearchFind=&quot;Find&quot; SearchHelp=&quot;Help&quot; SearchMethodList=&quot;|Automatic|Search&amp;amp;#160;like&amp;amp;#160;Google|Search&amp;amp;#160;by&amp;amp;#160;expression&quot; SearchSearch=&quot;Search&quot; SearchSelect=&quot;Select&quot; SelectAll=&quot;Changing selection of all rows&quot; SelectDate=&quot;Select date&quot; SelectDateMY=&quot;Select date&quot; SetGanttPercent=&quot;Update completed status to selected point&quot; SetStyle=&quot;Updating style ...&quot; Sort=&quot;Sorting rows ...&quot; StartErr=&quot;&amp;lt;b style='color:red;'&amp;gt;Fatal error ! &amp;lt;br/&amp;gt;TreeGrid cannot render&amp;lt;/b&amp;gt;&quot; Starts=&quot;starts,starts with,starts by,begins,begins with,begins by&quot; UpdateCfg=&quot;Updating settings ...&quot; UpdateGantt=&quot;Updating Gantt ...&quot; UpdateGrid=&quot;Updating view&quot; UpdateTree=&quot;Updating tree ...&quot; UpdateValues=&quot;Updating values ...&quot; V2_3=&quot;&quot; V2_5=&quot;&quot; V2_6=&quot;&quot; V3_0=&quot;&quot; V3_1=&quot;&quot; V3_2=&quot;&quot; V3_5=&quot;&quot; V3_9=&quot;&quot; V4_2=&quot;&quot; V4_3=&quot;&quot; V4_5=&quot;&quot; V4_5_7=&quot;&quot; V4_7=&quot;&quot; V5_0_1=&quot;&quot; V5_5=&quot;&quot; V5_6=&quot;&quot; V5_6_4=&quot;&quot; V5_9=&quot;&quot; V6_0=&quot;&quot;/>
      
      <MenuCfg All=&quot;Show all&quot; AutoSort=&quot;Auto sort rows after change&quot; AutoUpdate=&quot;Auto update changes to server&quot; Cancel=&quot;Cancel&quot; Caption=&quot;TreeGrid settings&quot; CheckUpdates=&quot;Check for updates on server every&quot; CheckUpdates0=&quot;Off&quot; CheckUpdates10=&quot;10 seconds&quot; CheckUpdates120=&quot;2 minutes&quot; CheckUpdates2=&quot;2 seconds&quot; CheckUpdates30=&quot;30 seconds&quot; CheckUpdates300=&quot;5 minutes&quot; CheckUpdates5=&quot;5 seconds&quot; CheckUpdates60=&quot;1 minute&quot; CheckUpdates600=&quot;10 minutes&quot; Clear=&quot;Hide all&quot; Hover1=&quot;None&quot; Hover2=&quot;Cell only&quot; Hover3=&quot;Cell and row color&quot; Hover4=&quot;Cell and row cursor&quot; MouseHover=&quot;Mouse hover&quot; OK=&quot;OK&quot; ShowAllPages=&quot;Show all pages&quot; ShowDeleted=&quot;Show deleted rows (in red)&quot; ShowDrag=&quot;Show dragged object&quot; ShowPager=&quot;Show pager&quot; ShowPanel=&quot;Show row's left panel&quot; SortClick=&quot;Sorting click&quot; SortClick1=&quot;Simple, no icons&quot; SortClick2=&quot;Simple&quot; SortClick3=&quot;Directional, icons only&quot; SortClick4=&quot;Directional&quot; V2_3=&quot;&quot; V2_6=&quot;&quot; V4_4=&quot;&quot; V5_0_20=&quot;&quot; V6_0=&quot;&quot;/>
      
      <MenuFilter F0=&quot;Off&quot; F1=&quot;Equal&quot; F10=&quot;Does not end with&quot; F11=&quot;Contains&quot; F12=&quot;Does not contain&quot; F2=&quot;Not equal&quot; F3=&quot;Less than&quot; F4=&quot;Less than or equal&quot; F5=&quot;Greater than&quot; F6=&quot;Greater than or equal&quot; F7=&quot;Begins with&quot; F8=&quot;Does not begin with&quot; F9=&quot;Ends with&quot;/>
      
      <Format AMDesignator=&quot;AM&quot; Cont=&quot;...&quot; ContLeft=&quot;... &quot; ContRight=&quot; ...&quot; D=&quot;d. MMMM yyyy&quot; DateSeparator=&quot;/&quot; Day1CharNames=&quot;S,M,T,W,T,F,S&quot; Day2CharNames=&quot;Su,Mo,Tu,We,Th,Fr,Sa&quot; DayNumbers=&quot;1st,2nd,3rd,4th,5th,6th,7th,8th,9th,10th,11th,12th,13th,14th,15th,16th,17th,18th,19th,20th,21st,22nd,23rd,24th,25th,26th,27th,28th,29th,30th,31st&quot; DecimalSeparator=&quot;.&quot; EmptyDate=&quot;&quot; F=&quot;d. MMMM yyyy H:mm:ss&quot; FirstWeekDay=&quot;0&quot; G=&quot;M/d/yyyy H:mm:ss&quot; GMT=&quot;1&quot; GroupSeparator=&quot;,&quot; Halves=&quot;I,II&quot; InputDecimalSeparators=&quot;.&quot; InputGroupSeparators=&quot;,&quot; LongDayNames=&quot;Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday&quot; LongMonthNames=&quot;January,February,March,April,May,June,July,August,September,October,November,December&quot; LongMonthNames2=&quot;January,February,March,April,May,June,July,August,September,October,November,December&quot; M=&quot;d. MMMM&quot; NaD=&quot;NaN&quot; NaN=&quot;NaN&quot; PMDesignator=&quot;PM&quot; Percent=&quot;%&quot; Quarters=&quot;I,II,III,IV&quot; R=&quot;ddd MMM d HH:mm:ss UTCzzzzz yyyy&quot; RangeSeparator=&quot;~&quot; RangeSeparatorHtml=&quot; ~ &quot; ShortDayNames=&quot;Sun,Mon,Tue,Wed,Thu,Fri,Sat&quot; ShortMonthNames=&quot;Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec&quot; T=&quot;H:mm:ss&quot; TimeSeparator=&quot;:&quot; U=&quot;d. MMMM yyyy HH:mm:ss&quot; ValueSeparator=&quot;;&quot; ValueSeparatorHtml=&quot;; &quot; Y=&quot;MMMMMMM yyyy&quot; d=&quot;M/d/yyyy&quot; f=&quot;d. MMMM yyyy H:mm&quot; g=&quot;M/d/yyyy H:mm&quot; m=&quot;d. MMMM&quot; nc=&quot;$###########0.00&quot; ne=&quot;0.000000 E+000&quot; nf=&quot;0.00&quot; ng=&quot;0.######&quot; ngg=&quot;0.###### E+00&quot; np=&quot;0.00%&quot; nr=&quot;0.0000&quot; nrg=&quot;0.0000 E+00&quot; r=&quot;ddd MMM d HH:mm:ss UTCzzzzz yyyy&quot; s=&quot;yyyy-MM-ddTHH:mm:ss&quot; t=&quot;H:mm&quot; u=&quot;yyyy-MM-dd HH:mm:ssZ&quot; y=&quot;MMMMMMM yyyy&quot;/>
   </Lang>
   
   <Toolbar AddChildTitle=&quot;Add new child row or move or copy selected rows to actual cursor position&quot; AddTitle=&quot;Add new row or move or copy selected rows&quot; CalcTitle=&quot;Enable calculations and re-calculate grid now&quot; CalcTitle1=&quot;Disable calculations to edit cell values faster&quot; CfgTitle=&quot;TreeGrid user settings&quot; CollapseAllTitle=&quot;Collapse all rows&quot; ColumnsTitle=&quot;Displays menu to choose visible columns&quot; DebugTitle=&quot;Shows debug window&quot; ExpandAllTitle=&quot;Expand all rows&quot; ExportTitle=&quot;Export grid data to your spreadsheet program&quot; HelpTitle=&quot;Show help for TreeGrid control&quot; PrintTitle=&quot;Print grid&quot; ReloadTitle=&quot;Reload grid, cancel changes&quot; RepaintTitle=&quot;Refresh pages, click it if grid slows down&quot; ResizeTitle=&quot;Resize grid&quot; SaveTitle=&quot;Submit changes to server&quot; SortTitle=&quot;Enable sorting and re-sort rows now&quot; SortTitle1=&quot;Disable sorting to change sort criteria faster&quot;/>
   
   <Panel PanelCopyTitle=&quot;Copy row&quot; PanelDeleteTitle=&quot;Delete row&quot; PanelMoveTitle=&quot;Drag row&quot; PanelSelectTitle=&quot;Select row&quot;/>
   
   <Header PanelHeaderDeleteTitle=&quot;Delete all selected rows&quot; PanelHeaderSelectTitle=&quot;Select or unselect all rows&quot;/>
   
</Grid>">



<script>
var cachedPageViewHeight = null;
var clearYUIListeners = true;
</script>

<div id="InfoPopupLauncherDiv" class="quickview nodrag" style="display:none; position: absolute; z-index:99999;" onmouseover="keepQuickViewLink();"></div>

<div id="loading_indicator" style="display:none">done</div>
<div id="tableIdName" style="display:none">ATTACHMENTS_FILELIST</div>

<div id="AgileMainContainer">
	<div id="leftpane" class="LeftPane">












<!-- Top div for logo and collapse icon -->
<div id="LeftPaneTop" class="LeftPaneTop">
	<div class="leftPaneHeader">
		
		   
			<img src="/Agile/static/3c01efec3cce1a3dffbec2ee2bcd663d/images/oracle_logo_black.png" style="float:left; top:2px; left:5px;  width:114px; height:25px">
		
		<div title="Collapse Left Navigation" id="collapse" class="layoutCollapse"></div>
	</div>
</div>   

<script>isPageLoading=true;</script>
<form name="ActionForm" method="POST" action="PCMServlet" onsubmit="return false;" target="LeftPane">
<!-- Begin Form Standard Attributes -->
<input name="module" value="LeftPaneHandler" size="8" id="module" type="HIDDEN" class="">
<input name="opcode" value="displayObject" size="8" id="opcode" type="HIDDEN" class="">
<input name="defaultAction" value="" size="8" id="defaultAction" type="HIDDEN" class="">
<input name="addlParam" value="" size="8" id="addlParam" type="HIDDEN" class="">
<input name="actionContextParam" value="" size="8" id="actionContextParam" type="HIDDEN" class="">
<input name="popup" value="" size="8" id="popup" type="HIDDEN" class="">
<input name="objver" value="" size="8" id="objver" type="HIDDEN" class="">
<input name="objid" value="" size="8" id="objid" type="HIDDEN" class="">
<input name="objectname" value="" size="8" id="objectname" type="HIDDEN" class="">
<input name="classid" value="" size="8" id="classid" type="HIDDEN" class="">
<input name="subclsid" value="" size="8" id="subclsid" type="HIDDEN" class="">
<input name="tabid" value="" size="8" id="tabid" type="HIDDEN" class="">
<input name="viewid" value="" size="8" id="viewid" type="HIDDEN" class="">
<input name="displayMode" value="" size="8" id="displayMode" type="HIDDEN" class="">
<input name="refresh" value="false" size="8" id="refresh" type="HIDDEN" class="">
<input name="pgWarnID" value="" size="8" id="pgWarnID" type="HIDDEN" class="">
<input name="pgWarnCode" value="" size="8" id="pgWarnCode" type="HIDDEN" class="">
<input name="warningString" value="" size="8" id="warningString" type="HIDDEN" class="">
<input name="fullrev" value="" size="8" id="fullrev" type="HIDDEN" class="">
<input name="process_actionId" value="" size="8" id="process_actionId" type="HIDDEN" class="">
<input name="pageName" value="" size="8" id="pageName" type="HIDDEN" class="">
<input name="formChanged" value="0" size="8" id="formChanged" type="HIDDEN" class="">
<input name="currentToken" value="" size="8" id="currentToken" type="HIDDEN" class="">
<input name="isTokenRequired" value="false" size="8" id="isTokenRequired" type="HIDDEN" class="">
<input name="ContextName" value="" size="8" id="ContextName" type="HIDDEN" class="">
<input name="ContextType" value="" size="8" id="ContextType" type="HIDDEN" class="">
<input name="DefaultBookmarkName" value="" size="8" id="DefaultBookmarkName" type="HIDDEN" class="">
<input name="helpID" value="6000" size="8" id="helpID" type="HIDDEN" class="">
<input name="tableIds" value="" size="8" id="tableIds" type="HIDDEN" class="">
<input name="showTips" value="" size="8" id="showTips" type="HIDDEN" class="">
<input name="refreshFromDB" value="" size="8" id="refreshFromDB" type="HIDDEN" class="">
<input name="recycle_qry_Id" value="" size="8" id="recycle_qry_Id" type="HIDDEN" class="">
<input name="isPageDirty" value="" size="8" id="isPageDirty" type="HIDDEN" class="">
<input name="currentPaginationTableId" value="-1" size="8" id="currentPaginationTableId" type="HIDDEN" class="">
<input name="subTabId" value="" size="8" id="subTabId" type="HIDDEN" class="">
<input name="PREVIEW_KEY" value="" size="8" id="PREVIEW_KEY" type="HIDDEN" class="">
<input name="PREVIEW_PARENT_KEY" value="" size="8" id="PREVIEW_PARENT_KEY" type="HIDDEN" class="">
<input name="PREVIEW_REFRESH" value="" size="8" id="PREVIEW_REFRESH" type="HIDDEN" class="">
<input name="contentTabView" value="" size="8" id="contentTabView" type="HIDDEN" class="">
<input name="contentTabIncludeAll" value="" size="8" id="contentTabIncludeAll" type="HIDDEN" class="">
<input name="whereUsedTabDisplayAllVersions" value="" size="8" id="whereUsedTabDisplayAllVersions" type="HIDDEN" class="">
<input name="cgToItemRevObjId" value="" size="8" id="cgToItemRevObjId" type="HIDDEN" class="">
<input name="cgToItemRevClassId" value="" size="8" id="cgToItemRevClassId" type="HIDDEN" class="">
<input name="cgToItemRevSiteId" value="" size="8" id="cgToItemRevSiteId" type="HIDDEN" class="">
<input name="preItemRevObjId" value="" size="8" id="preItemRevObjId" type="HIDDEN" class="">
<input name="preItemRevClassId" value="" size="8" id="preItemRevClassId" type="HIDDEN" class="">
<input name="preItemRevSiteId" value="" size="8" id="preItemRevSiteId" type="HIDDEN" class="">
<input name="searchFilterType" value="" size="8" id="searchFilterType" type="HIDDEN" class="">
<input name="checkoutLocation" value="" size="8" id="checkoutLocation" type="HIDDEN" class="">
<input name="boFileId" value="" size="8" id="boFileId" type="HIDDEN" class="">
<input name="fileRowIds" value="" size="8" id="fileRowIds" type="HIDDEN" class="">
<input name="fileIds" value="" size="8" id="fileIds" type="HIDDEN" class="">
<input name="fileNames" value="" size="8" id="fileNames" type="HIDDEN" class="">
<input name="fileSizes" value="" size="8" id="fileSizes" type="HIDDEN" class="">
<input name="asLatest" value="" size="8" id="asLatest" type="HIDDEN" class="">
<input name="asAllFiles" value="" size="8" id="asAllFiles" type="HIDDEN" class="">
<input name="selectedRevisionName" value="" size="8" id="selectedRevisionName" type="HIDDEN" class="">
<input name="selectedKeys" value="" size="8" id="selectedKeys" type="HIDDEN" class="">
<input name="fulltabledisplay" value="" size="8" id="fulltabledisplay" type="HIDDEN" class="">
<input name="fullgridtableid" value="" size="8" id="fullgridtableid" type="HIDDEN" class="">
<input name="refreshObjectTables" value="" size="8" id="refreshObjectTables" type="HIDDEN" class="">
<input name="iv" value="" size="8" id="iv" type="HIDDEN" class="">
<!-- End Form Standard Attributes -->
<input name="AGILE_CSRF_TOKEN_NAME" value="irSddVHz9tWrM43JllSRIxIzvJEBd6kh" size="8" id="AGILE_CSRF_TOKEN_NAME" type="HIDDEN" class="">
<!-- Begin ModuleSpecific Form Attributes -->
<input name="revchangeclass" value="" size="8" id="revchangeclass" type="HIDDEN" class="">
<input name="revchangeid" value="" size="8" id="revchangeid" type="HIDDEN" class="">
<input name="siteId" value="" size="8" id="siteId" type="HIDDEN" class="">
<input name="oldSiteId" value="" size="8" id="oldSiteId" type="HIDDEN" class="">
<input name="siteOrRevChanged" value="" size="8" id="siteOrRevChanged" type="HIDDEN" class="">
<input name="sQueryId" value="false" size="8" id="sQueryId" type="HIDDEN" class="">
<input name="rLeftPane" value="false" size="8" id="rLeftPane" type="HIDDEN" class="">
<input name="fromLeftPane" value="false" size="8" id="fromLeftPane" type="HIDDEN" class="">
<!-- End ModuleSpecific Form Attributes -->


<input type="hidden" name="addToTrail" id="addToTrail" value="false">
<input type="hidden" name="IS_DISPLAY_OBJECT_FROM_LEFTPANE" id="IS_DISPLAY_OBJECT_FROM_LEFTPANE" value="true">
<input type="hidden" name="NOT_EXPAND_CURRENT_OBJECT" id="NOT_EXPAND_CURRENT_OBJECT" value="">
<input type="hidden" name="ROOT_PROGRAM_OBJECT" id="ROOT_PROGRAM_OBJECT" value="">
<input type="hidden" name="contentTabIncludeAll" id="contentTabIncludeAll" value="">

<div class="LeftPaneBottom">

	<!-- BEGIN: LEFT PANE BUTTONS \\\-->  
	<div id="LeftPaneButtons" class="action_buttons">

	<a onclick="showMySettings()" href="javascript:noaction()" id="settings" title="My Settings" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="settingsspan"><em class="iconic settings">&nbsp;</em>&nbsp;</span></a>


	<a onclick="javascript:togglePrefMenu(event)" href="javascript:noaction()" id="preferences" title="Tools and Settings" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="preferencesspan"><em class="iconic2 preferences">&nbsp;</em><em class="iconic3 divet">&nbsp;</em>&nbsp;</span></a>


	<a onclick="javascript:toggleHelpMenu(event)" href="javascript:noaction()" id="help" title="Help" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="helpspan"><em class="iconic2 help">&nbsp;</em><em class="iconic3 divet">&nbsp;</em>&nbsp;</span></a>


	<a href="javascript:logout();" id="logout" title="Logout" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="logoutspan"><em class="iconic logout">&nbsp;</em>&nbsp;</span></a>
 

	</div>
	<!-- END: LEFT PANE BUTTONS \\\-->  


	<!-- BEGIN: ACCORDIAN \\\-->   
	<div id="slideMenu" class="slideMenu" style="overflow: hidden;">

		

			<!-- ===== FOLDER ===== -->

			<div id="folderItem" class="slideMenuItem">
			<div id="folderHeader" class="slideMenuHeader selected" onmouseover="YAHOO.util.Dom.addClass(this, 'slideMenuHeaderHover');" onmouseout="YAHOO.util.Dom.removeClass(this, 'slideMenuHeaderHover');"><em class="folder_open">&nbsp;</em>
			<a href="javascript:noaction()" class="drLink" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(document.getElementById('folderHeader'), 'slideMenuHeaderHover')" onblur="YAHOO.util.Dom.removeClass(document.getElementById('folderHeader'), 'slideMenuHeaderHover')">Folders</a></div>

			<div id="folderBody" class="slideMenuBody" tabindex="-1" style="height: 834px; overflow: auto; visibility: visible;">

			<div id="searchActions" class="title first">
				<p><a class="expand_all first" title="Expand All" href="javascript:expandAllTree('searchTree')" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, 'tree_actions_hover')" onblur="YAHOO.util.Dom.removeClass(this, 'tree_actions_hover')">&nbsp;</a>&nbsp;
				<a class="collapse_all" title="Collapse All" href="javascript:collapseAllTree('searchTree')" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, 'tree_actions_hover')" onblur="YAHOO.util.Dom.removeClass(this, 'tree_actions_hover')">&nbsp;</a>&nbsp;
				<a class="edit" title="Organize Searches" href="javascript:openOrganizePage('', 'SettingsHandler', 'organizeSearches', 'RightPane')" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, 'tree_actions_hover')" onblur="YAHOO.util.Dom.removeClass(this, 'tree_actions_hover')">&nbsp;</a></p>
			</div>
                       
			<input name="Selections_1" value="" size="8" id="Selections_1" type="HIDDEN" class="">
<input name="TableDirtyRows_1" value="" size="8" id="TableDirtyRows_1" type="HIDDEN" class="">
<input name="TableRowMap_1" value="" size="8" id="TableRowMap_1" type="HIDDEN" class="">
<input name="globalValue_1" value="false" size="8" id="globalValue_1" type="HIDDEN" class="">
<input name="TableTreeRows_1" value="" size="8" id="TableTreeRows_1" type="HIDDEN" class="">
<input name="ExpandedRow_1" value="-1" size="8" id="ExpandedRow_1" type="HIDDEN" class="">

<script>
var tree_gST = null;
function loadSearchTree() {
tree_gST = new YAHOO.widget.AgileTreeView("searchTree");
tree_gST.setTreeContextInfo("1", "gST", "PCMServlet", "LeftPaneHandler", "updateExpansions", "loadTreeNodes", true, 
false);
tree_gST.setDynamicLoad(loadDataForNode, 1);
var treeNode_Searches = new YAHOO.widget.AgileRootNode(new TreeNode("_nodeId_Searches", "Searches", "Searches","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, true, true, "Searches", "emphasis", false),tree_gST.getRoot(), true);
var treeNode_4_100_100 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_100_100", "Global Searches", "Global Searches","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, true, "4_100_100", null, true, -1), treeNode_Searches, false);
var treeNode_4_232333079_232333079 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_232333079_232333079", "Personal Searches", "Personal Searches","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, true, "4_232333079_232333079", null, true, -1), treeNode_Searches, false);
tree_gST._el.onkeydown  = function (evt) { tree_gST.handleKeyDownEvent(evt); }; 
tree_gST.draw();
} 
var namesArrgST = new Array();
namesArrgST[0]="Global Searches";namesArrgST[1]="Personal Searches";namesArrgST[2]="My Bookmarks";</script>
<div id="searchTree" class="treemenu"><div class="ygtvitem" id="ygtv0"><div class="ygtvchildren" id="ygtvc0"><div class="ygtvitem" id="ygtv1" onmousedown="return YAHOO.widget.TreeView.getNode('searchTree',1).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('searchTree',1));" onmouseup="return YAHOO.widget.TreeView.getNode('searchTree',1).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('searchTree',1));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td id="ygtvt1" class="ygtvlm" onclick="javascript:YAHOO.widget.TreeView.getNode('searchTree',1).toggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel1_img" class="node_icon"><img src="/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {noaction();})"> </span><a id="ygtvlabelel1" class="ygtvlabel emphasis" href="javascript:noaction();" target="_self" title="Searches" onclick="return YAHOO.widget.TreeView.getNode('searchTree',1).onLabelClick(event, YAHOO.widget.TreeView.getNode('searchTree',1));" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('searchTree',1).highlightNode('ygtvlabelel1');" onblur="var node = YAHOO.widget.TreeView.getNode('searchTree',1); if (node) node.unhighlightNode('ygtvlabelel1');">Searches</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc1"><div class="ygtvitem" id="ygtv2" onmousedown="return YAHOO.widget.TreeView.getNode('searchTree',2).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('searchTree',2));" onmouseup="return YAHOO.widget.TreeView.getNode('searchTree',2).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('searchTree',2));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt2" class="ygtvtp" onclick="javascript:YAHOO.widget.TreeView.getNode('searchTree',2).toggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel2_img" class="node_icon"><img src="/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {noaction();})"> </span><a tabindex="-1" id="ygtvlabelel2" class="ygtvlabel" href="javascript:noaction();" target="_self" title="Global Searches" onclick="return YAHOO.widget.TreeView.getNode('searchTree',2).onLabelClick(event, YAHOO.widget.TreeView.getNode('searchTree',2));" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('searchTree',2).highlightNode('ygtvlabelel2');" onblur="var node = YAHOO.widget.TreeView.getNode('searchTree',2); if (node) node.unhighlightNode('ygtvlabelel2');">Global&nbsp;Searches</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc2" style="display:none;"></div></div><div class="ygtvitem" id="ygtv3" onmousedown="return YAHOO.widget.TreeView.getNode('searchTree',3).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('searchTree',3));" onmouseup="return YAHOO.widget.TreeView.getNode('searchTree',3).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('searchTree',3));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt3" class="ygtvlp" onclick="javascript:YAHOO.widget.TreeView.getNode('searchTree',3).toggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel3_img" class="node_icon"><img src="/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {noaction();})"> </span><a tabindex="-1" id="ygtvlabelel3" class="ygtvlabel" href="javascript:noaction();" target="_self" title="Personal Searches" onclick="return YAHOO.widget.TreeView.getNode('searchTree',3).onLabelClick(event, YAHOO.widget.TreeView.getNode('searchTree',3));" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('searchTree',3).highlightNode('ygtvlabelel3');" onblur="var node = YAHOO.widget.TreeView.getNode('searchTree',3); if (node) node.unhighlightNode('ygtvlabelel3');">Personal&nbsp;Searches</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc3" style="display:none;"></div></div></div></div></div></div></div>

			                        
			<div id="bookmarkActions" class="title">
				<p><a class="expand_all first" title="Expand All" href="javascript:expandAllTree('bookmarkTree')" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, 'tree_actions_hover')" onblur="YAHOO.util.Dom.removeClass(this, 'tree_actions_hover')">&nbsp;</a>&nbsp;
				<a class="collapse_all" title="Collapse All" href="javascript:collapseAllTree('bookmarkTree')" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, 'tree_actions_hover')" onblur="YAHOO.util.Dom.removeClass(this, 'tree_actions_hover')">&nbsp;</a>&nbsp;
				<a class="edit" title="Organize Bookmarks" href="javascript:openOrganizePage('', 'SettingsHandler', 'organizeBookmarks', 'RightPane')" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, 'tree_actions_hover')" onblur="YAHOO.util.Dom.removeClass(this, 'tree_actions_hover')">&nbsp;</a></p>
			</div>
                             
			
<script>
var tree_fT = null;
function loadBookmarkTree() {
tree_fT = new YAHOO.widget.AgileTreeView("bookmarkTree");
tree_fT.setTreeContextInfo("1", "fT", "PCMServlet", "LeftPaneHandler", "updateExpansions", "loadTreeNodes", true, 
false);
tree_fT.setDynamicLoad(loadDataForNode, 1);
var treeNode_Bookmark = new YAHOO.widget.AgileRootNode(new TreeNode("_nodeId_Bookmark", "My Bookmarks", "My Bookmarks","javascript:noaction();", null, "/Agile/static/ce36d627199915d0fdf0d5289e01a113/images/bookmark.png", "/Agile/static/ce36d627199915d0fdf0d5289e01a113/images/bookmark.png", null, null, null, true, true, "Bookmark", "emphasis", false),tree_fT.getRoot(), true);
tree_fT._el.onkeydown  = function (evt) { tree_fT.handleKeyDownEvent(evt); }; 
tree_fT.draw();
tree_fT.registarDD();
} 
var namesArrfT = new Array();
namesArrfT[0]="Global Searches";namesArrfT[1]="Personal Searches";namesArrfT[2]="My Bookmarks";</script>
<div id="bookmarkTree" class="treemenu"><div class="ygtvitem" id="ygtv4"><div class="ygtvchildren" id="ygtvc4"><div class="ygtvitem" id="ygtv5" onmousedown="return YAHOO.widget.TreeView.getNode('bookmarkTree',5).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('bookmarkTree',5));" onmouseup="return YAHOO.widget.TreeView.getNode('bookmarkTree',5).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('bookmarkTree',5));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td id="ygtvt5" class="ygtvlm" onclick="javascript:YAHOO.widget.TreeView.getNode('bookmarkTree',5).toggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel5_img" class="node_icon"><img src="/Agile/static/ce36d627199915d0fdf0d5289e01a113/images/bookmark.png" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {noaction();})"> </span><a id="ygtvlabelel5" class="ygtvlabel emphasis" href="javascript:noaction();" target="_self" title="My Bookmarks" onclick="return YAHOO.widget.TreeView.getNode('bookmarkTree',5).onLabelClick(event, YAHOO.widget.TreeView.getNode('bookmarkTree',5));" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('bookmarkTree',5).highlightNode('ygtvlabelel5');" onblur="var node = YAHOO.widget.TreeView.getNode('bookmarkTree',5); if (node) node.unhighlightNode('ygtvlabelel5');">My&nbsp;Bookmarks</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc5"></div></div></div></div></div>

                               
			<div id="rvActions" class="title">&nbsp;</div>
                              
			
<script>
var tree_RV = null;
function loadRecentlyVisitedTree() {
tree_RV = new YAHOO.widget.AgileTreeView("recentlyVisitedTree");
tree_RV.setTreeContextInfo("RV", "RV", "PCMServlet", "LeftPaneHandler", "updateExpansions", "loadTreeNodes", false, 
false);
var treeNode_RVisited = new YAHOO.widget.AgileRootNode(new TreeNode("_nodeId_RVisited", "Recently Visited", "Recently Visited","javascript:noaction();", null, "/Agile/static/18dab1e1dd3c80e8e86ef3d67355795d/images/history.png", "/Agile/static/18dab1e1dd3c80e8e86ef3d67355795d/images/history.png", null, null, null, true, true, "RVisited", "emphasis", false),tree_RV.getRoot(), true);
var treeNode_4878_232336885 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232336885", "FA-0505813 : IQS2.0 PID Profile for QSFP-100G-AOC7M= - Criteria = Customer Name - T-MOBILE: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801773207: Service Request No - 692011554: Service Contract No - 200941956:,", "FA-0505813 : IQS2.0 PID Profile for QSFP-100G-AOC7M= - Criteria = Customer Name - T-MOBILE: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801773207: Service Request No - 692011554: Service Contract No - 200941956:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232336885', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232336885", null, true, 4750), treeNode_RVisited, false, true, '4878','232336885','null');
var treeNode_4878_230433739 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_230433739", "FA-0481375 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - DEUTSCHE BANK AG: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801511178: Service Request No - 691118129: Service Contract No - 203229531:,", "FA-0481375 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - DEUTSCHE BANK AG: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801511178: Service Request No - 691118129: Service Contract No - 203229531:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '230433739', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_230433739", null, true, 4750), treeNode_RVisited, false, true, '4878','230433739','null');
var treeNode_4878_232594404 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232594404", "FA-0509042 : IQS2.0 PID Profile for QSFP-100G-PSM4-S= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801817212: Service Request No - 639843408: Service Contract No - 200214276:,", "FA-0509042 : IQS2.0 PID Profile for QSFP-100G-PSM4-S= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801817212: Service Request No - 639843408: Service Contract No - 200214276:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232594404', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232594404", null, true, 4750), treeNode_RVisited, false, true, '4878','232594404','null');
var treeNode_4878_232580233 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232580233", "FA-0508853 : IQS2.0 PID Profile for QSFP-40G-SR-BD= - Criteria = Customer Name - OKI CROSSTECH LTD: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801808576: Service Request No - 639841849: Service Contract No - 201258888:,", "FA-0508853 : IQS2.0 PID Profile for QSFP-40G-SR-BD= - Criteria = Customer Name - OKI CROSSTECH LTD: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801808576: Service Request No - 639841849: Service Contract No - 201258888:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232580233', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232580233", null, true, 4750), treeNode_RVisited, false, true, '4878','232580233','null');
var treeNode_4878_232542031 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232542031", "FA-0508413 : IQS2.0 PID Profile for GLC-LH-SMD= - Criteria = Customer Name - IBM JAPAN LTD: Return Reason Code - OHW2: Theater - JPN: RMA Number - 801809027: Service Request No - 639841954: Service Contract No - 95281942:,", "FA-0508413 : IQS2.0 PID Profile for GLC-LH-SMD= - Criteria = Customer Name - IBM JAPAN LTD: Return Reason Code - OHW2: Theater - JPN: RMA Number - 801809027: Service Request No - 639841954: Service Contract No - 95281942:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232542031', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232542031", null, true, 4750), treeNode_RVisited, false, true, '4878','232542031','null');
var treeNode_4878_232539535 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232539535", "FA-0508324 : IQS2.0 PID Profile for XFP-10G-MM-SR= - Criteria = Customer Name - ARVATO DISTRIBUTION GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801806470: Service Request No - 639841497: Service Contract No - 91449988:,", "FA-0508324 : IQS2.0 PID Profile for XFP-10G-MM-SR= - Criteria = Customer Name - ARVATO DISTRIBUTION GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801806470: Service Request No - 639841497: Service Contract No - 91449988:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232539535', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232539535", null, true, 4750), treeNode_RVisited, false, true, '4878','232539535','null');
var treeNode_4878_232538200 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232538200", "FA-0508284 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803611: Service Request No - 639840892: Service Contract No - 204025098:,", "FA-0508284 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803611: Service Request No - 639840892: Service Contract No - 204025098:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232538200', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232538200", null, true, 4750), treeNode_RVisited, false, true, '4878','232538200','null');
var treeNode_4878_232538158 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232538158", "FA-0508283 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803561: Service Request No - 639840882: Service Contract No - 204025098:,", "FA-0508283 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803561: Service Request No - 639840882: Service Contract No - 204025098:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232538158', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232538158", null, true, 4750), treeNode_RVisited, false, true, '4878','232538158','null');
var treeNode_4878_232537871 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232537871", "FA-0508277 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803129: Service Request No - 639840763: Service Contract No - 203571222:,", "FA-0508277 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803129: Service Request No - 639840763: Service Contract No - 203571222:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232537871', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232537871", null, true, 4750), treeNode_RVisited, false, true, '4878','232537871','null');
var treeNode_4878_232538100 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232538100", "FA-0508276 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803138: Service Request No - 639840768: Service Contract No - 203571222:,", "FA-0508276 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803138: Service Request No - 639840768: Service Contract No - 203571222:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232538100', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232538100", null, true, 4750), treeNode_RVisited, false, true, '4878','232538100','null');
var treeNode_4878_232536311 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232536311", "FA-0508231 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE DEUTSCHLAND GMBH: Return Reason Code - OHW2: Theater - EMEA: RMA Number - 801804348: Service Request No - 692130170: Service Contract No - 91238831:,", "FA-0508231 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE DEUTSCHLAND GMBH: Return Reason Code - OHW2: Theater - EMEA: RMA Number - 801804348: Service Request No - 692130170: Service Contract No - 91238831:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232536311', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232536311", null, true, 4750), treeNode_RVisited, false, true, '4878','232536311','null');
var treeNode_4878_232501850 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232501850", "FA-0508025 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - NAVAXX SA: Return Reason Code - OHW3: Theater - EMEA: RMA Number - 801801828: Service Request No - 692121287: Service Contract No - 94836090:,", "FA-0508025 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - NAVAXX SA: Return Reason Code - OHW3: Theater - EMEA: RMA Number - 801801828: Service Request No - 692121287: Service Contract No - 94836090:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232501850', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232501850", null, true, 4750), treeNode_RVisited, false, true, '4878','232501850','null');
var treeNode_4878_232474624 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232474624", "FA-0507796 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CGI SVERIGE AB: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801795926: Service Request No - 639839413: Service Contract No - 203052937:,", "FA-0507796 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CGI SVERIGE AB: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801795926: Service Request No - 639839413: Service Contract No - 203052937:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232474624', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232474624", null, true, 4750), treeNode_RVisited, false, true, '4878','232474624','null');
var treeNode_4878_232475178 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232475178", "FA-0507782 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - OLYMPIC STEEL: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801797376: Service Request No - 691831047: Service Contract No - 204188687:,", "FA-0507782 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - OLYMPIC STEEL: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801797376: Service Request No - 691831047: Service Contract No - 204188687:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232475178', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232475178", null, true, 4750), treeNode_RVisited, false, true, '4878','232475178','null');
var treeNode_4878_232466083 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232466083", "FA-0507698 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - NEC PLATFORMS LTD: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801795197: Service Request No - 639839265: Service Contract No - 3095860:,", "FA-0507698 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - NEC PLATFORMS LTD: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801795197: Service Request No - 639839265: Service Contract No - 3095860:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232466083', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232466083", null, true, 4750), treeNode_RVisited, false, true, '4878','232466083','null');
var treeNode_4878_232456730 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232456730", "FA-0507549 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - HITACHI INFORMATION &amp; TELECOMMUNICATION ENGINEERING, LTD: Return Reason Code - OHW2: Theater - JPN: RMA Number - 801787811: Service Request No - 639837867: Service Contract No ...", "FA-0507549 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - HITACHI INFORMATION &amp; TELECOMMUNICATION ENGINEERING, LTD: Return Reason Code - OHW2: Theater - JPN: RMA Number - 801787811: Service Request No - 639837867: Service Contract No ...","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232456730', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232456730", null, true, 4750), treeNode_RVisited, false, true, '4878','232456730','null');
var treeNode_4878_232428856 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232428856", "FA-0506915 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - HSBC BANK PLC: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801790980: Service Request No - 639836464: Service Contract No - 93070170:,", "FA-0506915 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - HSBC BANK PLC: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801790980: Service Request No - 639836464: Service Contract No - 93070170:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232428856', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232428856", null, true, 4750), treeNode_RVisited, false, true, '4878','232428856','null');
var treeNode_4878_232425861 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232425861", "FA-0506751 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - NTT EAST CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801786640: Service Request No - 639837653: Service Contract No - 94752412:,", "FA-0506751 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - NTT EAST CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801786640: Service Request No - 639837653: Service Contract No - 94752412:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232425861', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232425861", null, true, 4750), treeNode_RVisited, false, true, '4878','232425861','null');
var treeNode_4878_232402224 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232402224", "FA-0506275 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - WELLS FARGO: Return Reason Code - OHW3: Theater - NAM: RMA Number - 801786868: Service Request No - 692080959: Service Contract No - 201629820:,", "FA-0506275 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - WELLS FARGO: Return Reason Code - OHW3: Theater - NAM: RMA Number - 801786868: Service Request No - 692080959: Service Contract No - 201629820:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232402224', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232402224", null, true, 4750), treeNode_RVisited, false, true, '4878','232402224','null');
var treeNode_4878_232375989 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232375989", "FA-0506113 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE GROUP SERVICES GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801776047: Service Request No - 692047226: Service Contract No - 92281781:,", "FA-0506113 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE GROUP SERVICES GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801776047: Service Request No - 692047226: Service Contract No - 92281781:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232375989', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232375989", null, true, 4750), treeNode_RVisited, false, true, '4878','232375989','null');
var treeNode_4878_232350716 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232350716", "FA-0505935 : IQS2.0 PID Profile for QSFP-40/100-SRBD= - Criteria = Customer Name - ALLSTATE INSURANCE COMPANY: Return Reason Code - ARFN: Theater - NAM: RMA Number - 801778650: Service Request No - 692054869: Service Contract No - 93725723:,", "FA-0505935 : IQS2.0 PID Profile for QSFP-40/100-SRBD= - Criteria = Customer Name - ALLSTATE INSURANCE COMPANY: Return Reason Code - ARFN: Theater - NAM: RMA Number - 801778650: Service Request No - 692054869: Service Contract No - 93725723:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232350716', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232350716", null, true, 4750), treeNode_RVisited, false, true, '4878','232350716','null');
var treeNode_4878_232315305 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232315305", "FA-0505648 : IQS2.0 PID Profile for QSFP-40G-SR-BD= - Criteria = Customer Name - BANK OF AMERICA: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801772895: Service Request No - 639835050: Service Contract No - 201605943:,", "FA-0505648 : IQS2.0 PID Profile for QSFP-40G-SR-BD= - Criteria = Customer Name - BANK OF AMERICA: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801772895: Service Request No - 639835050: Service Contract No - 201605943:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232315305', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232315305", null, true, 4750), treeNode_RVisited, false, true, '4878','232315305','null');
var treeNode_4878_232280756 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232280756", "FA-0505262 : IQS2.0 PID Profile for SFP-10G-LR= - Criteria = Customer Name - COACHELLA VALLEY UNIFIED SCHOOL DISTRICT: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801767468: Service Request No - 692000896: Service Contract No - 202556478:,", "FA-0505262 : IQS2.0 PID Profile for SFP-10G-LR= - Criteria = Customer Name - COACHELLA VALLEY UNIFIED SCHOOL DISTRICT: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801767468: Service Request No - 692000896: Service Contract No - 202556478:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232280756', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232280756", null, true, 4750), treeNode_RVisited, false, true, '4878','232280756','null');
var treeNode_4878_232263831 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232263831", "FA-0505057 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE GROUP SERVICES GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801761158: Service Request No - 692001331: Service Contract No - 92281781:,", "FA-0505057 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE GROUP SERVICES GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801761158: Service Request No - 692001331: Service Contract No - 92281781:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232263831', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232263831", null, true, 4750), treeNode_RVisited, false, true, '4878','232263831','null');
var treeNode_4878_232232577 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4878_232232577", "FA-0504596 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - WELLS FARGO: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801758390: Service Request No - 691994119: Service Contract No - 201629820:,", "FA-0504596 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - WELLS FARGO: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801758390: Service Request No - 691994119: Service Contract No - 201629820:,","javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232232577', '0');", null, "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png", "Standard FA Case", null, null, false, false, "4878_232232577", null, true, 4750), treeNode_RVisited, false, true, '4878','232232577','null');
tree_RV._el.onkeydown  = function (evt) { tree_RV.handleKeyDownEvent(evt); }; 
tree_RV.draw();
tree_RV.registarDD();
} 
var namesArrRV = new Array();
</script>
<div id="recentlyVisitedTree" class="treemenu"><div class="ygtvitem" id="ygtv6"><div class="ygtvchildren" id="ygtvc6"><div class="ygtvitem" id="ygtv7" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',7).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',7));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',7).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',7));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td id="ygtvt7" class="ygtvlm" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',7).toggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel7_img" class="node_icon"><img src="/Agile/static/18dab1e1dd3c80e8e86ef3d67355795d/images/history.png" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {noaction();})"> </span><a id="ygtvlabelel7" class="ygtvlabel emphasis" href="javascript:noaction();" target="_self" title="Recently Visited" onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',7).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',7));" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',7).highlightNode('ygtvlabelel7');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',7); if (node) node.unhighlightNode('ygtvlabelel7');">Recently&nbsp;Visited</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc7"><div class="ygtvitem" id="ygtv8" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',8).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',8));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',8).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',8));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt8" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',8).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel8_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232336885', '0');})"> </span><a tabindex="-1" id="ygtvlabelel8" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232336885', '0');" target="_self" title="FA-0505813 : IQS2.0 PID Profile for QSFP-100G-AOC7M= - Criteria = Customer Name - T-MOBILE: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801773207: Service Request No - 692011554: Service Contract No - 200941956:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',8).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',8));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',8).highlightNode('ygtvlabelel8');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',8); if (node) node.unhighlightNode('ygtvlabelel8');" infourl="showObjectInfo('4878','232336885','','','','false','',null);">FA-0505813&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;QSFP-100G-AOC7M=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;T-MOBILE:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW2:&nbsp;Theater&nbsp;-&nbsp;NAM:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801773207:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;692011554:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;200941956:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc8" style="display:none;"></div></div><div class="ygtvitem" id="ygtv9" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',9).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',9));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',9).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',9));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt9" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',9).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel9_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '230433739', '0');})"> </span><a tabindex="-1" id="ygtvlabelel9" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '230433739', '0');" target="_self" title="FA-0481375 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - DEUTSCHE BANK AG: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801511178: Service Request No - 691118129: Service Contract No - 203229531:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',9).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',9));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',9).highlightNode('ygtvlabelel9');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',9); if (node) node.unhighlightNode('ygtvlabelel9');" infourl="showObjectInfo('4878','230433739','','','','false','',null);">FA-0481375&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;GLC-SX-MMD=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;DEUTSCHE&nbsp;BANK&nbsp;AG:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;EMEA:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801511178:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;691118129:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;203229531:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc9" style="display:none;"></div></div><div class="ygtvitem" id="ygtv10" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',10).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',10));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',10).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',10));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt10" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',10).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel10_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232594404', '0');})"> </span><a tabindex="-1" id="ygtvlabelel10" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232594404', '0');" target="_self" title="FA-0509042 : IQS2.0 PID Profile for QSFP-100G-PSM4-S= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801817212: Service Request No - 639843408: Service Contract No - 200214276:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',10).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',10));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',10).highlightNode('ygtvlabelel10');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',10); if (node) node.unhighlightNode('ygtvlabelel10');" infourl="showObjectInfo('4878','232594404','','','','false','',null);">FA-0509042&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;QSFP-100G-PSM4-S=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;CTC&nbsp;TECHNOLOGY&nbsp;CORPORATION:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;JPN:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801817212:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639843408:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;200214276:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc10" style="display:none;"></div></div><div class="ygtvitem" id="ygtv11" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',11).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',11));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',11).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',11));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt11" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',11).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel11_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232580233', '0');})"> </span><a tabindex="-1" id="ygtvlabelel11" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232580233', '0');" target="_self" title="FA-0508853 : IQS2.0 PID Profile for QSFP-40G-SR-BD= - Criteria = Customer Name - OKI CROSSTECH LTD: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801808576: Service Request No - 639841849: Service Contract No - 201258888:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',11).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',11));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',11).highlightNode('ygtvlabelel11');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',11); if (node) node.unhighlightNode('ygtvlabelel11');" infourl="showObjectInfo('4878','232580233','','','','false','',null);">FA-0508853&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;QSFP-40G-SR-BD=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;OKI&nbsp;CROSSTECH&nbsp;LTD:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;JPN:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801808576:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639841849:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;201258888:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc11" style="display:none;"></div></div><div class="ygtvitem" id="ygtv12" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',12).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',12));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',12).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',12));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt12" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',12).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel12_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232542031', '0');})"> </span><a tabindex="-1" id="ygtvlabelel12" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232542031', '0');" target="_self" title="FA-0508413 : IQS2.0 PID Profile for GLC-LH-SMD= - Criteria = Customer Name - IBM JAPAN LTD: Return Reason Code - OHW2: Theater - JPN: RMA Number - 801809027: Service Request No - 639841954: Service Contract No - 95281942:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',12).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',12));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',12).highlightNode('ygtvlabelel12');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',12); if (node) node.unhighlightNode('ygtvlabelel12');" infourl="showObjectInfo('4878','232542031','','','','false','',null);">FA-0508413&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;GLC-LH-SMD=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;IBM&nbsp;JAPAN&nbsp;LTD:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW2:&nbsp;Theater&nbsp;-&nbsp;JPN:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801809027:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639841954:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;95281942:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc12" style="display:none;"></div></div><div class="ygtvitem" id="ygtv13" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',13).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',13));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',13).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',13));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt13" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',13).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel13_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232539535', '0');})"> </span><a tabindex="-1" id="ygtvlabelel13" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232539535', '0');" target="_self" title="FA-0508324 : IQS2.0 PID Profile for XFP-10G-MM-SR= - Criteria = Customer Name - ARVATO DISTRIBUTION GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801806470: Service Request No - 639841497: Service Contract No - 91449988:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',13).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',13));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',13).highlightNode('ygtvlabelel13');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',13); if (node) node.unhighlightNode('ygtvlabelel13');" infourl="showObjectInfo('4878','232539535','','','','false','',null);">FA-0508324&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;XFP-10G-MM-SR=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;ARVATO&nbsp;DISTRIBUTION&nbsp;GMBH:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;EMEA:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801806470:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639841497:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;91449988:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc13" style="display:none;"></div></div><div class="ygtvitem" id="ygtv14" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',14).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',14));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',14).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',14));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt14" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',14).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel14_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232538200', '0');})"> </span><a tabindex="-1" id="ygtvlabelel14" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232538200', '0');" target="_self" title="FA-0508284 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803611: Service Request No - 639840892: Service Contract No - 204025098:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',14).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',14));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',14).highlightNode('ygtvlabelel14');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',14); if (node) node.unhighlightNode('ygtvlabelel14');" infourl="showObjectInfo('4878','232538200','','','','false','',null);">FA-0508284&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;SFP-10G-SR=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;CTC&nbsp;TECHNOLOGY&nbsp;CORPORATION:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;JPN:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801803611:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639840892:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;204025098:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc14" style="display:none;"></div></div><div class="ygtvitem" id="ygtv15" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',15).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',15));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',15).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',15));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt15" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',15).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel15_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232538158', '0');})"> </span><a tabindex="-1" id="ygtvlabelel15" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232538158', '0');" target="_self" title="FA-0508283 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803561: Service Request No - 639840882: Service Contract No - 204025098:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',15).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',15));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',15).highlightNode('ygtvlabelel15');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',15); if (node) node.unhighlightNode('ygtvlabelel15');" infourl="showObjectInfo('4878','232538158','','','','false','',null);">FA-0508283&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;SFP-10G-SR=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;CTC&nbsp;TECHNOLOGY&nbsp;CORPORATION:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;JPN:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801803561:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639840882:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;204025098:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc15" style="display:none;"></div></div><div class="ygtvitem" id="ygtv16" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',16).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',16));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',16).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',16));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt16" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',16).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel16_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232537871', '0');})"> </span><a tabindex="-1" id="ygtvlabelel16" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232537871', '0');" target="_self" title="FA-0508277 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803129: Service Request No - 639840763: Service Contract No - 203571222:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',16).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',16));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',16).highlightNode('ygtvlabelel16');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',16); if (node) node.unhighlightNode('ygtvlabelel16');" infourl="showObjectInfo('4878','232537871','','','','false','',null);">FA-0508277&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;SFP-10G-SR=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;CTC&nbsp;TECHNOLOGY&nbsp;CORPORATION:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;JPN:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801803129:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639840763:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;203571222:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc16" style="display:none;"></div></div><div class="ygtvitem" id="ygtv17" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',17).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',17));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',17).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',17));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt17" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',17).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel17_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232538100', '0');})"> </span><a tabindex="-1" id="ygtvlabelel17" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232538100', '0');" target="_self" title="FA-0508276 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CTC TECHNOLOGY CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801803138: Service Request No - 639840768: Service Contract No - 203571222:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',17).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',17));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',17).highlightNode('ygtvlabelel17');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',17); if (node) node.unhighlightNode('ygtvlabelel17');" infourl="showObjectInfo('4878','232538100','','','','false','',null);">FA-0508276&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;SFP-10G-SR=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;CTC&nbsp;TECHNOLOGY&nbsp;CORPORATION:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;JPN:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801803138:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639840768:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;203571222:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc17" style="display:none;"></div></div><div class="ygtvitem" id="ygtv18" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',18).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',18));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',18).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',18));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt18" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',18).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel18_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232536311', '0');})"> </span><a tabindex="-1" id="ygtvlabelel18" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232536311', '0');" target="_self" title="FA-0508231 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE DEUTSCHLAND GMBH: Return Reason Code - OHW2: Theater - EMEA: RMA Number - 801804348: Service Request No - 692130170: Service Contract No - 91238831:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',18).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',18));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',18).highlightNode('ygtvlabelel18');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',18); if (node) node.unhighlightNode('ygtvlabelel18');" infourl="showObjectInfo('4878','232536311','','','','false','',null);">FA-0508231&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;FET-10G=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;VODAFONE&nbsp;DEUTSCHLAND&nbsp;GMBH:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW2:&nbsp;Theater&nbsp;-&nbsp;EMEA:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801804348:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;692130170:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;91238831:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc18" style="display:none;"></div></div><div class="ygtvitem" id="ygtv19" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',19).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',19));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',19).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',19));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt19" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',19).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel19_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232501850', '0');})"> </span><a tabindex="-1" id="ygtvlabelel19" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232501850', '0');" target="_self" title="FA-0508025 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - NAVAXX SA: Return Reason Code - OHW3: Theater - EMEA: RMA Number - 801801828: Service Request No - 692121287: Service Contract No - 94836090:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',19).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',19));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',19).highlightNode('ygtvlabelel19');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',19); if (node) node.unhighlightNode('ygtvlabelel19');" infourl="showObjectInfo('4878','232501850','','','','false','',null);">FA-0508025&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;FET-10G=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;NAVAXX&nbsp;SA:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW3:&nbsp;Theater&nbsp;-&nbsp;EMEA:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801801828:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;692121287:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;94836090:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc19" style="display:none;"></div></div><div class="ygtvitem" id="ygtv20" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',20).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',20));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',20).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',20));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt20" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',20).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel20_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232474624', '0');})"> </span><a tabindex="-1" id="ygtvlabelel20" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232474624', '0');" target="_self" title="FA-0507796 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - CGI SVERIGE AB: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801795926: Service Request No - 639839413: Service Contract No - 203052937:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',20).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',20));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',20).highlightNode('ygtvlabelel20');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',20); if (node) node.unhighlightNode('ygtvlabelel20');" infourl="showObjectInfo('4878','232474624','','','','false','',null);">FA-0507796&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;SFP-10G-SR=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;CGI&nbsp;SVERIGE&nbsp;AB:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;EMEA:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801795926:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639839413:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;203052937:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc20" style="display:none;"></div></div><div class="ygtvitem" id="ygtv21" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',21).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',21));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',21).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',21));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt21" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',21).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel21_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232475178', '0');})"> </span><a tabindex="-1" id="ygtvlabelel21" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232475178', '0');" target="_self" title="FA-0507782 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - OLYMPIC STEEL: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801797376: Service Request No - 691831047: Service Contract No - 204188687:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',21).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',21));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',21).highlightNode('ygtvlabelel21');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',21); if (node) node.unhighlightNode('ygtvlabelel21');" infourl="showObjectInfo('4878','232475178','','','','false','',null);">FA-0507782&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;FET-10G=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;OLYMPIC&nbsp;STEEL:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;NAM:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801797376:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;691831047:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;204188687:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc21" style="display:none;"></div></div><div class="ygtvitem" id="ygtv22" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',22).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',22));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',22).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',22));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt22" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',22).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel22_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232466083', '0');})"> </span><a tabindex="-1" id="ygtvlabelel22" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232466083', '0');" target="_self" title="FA-0507698 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - NEC PLATFORMS LTD: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801795197: Service Request No - 639839265: Service Contract No - 3095860:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',22).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',22));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',22).highlightNode('ygtvlabelel22');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',22); if (node) node.unhighlightNode('ygtvlabelel22');" infourl="showObjectInfo('4878','232466083','','','','false','',null);">FA-0507698&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;SFP-10G-SR=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;NEC&nbsp;PLATFORMS&nbsp;LTD:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;JPN:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801795197:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639839265:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;3095860:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc22" style="display:none;"></div></div><div class="ygtvitem" id="ygtv23" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',23).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',23));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',23).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',23));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt23" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',23).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel23_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232456730', '0');})"> </span><a tabindex="-1" id="ygtvlabelel23" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232456730', '0');" target="_self" title="FA-0507549 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - HITACHI INFORMATION &amp; TELECOMMUNICATION ENGINEERING, LTD: Return Reason Code - OHW2: Theater - JPN: RMA Number - 801787811: Service Request No - 639837867: Service Contract No ..." onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',23).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',23));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',23).highlightNode('ygtvlabelel23');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',23); if (node) node.unhighlightNode('ygtvlabelel23');" infourl="showObjectInfo('4878','232456730','','','','false','',null);">FA-0507549&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;GLC-SX-MMD=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;HITACHI&nbsp;INFORMATION&nbsp;&amp;&nbsp;TELECOMMUNICATION&nbsp;ENGINEERING,&nbsp;LTD:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW2:&nbsp;Theater&nbsp;-&nbsp;JPN:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801787811:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639837867:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;...</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc23" style="display:none;"></div></div><div class="ygtvitem" id="ygtv24" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',24).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',24));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',24).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',24));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt24" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',24).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel24_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232428856', '0');})"> </span><a tabindex="-1" id="ygtvlabelel24" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232428856', '0');" target="_self" title="FA-0506915 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - HSBC BANK PLC: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801790980: Service Request No - 639836464: Service Contract No - 93070170:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',24).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',24));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',24).highlightNode('ygtvlabelel24');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',24); if (node) node.unhighlightNode('ygtvlabelel24');" infourl="showObjectInfo('4878','232428856','','','','false','',null);">FA-0506915&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;SFP-10G-SR=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;HSBC&nbsp;BANK&nbsp;PLC:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;EMEA:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801790980:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639836464:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;93070170:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc24" style="display:none;"></div></div><div class="ygtvitem" id="ygtv25" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',25).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',25));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',25).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',25));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt25" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',25).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel25_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232425861', '0');})"> </span><a tabindex="-1" id="ygtvlabelel25" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232425861', '0');" target="_self" title="FA-0506751 : IQS2.0 PID Profile for GLC-SX-MMD= - Criteria = Customer Name - NTT EAST CORPORATION: Return Reason Code - OHW9: Theater - JPN: RMA Number - 801786640: Service Request No - 639837653: Service Contract No - 94752412:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',25).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',25));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',25).highlightNode('ygtvlabelel25');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',25); if (node) node.unhighlightNode('ygtvlabelel25');" infourl="showObjectInfo('4878','232425861','','','','false','',null);">FA-0506751&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;GLC-SX-MMD=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;NTT&nbsp;EAST&nbsp;CORPORATION:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;JPN:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801786640:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639837653:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;94752412:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc25" style="display:none;"></div></div><div class="ygtvitem" id="ygtv26" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',26).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',26));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',26).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',26));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt26" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',26).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel26_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232402224', '0');})"> </span><a tabindex="-1" id="ygtvlabelel26" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232402224', '0');" target="_self" title="FA-0506275 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - WELLS FARGO: Return Reason Code - OHW3: Theater - NAM: RMA Number - 801786868: Service Request No - 692080959: Service Contract No - 201629820:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',26).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',26));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',26).highlightNode('ygtvlabelel26');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',26); if (node) node.unhighlightNode('ygtvlabelel26');" infourl="showObjectInfo('4878','232402224','','','','false','',null);">FA-0506275&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;FET-10G=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;WELLS&nbsp;FARGO:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW3:&nbsp;Theater&nbsp;-&nbsp;NAM:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801786868:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;692080959:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;201629820:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc26" style="display:none;"></div></div><div class="ygtvitem" id="ygtv27" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',27).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',27));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',27).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',27));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt27" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',27).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel27_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232375989', '0');})"> </span><a tabindex="-1" id="ygtvlabelel27" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232375989', '0');" target="_self" title="FA-0506113 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE GROUP SERVICES GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801776047: Service Request No - 692047226: Service Contract No - 92281781:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',27).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',27));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',27).highlightNode('ygtvlabelel27');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',27); if (node) node.unhighlightNode('ygtvlabelel27');" infourl="showObjectInfo('4878','232375989','','','','false','',null);">FA-0506113&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;FET-10G=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;VODAFONE&nbsp;GROUP&nbsp;SERVICES&nbsp;GMBH:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;EMEA:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801776047:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;692047226:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;92281781:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc27" style="display:none;"></div></div><div class="ygtvitem" id="ygtv28" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',28).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',28));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',28).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',28));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt28" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',28).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel28_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232350716', '0');})"> </span><a tabindex="-1" id="ygtvlabelel28" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232350716', '0');" target="_self" title="FA-0505935 : IQS2.0 PID Profile for QSFP-40/100-SRBD= - Criteria = Customer Name - ALLSTATE INSURANCE COMPANY: Return Reason Code - ARFN: Theater - NAM: RMA Number - 801778650: Service Request No - 692054869: Service Contract No - 93725723:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',28).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',28));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',28).highlightNode('ygtvlabelel28');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',28); if (node) node.unhighlightNode('ygtvlabelel28');" infourl="showObjectInfo('4878','232350716','','','','false','',null);">FA-0505935&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;QSFP-40/100-SRBD=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;ALLSTATE&nbsp;INSURANCE&nbsp;COMPANY:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;ARFN:&nbsp;Theater&nbsp;-&nbsp;NAM:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801778650:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;692054869:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;93725723:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc28" style="display:none;"></div></div><div class="ygtvitem" id="ygtv29" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',29).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',29));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',29).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',29));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt29" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',29).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel29_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232315305', '0');})"> </span><a tabindex="-1" id="ygtvlabelel29" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232315305', '0');" target="_self" title="FA-0505648 : IQS2.0 PID Profile for QSFP-40G-SR-BD= - Criteria = Customer Name - BANK OF AMERICA: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801772895: Service Request No - 639835050: Service Contract No - 201605943:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',29).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',29));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',29).highlightNode('ygtvlabelel29');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',29); if (node) node.unhighlightNode('ygtvlabelel29');" infourl="showObjectInfo('4878','232315305','','','','false','',null);">FA-0505648&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;QSFP-40G-SR-BD=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;BANK&nbsp;OF&nbsp;AMERICA:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW2:&nbsp;Theater&nbsp;-&nbsp;NAM:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801772895:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;639835050:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;201605943:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc29" style="display:none;"></div></div><div class="ygtvitem" id="ygtv30" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',30).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',30));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',30).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',30));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt30" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',30).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel30_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232280756', '0');})"> </span><a tabindex="-1" id="ygtvlabelel30" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232280756', '0');" target="_self" title="FA-0505262 : IQS2.0 PID Profile for SFP-10G-LR= - Criteria = Customer Name - COACHELLA VALLEY UNIFIED SCHOOL DISTRICT: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801767468: Service Request No - 692000896: Service Contract No - 202556478:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',30).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',30));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',30).highlightNode('ygtvlabelel30');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',30); if (node) node.unhighlightNode('ygtvlabelel30');" infourl="showObjectInfo('4878','232280756','','','','false','',null);">FA-0505262&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;SFP-10G-LR=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;COACHELLA&nbsp;VALLEY&nbsp;UNIFIED&nbsp;SCHOOL&nbsp;DISTRICT:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;NAM:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801767468:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;692000896:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;202556478:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc30" style="display:none;"></div></div><div class="ygtvitem" id="ygtv31" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',31).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',31));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',31).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',31));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt31" class="ygtvtn" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',31).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel31_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232263831', '0');})"> </span><a tabindex="-1" id="ygtvlabelel31" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232263831', '0');" target="_self" title="FA-0505057 : IQS2.0 PID Profile for FET-10G= - Criteria = Customer Name - VODAFONE GROUP SERVICES GMBH: Return Reason Code - OHW9: Theater - EMEA: RMA Number - 801761158: Service Request No - 692001331: Service Contract No - 92281781:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',31).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',31));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',31).highlightNode('ygtvlabelel31');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',31); if (node) node.unhighlightNode('ygtvlabelel31');" infourl="showObjectInfo('4878','232263831','','','','false','',null);">FA-0505057&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;FET-10G=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;VODAFONE&nbsp;GROUP&nbsp;SERVICES&nbsp;GMBH:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;EMEA:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801761158:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;692001331:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;92281781:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc31" style="display:none;"></div></div><div class="ygtvitem" id="ygtv32" onmousedown="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',32).highlightContainerNode(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',32));" onmouseup="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',32).resetSelectedNodes(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',32));"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="ygtvblankdepthcell"><div class="ygtvspacer"></div></td><td id="ygtvt32" class="ygtvln" onclick="javascript:YAHOO.widget.TreeView.getNode('recentlyVisitedTree',32).notoggle()"><div class="ygtvspacer"></div></td><td nowrap="nowrap"><span id="ygtvlabelel32_img" class="node_icon"><img src="/Agile/static/05dacc169e676675246d41cd62d3d320/images/problem_report.png" title="Standard FA Case" border="0" width="16" height="16" onclick="javascript:displayObjectFromLeftPaneWithEvent(event, function() {displayObjectFromLeftPane('PSRHandler', '4878', '232232577', '0');})"> </span><a tabindex="-1" id="ygtvlabelel32" class="ygtvlabel" href="javascript:displayObjectFromLeftPane('PSRHandler', '4878', '232232577', '0');" target="_self" title="FA-0504596 : IQS2.0 PID Profile for SFP-10G-SR= - Criteria = Customer Name - WELLS FARGO: Return Reason Code - OHW9: Theater - NAM: RMA Number - 801758390: Service Request No - 691994119: Service Contract No - 201629820:," onclick="return YAHOO.widget.TreeView.getNode('recentlyVisitedTree',32).onLabelClick(event, YAHOO.widget.TreeView.getNode('recentlyVisitedTree',32));" onmouseout="cancelQuickViewTimer(this);" onmouseover="showQuickViewLink(event, this)" onfocus="this.hideFocus=true;YAHOO.widget.TreeView.getNode('recentlyVisitedTree',32).highlightNode('ygtvlabelel32');" onblur="var node = YAHOO.widget.TreeView.getNode('recentlyVisitedTree',32); if (node) node.unhighlightNode('ygtvlabelel32');" infourl="showObjectInfo('4878','232232577','','','','false','',null);">FA-0504596&nbsp;:&nbsp;IQS2.0&nbsp;PID&nbsp;Profile&nbsp;for&nbsp;SFP-10G-SR=&nbsp;-&nbsp;Criteria&nbsp;=&nbsp;Customer&nbsp;Name&nbsp;-&nbsp;WELLS&nbsp;FARGO:&nbsp;Return&nbsp;Reason&nbsp;Code&nbsp;-&nbsp;OHW9:&nbsp;Theater&nbsp;-&nbsp;NAM:&nbsp;RMA&nbsp;Number&nbsp;-&nbsp;801758390:&nbsp;Service&nbsp;Request&nbsp;No&nbsp;-&nbsp;691994119:&nbsp;Service&nbsp;Contract&nbsp;No&nbsp;-&nbsp;201629820:,</a></td></tr></tbody></table><div class="ygtvchildren" id="ygtvc32" style="display:none;"></div></div></div></div></div></div></div>

			
			</div>
			</div>                      
			
			<!-- ===== END FOLDER ===== -->
            
			<!-- ===== REPORTS ===== -->

			<div id="reportItem" class="slideMenuItem">
			<div id="reportHeader" class="slideMenuHeader" onmouseover="YAHOO.util.Dom.addClass(this, 'slideMenuHeaderHover');" onmouseout="YAHOO.util.Dom.removeClass(this, 'slideMenuHeaderHover');"><em class="report">&nbsp;</em> 
			<a href="javascript:noaction()" class="drLink" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(document.getElementById('reportHeader'), 'slideMenuHeaderHover')" onblur="YAHOO.util.Dom.removeClass(document.getElementById('reportHeader'), 'slideMenuHeaderHover')">Reports</a></div>
				  
			<div id="reportBody" class="slideMenuBody" tabindex="-1" style="height:0px;overflow:auto;visibility:hidden">

			<div id="reportActions" class="title first">
				<p><a class="expand_all first" title="Expand All" href="javascript:expandAllTree('reportsTree')" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, 'tree_actions_hover')" onblur="YAHOO.util.Dom.removeClass(this, 'tree_actions_hover')">&nbsp;</a>&nbsp;
				<a class="collapse_all" title="Collapse All" href="javascript:collapseAllTree('reportsTree')" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, 'tree_actions_hover')" onblur="YAHOO.util.Dom.removeClass(this, 'tree_actions_hover')">&nbsp;</a>&nbsp;
				<a class="edit" title="Organize Reports" href="javascript:openOrganizePage('', 'SettingsHandler', 'organizeReports', 'RightPane')" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, 'tree_actions_hover')" onblur="YAHOO.util.Dom.removeClass(this, 'tree_actions_hover')">&nbsp;</a></p>
			</div>
			
			<input name="Selections_2" value="" size="8" id="Selections_2" type="HIDDEN" class="">
<input name="TableDirtyRows_2" value="" size="8" id="TableDirtyRows_2" type="HIDDEN" class="">
<input name="TableRowMap_2" value="" size="8" id="TableRowMap_2" type="HIDDEN" class="">
<input name="globalValue_2" value="false" size="8" id="globalValue_2" type="HIDDEN" class="">
<input name="TableTreeRows_2" value="" size="8" id="TableTreeRows_2" type="HIDDEN" class="">
<input name="ExpandedRow_2" value="-1" size="8" id="ExpandedRow_2" type="HIDDEN" class="">

<script>
var tree_lPRT = null;
function loadReportsTree() {
tree_lPRT = new YAHOO.widget.AgileTreeView("reportsTree");
tree_lPRT.setTreeContextInfo("2", "lPRT", "PCMServlet", "LeftPaneHandler", "updateExpansions", "loadTreeNodes", true, 
false);
tree_lPRT.setDynamicLoad(loadDataForNode, 1);
var treeNode_ReportsT = new YAHOO.widget.AgileRootNode(new TreeNode("_nodeId_ReportsT", "Reports and Analytics", "Reports and Analytics","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, true, true, "ReportsT", "emphasis", false),tree_lPRT.getRoot(), true);
var treeNode_4_211_211 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_211_211", "PLM Analytics", "PLM Analytics","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, true, "4_211_211", null, true, -1), treeNode_ReportsT, false);
var treeNode_4_232333084_232333084 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_232333084_232333084", "Personal Reports", "Personal Reports","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, false, "4_232333084_232333084", null, true, -1), treeNode_ReportsT, false);
var treeNode_4_260_260 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_260_260", "Global Reports", "Global Reports","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, true, "4_260_260", null, true, -1), treeNode_ReportsT, false);
var treeNode_4_212_212 = new YAHOO.widget.AgileTextNode(new TreeNode("treeNode_4_212_212", "Standard Reports", "Standard Reports","javascript:noaction();", null, "/Agile/static/23e57292a19204b211b0ff5a4cbf2e14/images/folder_closed.png", "/Agile/static/2d882852d4b3baec409270aea5f17a76/images/folder_open.png", null, null, null, false, true, "4_212_212", null, true, -1), treeNode_ReportsT, false);
tree_lPRT._el.onkeydown  = function (evt) { tree_lPRT.handleKeyDownEvent(evt); }; 
tree_lPRT.draw();
} 
var namesArrlPRT = new Array();
namesArrlPRT[0]="PLM Analytics";namesArrlPRT[1]="Personal Reports";namesArrlPRT[2]="Global Reports";namesArrlPRT[3]="Standard Reports";</script>
<div id="reportsTree" class="treemenu"></div>

			
			</div>
			</div>

			<!-- ===== END REPORTS ===== -->
		
		                    

	
		<!-- ===== CONTEXT NAVIGATION DRAWER ===== -->

		<div id="ctxNavItem" class="slideMenuItem">                     
		<div id="ctxNavHeader" class="slideMenuHeader" onmouseover="YAHOO.util.Dom.addClass(this, 'slideMenuHeaderHover');" onmouseout="YAHOO.util.Dom.removeClass(this, 'slideMenuHeaderHover');"><em class="program">&nbsp;</em> 
		<a href="javascript:noaction()" class="drLink" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(document.getElementById('ctxNavHeader'), 'slideMenuHeaderHover')" onblur="YAHOO.util.Dom.removeClass(document.getElementById('ctxNavHeader'), 'slideMenuHeaderHover')">Navigator</a></div>
		
		<div id="ctxNavBody" class="slideMenuBody" tabindex="-1" style="height: 0px; overflow: auto; visibility: hidden;">

            <div id="ctxNavActions" class="notitle first">&nbsp;</div>                                              
                                      
            <div id="ctxNavTree" class="treemenu"></div>

			<div id="navigator_info" style="display:show"><p class="lp_navigator">To display data here, click 'Navigator' for Search Results, Bills of Materials, or Projects.</p></div>

		</div>                     
		</div>
		
		<!-- ===== END CONTEXT NAVIGATION DRAWER ===== -->           


    </div> <!-- END: slideMenu -->			 
</div> <!-- END: LeftPaneBottom -->

<input name="registeredTables" value="" size="8" id="registeredTables" type="HIDDEN" class="">
<input name="registeredTableNames" value="" size="8" id="registeredTableNames" type="HIDDEN" class="">
<input name="deleteRowsTableId" value="" size="8" id="deleteRowsTableId" type="HIDDEN" class="">
</form><form name="ActionForm_2__" method="POST" action="PCMServlet" onsubmit="return false;" target="LeftPane">
<!-- Begin Form Standard Attributes -->
<input name="module" value="LeftPaneHandler" size="8" id="module" type="HIDDEN" class="">
<input name="opcode" value="displayObject" size="8" id="opcode" type="HIDDEN" class="">
<input name="defaultAction" value="" size="8" id="defaultAction" type="HIDDEN" class="">
<input name="addlParam" value="" size="8" id="addlParam" type="HIDDEN" class="">
<input name="actionContextParam" value="" size="8" id="actionContextParam" type="HIDDEN" class="">
<input name="popup" value="" size="8" id="popup" type="HIDDEN" class="">
<input name="objver" value="" size="8" id="objver" type="HIDDEN" class="">
<input name="objid" value="" size="8" id="objid" type="HIDDEN" class="">
<input name="objectname" value="" size="8" id="objectname" type="HIDDEN" class="">
<input name="classid" value="" size="8" id="classid" type="HIDDEN" class="">
<input name="subclsid" value="" size="8" id="subclsid" type="HIDDEN" class="">
<input name="tabid" value="" size="8" id="tabid" type="HIDDEN" class="">
<input name="viewid" value="" size="8" id="viewid" type="HIDDEN" class="">
<input name="displayMode" value="" size="8" id="displayMode" type="HIDDEN" class="">
<input name="refresh" value="false" size="8" id="refresh" type="HIDDEN" class="">
<input name="pgWarnID" value="" size="8" id="pgWarnID" type="HIDDEN" class="">
<input name="pgWarnCode" value="" size="8" id="pgWarnCode" type="HIDDEN" class="">
<input name="warningString" value="" size="8" id="warningString" type="HIDDEN" class="">
<input name="fullrev" value="" size="8" id="fullrev" type="HIDDEN" class="">
<input name="process_actionId" value="" size="8" id="process_actionId" type="HIDDEN" class="">
<input name="pageName" value="" size="8" id="pageName" type="HIDDEN" class="">
<input name="formChanged" value="0" size="8" id="formChanged" type="HIDDEN" class="">
<input name="currentToken" value="" size="8" id="currentToken" type="HIDDEN" class="">
<input name="isTokenRequired" value="false" size="8" id="isTokenRequired" type="HIDDEN" class="">
<input name="ContextName" value="" size="8" id="ContextName" type="HIDDEN" class="">
<input name="ContextType" value="" size="8" id="ContextType" type="HIDDEN" class="">
<input name="DefaultBookmarkName" value="" size="8" id="DefaultBookmarkName" type="HIDDEN" class="">
<input name="helpID" value="6000" size="8" id="helpID" type="HIDDEN" class="">
<input name="tableIds" value="" size="8" id="tableIds" type="HIDDEN" class="">
<input name="showTips" value="" size="8" id="showTips" type="HIDDEN" class="">
<input name="refreshFromDB" value="" size="8" id="refreshFromDB" type="HIDDEN" class="">
<input name="recycle_qry_Id" value="" size="8" id="recycle_qry_Id" type="HIDDEN" class="">
<input name="isPageDirty" value="" size="8" id="isPageDirty" type="HIDDEN" class="">
<input name="currentPaginationTableId" value="-1" size="8" id="currentPaginationTableId" type="HIDDEN" class="">
<input name="subTabId" value="" size="8" id="subTabId" type="HIDDEN" class="">
<input name="PREVIEW_KEY" value="" size="8" id="PREVIEW_KEY" type="HIDDEN" class="">
<input name="PREVIEW_PARENT_KEY" value="" size="8" id="PREVIEW_PARENT_KEY" type="HIDDEN" class="">
<input name="PREVIEW_REFRESH" value="" size="8" id="PREVIEW_REFRESH" type="HIDDEN" class="">
<input name="contentTabView" value="" size="8" id="contentTabView" type="HIDDEN" class="">
<input name="contentTabIncludeAll" value="" size="8" id="contentTabIncludeAll" type="HIDDEN" class="">
<input name="whereUsedTabDisplayAllVersions" value="" size="8" id="whereUsedTabDisplayAllVersions" type="HIDDEN" class="">
<input name="cgToItemRevObjId" value="" size="8" id="cgToItemRevObjId" type="HIDDEN" class="">
<input name="cgToItemRevClassId" value="" size="8" id="cgToItemRevClassId" type="HIDDEN" class="">
<input name="cgToItemRevSiteId" value="" size="8" id="cgToItemRevSiteId" type="HIDDEN" class="">
<input name="preItemRevObjId" value="" size="8" id="preItemRevObjId" type="HIDDEN" class="">
<input name="preItemRevClassId" value="" size="8" id="preItemRevClassId" type="HIDDEN" class="">
<input name="preItemRevSiteId" value="" size="8" id="preItemRevSiteId" type="HIDDEN" class="">
<input name="searchFilterType" value="" size="8" id="searchFilterType" type="HIDDEN" class="">
<input name="checkoutLocation" value="" size="8" id="checkoutLocation" type="HIDDEN" class="">
<input name="boFileId" value="" size="8" id="boFileId" type="HIDDEN" class="">
<input name="fileRowIds" value="" size="8" id="fileRowIds" type="HIDDEN" class="">
<input name="fileIds" value="" size="8" id="fileIds" type="HIDDEN" class="">
<input name="fileNames" value="" size="8" id="fileNames" type="HIDDEN" class="">
<input name="fileSizes" value="" size="8" id="fileSizes" type="HIDDEN" class="">
<input name="asLatest" value="" size="8" id="asLatest" type="HIDDEN" class="">
<input name="asAllFiles" value="" size="8" id="asAllFiles" type="HIDDEN" class="">
<input name="selectedRevisionName" value="" size="8" id="selectedRevisionName" type="HIDDEN" class="">
<input name="selectedKeys" value="" size="8" id="selectedKeys" type="HIDDEN" class="">
<input name="fulltabledisplay" value="" size="8" id="fulltabledisplay" type="HIDDEN" class="">
<input name="fullgridtableid" value="" size="8" id="fullgridtableid" type="HIDDEN" class="">
<input name="refreshObjectTables" value="" size="8" id="refreshObjectTables" type="HIDDEN" class="">
<input name="iv" value="" size="8" id="iv" type="HIDDEN" class="">
<!-- End Form Standard Attributes -->
<input name="AGILE_CSRF_TOKEN_NAME" value="irSddVHz9tWrM43JllSRIxIzvJEBd6kh" size="8" id="AGILE_CSRF_TOKEN_NAME" type="HIDDEN" class="">
<!-- Begin ModuleSpecific Form Attributes -->
<input name="revchangeclass" value="" size="8" id="revchangeclass" type="HIDDEN" class="">
<input name="revchangeid" value="" size="8" id="revchangeid" type="HIDDEN" class="">
<input name="siteId" value="" size="8" id="siteId" type="HIDDEN" class="">
<input name="oldSiteId" value="" size="8" id="oldSiteId" type="HIDDEN" class="">
<input name="siteOrRevChanged" value="" size="8" id="siteOrRevChanged" type="HIDDEN" class="">
<input name="sQueryId" value="false" size="8" id="sQueryId" type="HIDDEN" class="">
<input name="rLeftPane" value="false" size="8" id="rLeftPane" type="HIDDEN" class="">
<input name="fromLeftPane" value="false" size="8" id="fromLeftPane" type="HIDDEN" class="">
<!-- End ModuleSpecific Form Attributes -->
<div id="frmDiv" style="width:0;height:0;"></div></form><script>isPageLoading=false;</script>


 <!-- END: drawerContent -->


<script>

function refreshCtxNavTree(){
	var tree = YAHOO.widget.TreeView.getTree('ctxNavTree');
	if(tree != null){
		var hasTreeActions = false;

		if(tree._classId == 18022 || 
			tree._classId == 18387) {
			hasTreeActions = true;
		}

		loadCtxNavTree(hasTreeActions, YAHOO.widget.TreeView.getTree('ctxNavTree').getObjectTreeParams())
	}
}

function buildTreeActions(){
	var act = '<p><a class="expand_all first" title="Expand All" '+
			  'href="javascript:expandAllTree(\'ctxNavTree\')" '+
			  'onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, \'tree_actions_hover\')" ' + 'onblur="YAHOO.util.Dom.removeClass(this, \'tree_actions_hover\')">&nbsp;</a>&nbsp;' +
			  '<a class="collapse_all" title="Collapse All" '+
			  'href="javascript:collapseAllTree(\'ctxNavTree\')" ' + 
		      'onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(this, \'tree_actions_hover\')" ' + 'onblur="YAHOO.util.Dom.removeClass(this, \'tree_actions_hover\')">&nbsp;</a></p>';

	document.getElementById('ctxNavActions').innerHTML = act;
	document.getElementById('ctxNavActions').className = "title first";
}

var dock = "Dock";
var undock = "Undock";

function toggleMDI(fld){
	if(fld.title.indexOf(undock) != -1)
		fld.title = dock;
	else
		fld.title = undock;

	alert('Behavior not defined yet!')
}

var toolsMenu;
var helpMenu;

function loadMenus(){
	var toolsMenuItems = [ [{ text : "Export" , url : "javascript:displayNewPDX()"} , { text : "Create Project from XML File" , url : "javascript:openMSProjectPublishWindow()"}] , [{ text : "Address Book" , url : "javascript:noaction()" , submenu :  { id:"18275", itemdata : [ [{ text : "Users" , url : "javascript:showAddressBook(0)" } ,{ text : "User Groups" , url : "javascript:showAddressBook(1)" } ,{ text : "Functional Teams" , url : "javascript:showAddressBook(2)" } ,{ text : "Supplier Groups" , url : "javascript:showAddressBook(3)" } ], [] ] }} , { text : "View files in separate Viewer windows" , id : "link_autovue_open" , url : "javascript:setAutovueOpeningMode()"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://www-pqmprd.cisco.com/BagnTagUserService/UserServlet"},"fn":"onURLPXClickFromToolsMenu"} , text : "Bag and Tag Inventory" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://www-pqmprd.cisco.com/BagnTagUserService/ClosureDescUserServlet"},"fn":"onURLPXClickFromToolsMenu"} , text : "Closure Description Approval Tool" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://www-pqmprd.cisco.com/MasterDataMaintenance/MainServlet"},"fn":"onURLPXClickFromToolsMenu"} , text : "Master Data Maintenance" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://www-pqmprd.cisco.com/BagnTagUserService/DashBoardUserServlet"},"fn":"onURLPXClickFromToolsMenu"} , text : "QIT Dashboard" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://cqi-cae.cisco.com/cqi/"},"fn":"onURLPXClickFromToolsMenu"} , text : "QMS FA Reporting Dashboard" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"http://wwwin.cisco.com/mfg/organizations/qms/qms.shtml"},"fn":"onURLPXClickFromToolsMenu"} , text : "QMS Launch Page" , url : "#"} , { onclick : {"obj":{"handler":"invokeURLProcessActionFromToolsMenu","url":"https://ibpm.cisco.com/rma/home/"},"fn":"onURLPXClickFromToolsMenu"} , text : "RMA Tool" , url : "#"}]];
	for(var i=0;i<toolsMenuItems.length;i++) {
		for(var j=0;j<toolsMenuItems[i].length;j++){
			if(toolsMenuItems[i][j].onclick != null){
				if(toolsMenuItems[i][j].onclick.fn != null){
					if(toolsMenuItems[i][j].onclick.fn == "onURLPXClickFromToolsMenu"){
						toolsMenuItems[i][j].onclick.fn = onURLPXClickFromToolsMenu;
					}				
				}
			}
		}
	}
	toolsMenu = new YAHOO.widget.Menu("tools", { constraintoviewport:false, zindex: 99998, hidedelay:600 });
	toolsMenu.addItems(toolsMenuItems);
	toolsMenu.render(document.body);
	toolsMenu.cfg.setProperty("context", ["preferences", "tl","bl"]);

	var helpMenuItems = [ [{ text : "Help" , url : "javascript:showOnlineHelp('http://www.oracle.com/technology/documentation/agile.html?Lang=en_US&CTXEX=');"} , { text : "About" , url : "javascript:displayAbout()"}] , [{ text : "Keyboard Controls" , url : "javascript:openKeyBoardControls()"} , { text : "Quick Tours" , url : "javascript:openMoviePopup()"}]];
		helpMenu = new YAHOO.widget.Menu("helpMenu", { constraintoviewport:false, zindex: 99998, hidedelay:600 });
	helpMenu.addItems(helpMenuItems);
	helpMenu.render(document.body);
	helpMenu.cfg.setProperty("context", ["help", "tl","bl"]);
}



AGILE.EventManager.addEvent(LEFTPANECONTENT, ON_LOAD, function() {
								doOnloadLeftActions();
							  });

AGILE.EventManager.addEvent(LEFTPANECONTENT, ON_WINDOW_RESIZE, function() {
								doLeftResizeActions();
							  });

AGILE.EventManager.addEvent('', OBJECT_CHANGED, function() {
									 markRecentlyForRefresh = true;
   	                                 });

</script>

 
<!-- //debug(" Page Compilation Time >> 4 "); -->
</div>
		<div id="collapsedPane" class="collapsedPane" style="display:none;" onmouseover="YAHOO.util.Dom.addClass(this, 'collapsedPaneHover');" onmouseout="YAHOO.util.Dom.removeClass(this, 'collapsedPaneHover');">          
		<div id="expand" class="layoutExpand" title="Expand Left Navigation">
		</div>
	</div>
	<div id="MainPane" class="MainPane" style="width: 1554px;">	
		<div id="sLeftHandler" style="display:block; border-left:4px solid #7a7a7a; cursor:e-resize; color: #7a7a7a; position:absolute; width:4px; z-index:2; height:100%;">&nbsp;</div>
		<div id="sLeftHandler_proxy" style="visibility: hidden; position: absolute; cursor: e-resize; width: 4px; height: 100%; z-index: 2; color: rgb(122, 122, 122); background-color: rgb(122, 122, 122);">&nbsp;</div>
		



<script>

function handleTopPaneActions() {
	toggle(false, "top_back");
	toggle(false, "top_forward");
	toggle(true, "top_refresh");
	toggle(true, "top_home");
}

</script>
		


<style>

	.style_0 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/320b5d4bd8abc5d083fbf85f8ba7f43a/images/icn_action_search_selector.png');
	}

	.style_901 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/3faac2f04cb61823ae536a1fcc857e11/images/part.png');
	}

	.style_1476 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/2e078fc4d5bc47e9c57925578c2deae8/images/icn_obj_manufacturer_part.png');
	}

	.style_2000004415 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/046041b2aa1218f540cd2beac22dd323/images/icn_obj_part_family.png');
	}

	.style_931 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/1f464afb6e2c4c54c9c525247bb6b0dd/images/icn_obj_eng_change_order.png');
	}

	.style_4750 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/8baa9b28a367eb99ead5272579e27d0b/images/icn_obj_problem_report.png');
	}

	.style_4010 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/9c42a6ad181a848308d5cf971b3f4359/images/icn_obj_non_conformance.png');
	}

	.style_18007 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/7faebf016a9549f0acc873a97ce8e859/images/ico_obj_program.png');
	}

	.style_18444 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/b2eee7dd5229f42e7ca182d0d14cac1e/images/icn_obj_discussion.png');
	}

	.style_2000002893 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/a549548361234aa41bc4c3381475067a/images/icn_obj_material_declaration.png');
	}

	.style_2000001998 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/33ccfb3a88463d5383bfa9665f422595/images/icn_obj_specification.png');
	}

	.style_4974 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/22a1dae157c12a4ecc8e9a6835f53ddc/images/icn_obj_customer.png');
	}

	.style_1435 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/c76008c6d7ac7316ec206dc022581101/images/icn_obj_manufacturer.png');
	}

	.style_17544 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/bd6f7e31a467966b1d4d95bd5f77bd02/images/icn_obj_supplier.png');
	}

	.style_11595 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/e0f993df834daaa219fd13cfcc87437b/images/icn_obj_user.png');
	}

	.style_11976 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/62e9ac64fbedfa71ba6f9f6508b877dc/images/icn_obj_user_group.png');
	}

	.style_6145 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/a4a9063b33680c7528830c3c0931bb57/images/icn_obj_file_folder.png');
	}

	.style_12650 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/0003b64cf693e91252698951ff50d0d4/images/icn_obj_auto_transfer_order.png');
	}

	.style_3091 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/f5527b4e285e7edbba61bd472f8a9c97/images/icn_obj_report.png');
	}

	.style_1112 {
		background-position: 15px 3px;
		background-image: url('/Agile/static/c411f8ec02a39b6ff2f21e915951e004/images/icn_search_text.png');
	}


</style>


<script>
var searchCriteriaStr = 'Enter Criteria';
var createMenuItems = [ [{ text : "Items" , submenu :  { id:"901", itemdata : [ [{ text : "Documents" , url : "javascript:displayNewItem(9000)" } ] ] }}] , [{ text : "Quality Change Requests" , submenu :  { id:"4010", itemdata : [ [{ text : "Corrective and Preventive Actions" , url : "javascript:displayNewQCR(4928)" } ] ] }}] , [{ text : "Discussions" , url : "javascript:displayNewDiscussion();"}] , [{ text : "Reports" , submenu :  { id:"3091", itemdata : [ [{ text : "Custom Reports" , url : "javascript:displayNewReport(8020)" } ,{ text : "External Reports" , url : "javascript:displayNewReport(8030)" } ] ] }}]];
var searchMenuItems = [ [{ classname : "searchMenu style_0 selecteditem" , emphasis : true , id : "cls_0" , text : "All" , url : "javascript:changeSelector(0)"}] , [{ classname : "searchMenu style_901" , id : "cls_901" , text : "Items" , url : "javascript:changeSelector(901)"} , { classname : "searchMenu style_1476" , id : "cls_1476" , text : "Manufacturer Parts" , url : "javascript:changeSelector(1476)"} , { classname : "searchMenu style_2000004415" , id : "cls_2000004415" , text : "Part Groups" , url : "javascript:changeSelector(2000004415)"}] , [{ classname : "searchMenu style_931" , id : "cls_931" , text : "Changes" , url : "javascript:changeSelector(931)"} , { classname : "searchMenu style_4750" , id : "cls_4750" , text : "Product Service Requests" , url : "javascript:changeSelector(4750)"} , { classname : "searchMenu style_4010" , id : "cls_4010" , text : "Quality Change Requests" , url : "javascript:changeSelector(4010)"}] , [{ classname : "searchMenu style_18007" , id : "cls_18007" , text : "Programs" , url : "javascript:changeSelector(18007)"} , { classname : "searchMenu style_18444" , id : "cls_18444" , text : "Discussions" , url : "javascript:changeSelector(18444)"}] , [{ classname : "searchMenu style_2000002893" , id : "cls_2000002893" , text : "Declarations" , url : "javascript:changeSelector(2000002893)"} , { classname : "searchMenu style_2000001998" , id : "cls_2000001998" , text : "Specifications" , url : "javascript:changeSelector(2000001998)"}] , [{ classname : "searchMenu style_4974" , id : "cls_4974" , text : "Customers" , url : "javascript:changeSelector(4974)"} , { classname : "searchMenu style_1435" , id : "cls_1435" , text : "Manufacturers" , url : "javascript:changeSelector(1435)"} , { classname : "searchMenu style_17544" , id : "cls_17544" , text : "Suppliers" , url : "javascript:changeSelector(17544)"} , { classname : "searchMenu style_11595" , id : "cls_11595" , text : "Users" , url : "javascript:changeSelector(11595)"} , { classname : "searchMenu style_11976" , id : "cls_11976" , text : "User Groups" , url : "javascript:changeSelector(11976)"}] , [{ classname : "searchMenu style_6145" , id : "cls_6145" , text : "File Folders" , url : "javascript:changeSelector(6145)"} , { classname : "searchMenu style_12650" , id : "cls_12650" , text : "Transfer Orders" , url : "javascript:changeSelector(12650)"}] , [{ classname : "searchMenu style_3091" , id : "cls_3091" , text : "Reports" , url : "javascript:changeSelector(3091)"}] , [{ classname : "searchMenu style_1112" , id : "cls_1112" , text : "Include Attachments Text" , url : "javascript:toggleSearchText()"}]];




onWindowLoad = function(p_oEvent) {
	
	if(true) {
		var createElem = document.getElementById("toggle_create_menu");
		createObjMenu = new YAHOO.widget.Menu( "createmenu", {constraintoviewport:false, zindex: 99998, hidedelay:600 });
		YAHOO.util.Event.addListener("toggle_create_menu", "click", toggleCreateMenu);
	}


	searchMenu = new YAHOO.widget.Menu("searchmenu", { classname:"search_selectors", constraintoviewport:false, zindex: 99998, hidedelay:600 });
	searchMenu.clickEvent.subscribe(function(e) {
		searchMenu.hide();		
	 });

	YAHOO.util.Event.addListener("toggle_search_menu", "click", toggleSearchMenu);
	YAHOO.util.Event.addListener(window, "resize", hideToppaneMenus);

	function hideToppaneMenus() {
		createObjMenu.hide();
		searchMenu.hide();
	}

	if(document.reqForm.quickSearchSelectionObject.value != 0) {
		document.reqForm.quickSearchSelectionObject.className = "";			
	}

	updateToolTip(document.reqForm.quickSearchSelectionObject.value, 'All');
	document.reqForm.QUICKSEARCH_STRING.focus();
	registerEvents();
}


YAHOO.util.Event.addListener(window, "load", onWindowLoad);


prefStartPageUrl = "module=InboxSearchHandler&opcode=displayInboxView";
var _initSearchValue = "Enter Criteria";

</script>

<form name="reqForm" method="POST" action="PCMServlet"> 

    <input type="hidden" name="module" id="module" value="">
	<input type="hidden" name="opcode" id="opcode" value="">
	<input type="hidden" name="addlParam" id="addlParam" value="">
    <input type="hidden" name="classid" id="classid" value="">
	<input type="hidden" name="objid" id="objid" value="">
	<input type="hidden" name="popup" id="popup" value="">
	<input type="hidden" name="refresh" id="refresh" value="true">
    <input type="hidden" name="displayMode" id="displayMode" value="">
	<input type="hidden" name="fromSearchUrl" id="fromSearchUrl" value="">
	<input type="hidden" name="ThumbnailSearchViewMode" id="ThumbnailSearchViewMode" value="">
    <input name="registeredTables" value="" type="HIDDEN" class="" size="8" id="registeredTables">

    <input type="hidden" name="wizardId" id="wizardId" value="">
    <input type="hidden" name="create_subclsid" id="create_subclsid" value="">
    <input type="hidden" name="addToTrail" id="addToTrail" value="">
    <input type="hidden" name="wizardHandler" id="wizardHandler" value="">
    <input type="hidden" name="quickSearchSelectionObject" id="quickSearchSelectionObject" value="0">
    <input type="hidden" name="needAttachmentSearch" id="needAttachmentSearch" value="null">

<div class="TopPane">
	<!-- BEGIN: TOP PANE BUTTONS \\\-->
	<div class="nav_buttons">
		<a onclick="javascript:navigateBack()" href="javascript:noaction()" id="top_back" title="Back" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="top_backspan"><em class="iconic back">&nbsp;</em>&nbsp;</span></a>


		<a onclick="javascript:navigateForward()" href="javascript:noaction()" id="top_forward" title="Forward" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="top_forwardspan"><em class="iconic forward">&nbsp;</em>&nbsp;</span></a>


		<a onclick="javascript:doFrameRefresh()" href="javascript:noaction()" id="top_refresh" title="Refresh" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="top_refreshspan"><em class="iconic reload">&nbsp;</em>&nbsp;</span></a>


		<a onclick="javascript:goHome()" href="javascript:noaction()" id="top_home" title="Home  (Ctrl + Shift + H)" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="top_homespan"><em class="iconic home">&nbsp;</em>&nbsp;</span></a>

		
		<a onclick="javascript:AGILE.util.fileUploadManager.reloadUploadPalette()" href="javascript:noaction()" id="top_gupi" title="Display the progress of file uploads" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)" style="padding-left: 6px;"><span id="top_gupispan" style="padding-right: 6px;"><span class="top_gupi_upload">&nbsp;<em class="top_gupi_remaintime top_gupi_remaintime_active">92%</em><em class="top_gupi_progress" style="width: 92%;">&nbsp;</em></span></span></a>


	</div>
	<!-- END: TOP PANE BUTTONS \\\-->
	
		<!-- BEGIN: CREATE NEW MENU (YUI) \\\-->
		<div class="create_button" id="createButton">
			<a href="javascript:noaction()" id="toggle_create_menu" title="Ctrl + Shift + C" onfocus="this.hideFocus=true;YAHOO.util.Dom.addClass(document.getElementById('createButton'), 'create_button_hover')" onblur="YAHOO.util.Dom.removeClass(document.getElementById('createButton'), 'create_button_hover')">Create New<em class="dropdown">&nbsp;</em></a>
		</div>
		<!-- END: CREATE NEW MENU \\\-->
	
	<!-- BEGIN: SEARCH PANEL (YUI) \\\-->
	<div class="search_panel">
		<a tabindex="-1" href="javascript:noaction()" id="toggle_search_menu" title="All"><em id="selector_elm" class="search_selector">&nbsp;</em><em class="divet">&nbsp;</em></a>
		<input type="text" name="QUICKSEARCH_STRING" value="" id="QUICKSEARCH_STRING" onfocus="setTimeout('focusSearchElem()', 100);">

		<div class="search_buttons">
			
			<a onclick="javascript:doSimpleSearch()" href="javascript:noaction()" id="top_simpleSearch" title="Execute a Quick Search" class="button " onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="top_simpleSearchspan" class=" "><em class="iconic quick_search">&nbsp;</em>&nbsp;</span></a>

            <!-- @TODO localize -->
			<a onclick="javascript:showParametricSearch()" href="javascript:noaction()" id="top_paramSearch" title="Custom Search (Ctrl + Shift + Q)" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="top_paramSearchspan"><em class="iconic parametric_search">&nbsp;</em>&nbsp;</span></a>

			<span id="progress_indicator_global" class="progress_indicator global" style="visibility: hidden;">&nbsp;</span>
		</div>
	</div>
	<!-- END: SEARCH PANEL \\\-->
</div>

</form>	
		<div id="rightpanecontent">









    
    
    
    
    
    
    
    
    


    
    
     
    
        
        
     
    
    
    
    
    

    


    
    
    
    
    
    
    
    


    
    
    
        
    
    
    


       
    
    
    
    
    
    
    


    
    
    
    
    
    
    
    
    














<script>isPageLoading=true;</script>
<form name="MainForm" method="POST" action="PCMServlet" enctype="application/x-www-form-urlencoded" onsubmit="return false;" target="RightPane">
<!-- Begin Form Standard Attributes -->
<input name="module" value="PSRHandler" size="8" id="module" type="HIDDEN" class="">
<input name="opcode" value="displayObject" size="8" id="opcode" type="HIDDEN" class="">
<input name="defaultAction" value="" size="8" id="defaultAction" type="HIDDEN" class="">
<input name="addlParam" value="" size="8" id="addlParam" type="HIDDEN" class="">
<input name="actionContextParam" value="" size="8" id="actionContextParam" type="HIDDEN" class="">
<input name="popup" value="" size="8" id="popup" type="HIDDEN" class="">
<input name="objver" value="172" size="8" id="objver" type="HIDDEN" class="">
<input name="objid" value="232336885" size="8" id="objid" type="HIDDEN" class="">
<input name="objectname" value="FA-0505813" size="8" id="objectname" type="HIDDEN" class="">
<input name="classid" value="4878" size="8" id="classid" type="HIDDEN" class="">
<input name="subclsid" value="4883" size="8" id="subclsid" type="HIDDEN" class="">
<input name="tabid" value="7" size="8" id="tabid" type="HIDDEN" class="">
<input name="viewid" value="0" size="8" id="viewid" type="HIDDEN" class="">
<input name="displayMode" value="0" size="8" id="displayMode" type="HIDDEN" class="">
<input name="refresh" value="false" size="8" id="refresh" type="HIDDEN" class="">
<input name="pgWarnID" value="" size="8" id="pgWarnID" type="HIDDEN" class="">
<input name="pgWarnCode" value="" size="8" id="pgWarnCode" type="HIDDEN" class="">
<input name="warningString" value="" size="8" id="warningString" type="HIDDEN" class="">
<input name="fullrev" value="" size="8" id="fullrev" type="HIDDEN" class="">
<input name="process_actionId" value="" size="8" id="process_actionId" type="HIDDEN" class="">
<input name="pageName" value="" size="8" id="pageName" type="HIDDEN" class="">
<input name="formChanged" value="0" size="8" id="formChanged" type="HIDDEN" class="">
<input name="currentToken" value="" size="8" id="currentToken" type="HIDDEN" class="">
<input name="isTokenRequired" value="false" size="8" id="isTokenRequired" type="HIDDEN" class="">
<input name="ContextName" value="FA-0505813" size="8" id="ContextName" type="HIDDEN" class="">
<input name="ContextType" value="Standard FA Case" size="8" id="ContextType" type="HIDDEN" class="">
<input name="DefaultBookmarkName" value="FA-0505813 : IQS2.0 PID Profile for QSFP-100G-AOC7M= - Criteria = Customer Name - T-MOBILE: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801773207: Service Request No - 692011554: Service Contract No - 200941956:," size="8" id="DefaultBookmarkName" type="HIDDEN" class="">
<input name="helpID" value="4878_7" size="8" id="helpID" type="HIDDEN" class="">
<input name="tableIds" value="10" size="8" id="tableIds" type="HIDDEN" class="">
<input name="showTips" value="" size="8" id="showTips" type="HIDDEN" class="">
<input name="refreshFromDB" value="" size="8" id="refreshFromDB" type="HIDDEN" class="">
<input name="recycle_qry_Id" value="" size="8" id="recycle_qry_Id" type="HIDDEN" class="">
<input name="isPageDirty" value="" size="8" id="isPageDirty" type="HIDDEN" class="">
<input name="currentPaginationTableId" value="-1" size="8" id="currentPaginationTableId" type="HIDDEN" class="">
<input name="subTabId" value="" size="8" id="subTabId" type="HIDDEN" class="">
<input name="PREVIEW_KEY" value="" size="8" id="PREVIEW_KEY" type="HIDDEN" class="">
<input name="PREVIEW_PARENT_KEY" value="" size="8" id="PREVIEW_PARENT_KEY" type="HIDDEN" class="">
<input name="PREVIEW_REFRESH" value="" size="8" id="PREVIEW_REFRESH" type="HIDDEN" class="">
<input name="contentTabView" value="" size="8" id="contentTabView" type="HIDDEN" class="">
<input name="contentTabIncludeAll" value="" size="8" id="contentTabIncludeAll" type="HIDDEN" class="">
<input name="whereUsedTabDisplayAllVersions" value="" size="8" id="whereUsedTabDisplayAllVersions" type="HIDDEN" class="">
<input name="cgToItemRevObjId" value="" size="8" id="cgToItemRevObjId" type="HIDDEN" class="">
<input name="cgToItemRevClassId" value="" size="8" id="cgToItemRevClassId" type="HIDDEN" class="">
<input name="cgToItemRevSiteId" value="" size="8" id="cgToItemRevSiteId" type="HIDDEN" class="">
<input name="preItemRevObjId" value="" size="8" id="preItemRevObjId" type="HIDDEN" class="">
<input name="preItemRevClassId" value="" size="8" id="preItemRevClassId" type="HIDDEN" class="">
<input name="preItemRevSiteId" value="" size="8" id="preItemRevSiteId" type="HIDDEN" class="">
<input name="searchFilterType" value="" size="8" id="searchFilterType" type="HIDDEN" class="">
<input name="checkoutLocation" value="" size="8" id="checkoutLocation" type="HIDDEN" class="">
<input name="boFileId" value="" size="8" id="boFileId" type="HIDDEN" class="">
<input name="fileRowIds" value="" size="8" id="fileRowIds" type="HIDDEN" class="">
<input name="fileIds" value="" size="8" id="fileIds" type="HIDDEN" class="">
<input name="fileNames" value="" size="8" id="fileNames" type="HIDDEN" class="">
<input name="fileSizes" value="" size="8" id="fileSizes" type="HIDDEN" class="">
<input name="asLatest" value="" size="8" id="asLatest" type="HIDDEN" class="">
<input name="asAllFiles" value="" size="8" id="asAllFiles" type="HIDDEN" class="">
<input name="selectedRevisionName" value="" size="8" id="selectedRevisionName" type="HIDDEN" class="">
<input name="selectedKeys" value="" size="8" id="selectedKeys" type="HIDDEN" class="">
<input name="fulltabledisplay" value="" size="8" id="fulltabledisplay" type="HIDDEN" class="">
<input name="fullgridtableid" value="" size="8" id="fullgridtableid" type="HIDDEN" class="">
<input name="refreshObjectTables" value="" size="8" id="refreshObjectTables" type="HIDDEN" class="">
<input name="iv" value="" size="8" id="iv" type="HIDDEN" class="">
<!-- End Form Standard Attributes -->
<input name="AGILE_CSRF_TOKEN_NAME" value="irSddVHz9tWrM43JllSRIxIzvJEBd6kh" size="8" id="AGILE_CSRF_TOKEN_NAME" type="HIDDEN" class="">
<!-- Begin ModuleSpecific Form Attributes -->
<input name="addAIClassId" value="" size="8" id="addAIClassId" type="HIDDEN" class="">
<input name="addAIObjId" value="" size="8" id="addAIObjId" type="HIDDEN" class="">
<input name="aiObjectName" value="" size="8" id="aiObjectName" type="HIDDEN" class="">
<input name="changeCreated" value="" size="8" id="changeCreated" type="HIDDEN" class="">
<input name="fromAISiteId" value="" size="8" id="fromAISiteId" type="HIDDEN" class="">
<input name="fromAIRevId" value="" size="8" id="fromAIRevId" type="HIDDEN" class="">
<!-- End ModuleSpecific Form Attributes -->


<input type="hidden" name="skipKey" id="skipKey" value="">
<input type="hidden" name="sequenceModified" id="sequenceModified" value="">
<input type="hidden" name="bookmarks_Refresh" id="bookmarks_Refresh" value="false">





	<!--************************************
		HEADER
	*************************************-->
	<div id="header_tab_wrapper" class="header_tab_wrapper">

	<div class="header_wrapper">
		<!-- bread crumb -->
		





			<div class="breadcrumb_wrapper">
			<ul class="breadcrumbs">
				<li><a href="javascript:displayTrailObject('5');">Search Results</a>&nbsp;»</li><li>FA-0505813</li>
<input name="trailPath" value="Search Results;4878:232336885" size="8" id="trailPath" type="HIDDEN" class="">

			</ul>
			</div>


		

		<div class="column_one layout">
			







	

	<!-- standard page title -->

	
		<h2>FA-0505813</h2>
		
	

	<!-- page description -->
	
		<p><strong>Standard FA Case</strong>
		
		
		• 
		

		<span class="objectHeaderDescripton" title="IQS2.0 PID Profile for QSFP-100G-AOC7M= - Criteria = Customer Name - T-MOBILE: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801773207: Service Request No - 692011554: Service Contract No - 200941956:,">
		
          IQS2.0 PID Profile for QSFP-100G-AOC7M= - Criteria = Customer Name - T-MOBILE: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801773207: Servi...

		</span></p>

	


		</div>

		<!-- object status -->
		
						













<!-- Object Stamp -->



	<div class="column_two">

	    
		<h2 style="color:Blue;">Fault Duplication</h2>
	


	
	</div>






			

	</div>

	<!--************************************
		OBJECT LEVEL CONTROLS
	*************************************-->

	<div class="object_level_controls">
		

		


		
			







		
		
			
				<script>

actionsMenu['arMenu36'] = new Array( new Array(
 getMenuItemObj("In Transit", null, "javascript:showNextWorkflowStatus('32056','preAuditDisplayChangeStatus');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fault Isolation", null, "javascript:showNextWorkflowStatus('32075','showNextWorkflowStatus');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Root Cause In Progress", null, "javascript:showNextWorkflowStatus('32078','showNextWorkflowStatus');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Pending Closure Approval", null, "javascript:showNextWorkflowStatus('32088','showNextWorkflowStatus');", null, null, null, false, null, null, null, null, null)) );
var arMenu36_obj; menuIds[menuIds.length] = '36'; 


</script>

<a id="MSG_Comment" title="Comment" href="javascript:noaction();" onclick="javascript:showCommentPage()" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_Commentspan"><em style="background-image: url(/Agile/static/33bb1a437f08cb21a37cabba51789d0c/images/icn_action_comment.png)">&nbsp;</em>&nbsp;Comment</span></a>
<a id="MSG_NextStatus" href="javascript:noaction();" class="button combo" onclick="javascript:showNextWorkflowStatus();" ondblclick="javascript:showNextWorkflowStatus();" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_NextStatusspan"><em style="background-image: url(/Agile/static/d8c994b514a67d5dc7d5fda515aefaae/images/ico_next_status.png)">&nbsp;</em>&nbsp;Next Status&nbsp;<em class="menu" id="MSG_NextStatus_em" onclick="javascript:showActionsMenu(document.getElementById('MSG_NextStatus'), '36', event);" ondblclick="javascript:showActionsMenu(document.getElementById('MSG_NextStatus'), '36', event);" onmouseover="YAHOO.util.Dom.addClass(this, 'buttonComboSpanMenuHover');" onmouseout="YAHOO.util.Dom.removeClass(this, 'buttonComboSpanMenuHover');">&nbsp;</em>&nbsp;</span></a>

<a id="MSG_Show_In_Navigator" title="Navigator (Show Tables in Navigator)" href="javascript:noaction();" onclick="javascript:showTreeViewInLeftPane('LeftPaneHandler', 'showPSRViewForLeftPane')" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_Show_In_Navigatorspan"><em style="background-image: url(/Agile/static/4722f7e42e18f3b11bd43c6a42e96be3/images/ico_view_navigator.png)">&nbsp;</em>&nbsp;Navigator</span></a>
		
			
			<script>
</script>
<script>actionsMenu['arMenu38'] = new Array( new Array(
 getMenuItemObj("Bookmark", null, "javascript:addBookMarks()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Subscribe", null, "javascript:showSubscription()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Save As", null, "javascript:showSaveAsDialog()", null, null, null, true, null, null, null, null, null,null),
 getMenuItemObj("Delete", null, "javascript:deleteObject()", null, null, null, true, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Send", null, "javascript:sendObject()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Sharing", null, "javascript:loadShareDialog('PSRHandler')", null, null, null, true, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Copy URL to Clipboard", null, "javascript:copyToClipBoard()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Audit Status", null, "javascript:auditStatus()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Audit Release", null, "javascript:auditRelease()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("View Workflows", null, "javascript:viewWorkflows()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Print", null, "javascript:showPrintOptions()", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Export", null, "javascript:ShowExportDialog()", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Create Quality Change Requests", null, "javascript:showSaveAsDialog('CreateQCRHandler')", null, null, null, false, null, null, null, null, null,null)), new Array(
 getMenuItemObj("Calculate FA Case Priority", null, "javascript:invokeProcessAction('48698')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Convert FA Case to Customer/Cisco Requested", null, "javascript:invokeProcessAction('40065')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Create OEM / Root Cause", null, "javascript:invokeProcessAction('48839')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Create SoftWare Root Cause Case", null, "javascript:invokeProcessAction('50743')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Generate 4-Block Report", null, "javascript:invokeProcessAction('51986')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Reset Validation for Submittal", null, "javascript:invokeProcessAction('37778')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Retrieve C3 Data", null, "javascript:invokeProcessAction('36460')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Set High Priority FA to Yes/No", null, "javascript:invokeProcessAction('48699')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Update CPN Information", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"https://www-pqmprd.cisco.com/ACTSUserService/ACTSServlet?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}}),
 getMenuItemObj("Update Final SRE Symptom Code Category and Sub Category", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"https://www-pqmprd.cisco.com/UpdateSRESymptomCategory/UpdateSRESymptomCategoryServlet?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}}),
 getMenuItemObj("Update  Issue Classification", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"https://www-pqmprd.cisco.com/DeriveAndUpdateIssueClassification/UpdateIssueClassificationServlet?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}}),
 getMenuItemObj("Validation for Submittal", null, "javascript:invokeProcessAction('37780')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("View Logistic information from FAST", null, "#", null, null, null, false, null, null, null, onURLPXClick, null,{"obj":{"handler":"invokeURLPX","url":"http://wwwix-pqmprd.cisco.com:7009/LogisticInfoURLPX/FALogisticInfoMain.jsp?agile.classID=4883&agile.4856=FA-0505813&agile.userName=wlongsid&ContextType=Standard FA Case&ContextName=FA-0505813","target":"new"}})) );</script>
<script>menuIds[menuIds.length] =  '38'; </script>
<a id="Actions" href="javascript:noaction();" class="button  " onclick="javascript:showActionsMenu(this, '38', event,'','');" ondblclick="javascript:showActionsMenu(this, '38', event,'','');" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="Actionsspan">Actions<em id="Actionsem_38" class="dropdown">&nbsp;</em>&nbsp;</span></a>
	
	


		
	</div>		
	</div>






<!--************************************
	TAB VIEW
*************************************-->
<div id="tabsview_wrapper">	
<!-- start content -->








<div id="tabsandcontrols"> <!-- wrapper for tabs, dms, and tab actions -->

	<!--************************************
		TABS
	*************************************-->
	




 






<script>

var leftEnabledImg = "/Agile/static/e8176e654a45303646af19ee11289146/images/icn_action_tabscroll_left_enabled.png";
var leftDisabledImg = "/Agile/static/c7e1230fb6e6767f97e3af39d4c5bc4d/images/icn_action_tabscroll_left_disabled.png";
var rightEnabledImg = "/Agile/static/6dbe07cad9d304865dea9dfd18d4cb59/images/icn_action_tabscroll_right_enabled.png";
var rightDisabledImg = "/Agile/static/5f2041e87043a6f311afca298dd87a84/images/icn_action_tabscroll_right_disabled.png";

</script>



<div id="leftScroll" style="display: none;">
<img id="leftScrollImg" src="/Agile/static/e8176e654a45303646af19ee11289146/images/icn_action_tabscroll_left_enabled.png" onmousedown="scrollButtonPressed(event, 'left')" onmouseup="hideShowScrollButtons()" oncontextmenu="return false">
</div>

<div id="rightScroll" style="display: none;">
<img id="rightScrollImg" src="/Agile/static/6dbe07cad9d304865dea9dfd18d4cb59/images/icn_action_tabscroll_right_enabled.png" onmousedown="scrollButtonPressed(event, 'right')" onmouseup="hideShowScrollButtons()" oncontextmenu="return false">
</div>

<div id="rightScrollMenu" style="display: block; left: 1904px; top: 150px;">
<img id="rightMenuImg" src="/Agile/static/8913d52dc8a2aeaaa1ea83e36663943d/images/icn_action_tabmenu.png" onclick="showTabsMenu(this, '39', event)" ondblclick="showTabsMenu(this, '39', event)">
</div>





	
<script>tabsMenu = [];tabsMenu['menu_39'] = [ [
 getMenuItemObj("Cover Page", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '0','', '0');", null, null, null, false, null, null, null, null, "tabMenu "), 
 getMenuItemObj("Affected Items", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '2','', '0');", null, null, null, false, null, null, null, null, "tabMenu icn_status_dot_gray"), 
 getMenuItemObj("Workflow", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '4','', '0');", null, null, null, false, null, null, null, null, "tabMenu icn_status_dot_gray"), 
 getMenuItemObj("Relationships", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '5','', '0');", null, null, null, false, null, null, null, null, "tabMenu "), 
 getMenuItemObj("Attachments", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '7','', '0');", null, true, null, false, null, null, null, null, "tabMenu selecteditem icn_status_dot_gray"), 
 getMenuItemObj("History", null, "javascript:displayObject('PSRHandler', '4878', '232336885', '8','', '0');", null, null, null, false, null, null, null, null, "tabMenu ")] ];</script>
<script>var arMenu39_obj; menuIds[menuIds.length] =  '39'; </script>
<div id="tabsDiv" class="new_tabs" style="width: 100%;"><ul style="width: 100%;"><li><a href="javascript:displayObject('PSRHandler', '4878', '232336885', '0','', '0');" onfocus="this.className='onTabFocus';" onblur="this.className='';">Cover Page</a></li><li><a href="javascript:displayObject('PSRHandler', '4878', '232336885', '2','', '0');" onfocus="this.className='onTabFocus';" onblur="this.className='';">Affected Items<img src="/Agile/static/30d777677553af90f7ede446578da674/images/icn_status_dot_gray.png"></a></li><li><a href="javascript:displayObject('PSRHandler', '4878', '232336885', '4','', '0');" onfocus="this.className='onTabFocus';" onblur="this.className='';">Workflow<img src="/Agile/static/30d777677553af90f7ede446578da674/images/icn_status_dot_gray.png"></a></li><li><a href="javascript:displayObject('PSRHandler', '4878', '232336885', '5','', '0');" onfocus="this.className='onTabFocus';" onblur="this.className='';">Relationships</a></li><li id="selectedTab"><span><a href="javascript:displayObject('PSRHandler', '4878', '232336885', '7','', '0');" onfocus="this.className='onTabFocus';" onblur="this.className='';">Attachments<img src="/Agile/static/30d777677553af90f7ede446578da674/images/icn_status_dot_gray.png"></a></span></li><li><a href="javascript:displayObject('PSRHandler', '4878', '232336885', '8','', '0');" onfocus="this.className='onTabFocus';" onblur="this.className='';">History</a></li></ul></div>
		





    
	<!--************************************
		MESSAGES
	*************************************-->	
	<!-- COMMENT OUT FOR NOW UNTIL WE FULLY IMPLEMENT THE 'HELP STRIP'-->
	<!-- region:render section="tabTips" /-->	
	
		
	





<div id="dms" class="message"><p class="text">&nbsp;</p></div>





	
	
	











	
	<!-- Keep the warnings tag for now -->
		
			
	
	
	








		

<script>
	resizeHeadingLinks();
</script>
	<!-- hide view_controls div by default for now need to fix the css 
		margins when we start working on the layout that include this one -->	
	
	
	
	
	
	
	
	
	
	
	
	
	
	









<style>
.table_actions {
	min-width: 800px;
}
</style>
<!-- BEGIN ITEM ATTACHMENTS CONTENT -->
<script language="Javascript">

	// Todo: need to place this common code into one place instead of copying/pasting, but not in HF
	function encodeToHex(str) { 
		var encodedStr = "";
		for (var i=0; i < str.length; i++) {
			if (str.charAt(i) == '&') {
				encodedStr += "\\x26";
			}
			else if (str.charAt(i) == '=') {
				encodedStr += "\\x3D";
			}
			else if (str.charAt(i) == '/') {
				encodedStr += "\\x2F";
			}
			else if (str.charAt(i) == '"') {
				encodedStr += "\\x22";
			}
			else if (str.charAt(i) == '#') {
				encodedStr += "\\x23";
			}
			else {
				encodedStr += str.charAt(i);
			}
		}

		return encodedStr;
	}




 attachCopyUrl = "https\x3A\x2F\x2Fwww\x2Dplmprd.cisco.com\x2FAgile"

</script>

<div id="selectfile_prompt_mask" class="prompt_mask" style="z-index: 9021; display: none;"></div>
<div id="selectfile_prompt_shadow" class="prompt_shadow add_rule" style="z-index: 9022; display: none;">
    <div class="prompt">
        <fieldset>
			<h4>Select File</h4>
            <span id="fileVersionTitle">&nbsp;</span>
            <dl class="side_by_side_mixed chk_group prompt_options">
                <dt>&nbsp;</dt>
                <dd>
                    File: 
                    <select id="versionfileNames"></select>
                </dd>
            </dl>
		</fieldset>
        <div class="prompt_footer">
                <a href="#" id="fvSave" onblur="buttonBlur(this.id)" onfocus="buttonFocus(this.id)" onclick="javascript: saveSelectedVersionFile();" class="button">
                    <span id="fvSavespan" class="nodrag"><em class="save_dialog nodrag">&nbsp;</em>OK</span>
                </a> 
                <a href="#" id="fvCancel" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)" onclick="javascript: cancelSelectFileVersionDialog();" class="button">
				    <span id="fvCancelspan" class="nodrag"><em class="cancel nodrag">&nbsp;</em>Cancel</span>
                </a>
        </div>
    </div>
</div>
<input id="sVersionFileRowId" name="sVersionFileRowId" type="hidden" value="">
<input id="sVersionInfo" name="sVersionInfo" type="hidden" value="">

				<input name="currentPage_10" value="" size="8" id="currentPage_10" type="HIDDEN" class="">
<input name="Selections_10" value="" size="8" id="Selections_10" type="HIDDEN" class="">
<input name="itemsPerPage_10" value="30" size="8" id="itemsPerPage_10" type="HIDDEN" class="">
<input name="selectedItems_10" value="" size="8" id="selectedItems_10" type="HIDDEN" class="">
<input name="TableRowMap_10" value="" size="8" id="TableRowMap_10" type="HIDDEN" class="">
<input name="TableDirtyRows_10" value="" size="8" id="TableDirtyRows_10" type="HIDDEN" class="">
<input name="GLOBAL_SELECT_10" value="" size="8" id="GLOBAL_SELECT_10" type="HIDDEN" class="">
<input name="SELECTED_RANGE_10" value="" size="8" id="SELECTED_RANGE_10" type="HIDDEN" class="">
<input name="AUTOCOMPLETE_VALUEID_10" value="" size="8" id="AUTOCOMPLETE_VALUEID_10" type="HIDDEN" class="">











		
	<div id="view_controls_10" class="view_controls"><div>

	<div class="column_one no_width" id="view_controls_tabletitle_10">
		<h4 style="display: block; float: none;">

		

			Attachments

		

		</h4>

		
	</div>

	<div class="column_three">
	<p>

		 
		

		

		 		
        
         
		
		
		<label for="TABLE_VIEWS_LIST_10">Views:</label>

		<select name="TABLE_VIEWS_LIST_10" onblur="removeElementFocus(this);" size="1" onchange="javascript:selectTableView(this, 'ATTACHMENTS_FILELIST', 'TABLE_VIEWS_LIST_10','10')" id="TABLE_VIEWS_LIST_10" class="table_views" onfocus="setElementFocus(this);"><option value="657" selected="" title="Base View * ">Base View * </option></select>


			

			<script>
</script>
<script>actionsMenu['arMenu40'] = new Array( new Array(
 getMenuItemObj("Personalize", null, "javascript:manageViewAction('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Save As", null, "javascript:saveAsViewAction('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Delete", null, "javascript:deleteViewAction('ATTACHMENTS_FILELIST','10')", null, null, null, true, null, null, null, null, null,null),
 getMenuItemObj("Set as Standard FA Case Default", null, "javascript:setAsDefaultViewAction('ATTACHMENTS_FILELIST','10','true','Set as Standard FA Case Default')", null, null, null, false, null, null, null, null, null,null),
 getMenuItemObj("Set as Problem Reports Default", null, "javascript:setAsDefaultViewAction('ATTACHMENTS_FILELIST','10','false','Set as Problem Reports Default')", null, null, null, false, null, null, null, null, null,null)) );</script>
<script>menuIds[menuIds.length] =  '40'; </script>
<a id="Personalize_10" href="javascript:manageViewAction('ATTACHMENTS_FILELIST');" class="button combo " onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="Personalize_10span" onmouseover="YAHOO.util.Dom.addClass(this, 'buttonComboSpanHover'); YAHOO.util.Dom.addClass(document.getElementById('Personalize_10em_40'), 'buttonComboSpanHoverMenu');" onmouseout="YAHOO.util.Dom.removeClass(this, 'buttonComboSpanHover'); YAHOO.util.Dom.removeClass(document.getElementById('Personalize_10em_40'), 'buttonComboSpanHoverMenu');">Personalize<em id="Personalize_10em_40" class="menu" onclick="javascript:showActionsMenu(document.getElementById('Personalize_10'), '40', event,'',''); javascript:stopEventNavigation(event);" ondblclick="javascript:showActionsMenu(document.getElementById('Personalize_10'), '40', event,'',''); javascript:stopEventNavigation(event);" onmouseover="YAHOO.util.Dom.addClass(this, 'buttonComboSpanMenuHover');" onmouseout="YAHOO.util.Dom.removeClass(this, 'buttonComboSpanMenuHover');">&nbsp;</em>&nbsp;</span></a>
		
		
		<script>
		viewMenuIds['ATTACHMENTS_FILELIST'] = '40';  
		
		
					
					var viewModifyArray = viewsProperties['10'];
					
					if(viewModifyArray == null) {
						viewsProperties['10'] = new Array();
						viewModifyArray = viewsProperties['10'];
					}

					viewModifyArray['657'] = 'false';
					viewModifyArray['657_classLevelInfo'] = 'false';
			
			
		</script>
	
	</p>
	</div>
	</div>		
	</div>


















<!--************************************
	TABLE ACTIONS
*************************************-->







		<div id="table_actions_10" class="table_actions">
			<div class="column_one no_width">
			<p>
					
							<script>
actionsMenu['arMenu42'] = new Array( new Array(
 getMenuItemObj("Files", null, "javascript:addFilePopUp()", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("URLs", null, "javascript:addURLPopUp()", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("By Search", null, "javascript:AGILE.grid.ShowAttachmentsPalette('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null)) );
var arMenu42_obj; menuIds[menuIds.length] = '42'; 




actionsMenu['arMenu46'] = new Array( new Array(
 getMenuItemObj("View", null, "javascript:viewAction('viewMultipleFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null)), new Array(
 getMenuItemObj("Compare", null, "javascript:viewAction('compareFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Compare by Search", null, "javascript:viewAction('advanceCompareFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Overlay", null, "javascript:viewAction('overlayFiles', 'ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null)) );
var arMenu46_obj; menuIds[menuIds.length] = '46'; 




actionsMenu['arMenu50'] = new Array( new Array(
 getMenuItemObj("Get Shortcut", null, "javascript:copyRowToClipBoard('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("View Versions", null, "javascript:showVersionHistoryPalette('ATTACHMENTS_FILELIST');", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Print", null, "javascript:printBOAttachment('10');", null, null, null, false, null, null, null, null, null)), new Array(
 getMenuItemObj("Copy", "Ctrl + C", "javascript:AGILE.grid.copyRows('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Paste", "Ctrl + V", "javascript:AGILE.grid.pasteRows({gridID:'ATTACHMENTS_FILELIST'})", null, null, null, false, null, null, null, null, null)), new Array(
 getMenuItemObj("Fill-down", "Ctrl + Shift + D", "javascript:AGILE.grid.filldown('ATTACHMENTS_FILELIST', true)", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fill-down (selected cells)", "Ctrl + Shift + D", "javascript:AGILE.grid.filldown('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fill-up", "Ctrl + Shift + U", "javascript:AGILE.grid.fillup('ATTACHMENTS_FILELIST', true)", null, null, null, false, null, null, null, null, null),
 getMenuItemObj("Fill-up (selected cells)", "Ctrl + Shift + U", "javascript:AGILE.grid.fillup('ATTACHMENTS_FILELIST')", null, null, null, false, null, null, null, null, null)) );
var arMenu50_obj; menuIds[menuIds.length] = '50'; 

</script>

<a id="MSG_AddAttachment_10" href="javascript:noaction();" class="button combo" onclick="javascript:addFilePopUp()" ondblclick="javascript:addFilePopUp()" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_AddAttachment_10span" onmouseover="YAHOO.util.Dom.addClass(this, 'buttonComboSpanHover'); YAHOO.util.Dom.addClass(document.getElementById('MSG_AddAttachment_10_em'), 'buttonComboSpanHoverMenu');" onmouseout="YAHOO.util.Dom.removeClass(this, 'buttonComboSpanHover'); YAHOO.util.Dom.removeClass(document.getElementById('MSG_AddAttachment_10_em'), 'buttonComboSpanHoverMenu');" class=" ">Add&nbsp;<em class="menu " id="MSG_AddAttachment_10_em" onclick="javascript:showActionsMenu(document.getElementById('MSG_AddAttachment_10'), '42', event);" ondblclick="javascript:showActionsMenu(document.getElementById('MSG_AddAttachment_10'), '42', event);" onmouseover="YAHOO.util.Dom.addClass(this, 'buttonComboSpanMenuHover');" onmouseout="YAHOO.util.Dom.removeClass(this, 'buttonComboSpanMenuHover');">&nbsp;</em>&nbsp;</span></a>

<a id="MSG_Remove_10" title="Remove (Del)" href="javascript:noaction();" onclick="javascript:AGILE.util.deleteRows('ATTACHMENTS_FILELIST', 'deleteRows');" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_Remove_10span">Remove</span></a><span class="btn_divide"></span>
<a id="MSG_Get_10" title="Get" href="javascript:noaction();" onclick="javascript:getBOAttachment('ATTACHMENTS_FILELIST')" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_Get_10span">Get</span></a>
<a id="MSG_Open_10" title="Open" href="javascript:noaction();" onclick="javascript:openFileFromRow('ATTACHMENTS_FILELIST')" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_Open_10span">Open</span></a>
<a id="MSG_ViewFileMenu_10" href="javascript:noaction();" class="button " onclick="javascript:showActionsMenu(this, '46', event);" ondblclick="javascript:showActionsMenu(this, '46', event);" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_ViewFileMenu_10span">View&nbsp;<em class="dropdown">&nbsp;</em>&nbsp;</span></a>
<span class="btn_divide"></span>
<a id="MSG_CheckOut_10" title="CheckOut" href="javascript:noaction();" onclick="checkoutAttachment('ATTACHMENTS_FILELIST')" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_CheckOut_10span">CheckOut</span></a>
<a id="MSG_CancelCheckOut_10" title="Cancel CheckOut" href="javascript:noaction();" onclick="javascript:cancleCheckoutAttachment('ATTACHMENTS_FILELIST')" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_CancelCheckOut_10span">Cancel CheckOut</span></a>
<a id="MSG_CheckIn_10" title="CheckIn" href="javascript:noaction();" onclick="javascript:checkinAttachment('ATTACHMENTS_FILELIST');" class="button" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_CheckIn_10span">CheckIn</span></a><span class="btn_divide"></span>
<a id="MSG_More_10" href="javascript:noaction();" class="button " onclick="javascript:showActionsMenu(this, '50', event);" ondblclick="javascript:showActionsMenu(this, '50', event);" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)"><span id="MSG_More_10span">More&nbsp;<em class="dropdown">&nbsp;</em>&nbsp;</span></a>

  
						

			</p>
			</div>
			
			<div class="column_three">
			<p>	
					
					<script>


</script>

<a id="MSG_Save_10" title="Save (Ctrl + Shift + S)" href="#" onclick="AGILE.grid.SaveGridTable('ATTACHMENTS_FILELIST')" class="button disabled" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)" tabindex="-1"><span id="MSG_Save_10span">Save</span></a>
<a id="MSG_Cancel_10" title="Cancel" href="#" onclick="AGILE.grid.ReloadGrid('ATTACHMENTS_FILELIST')" class="button disabled" onfocus="buttonFocus(this.id)" onblur="buttonBlur(this.id)" tabindex="-1"><span id="MSG_Cancel_10span">Cancel</span></a>
  
				
			</p>
			</div>

		</div>


<div id="gridwrapper_ATTACHMENTS_FILELIST"><div class="table_loading" id="loading_ATTACHMENTS_FILELIST" style="top: 469px; left: 1144px; display: none;"> <span class="table_progress_indicator" style=""> </span> <p style="padding: 4px; float: left;">Loading…</p></div>
<div id="treegrid_ATTACHMENTS_FILELIST" considerforresize="true" name="treegrid_ATTACHMENTS_FILELIST" class="treegrid" style="width: 100%; height: 673px; clear: both; overflow: hidden;"><table cellspacing="0" cellpadding="0" class="GMMainTable" id="ATTACHMENTS_FILELIST" onclick="return Grids[0].GridClick(event)" onmousemove="return Grids[0].GridMouseMove(event)" onmouseover="return Grids[0].GridMouseOver(event)" onmousedown="return Grids[0].GridMouseDown(event)" onmouseup="return Grids[0].GridMouseUp(event)" ondblclick="return Grids[0].GridDblClick(event)" oncontextmenu="return Grids[0].GridRightClick(event)" style=""><tbody><tr><td style="overflow:hidden;"><div class="GMHeadLeft" style="overflow:hidden;"><table cellspacing="0" cellpadding="0" class="GMSection"><tbody><tr><th style="width:0px;"></th><th style="height:0px;width:17px;"></th></tr><tr class="GMHeaderRow" style="height: 40px;"><td style="width: 0px; height: 40px;"></td><td class=" GPanelTopHeader GMCellHeaderPanel"><u class="GMPanelSelectOff GMImage">﻿</u></td></tr></tbody></table></div></td><td style="overflow:hidden;"><div class="GMHeadMid" style="overflow: hidden; width: 1531px;"><table cellspacing="0" cellpadding="0" class="GMSection"><tbody><tr><th style="width:0px;"></th><th style="height:0px;width:0px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:0px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:272px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:280px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:280px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height: 0px; width: 1px;"></th><th style="height: 0px; width: 0px;"></th></tr><tr class="GMHeaderRow" style="height: 40px;"><td style="width: 0px; height: 40px;"></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><img id="i_2000009282" class="gridIconSize" src="/Agile/static/cace266880ed63fe5ba8376622067120/images/CheckedOut.gif" title="Has&nbsp;been&nbsp;Checkedout"></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><img id="i_2000009283" class="gridIconSize" src="/Agile/static/d5f20dd85d2d37b84ca5a52473e5e796/images/ico_status_redlined.png" title="Has&nbsp;been&nbsp;Redlined"></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_1046" title="Filename">Filename</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_1045" title="File Description">File Description</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3623" title="File Size">File Size</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3624" title="File Type">File Type</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_6038" title="Folder Number">Folder Number</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_6039" title="Folder Description">Folder Description</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3622" title="Folder Version">Folder Version</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_4681" title="Attachment Type">Attachment Type</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3687" title="SW Product ID">SW Product ID</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3688" title="SW Component ID">SW Component ID</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3689" title="Bug Status">Bug Status</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3651" title="SORT Rule Exists">SORT Rule Exists</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3690" title="SORT Rule ID">SORT Rule ID</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3679" title="Associated FA Cases">Associated FA Cases</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3652" title="Eligible For SORT Rule">Eligible For SORT Rule</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_1143" title="Checkout Date">Checkout Date</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3621" title="Modified Date">Modified Date</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_3645" title="Last View Date">Last View Date</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_2000009484" title="Label">Label</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_1142" title="Checkout User">Checkout User</span></div></td><td style="background-color:rgb(239,239,239)" class=" GMRow GMHeaderText GMCellHeader" colspan="2"><div class="AutoWrapHeader"><span id="i_2000008716" title="Checkin User">Checkin User</span></div></td><td class=" GMRow GMHeaderText GMCellHeaderEmpty" colspan="2"> </td></tr></tbody></table></div></td><td rowspan="3" valign="top" style="display: none;"><div class="GMVScroll" style="width: 18px; height: 382px;"><div style="width: 18px; overflow: auto; height: 382px;" onscroll="Grids[0].Scrolled();" onmousemove="Grids[0].ARow=null;Grids[0].ASec=-1;"><div style="width: 1px; overflow: hidden; height: 424px;">&nbsp;</div></div></div></td><td rowspan="5" valign="top" style="display:none;"><div class="GMPagerMain" style="width:100px;height:20px;overflow:hidden;white-space:nowrap;" onmousemove="Grids[0].ARow=null;Grids[0].ASec=-6;"><div class="GMPagerHeader"><div class="GMPagerCaption">Pager</div></div><div class="GMPagerBody" style="overflow:auto;"><div><div></div><div class="GMPagerCursor" style="height:20px;overflow:hidden;">&nbsp;</div></div></div></div></td></tr><tr><td style="overflow:hidden;"><div class="GMBodyLeft" style="overflow: hidden; height: 379px;"><div class="GMPageOne"><table cellspacing="0" cellpadding="0" class="GMSection"><tbody><tr><th style="width:0px;"></th><th style="height:0px;width:17px;"></th></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(208,208,208)" class=" GMPx1xx GMCellPanel GMEmpty">&nbsp;</td></tr></tbody></table></div><div style="height:0px;overflow:hidden;"></div></div></td><td style="overflow:hidden;"><div class="GMBodyMid" style="overflow: hidden; width: 1531px; height: 379px;"><div class="GMPageOne"><table cellspacing="0" cellpadding="0" class="GMSection"><tbody><tr><th style="width:0px;"></th><th style="height:0px;width:0px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:0px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:272px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:280px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:280px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height: 0px; width: 1px;"></th><th style="height: 0px; width: 0px;"></th></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:openURLs('https\x3A\x2F\x2Fibpm.cisco.com\x2Frma\x2Fhome\x2F\x3FOrderNumber\x3D801773207');" class="image_link">https://ibpm.cisco.com/rma/home/?OrderNumber=801773207</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">801773207 &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">url &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '232337607', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '232337607', '0', '6038', 'R0', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1945011</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">08/26/2021 06:57:07 AM PDT</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">08/26/2021 06:57:06 AM PDT</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '6015933', '0');" class="image_link" infourl="showObjectInfo('11605', '6015933', '0', '2000008716', 'R0', 'false', 'ATTACHMENTS_FILELIST');">userqms2, userqms2 (userqms2)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:openURLs('https\x3A\x2F\x2Fmycase.cloudapps.cisco.com\x2F692011554');" class="image_link">https://mycase.cloudapps.cisco.com/692011554</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">692011554 &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">url &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '232337613', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '232337613', '0', '6038', 'R1', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1945012</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">08/26/2021 06:57:07 AM PDT</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">08/26/2021 06:57:07 AM PDT</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '6015933', '0');" class="image_link" infourl="showObjectInfo('11605', '6015933', '0', '2000008716', 'R1', 'false', 'ATTACHMENTS_FILELIST');">userqms2, userqms2 (userqms2)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233443429','1','233443069',false,'','233443433');" class="image_link">FIW220204S7_3.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,065,568</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233443429', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233443429', '0', '6038', 'R2', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1978803</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/14/2021 09:43:27 PM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/14/2021 09:43:27 PM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '231807708', '0');" class="image_link" infourl="showObjectInfo('11605', '231807708', '0', '2000008716', 'R2', 'false', 'ATTACHMENTS_FILELIST');">Tatip, Pharinya (ptatip)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233443434','1','233443070',false,'','233443438');" class="image_link">FIW220204S7_1.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,032,759</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233443434', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233443434', '0', '6038', 'R3', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1978804</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/14/2021 09:43:28 PM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/14/2021 09:43:28 PM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '231807708', '0');" class="image_link" infourl="showObjectInfo('11605', '231807708', '0', '2000008716', 'R3', 'false', 'ATTACHMENTS_FILELIST');">Tatip, Pharinya (ptatip)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233443439','1','233443071',false,'','233443443');" class="image_link">FIW220204S7_2.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,063,432</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233443439', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233443439', '0', '6038', 'R4', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1978805</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/14/2021 09:43:30 PM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/14/2021 09:43:29 PM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '231807708', '0');" class="image_link" infourl="showObjectInfo('11605', '231807708', '0', '2000008716', 'R4', 'false', 'ATTACHMENTS_FILELIST');">Tatip, Pharinya (ptatip)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580129','1','233578995',false,'','233580133');" class="image_link">FIW220204S7_11.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,032,759</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580129', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580129', '0', '6038', 'R5', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983240</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:03:49 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:03:49 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R5', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580134','1','233578996',false,'','233580138');" class="image_link">FIW220204S7_22.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,063,432</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580134', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580134', '0', '6038', 'R6', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983241</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:03:50 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:03:50 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R6', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580139','1','233578997',false,'','233580143');" class="image_link">FIW220204S7_33.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,065,568</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580139', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580139', '0', '6038', 'R7', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983242</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:03:51 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:03:51 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R7', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580144','1','233578999',false,'','233580189');" class="image_link">FIW220204S7_11.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,032,759</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580144', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580144', '0', '6038', 'R8', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983243</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:06:11 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:06:11 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R8', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580190','1','233578998',false,'','233580194');" class="image_link">FIW220204S7_22.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,063,432</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580190', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580190', '0', '6038', 'R9', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983244</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:06:12 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:06:12 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R9', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580195','1','233579000',false,'','233580199');" class="image_link">FIW220204S7_33.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,065,568</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580195', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580195', '0', '6038', 'R10', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983245</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:06:18 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:06:18 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R10', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580200','1','233579002',false,'','233580204');" class="image_link">FIW220204S7_11.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,032,759</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580200', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580200', '0', '6038', 'R11', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983246</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:09:19 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:09:19 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R11', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580275','1','233578989',false,'','233580279');" class="image_link">FIW220204S7_11.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,032,759</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580275', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580275', '0', '6038', 'R12', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983234</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 02:57:31 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 02:57:30 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R12', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580280','1','233578990',false,'','233580284');" class="image_link">FIW220204S7_22.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,063,432</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580280', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580280', '0', '6038', 'R13', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983235</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 02:57:32 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 02:57:31 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R13', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580285','1','233578991',false,'','233580310');" class="image_link">FIW220204S7_33.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,065,568</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580285', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580285', '0', '6038', 'R14', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983236</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 02:57:33 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 02:57:32 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R14', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580311','1','233578992',false,'','233580315');" class="image_link">FIW220204S7_11.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,032,759</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580311', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580311', '0', '6038', 'R15', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983237</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:01:35 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:01:34 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R15', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580316','1','233578993',false,'','233580320');" class="image_link">FIW220204S7_22.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,063,432</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580316', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580316', '0', '6038', 'R16', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983238</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:01:36 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:01:36 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R16', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr><tr class="GMDataRow" style="height:21px;"><td style="width:0px;height:21px"></td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMImg GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/4483630b01302dd6f2447927505499b5/images/ico_obj_file.png" title="File">&nbsp;<a tabindex="-1" href="javascript:noaction();" onclick="javascript:viewFile('6159','233580321','1','233578994',false,'','233580325');" class="image_link">FIW220204S7_33.JPG</a></td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">3,065,568</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">JPG &nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayDesignObject('AttachmentHandler', '6159', '233580321', '0', 'RightPane', '0', '', '1');" class="image_link" infourl="showObjectInfo('6159', '233580321', '0', '6038', 'R17', 'false', 'ATTACHMENTS_FILELIST', '1');">FOLDER1983239</a>&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell" colspan="2">1</td><td style="background-color:rgb(255,255,255)" class=" GMColorReadOnly GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:01:37 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2">11/26/2021 03:01:37 AM PST</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><img class="gridIconSize" src="/Agile/static/7edfadf3763ac1170dfb6eb026ed98d0/images/ico_status_no_read_priv.png" title="No Privilege">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell GMEmpty" colspan="2">&nbsp;</td><td style="background-color:rgb(255,255,255)" class=" GMColorNoFocus GMRow GMText GMCell" colspan="2"><a tabindex="-1" href="javascript:noaction();" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" onclick="javascript:displayObject('UserObjectHandler', '11605', '232326199', '0');" class="image_link" infourl="showObjectInfo('11605', '232326199', '0', '2000008716', 'R17', 'false', 'ATTACHMENTS_FILELIST');">Longsida, Wisit (wlongsid)</a>&nbsp;</td><td class=" GMRow GMHtml GMCellEmpty GMEmpty" colspan="2">&nbsp;</td></tr></tbody></table></div><div style="height:0px;overflow:hidden;"></div></div></td></tr><tr><td colspan="2" style=""><div class="GMSpaceRow" style="width: 1548px; overflow: hidden; height: 231px;"><table cellspacing="0" cellpadding="0"><tbody><tr style="height:21px;"><td></td></tr></tbody></table></div></td></tr><tr style="display:none;"><td style="overflow:hidden;"><div class="GMFootLeft GMNone" style="overflow:hidden;"><table cellspacing="0" cellpadding="0" class="GMSection"><tbody><tr><th style="width:0px;"></th><th style="height:0px;width:17px;"></th></tr></tbody></table></div></td><td style="overflow:hidden;"><div class="GMFootMid GMNone" style="overflow: hidden; width: 1531px;"><table cellspacing="0" cellpadding="0" class="GMSection"><tbody><tr><th style="width:0px;"></th><th style="height:0px;width:0px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:0px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:272px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:280px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:280px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:55px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height:0px;width:80px;"></th><th style="height:0px;width:20px;"></th><th style="height: 0px; width: 1px;"></th><th style="height: 0px; width: 0px;"></th></tr></tbody></table></div></td></tr><tr style=""><td colspan="2"><div class="GMHScroll" style="height: 18px; overflow: hidden; width: 1550px;"><div style="height: 18px; overflow: auto; width: 1550px;" onscroll="Grids[0].Scrolled();" onmousemove="Grids[0].ARow=null;Grids[0].ASec=-3;"><div style="height: 1px; overflow: hidden; width: 2665px;">&nbsp;</div></div></div></td><td onmousemove="Grids[0].ARow=null;Grids[0].ASec=-5;" style="display: none;"><div class="GMXScroll" style="height:18px;width:18px;overflow:hidden;">&nbsp;</div></td></tr><tr style="display:none;"><td colspan="3"><div class="GMToolbarRow" style="width: 1547px;"><table cellspacing="0" cellpadding="0"><tbody><tr style="height:21px;"><td onmousemove="Grids[0].TmpSpaceCol=&quot;Save&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMHidden"></td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Reload&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolReload GMEmpty">&nbsp;</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Repaint&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolRepaint GMEmpty">&nbsp;</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Print&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolPrint GMEmpty">&nbsp;</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Export&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMHidden"></td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Add&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolAdd GMEmpty">&nbsp;</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;AddChild&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMHidden"></td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Sort&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolSort1 GMEmpty">&nbsp;</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Calc&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolCalc GMEmpty">&nbsp;</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;ExpandAll&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMHidden"></td><td onmousemove="Grids[0].TmpSpaceCol=&quot;CollapseAll&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMHidden"></td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Columns&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolColumns GMEmpty">&nbsp;</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Cfg&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolCfg GMEmpty">&nbsp;</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Help&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolHelp GMEmpty">&nbsp;</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Debug&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMHidden"></td><td onmousemove="Grids[0].TmpSpaceCol=&quot;StyleTitle&quot;;" class=" GMRow GMCellSpace GMHtml"><span style="color:#999;">Style:</span></td><td onmousemove="Grids[0].TmpSpaceCol=&quot;StyleStandard&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolIcon">Standard</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;StyleLight&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolIcon">Light</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;StyleOffice&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolIcon">Office</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;StyleModern&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolIcon1">Modern</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;StyleBorders&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolIcon">Borders</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;StyleRobust&quot;;" style="background-color:rgb(255,255,255)" class=" GMRow GMCellSpace GMToolIcon">Robust</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Empty&quot;;" class=" GMRow GMCellSpace GMHtml"><div style="cursor: default; padding-top: 2px; padding-left: 3px; padding-right: 3px; white-space: nowrap; font: 9px arial; color: rgb(119, 119, 119); width: 3094px; overflow: hidden;"><span style="cursor:pointer;" title="http://www.treegrid.com/" onclick="window.open(&quot;http://www.treegrid.com/&quot;);">EJS TreeGrid v6.0</span></div></td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Formula&quot;;" class=" GMRow GMCellSpace GMText">&nbsp;</td><td onmousemove="Grids[0].TmpSpaceCol=&quot;Resize&quot;;" class=" GMRow GMCellSpace GMHidden"></td></tr></tbody></table></div></td></tr></tbody></table></div>
<div id="GridFooter" class="GridFooter">
<table id="table_footer" class="table_footer">
<tbody><tr>
<td class="status">
<strong id="selectCount_ATTACHMENTS_FILELIST">0</strong> of <strong id="totalCount_ATTACHMENTS_FILELIST">18</strong>
rows selected
<span style="color: rgb(255, 0, 0); padding-left: 5px; " id="missingRowsSpan_ATTACHMENTS_FILELIST"></span>
<span style="color: rgb(255, 0, 0); padding-left: 5px; " id="hasMoreRowsSpan_ATTACHMENTS_FILELIST"></span>
<span style="color: rgb(255, 0, 0); padding-left: 5px; " id="isRecordLimitReachedSpan_ATTACHMENTS_FILELIST">
</span>
</td>
<td style="text-align:right;padding-right:2px;">
<span id="missingRows_ATTACHMENTS_FILELIST" class="filter_text"></span>
<span id="hasMoreRows_ATTACHMENTS_FILELIST" class="filter_text"></span>
<span id="haveUnsupportSort_ATTACHMENTS_FILELIST" class="filter_text"></span>
<span id="isRecordLimitReached_ATTACHMENTS_FILELIST" class="filter_text">
</span>
</td><td id="filter_icon_ATTACHMENTS_FILELIST" class="" style="display: none;"></td>
</tr></tbody></table>
</div>
</div>
<script>
if(document.MainForm && document.MainForm.registeredTables)
document.MainForm.registeredTables.value = '10';
var tel = document.getElementById('tableIdName'); if (tel) tel.innerHTML = 'ATTACHMENTS_FILELIST';
try{ StartTreeGrid(); } catch(err) { }
setTimeout("AGILE.grid.showTableLoading('ATTACHMENTS_FILELIST')", 10)
</script>

				


</div> <!-- tabsandcontrols -->

<script>
	

	
</script>



<!-- end content -->
</div>

        
	<!-- region : render section="footer" / --> 





<input type="hidden" name="setSequentialWarning" value="false">
<input type="hidden" name="currentWarningCode" value="">
<input type="hidden" name="commonWarnCode" value="">
<input type="hidden" name="LOAD_TABLE_FAILED" value="false">

<script>

var res = eval("document.MainForm");
var doYesProceed;
var isPopup;


	isPopup = false;






function yesProceed(){
	setWarningCodes();

	if(eval(res.stepCommand))
		eval(res.stepCommand).value = "null";

	if(eval(res.deleteRowsTableId))
		eval(res.deleteRowsTableId).value = "";

	disableButtons();

	if (doYesProceed != null) {
		doYesProceed();
	}

	if (disableButton != null) {
		disableButton('Save');
		disableButton('Validate');
	}
	if(isPopup == true)
	{
		submitForm('MainForm',"PSRHandler","refreshObject", "_self");
	}else{
		submitForm2({module: 'PSRHandler', opcode: 'refreshObject'});	
	}

}

function disableButtons() {

} // fn

function noProceed()
{
	setRepWarningCodes();

	if(eval(res.stepCommand))
		eval(res.stepCommand).value = "null";
	if(isPopup == true) {
		submitForm('MainForm',"PSRHandler","refreshObject", "_self");
	}else{
		submitForm2({module: 'PSRHandler', opcode: 'refreshObject'});
	}
}

function noNext()
{
	

	clearWarningCodes("null");

	
}

function setWarningCodes()
{
	res.pgWarnID.value = "null";
	res.pgWarnCode.value = "null";
	res.commonWarnCode.value = "null";
}

function setRepWarningCodes()
{
	res.pgWarnID.value = "null";
	res.pgWarnCode.value = "null";
}

function clearWarningCodes(wCode)
{
	if (wCode != null && wCode.length > 0) 
	{
		var allCodeIds = "null";
		var allCodes = "null";      
		var arrCodeIds = allCodeIds.split(";")
		var arrCodes = allCodes.split(";")
		var rCodeIds = "";
		var rCodes = "";

		for (var i=0; i<arrCodes.length; i++ ){
			if(wCode == arrCodes[i]) {
				continue;
			}
			rCodeIds = arrCodeIds[i] +";"+rCodeIds;
			rCodes = arrCodes[i] +";"+rCodes;
		}

		res.pgWarnID.value = rCodeIds;
		res.pgWarnCode.value = rCodes;

	} else {
		res.pgWarnID.value = "";
		res.pgWarnCode.value = "";
		res.commonWarnCode.value = "";
	}

}

function cancelWarning()
{
	clearWarningCodes();
	if(isPopup == true) {
		submitForm('MainForm', '', '', '_self');
	}else{
		submitForm2();
	}
}
</script>


<input name="registeredTables" value="10" size="8" id="registeredTables" type="HIDDEN" class="">
<input name="registeredTableNames" value="" size="8" id="registeredTableNames" type="HIDDEN" class="">
<input name="deleteRowsTableId" value="" size="8" id="deleteRowsTableId" type="HIDDEN" class="">
</form><form name="MainForm_2__" method="POST" action="PCMServlet" enctype="application/x-www-form-urlencoded" onsubmit="return false;" target="RightPane">
<!-- Begin Form Standard Attributes -->
<input name="module" value="PSRHandler" size="8" id="module" type="HIDDEN" class="">
<input name="opcode" value="displayObject" size="8" id="opcode" type="HIDDEN" class="">
<input name="defaultAction" value="" size="8" id="defaultAction" type="HIDDEN" class="">
<input name="addlParam" value="" size="8" id="addlParam" type="HIDDEN" class="">
<input name="actionContextParam" value="" size="8" id="actionContextParam" type="HIDDEN" class="">
<input name="popup" value="" size="8" id="popup" type="HIDDEN" class="">
<input name="objver" value="172" size="8" id="objver" type="HIDDEN" class="">
<input name="objid" value="232336885" size="8" id="objid" type="HIDDEN" class="">
<input name="objectname" value="FA-0505813" size="8" id="objectname" type="HIDDEN" class="">
<input name="classid" value="4878" size="8" id="classid" type="HIDDEN" class="">
<input name="subclsid" value="4883" size="8" id="subclsid" type="HIDDEN" class="">
<input name="tabid" value="7" size="8" id="tabid" type="HIDDEN" class="">
<input name="viewid" value="0" size="8" id="viewid" type="HIDDEN" class="">
<input name="displayMode" value="0" size="8" id="displayMode" type="HIDDEN" class="">
<input name="refresh" value="false" size="8" id="refresh" type="HIDDEN" class="">
<input name="pgWarnID" value="" size="8" id="pgWarnID" type="HIDDEN" class="">
<input name="pgWarnCode" value="" size="8" id="pgWarnCode" type="HIDDEN" class="">
<input name="warningString" value="" size="8" id="warningString" type="HIDDEN" class="">
<input name="fullrev" value="" size="8" id="fullrev" type="HIDDEN" class="">
<input name="process_actionId" value="" size="8" id="process_actionId" type="HIDDEN" class="">
<input name="pageName" value="" size="8" id="pageName" type="HIDDEN" class="">
<input name="formChanged" value="0" size="8" id="formChanged" type="HIDDEN" class="">
<input name="currentToken" value="" size="8" id="currentToken" type="HIDDEN" class="">
<input name="isTokenRequired" value="false" size="8" id="isTokenRequired" type="HIDDEN" class="">
<input name="ContextName" value="FA-0505813" size="8" id="ContextName" type="HIDDEN" class="">
<input name="ContextType" value="Standard FA Case" size="8" id="ContextType" type="HIDDEN" class="">
<input name="DefaultBookmarkName" value="FA-0505813 : IQS2.0 PID Profile for QSFP-100G-AOC7M= - Criteria = Customer Name - T-MOBILE: Return Reason Code - OHW2: Theater - NAM: RMA Number - 801773207: Service Request No - 692011554: Service Contract No - 200941956:," size="8" id="DefaultBookmarkName" type="HIDDEN" class="">
<input name="helpID" value="4878_7" size="8" id="helpID" type="HIDDEN" class="">
<input name="tableIds" value="10" size="8" id="tableIds" type="HIDDEN" class="">
<input name="showTips" value="" size="8" id="showTips" type="HIDDEN" class="">
<input name="refreshFromDB" value="" size="8" id="refreshFromDB" type="HIDDEN" class="">
<input name="recycle_qry_Id" value="" size="8" id="recycle_qry_Id" type="HIDDEN" class="">
<input name="isPageDirty" value="" size="8" id="isPageDirty" type="HIDDEN" class="">
<input name="currentPaginationTableId" value="-1" size="8" id="currentPaginationTableId" type="HIDDEN" class="">
<input name="subTabId" value="" size="8" id="subTabId" type="HIDDEN" class="">
<input name="PREVIEW_KEY" value="" size="8" id="PREVIEW_KEY" type="HIDDEN" class="">
<input name="PREVIEW_PARENT_KEY" value="" size="8" id="PREVIEW_PARENT_KEY" type="HIDDEN" class="">
<input name="PREVIEW_REFRESH" value="" size="8" id="PREVIEW_REFRESH" type="HIDDEN" class="">
<input name="contentTabView" value="" size="8" id="contentTabView" type="HIDDEN" class="">
<input name="contentTabIncludeAll" value="" size="8" id="contentTabIncludeAll" type="HIDDEN" class="">
<input name="whereUsedTabDisplayAllVersions" value="" size="8" id="whereUsedTabDisplayAllVersions" type="HIDDEN" class="">
<input name="cgToItemRevObjId" value="" size="8" id="cgToItemRevObjId" type="HIDDEN" class="">
<input name="cgToItemRevClassId" value="" size="8" id="cgToItemRevClassId" type="HIDDEN" class="">
<input name="cgToItemRevSiteId" value="" size="8" id="cgToItemRevSiteId" type="HIDDEN" class="">
<input name="preItemRevObjId" value="" size="8" id="preItemRevObjId" type="HIDDEN" class="">
<input name="preItemRevClassId" value="" size="8" id="preItemRevClassId" type="HIDDEN" class="">
<input name="preItemRevSiteId" value="" size="8" id="preItemRevSiteId" type="HIDDEN" class="">
<input name="searchFilterType" value="" size="8" id="searchFilterType" type="HIDDEN" class="">
<input name="checkoutLocation" value="" size="8" id="checkoutLocation" type="HIDDEN" class="">
<input name="boFileId" value="" size="8" id="boFileId" type="HIDDEN" class="">
<input name="fileRowIds" value="" size="8" id="fileRowIds" type="HIDDEN" class="">
<input name="fileIds" value="" size="8" id="fileIds" type="HIDDEN" class="">
<input name="fileNames" value="" size="8" id="fileNames" type="HIDDEN" class="">
<input name="fileSizes" value="" size="8" id="fileSizes" type="HIDDEN" class="">
<input name="asLatest" value="" size="8" id="asLatest" type="HIDDEN" class="">
<input name="asAllFiles" value="" size="8" id="asAllFiles" type="HIDDEN" class="">
<input name="selectedRevisionName" value="" size="8" id="selectedRevisionName" type="HIDDEN" class="">
<input name="selectedKeys" value="" size="8" id="selectedKeys" type="HIDDEN" class="">
<input name="fulltabledisplay" value="" size="8" id="fulltabledisplay" type="HIDDEN" class="">
<input name="fullgridtableid" value="" size="8" id="fullgridtableid" type="HIDDEN" class="">
<input name="refreshObjectTables" value="" size="8" id="refreshObjectTables" type="HIDDEN" class="">
<input name="iv" value="" size="8" id="iv" type="HIDDEN" class="">
<!-- End Form Standard Attributes -->
<input name="AGILE_CSRF_TOKEN_NAME" value="irSddVHz9tWrM43JllSRIxIzvJEBd6kh" size="8" id="AGILE_CSRF_TOKEN_NAME" type="HIDDEN" class="">
<!-- Begin ModuleSpecific Form Attributes -->
<input name="addAIClassId" value="" size="8" id="addAIClassId" type="HIDDEN" class="">
<input name="addAIObjId" value="" size="8" id="addAIObjId" type="HIDDEN" class="">
<input name="aiObjectName" value="" size="8" id="aiObjectName" type="HIDDEN" class="">
<input name="changeCreated" value="" size="8" id="changeCreated" type="HIDDEN" class="">
<input name="fromAISiteId" value="" size="8" id="fromAISiteId" type="HIDDEN" class="">
<input name="fromAIRevId" value="" size="8" id="fromAIRevId" type="HIDDEN" class="">
<!-- End ModuleSpecific Form Attributes -->
<div id="frmDiv" style="width:0;height:0;"></div></form><script>isPageLoading=false;</script>

<!-- end of Mainform form -->

<div id="content" style="width:0;height:0">
<form name="ConfiguredViewForm" method="POST" action="PLMServlet"> 
	<input type="hidden" name="module" id="module" value="">
	<input type="hidden" name="opcode" id="opcode" value="">
	<input type="hidden" name="addlParam" id="addlParam" value="">

	<input type="hidden" name="classid" id="classid" value="true">
	<input type="hidden" name="objid" id="objid" value="">
	<input type="hidden" name="popup" id="popup" value="">
	<input type="hidden" name="refresh" id="refresh" value="true">
	<input type="hidden" name="displayMode" id="displayMode" value="">
	<input type="hidden" name="replyRowKey" id="replyRowKey" value="">
	<input type="hidden" name="discussionRowKey" id="discussionRowKey" value="">
	<input type="hidden" name="versionControlItemObjId" id="versionControlItemObjId" value="">
	<input type="hidden" name="versionControlItemClassId" id="versionControlItemClassId" value="">
	<input type="hidden" name="versionControlItemRowId" id="versionControlItemRowId" value="">
	<input type="hidden" name="attachmentNumber" id="attachmentNumber" value="">
</form>
</div>

<script>
if(is_ie5) {
	height = null;
	width = null;
}

/**
 * Destory any visiable palettes
 */
function destoryPalettes(id) {    
   var paletteDiv = document.getElementById(id);
   if (paletteDiv) {
      paletteDiv.style.display = "";
      destoryTablePalette();
   } 
   
   if(document.getElementById('gridTablePanel'))
	document.getElementById('gridTablePanel').style.display = 'none';
};

function checkWarnings()
{
	
}


function doRightPaneOnloadActions() 
{ 
    // destroy any visable palettes
    // curenty there is only 2 types of palettes: SelectControl & TablePalette
    // below are their respective ids.
    //@TODO When we have more floating divs we should have a way to remove all    
    destoryPalettes("floater_window2"); 
    destoryPalettes("floater_window");
    
	     
	  initializeScrollingTabs();	
		
	
	doOnloadMenuActions();	
    // MADDY: Commented out to improve performance
	// setPageViewContent();
	enablePageRefresh();
	//to allow client to overwrite warning check logic
	/*  */
	checkWarnings();
	
	/* ME-001 */
	var twoColumnsWrapperDivs = YAHOO.util.Dom.getElementsByClassName("two_columns_wrapper_div");
	for(i = 0; i < twoColumnsWrapperDivs.length; i++){
	  var twoColumnsWrapperDiv = twoColumnsWrapperDivs[i];
	  var children = twoColumnsWrapperDiv.childNodes;
	  if(2 == children.length){ /* two short fields in one line. */
	    var child1 = children[0];
		var child2 = children[1];
		if((child1.offsetTop != child2.offsetTop)&&(child1.offsetLeft != child2.offsetLeft)){
		  if(child2.style)
		    child2.style.clear = 'left';
		}
	  }
	}
	/* ME-001 */
	
	//18385955, move code to IncludeCoverPage.inc
	/* //932 me 011
	if(typeof(document.getElementById('fromaudit')) != "undefined" && document.getElementById('fromaudit') != null 
			&& eval('document.MainForm.fromaudit').value == 'true'){
		if(typeof(document.getElementById('attrid'))!="undefined" && document.getElementById('attrid') != null){
			var attrId = eval('document.MainForm.attrid').value;
			if(document.getElementById("col_" + attrId))
				document.getElementById("col_" + attrId).scrollIntoView();
		}
	} */
}



function getErrorImage(pos,size){ 	
	var imagePath="";
	switch(CoverpageThumbnail._thumbnailStatus[pos]){
	case '0':
	case '2':
	case '3':
		if(size==2)
		  imagePath="/Agile/static/5813514ddc6454daf3442f46adfc5034/images/thumbnail/medium/InProgress.gif";
		else if(size==0)
		  imagePath="/Agile/static/3f11e827f09f0cb3a62c135acfc69b64/images/thumbnail/big/InProgress.gif";
		else
          imagePath="/Agile/static/bf275bc7f81ca5042cc1c1384253e3e9/images/thumbnail/small/InProgressTable.gif";

		break;
	case '4':
		if(size==2)
		  imagePath="/Agile/static/68c007acd5615e415b36a06230943556/images/thumbnail/medium/Error.png";
		else if(size==0)
		  imagePath="/Agile/static/93768615e5a8fc7497e6ec3acc0c402e/images/thumbnail/big/Error.png";
		else
		  imagePath="/Agile/static/e397aae79ed105924af1c813dba5a707/images/thumbnail/small/Error.png";
		break;
	//Bug fix 13787389
	//For unsupported files, Thumbnail icon should display N/A image in the Where Used/BOM tab when default thumbnail is changed from thumbnail navigator
	case '7':
    	if(size==2)
    	  imagePath="/Agile/static/34be4254e340234407a89fab9b676776/images/thumbnail/medium/thumbnail_na_filetype.png";
        else if(size==0)
           imagePath="null";
        else
		   imagePath="/Agile/static/022c6efc178fe284211dae97724194ea/images/thumbnail/small/thumbnail_na_filetype.png";
		break;	 

	default:
		if(size==2)
		  imagePath="/Agile/static/5813514ddc6454daf3442f46adfc5034/images/thumbnail/medium/InProgress.gif";
		else if(size==0)
		  imagePath="/Agile/static/3f11e827f09f0cb3a62c135acfc69b64/images/thumbnail/big/InProgress.gif";
		else
		  imagePath="/Agile/static/bf275bc7f81ca5042cc1c1384253e3e9/images/thumbnail/small/InProgressTable.gif";
	}

		return imagePath;

}

function doRightResizeActions() {
	     
	  initializeScrollingTabs();	
	
 
	hideMenus()
	setPageViewContent();
	setTableViewContent();
	//resizeLastColumn();
	setGridViewContent();
	
	//933HF174
	var fullDisplay = jQuery('#rightpanecontent form[name="MainForm"] #fulltabledisplay').val();
	var fullTableId = jQuery('#rightpanecontent form[name="MainForm"] #fullgridtableid').val();
	if (fullDisplay == 'true' && fullTableId =='ITEMTABLE_TITLEBLOCK_RED') {
		resetPageViewContent('pageViewContent2');		
	}
}








 
AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_LOAD, function() {
										   doRightPaneOnloadActions();
										   
   	                                 });
AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_UNLOAD, function() 
{
	if(AGILE.widget.CloseAllPalettes)
		AGILE.widget.CloseAllPalettes();
});

AGILE.EventManager.addEvent(RIGHTPANECONTENT, ON_WINDOW_RESIZE, function() {
								doRightResizeActions();
							  });

AGILE.EventManager.addEvent(RIGHTPANECONTENT, REFRESH_PAGE, function() {
										   refreshRightPane();
   	                                 });
RefererURL = 'https\x3A\x2F\x2Fwww\x2Dplmprd.cisco.com\x2FAgile\x2F';



//18385955, move code to IncludeCoverPage.inc


</script>


<div container="rightpanecontent" style="display:none;"></div>

</div>
	</div>
</div>

<script>
// Add event listener for replicating/zipping event from File Server
// The method of listenerForFileServerMessage() is defined in common.js.
setUserPreferIFSDomain("https\x3A\x2F\x2Fwww\x2Dplmprd.cisco.com");

YAHOO.util.Event.addListener(window, "message", listenerForFileServerMessage);

</script>

<script>
var processingImage = '/Agile/static/4aaf776fd520db82f02660e6f28f91a2/images/table_loading.gif';
var agileSplitter;

function showTreeViewInLeftPane(module,opcode) {
	var hasTreeActions = false;
	var classid = document.MainForm.classid.value;	
	if(classid == 18022 || classid == 18387) {
		hasTreeActions = true;
	}
	var version="";
	if( document.MainForm.version)
		version=document.MainForm.version.value;

	var params = "ajaxRequest=true&module="+ module +"&opcode="+ opcode + "&classid="+ classid +"&version="+ version +  "&objid="+ document.MainForm.objid.value;

	//show the tree
	showCtxNavTree(hasTreeActions, params);
}

function doResizeActions()
{	
}

var leftSpliter = new AGILE.widget.LeftSplitter();

function doWindowResizeActions()
{	
	var leftContainer = document.getElementById('leftpane');
	var rightContainer = document.getElementById('MainPane');
	var rightPaneWidth = windowSize()[0] - leftContainer.offsetWidth;
	YAHOO.util.Dom.setStyle(rightContainer, "width", rightPaneWidth-1 + "px");
	leftSpliter.initConstraints();
	fireResizeEvents();
}

function fireResizeEvents()
{	
    AGILE.EventManager.fireEvent(LEFTPANECONTENT, ON_WINDOW_RESIZE);    
    AGILE.EventManager.fireEvent(RIGHTPANECONTENT, ON_WINDOW_RESIZE);
    AGILE.EventManager.fireEvent(RIGHTPANECONTENT, VERT_SPLITTER_RESIZE); 
}

function doBodyOnloadActions() {
	var leftContainer = document.getElementById('leftpane');
	var rightContainer = document.getElementById('MainPane');
	var x =  leftContainer.offsetWidth;
	var rightPaneWidth = rightContainer.offsetWidth;
	//YAHOO.util.Dom.setStyle(leftContainer, "width", x + "px");	
	//YAHOO.util.Dom.setStyle(rightContainer, "width", rightPaneWidth-1 + "px");
	YAHOO.util.Event.addListener(document, "keydown", AGILE.util.onKeyDown);
	YAHOO.util.Event.addListener(document, "mousedown", AGILE.util.docMousedown);
	YAHOO.util.Event.addListener(document, "mouseup", AGILE.util.docMouseup);

	

	

}

// Instantiates the Session Manager
var SessionManager = new AGILE.SessionManager({PLMTimeout:25, 
	WebAppTimeout:25, 
	disablePrompt: false, 
	//20949645
	sso: true});


/**
 * Dereference this window from its parent list of child windows and also close all 
 * its child windows upon unload.
 */
function doUnloadActions() {
	if(AGILE.util.isValidWindowUnload()) {
		AGILE.WindowManager.closeChildWindows();
		if(!window['loggedOut']) {
			var uri = "ajaxRequest=true&module=LoginHandler&opcode=saveRecentlyVisited";
			sendSyncRequest(uri, null, false, null, {}, "PCMServlet");
		}
	}
}

var RefererURL = "";

function copyToClipBoard()
{	
	var module = '';
	var opcode = '';
	var classId ='';
	var objid ='';
	var tabid ='';

	if (document.MainForm.module)
		module = document.MainForm.module.value;

	if (document.MainForm.opcode)
		opcode = document.MainForm.opcode.value;

	if (document.MainForm.classid)
		classId = document.MainForm.classid.value;

	if (document.MainForm.objid)
		objid = document.MainForm.objid.value;

	if (document.MainForm.tabid)
		tabid = document.MainForm.tabid.value;

	var queryString = 'module=' + module + 
						'&opcode=' + opcode + 
						'&classid=' + classId + 
						'&objid=' + objid + 
						'&tabid=' + tabid+'&';	
	
	queryString = '?fromPCClient=true&module='+module+'&requestUrl='+ escape(queryString);

	//bug 10162823
    //var re = new RegExp(';jsessionid=[^;/?\s]*', 'g'); -- Bug 13491196
	var re = new RegExp(';jsessionid=[^;?#]*', 'g');
        
	var url = RefererURL.replace(re, '');
    
	if(navigator.appName != 'Netscape'){
		var copyMessage ="The URL has been copied to the clipboard. Use CTRL-V to paste. ";
		copyToClipboard(url+queryString);		
		
		AGILE.util.DMS.showInfoMessage(copyMessage)		
		
	}
	else{
        var formName = eval('document.MainForm');
        addlParam =  url+queryString;		
        openDialogWindow('MainForm', 'CMBaseHandler', "copyToClipBoard", "popUpWindow", "270", "500", 'true', 'false', addlParam);
	}
} //copyToClipBoard

window.onresize = doWindowResizeActions;
window.name='MainWindow';
displayContent({containerToUpdate: LEFTPANECONTENT, params:'module\x3DLeftPaneHandler\x26opcode\x3DdisplayObject', clearGrid:'false'});
displayContent({containerToUpdate: RIGHTPANECONTENT, params:'module\x3DInboxSearchHandler\x26opcode\x3DdisplayInboxView\x26framesReloaded\x3Dtrue'}, '', '');
//open calendar in popup window
//-39 is the dummy class id of calendar, refer to AdminType.CALENDAR_DUMMY_CLASS_ID

</script>


<iframe src="/Agile/static/5db071c49f12bae12982ee8c9eac075e/dummy.html" name="AttachmentFrame" id="AttachmentFrame" style="width:20px; height:0px; border: 0px" frameborder="false"></iframe>








<div class="datepicker_container"><iframe src="PLMServlet?module=ObjectViewHandler&amp;opcode=dateTimePicker&amp;popup=true"></iframe></div><div id="FileUploadContainer"><div id="fileupload" class=""><div id="lfuploadpalette_window" tabindex="-1" class="ux_palette infopop" style="display: block; left: 1231px; top: 224.5px;"><div id="lfuploadpalette_windowTitle" class="ux_palette_top removeOutLine" tabindex="-1"><div id="lfuploadpalette_window_handle" class="ux_palette_header removeOutLine" tabindex="-1"><a id="lfuploadpalette_window_toggle" class="ux_palette_expanded ux_palette_toggle removeOutLine" onclick="AGILE.widget.Palettes['lfuploadpalette_window'].togglePalette()" href="#"></a><h4 id="lfuploadpalette_title" class="ux_palette_title" ondblclick="AGILE.widget.Palettes['lfuploadpalette_window'].togglePalette()">File Upload Manager</h4><div class="ux_palette_windowbuttonpanel"><a id="lfuploadpalette_window_close" title="Esc" tabindex="-1" class="ux_palette_windowbutton ux_palette_close removeOutLine" href="javascript:AGILE.widget.Palettes['lfuploadpalette_window'].hidePalette()"><span>&nbsp;</span></a></div></div><div id="lfuploadpalette_window_head" tabindex="-1" class="ux_palette_top_action_bar removeOutLine nodrag"><div id="lfuploadpalette_window_anim" tabindex="-1" class="right_column removeOutLine nodrag"></div><div id="lfuploadpalette_window_header" tabindex="-1" class="left_column removeOutLine nodrag"><div class="fileupload-buttonbar"><div class="progress-buttons-span"><div class="fileupload-progress fade in"><div class="progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="92"><div class="bar" style="width: 92%;"></div></div><div class="progress-extended">3.52 Mbit/s | 00:00:02 | 92.99 % | 17.04 MB / 18.32 MB</div></div><a id="clearAllUM" href="#" onclick="AGILE.widget.Palettes['lfuploadpalette_window'].clearAllFiles();" onfocus="buttonFocus(this.id);" onblur="buttonBlur(this.id);" class="button"><span id="clearAllUMspan">Clear All</span></a></div><div class="upload-options"><input type="checkbox" id="autoHide" name="autoHide" onclick="AGILE.widget.Palettes['lfuploadpalette_window'].autoHideUM()"><label for="autoHide">Auto Hide</label></div></div><div id="UMErrorMessage"><p></p></div></div></div></div><div id="lfuploadpalette_window_body_Maincontent" tabindex="-1" class="ux_palette_main removeOutLine nodrag"><div id="lfuploadpalette_window_body_content" tabindex="-1" style="display: block; overflow-y: auto; height: 435px;" class="nodrag"><table role="presentation" class="table table-striped"><tbody class="files"><tr class="template-download fade in"><td class="uid" style="display:none;">703832_0</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','undefined');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_22.JPG</span></td><td class="size" style="text-align: right">3.06 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="error" id="error" title="" style="display:none;font-style:italic;"></td><td class="status" id="completed">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade in"><td class="uid" style="display:none;">703832_1</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','undefined');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_11.JPG</span></td><td class="size" style="text-align: right">3.03 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="error" id="error" title="" style="display:none;font-style:italic;"></td><td class="status" id="completed">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade in"><td class="uid" style="display:none;">703832_2</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','undefined');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_33.JPG</span></td><td class="size" style="text-align: right">3.07 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="error" id="error" title="" style="display:none;font-style:italic;"></td><td class="status" id="completed">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade in"><td class="uid" style="display:none;">703836_0</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','undefined');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_22.JPG</span></td><td class="size" style="text-align: right">3.06 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="error" id="error" title="" style="display:none;font-style:italic;"></td><td class="status" id="completed">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade in"><td class="uid" style="display:none;">703836_1</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','undefined');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_11.JPG</span></td><td class="size" style="text-align: right">3.03 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="error" id="error" title="" style="display:none;font-style:italic;"></td><td class="status" id="completed">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-upload fade in"><td class="fileUID" style="display:none;">703836_2</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','' );" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a> • FIW220204S7_33.JPG</td><td class="size" style="text-align: right">3.07 MB</td><td class="date">11/26/2021</td><td class="selectedRow" id="selectedRow" style="display:none;">undefined</td><td class="classid" id="classid" style="display:none;">4878</td><td class="objid" id="objid" style="display:none;">232336885</td><td class="modulename" id="modulename" style="display:none;">PSRHandler</td><td class="revclassid" id="revclassid" style="display:none;">-1</td><td class="revid" id="revid" style="display:none;">-1</td><td class="progress-cell"><div class="progress" aria-valuenow="58"><div class="bar" style="width: 58%;"></div></div></td><td class="error" id="error" style="display:none;"></td><td class="status" id="status">In Progress</td><td class="pause"><button class="btnPause" title="Pause" style="display: inline-block;"><i class="icon-pause"></i></button><button class="btnResume" title="Resume" style="display: none;"><i class="icon-resume"></i></button><button class="btnRemove" title="Cancel" style="display: none;"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076974</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_33.JPG</span></td><td class="size" style="text-align: right">3.07 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076972</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_22.JPG</span></td><td class="size" style="text-align: right">3.06 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076973</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_11.JPG</span></td><td class="size" style="text-align: right">3.03 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076971</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_33.JPG</span></td><td class="size" style="text-align: right">3.07 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076969</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_22.JPG</span></td><td class="size" style="text-align: right">3.06 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076970</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_11.JPG</span></td><td class="size" style="text-align: right">3.03 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076968</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_33.JPG</span></td><td class="size" style="text-align: right">3.07 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076966</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_22.JPG</span></td><td class="size" style="text-align: right">3.06 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076967</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_11.JPG</span></td><td class="size" style="text-align: right">3.03 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2077261</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_33.JPG</span></td><td class="size" style="text-align: right">3.07 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2077259</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_22.JPG</span></td><td class="size" style="text-align: right">3.06 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2077260</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_11.JPG</span></td><td class="size" style="text-align: right">3.03 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2077258</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','230433739','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','230433739','','1001','','false');">FA-0481375</a><span> • H11K115_TX.txt</span></td><td class="size" style="text-align: right">0.01 KB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2077257</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','230433739','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','230433739','','1001','','false');">FA-0481375</a><span> • H11K115_RX.txt</span></td><td class="size" style="text-align: right">0.01 KB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076965</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','230433739','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','230433739','','1001','','false');">FA-0481375</a><span> • H11K115_TX.txt</span></td><td class="size" style="text-align: right">0.01 KB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076964</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','230433739','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','230433739','','1001','','false');">FA-0481375</a><span> • H11K115_RX.txt</span></td><td class="size" style="text-align: right">0.01 KB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076963</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','230433739','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','230433739','','1001','','false');">FA-0481375</a><span> • H11K115_TX.txt</span></td><td class="size" style="text-align: right">0.01 KB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076962</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','230433739','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','230433739','','1001','','false');">FA-0481375</a><span> • H11K115_RX.txt</span></td><td class="size" style="text-align: right">0.01 KB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076960</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_11.JPG</span></td><td class="size" style="text-align: right">3.03 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076959</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_22.JPG</span></td><td class="size" style="text-align: right">3.06 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr><tr class="template-download fade"><td class="id" style="display:none;">2076961</td><td style="text-align: left" class="boInfo"><a href="javascript:displayObjFromUploadMgr('PSRHandler','4878','232336885','7','-1','-1','null');" onmouseover="showQuickViewLink(event, this)" onmouseout="cancelQuickViewTimer(this);" class="image_link" infourl="showObjectInfo('4878','232336885','','1001','','false');">FA-0505813</a><span> • FIW220204S7_33.JPG</span></td><td class="size" style="text-align: right">3.07 MB</td><td class="date">11/26/2021</td><td class="progress-cell"></td><td class="status">Completed</td><td class="delete"><button class="btn" title="Remove"><i class="icon-remove"></i></button></td></tr></tbody></table></div><div id="lfuploadpalette_window_savedSearch_content" tabindex="-1" style="display: none; heigth: 0px;" class="nodrag"></div></div><div id="lfuploadpalette_window_footer" tabindex="-1" class="ux_palette_bottom removeOutLine nodrag"><div id="lfuploadpalette_message" tabindex="-1" class="ux_palette_message_area removeOutLine nodrag"></div><div id="lfuploadpalette_actions" tabindex="-1" class="ux_palette_bottom_action_bar removeOutLine nodrag"><div id="lfuploadpalette_right_actions" style="width: 50%;" class="right_column removeOutLine nodrag" tabindex="-1"></div><div id="lfuploadpalette_left_actions" class="left_column removeOutLine nodrag" tabindex="-1"></div></div><div id="lfuploadpalette_resize_handle" tabindex="-1" class="ux_palette_handle removeOutLine">&nbsp;</div></div></div></div><div id="lfaddpalette_window" tabindex="-1" class="ux_palette removeOutLine" style="display: block; height: 400px; width: 500px; left: 698.5px; top: 274.5px;"><div id="lfaddpalette_windowTitle" class="ux_palette_top removeOutLine" tabindex="-1"><div id="lfaddpalette_window_handle" class="ux_palette_header removeOutLine" tabindex="-1"><a id="lfaddpalette_window_toggle" class="ux_palette_expanded ux_palette_toggle removeOutLine" onclick="AGILE.widget.Palettes['lfaddpalette_window'].togglePalette()" href="#"></a><h4 id="lfaddpalette_title" class="ux_palette_title" ondblclick="AGILE.widget.Palettes['lfaddpalette_window'].togglePalette()">File Upload Selector</h4><div class="ux_palette_windowbuttonpanel"><a id="lfaddpalette_window_close" title="Esc" tabindex="-1" class="ux_palette_windowbutton ux_palette_close removeOutLine" href="javascript:AGILE.widget.Palettes['lfaddpalette_window'].hidePalette()"><span>&nbsp;</span></a></div></div><div id="lfaddpalette_window_head" tabindex="-1" class="ux_palette_top_action_bar removeOutLine nodrag"><div id="lfaddpalette_window_anim" tabindex="-1" class="right_column removeOutLine nodrag"></div><div id="lfaddpalette_window_header" tabindex="-1" class="left_column removeOutLine nodrag"><div id="lf_add_palette_subtitle" class="lf_subtitle">FA-0505813</div><div class="fileupload-buttonbar"><div class="upload-buttons-span"><input type="checkbox" id="uploadImmediately" name="uploadImmediately"><label for="uploadImmediately" class="immediately-span">Start Upload Immediately</label><a id="uploadFilesUM" class="button disabled" href="#" onfocus="buttonFocus(this.id);" onblur="buttonBlur(this.id);"><span id="uploadFilesUMspan" class=" ">Upload</span></a></div><div><span class="fileinput-span lf-btn-span"><a id="browserFiles" href="#" onfocus="buttonFocus(this.id);" onblur="buttonBlur(this.id);" class="button"><span id="browserFilesspan">Browse for files</span><input type="file" accept="" id="add-files-input" title="Browse for Files or Drag Files onto the white box" name="files[]" multiple=""></a></span>&nbsp;<span class="lf-btn-span"><a id="clearFileUM" href="#" onclick="AGILE.widget.Palettes['lfaddpalette_window']._clearFiles();" onfocus="buttonFocus(this.id);" onblur="buttonBlur(this.id);" class="button"><span id="clearFileUMspan">Clear All</span></a></span></div><div class="clearfix">&nbsp;</div></div></div></div></div><div id="lfaddpalette_window_body_Maincontent" tabindex="-1" class="ux_palette_main removeOutLine nodrag"><div id="lfaddpalette_window_body_content" tabindex="-1" style="display: block; overflow-y: auto; height: 262px;" class="nodrag"><div id="add-files-selected-container"><ul id="add-files-selected-list"></ul></div></div><div id="lfaddpalette_window_savedSearch_content" tabindex="-1" style="display: none; heigth: 0px;" class="nodrag"></div></div><div id="lfaddpalette_window_footer" tabindex="-1" class="ux_palette_bottom removeOutLine nodrag"><div id="lfaddpalette_message" tabindex="-1" class="ux_palette_message_area removeOutLine nodrag"><p></p></div><div id="lfaddpalette_actions" tabindex="-1" class="ux_palette_bottom_action_bar removeOutLine nodrag"><div id="lfaddpalette_right_actions" style="width: 50%;" class="right_column removeOutLine nodrag" tabindex="-1"></div><div id="lfaddpalette_left_actions" class="left_column removeOutLine nodrag" tabindex="-1"><div class="upload-options"><div><label class="folder_type_label" for="selectedAttachmentSubClass" style="display: none;">Type</label><select id="selectedAttachmentSubClass" class="medium_width" size="1" name="selectedAttachmentSubClass" style="display: none;"></select></div><div><input type="checkbox" id="unZipFiles" name="unZipFiles"><label for="unZipFiles">Unzip all Zip files after upload</label></div><div><input type="checkbox" id="multipleFilesToRow" name="multipleFilesToRow"><label for="multipleFilesToRow">Add all files to a single file folder</label></div></div></div></div><div id="lfaddpalette_resize_handle" tabindex="-1" class="ux_palette_handle removeOutLine">&nbsp;</div></div></div></div><div id="dd-proxy" style="position: absolute; width: 15px; height: 15px; display: none; z-index: 99997;"> <p id="dragCount" class="drag_tooltip" tabindex="-1" style="position:absolute;z-index:99997;left:-9px;top:-8px;width: auto; min-width: 15px;padding: 2px;color: #000; background-color:  #fff;border: 1px dotted #787878;font-weight: bold;font-size: 14px; text-align: center;height: 15px;width: auto;min-width: 15px;padding: 2px; line-height: 14px;padding: 2px;opacity: .75;filter: alpha(opacity=75);"></p></div><div id="tools" class=" module yui-overlay yuimenu " style="position: absolute; visibility: hidden; z-index: 99998; width: 228px; left: 41.1875px; top: 55px;"><div class="bd"><ul class=" first-of-type"><li id="yui-gen0" class=" yuimenuitem first-of-type" groupindex="0" index="0"><a href="javascript:displayNewPDX()">Export</a></li><li id="yui-gen1" class=" yuimenuitem" groupindex="0" index="1"><a href="javascript:openMSProjectPublishWindow()">Create Project from XML File</a></li></ul><ul><li id="yui-gen2" class=" yuimenuitem hassubmenu first-of-type" groupindex="1" index="0"><a href="javascript:noaction()" class=" hassubmenu">Address Book</a><em class="submenuindicator">Submenu collapsed.  Click to expand submenu.</em><div id="18275" class=" module yui-overlay yuimenu " style="position: absolute; visibility: hidden; left: -1px; top: -30px; z-index: 99999; width: 128px;"><div class="bd"><ul class=" first-of-type"><li id="yui-gen3" class=" yuimenuitem first-of-type" groupindex="0" index="0"><a href="javascript:showAddressBook(0)">Users</a></li><li id="yui-gen4" class=" yuimenuitem" groupindex="0" index="1"><a href="javascript:showAddressBook(1)">User Groups</a></li><li id="yui-gen5" class=" yuimenuitem" groupindex="0" index="2"><a href="javascript:showAddressBook(2)">Functional Teams</a></li><li id="yui-gen6" class=" yuimenuitem" groupindex="0" index="3"><a href="javascript:showAddressBook(3)">Supplier Groups</a></li></ul></div></div></li><li id="link_autovue_open" class=" yuimenuitem" groupindex="1" index="1"><a href="javascript:setAutovueOpeningMode()">View files in separate Viewer windows</a></li><li id="yui-gen7" class=" yuimenuitem" groupindex="1" index="2"><a href="#">Bag and Tag Inventory</a></li><li id="yui-gen8" class=" yuimenuitem" groupindex="1" index="3"><a href="#">Closure Description Approval Tool</a></li><li id="yui-gen9" class=" yuimenuitem" groupindex="1" index="4"><a href="#">Master Data Maintenance</a></li><li id="yui-gen10" class=" yuimenuitem" groupindex="1" index="5"><a href="#">QIT Dashboard</a></li><li id="yui-gen11" class=" yuimenuitem" groupindex="1" index="6"><a href="#">QMS FA Reporting Dashboard</a></li><li id="yui-gen12" class=" yuimenuitem" groupindex="1" index="7"><a href="#">QMS Launch Page</a></li><li id="yui-gen13" class=" yuimenuitem" groupindex="1" index="8"><a href="#">RMA Tool</a></li></ul></div></div><iframe id="_yuiResizeMonitor" style="visibility: visible; width: 10em; height: 10em; position: absolute; top: -110px; left: -110px; border-style: none; border-width: 0px; opacity: 0;"></iframe><div id="helpMenu" class=" module yui-overlay yuimenu " style="position: absolute; visibility: hidden; z-index: 99998; width: 134px; left: 90.4375px; top: 55px;"><div class="bd"><ul class=" first-of-type"><li id="yui-gen14" class=" yuimenuitem first-of-type" groupindex="0" index="0"><a href="javascript:showOnlineHelp('http://www.oracle.com/technology/documentation/agile.html?Lang=en_US&amp;CTXEX=');">Help</a></li><li id="yui-gen15" class=" yuimenuitem" groupindex="0" index="1"><a href="javascript:displayAbout()">About</a></li></ul><ul><li id="yui-gen16" class=" yuimenuitem first-of-type" groupindex="1" index="0"><a href="javascript:openKeyBoardControls()">Keyboard Controls</a></li><li id="yui-gen17" class=" yuimenuitem" groupindex="1" index="1"><a href="javascript:openMoviePopup()">Quick Tours</a></li></ul></div></div><div style="position: absolute; top: -1000px; left: -1000px;"><span class="[object Event]tn">&nbsp;</span><span class="[object Event]tm">&nbsp;</span><span class="[object Event]tmh">&nbsp;</span><span class="[object Event]tp">&nbsp;</span><span class="[object Event]tph">&nbsp;</span><span class="[object Event]ln">&nbsp;</span><span class="[object Event]lm">&nbsp;</span><span class="[object Event]lmh">&nbsp;</span><span class="[object Event]lp">&nbsp;</span><span class="[object Event]lph">&nbsp;</span><span class="[object Event]loading">&nbsp;</span></div></body></html>